if (!function(a, b) {
    "object" == typeof module && "object" == typeof module.exports ? module.exports = a.document ? b(a, !0) : function(a) {
        if (!a.document) throw new Error("jQuery requires a window with a document");
        return b(a);
    } : b(a);
}("undefined" != typeof window ? window : this, function(a, b) {
    function q(a, b) {
        return b.toUpperCase();
    }
    var c = [], d = c.slice, e = c.concat, f = c.push, g = c.indexOf, h = {}, i = h.toString, j = h.hasOwnProperty, k = {}, Yb = "1.11.3", m = function(a, b) {
        return new m.fn.init(a, b);
    }, n = /^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g, o = /^-ms-/, p = /-([\da-z])/gi;
    function r(a) {
        var b = "length" in a && a.length, c = m.type(a);
        return "function" !== c && !m.isWindow(a) && (!(1 !== a.nodeType || !b) || ("array" === c || 0 === b || "number" == typeof b && 0 < b && b - 1 in a));
    }
    m.fn = m.prototype = {
        jquery: Yb,
        constructor: m,
        selector: "",
        length: 0,
        toArray: function() {
            return d.call(this);
        },
        get: function(a) {
            return null != a ? a < 0 ? this[a + this.length] : this[a] : d.call(this);
        },
        pushStack: function(b) {
            b = m.merge(this.constructor(), b);
            return b.prevObject = this, b.context = this.context, b;
        },
        each: function(a, b) {
            return m.each(this, a, b);
        },
        map: function(a) {
            return this.pushStack(m.map(this, function(b, c) {
                return a.call(b, c, b);
            }));
        },
        slice: function() {
            return this.pushStack(d.apply(this, arguments));
        },
        first: function() {
            return this.eq(0);
        },
        last: function() {
            return this.eq(-1);
        },
        eq: function(c) {
            var b = this.length, c = +c + (c < 0 ? b : 0);
            return this.pushStack(0 <= c && c < b ? [ this[c] ] : []);
        },
        end: function() {
            return this.prevObject || this.constructor(null);
        },
        push: f,
        sort: c.sort,
        splice: c.splice
    }, m.extend = m.fn.extend = function() {
        var b, c, d, e, f, g = arguments[0] || {}, h = 1, i = arguments.length, j = !1;
        for ("boolean" == typeof g && (j = g, g = arguments[h] || {}, h++), "object" == typeof g || m.isFunction(g) || (g = {}), 
        h === i && (g = this, h--); h < i; h++) if (null != (e = arguments[h])) for (d in e) f = g[d], 
        c = e[d], g !== c && (j && c && (m.isPlainObject(c) || (b = m.isArray(c))) ? (f = b ? (b = !1, 
        f && m.isArray(f) ? f : []) : f && m.isPlainObject(f) ? f : {}, g[d] = m.extend(j, f, c)) : void 0 !== c && (g[d] = c));
        return g;
    }, m.extend({
        expando: "jQuery" + (Yb + Math.random()).replace(/\D/g, ""),
        isReady: !0,
        error: function(a) {
            throw new Error(a);
        },
        noop: function() {},
        isFunction: function(a) {
            return "function" === m.type(a);
        },
        isArray: Array.isArray || function(a) {
            return "array" === m.type(a);
        },
        isWindow: function(a) {
            return null != a && a == a.window;
        },
        isNumeric: function(a) {
            return !m.isArray(a) && 0 <= a - parseFloat(a) + 1;
        },
        isEmptyObject: function(a) {
            for (var b in a) return !1;
            return !0;
        },
        isPlainObject: function(a) {
            if (!a || "object" !== m.type(a) || a.nodeType || m.isWindow(a)) return !1;
            try {
                if (a.constructor && !j.call(a, "constructor") && !j.call(a.constructor.prototype, "isPrototypeOf")) return !1;
            } catch (c) {
                return !1;
            }
            if (k.ownLast) for (var b in a) return j.call(a, b);
            for (b in a) ;
            return void 0 === b || j.call(a, b);
        },
        type: function(a) {
            return null == a ? a + "" : "object" == typeof a || "function" == typeof a ? h[i.call(a)] || "object" : typeof a;
        },
        globalEval: function(b) {
            b && m.trim(b) && (a.execScript || function(b) {
                a.eval.call(a, b);
            })(b);
        },
        camelCase: function(a) {
            return a.replace(o, "ms-").replace(p, q);
        },
        nodeName: function(a, b) {
            return a.nodeName && a.nodeName.toLowerCase() === b.toLowerCase();
        },
        each: function(a, b, c) {
            var d, e = 0, f = a.length, g = r(a);
            if (c) {
                if (g) for (;e < f && !1 !== (d = b.apply(a[e], c)); e++) ; else for (e in a) if (d = b.apply(a[e], c), 
                !1 === d) break;
            } else if (g) for (;e < f && !1 !== (d = b.call(a[e], e, a[e])); e++) ; else for (e in a) if (d = b.call(a[e], e, a[e]), 
            !1 === d) break;
            return a;
        },
        trim: function(a) {
            return null == a ? "" : (a + "").replace(n, "");
        },
        makeArray: function(a, c) {
            c = c || [];
            return null != a && (r(Object(a)) ? m.merge(c, "string" == typeof a ? [ a ] : a) : f.call(c, a)), 
            c;
        },
        inArray: function(a, b, c) {
            var d;
            if (b) {
                if (g) return g.call(b, a, c);
                for (d = b.length, c = c ? c < 0 ? Math.max(0, d + c) : c : 0; c < d; c++) if (c in b && b[c] === a) return c;
            }
            return -1;
        },
        merge: function(a, b) {
            for (var c = +b.length, d = 0, e = a.length; d < c; ) a[e++] = b[d++];
            if (c != c) for (;void 0 !== b[d]; ) a[e++] = b[d++];
            return a.length = e, a;
        },
        grep: function(a, b, c) {
            for (var e = [], f = 0, g = a.length, h = !c; f < g; f++) !b(a[f], f) != h && e.push(a[f]);
            return e;
        },
        map: function(a, b, c) {
            var d, f = 0, g = a.length, i = [];
            if (r(a)) for (;f < g; f++) null != (d = b(a[f], f, c)) && i.push(d); else for (f in a) d = b(a[f], f, c), 
            null != d && i.push(d);
            return e.apply([], i);
        },
        guid: 1,
        proxy: function(a, b) {
            var c, e;
            return "string" == typeof b && (e = a[b], b = a, a = e), m.isFunction(a) ? (c = d.call(arguments, 2), 
            (e = function() {
                return a.apply(b || this, c.concat(d.call(arguments)));
            }).guid = a.guid = a.guid || m.guid++, e) : void 0;
        },
        now: function() {
            return +new Date();
        },
        support: k
    }), m.each("Boolean Number String Function Array Date RegExp Object Error".split(" "), function(a, b) {
        h["[object " + b + "]"] = b.toLowerCase();
    });
    Yb = function(a) {
        function da(a, b, c) {
            var d = "0x" + b - 65536;
            return d != d || c ? b : d < 0 ? String.fromCharCode(65536 + d) : String.fromCharCode(d >> 10 | 55296, 1023 & d | 56320);
        }
        function ea() {
            m();
        }
        var b, c, d, e, f, g, h, i, j, k, l, m, n, o, p, q, r, s, t, u = "sizzle" + +new Date(), v = a.document, w = 0, x = 0, y = ha(), z = ha(), A = ha(), B = function(a, b) {
            return a === b && (l = !0), 0;
        }, D = {}.hasOwnProperty, E = [], F = E.pop, G = E.push, H = E.push, I = E.slice, J = function(a, b) {
            for (var c = 0, d = a.length; c < d; c++) if (a[c] === b) return c;
            return -1;
        }, K = "checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped", L = "[\\x20\\t\\r\\n\\f]", M = "(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+", N = M.replace("w", "w#"), O = "\\[" + L + "*(" + M + ")(?:" + L + "*([*^$|!~]?=)" + L + "*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|(" + N + "))|)" + L + "*\\]", P = ":(" + M + ")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|" + O + ")*)|.*)\\)|)", Q = new RegExp(L + "+", "g"), R = new RegExp("^" + L + "+|((?:^|[^\\\\])(?:\\\\.)*)" + L + "+$", "g"), S = new RegExp("^" + L + "*," + L + "*"), T = new RegExp("^" + L + "*([>+~]|" + L + ")" + L + "*"), U = new RegExp("=" + L + "*([^\\]'\"]*?)" + L + "*\\]", "g"), V = new RegExp(P), W = new RegExp("^" + N + "$"), X = {
            ID: new RegExp("^#(" + M + ")"),
            CLASS: new RegExp("^\\.(" + M + ")"),
            TAG: new RegExp("^(" + M.replace("w", "w*") + ")"),
            ATTR: new RegExp("^" + O),
            PSEUDO: new RegExp("^" + P),
            CHILD: new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\(" + L + "*(even|odd|(([+-]|)(\\d*)n|)" + L + "*(?:([+-]|)" + L + "*(\\d+)|))" + L + "*\\)|)", "i"),
            bool: new RegExp("^(?:" + K + ")$", "i"),
            needsContext: new RegExp("^" + L + "*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\(" + L + "*((?:-\\d)?\\d*)" + L + "*\\)|)(?=[^-]|$)", "i")
        }, Y = /^(?:input|select|textarea|button)$/i, Z = /^h\d$/i, $ = /^[^{]+\{\s*\[native \w/, _ = /^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/, aa = /[+~]/, ba = /'|\\/g, ca = new RegExp("\\\\([\\da-f]{1,6}" + L + "?|(" + L + ")|.)", "ig");
        try {
            H.apply(E = I.call(v.childNodes), v.childNodes), E[v.childNodes.length].nodeType;
        } catch (fa) {
            H = {
                apply: E.length ? function(a, b) {
                    G.apply(a, I.call(b));
                } : function(a, b) {
                    for (var c = a.length, d = 0; a[c++] = b[d++]; ) ;
                    a.length = c - 1;
                }
            };
        }
        function ga(a, b, d, e) {
            var k, l, o, r, s, w, x;
            if ((b ? b.ownerDocument || b : v) !== n && m(b), d = d || [], k = (b = b || n).nodeType, 
            "string" != typeof a || !a || 1 !== k && 9 !== k && 11 !== k) return d;
            if (!e && p) {
                if (11 !== k && (w = _.exec(a))) if (x = w[1]) {
                    if (9 === k) {
                        if (!(r = b.getElementById(x)) || !r.parentNode) return d;
                        if (r.id === x) return d.push(r), d;
                    } else if (b.ownerDocument && (r = b.ownerDocument.getElementById(x)) && t(b, r) && r.id === x) return d.push(r), 
                    d;
                } else {
                    if (w[2]) return H.apply(d, b.getElementsByTagName(a)), d;
                    if ((x = w[3]) && c.getElementsByClassName) return H.apply(d, b.getElementsByClassName(x)), 
                    d;
                }
                if (c.qsa && (!q || !q.test(a))) {
                    if (s = r = u, w = b, x = 1 !== k && a, 1 === k && "object" !== b.nodeName.toLowerCase()) {
                        for (o = g(a), (r = b.getAttribute("id")) ? s = r.replace(ba, "\\$&") : b.setAttribute("id", s), 
                        s = "[id='" + s + "'] ", l = o.length; l--; ) o[l] = s + ra(o[l]);
                        w = aa.test(a) && pa(b.parentNode) || b, x = o.join(",");
                    }
                    if (x) try {
                        return H.apply(d, w.querySelectorAll(x)), d;
                    } catch (y) {} finally {
                        r || b.removeAttribute("id");
                    }
                }
            }
            return i(a.replace(R, "$1"), b, d, e);
        }
        function ha() {
            var a = [];
            function b(c, e) {
                return a.push(c + " ") > d.cacheLength && delete b[a.shift()], b[c + " "] = e;
            }
            return b;
        }
        function ia(a) {
            return a[u] = !0, a;
        }
        function ja(a) {
            var b = n.createElement("div");
            try {
                return !!a(b);
            } catch (c) {
                return !1;
            } finally {
                b.parentNode && b.parentNode.removeChild(b), b = null;
            }
        }
        function ka(a, b) {
            for (var c = a.split("|"), e = a.length; e--; ) d.attrHandle[c[e]] = b;
        }
        function la(a, b) {
            var c = b && a, d = c && 1 === a.nodeType && 1 === b.nodeType && (~b.sourceIndex || 1 << 31) - (~a.sourceIndex || 1 << 31);
            if (d) return d;
            if (c) for (;c = c.nextSibling; ) if (c === b) return -1;
            return a ? 1 : -1;
        }
        function oa(a) {
            return ia(function(b) {
                return b = +b, ia(function(c, d) {
                    for (var e, f = a([], c.length, b), g = f.length; g--; ) c[e = f[g]] && (c[e] = !(d[e] = c[e]));
                });
            });
        }
        function pa(a) {
            return a && void 0 !== a.getElementsByTagName && a;
        }
        for (b in c = ga.support = {}, f = ga.isXML = function(b) {
            b = b && (b.ownerDocument || b).documentElement;
            return !!b && "HTML" !== b.nodeName;
        }, m = ga.setDocument = function(b) {
            var g = b ? b.ownerDocument || b : v;
            return g !== n && 9 === g.nodeType && g.documentElement ? (o = (n = g).documentElement, 
            (b = g.defaultView) && b !== b.top && (b.addEventListener ? b.addEventListener("unload", ea, !1) : b.attachEvent && b.attachEvent("onunload", ea)), 
            p = !f(g), c.attributes = ja(function(a) {
                return a.className = "i", !a.getAttribute("className");
            }), c.getElementsByTagName = ja(function(a) {
                return a.appendChild(g.createComment("")), !a.getElementsByTagName("*").length;
            }), c.getElementsByClassName = $.test(g.getElementsByClassName), c.getById = ja(function(a) {
                return o.appendChild(a).id = u, !g.getElementsByName || !g.getElementsByName(u).length;
            }), c.getById ? (d.find.ID = function(c, b) {
                if (void 0 !== b.getElementById && p) {
                    c = b.getElementById(c);
                    return c && c.parentNode ? [ c ] : [];
                }
            }, d.filter.ID = function(a) {
                var b = a.replace(ca, da);
                return function(a) {
                    return a.getAttribute("id") === b;
                };
            }) : (delete d.find.ID, d.filter.ID = function(a) {
                var b = a.replace(ca, da);
                return function(c) {
                    c = void 0 !== c.getAttributeNode && c.getAttributeNode("id");
                    return c && c.value === b;
                };
            }), d.find.TAG = c.getElementsByTagName ? function(a, b) {
                return void 0 !== b.getElementsByTagName ? b.getElementsByTagName(a) : c.qsa ? b.querySelectorAll(a) : void 0;
            } : function(a, b) {
                var c, d = [], e = 0, f = b.getElementsByTagName(a);
                if ("*" !== a) return f;
                for (;c = f[e++]; ) 1 === c.nodeType && d.push(c);
                return d;
            }, d.find.CLASS = c.getElementsByClassName && function(a, b) {
                return p ? b.getElementsByClassName(a) : void 0;
            }, r = [], q = [], (c.qsa = $.test(g.querySelectorAll)) && (ja(function(a) {
                o.appendChild(a).innerHTML = "<a id='" + u + "'></a><select id='" + u + "-\f]' msallowcapture=''><option selected=''></option></select>", 
                a.querySelectorAll("[msallowcapture^='']").length && q.push("[*^$]=" + L + "*(?:''|\"\")"), 
                a.querySelectorAll("[selected]").length || q.push("\\[" + L + "*(?:value|" + K + ")"), 
                a.querySelectorAll("[id~=" + u + "-]").length || q.push("~="), a.querySelectorAll(":checked").length || q.push(":checked"), 
                a.querySelectorAll("a#" + u + "+*").length || q.push(".#.+[+~]");
            }), ja(function(a) {
                var b = g.createElement("input");
                b.setAttribute("type", "hidden"), a.appendChild(b).setAttribute("name", "D"), a.querySelectorAll("[name=d]").length && q.push("name" + L + "*[*^$|!~]?="), 
                a.querySelectorAll(":enabled").length || q.push(":enabled", ":disabled"), a.querySelectorAll("*,:x"), 
                q.push(",.*:");
            })), (c.matchesSelector = $.test(s = o.matches || o.webkitMatchesSelector || o.mozMatchesSelector || o.oMatchesSelector || o.msMatchesSelector)) && ja(function(a) {
                c.disconnectedMatch = s.call(a, "div"), s.call(a, "[s!='']:x"), r.push("!=", P);
            }), q = q.length && new RegExp(q.join("|")), r = r.length && new RegExp(r.join("|")), 
            b = $.test(o.compareDocumentPosition), t = b || $.test(o.contains) ? function(a, d) {
                var c = 9 === a.nodeType ? a.documentElement : a, d = d && d.parentNode;
                return a === d || !(!d || 1 !== d.nodeType || !(c.contains ? c.contains(d) : a.compareDocumentPosition && 16 & a.compareDocumentPosition(d)));
            } : function(a, b) {
                if (b) for (;b = b.parentNode; ) if (b === a) return !0;
                return !1;
            }, B = b ? function(a, b) {
                if (a === b) return l = !0, 0;
                var d = !a.compareDocumentPosition - !b.compareDocumentPosition;
                return d || (1 & (d = (a.ownerDocument || a) === (b.ownerDocument || b) ? a.compareDocumentPosition(b) : 1) || !c.sortDetached && b.compareDocumentPosition(a) === d ? a === g || a.ownerDocument === v && t(v, a) ? -1 : b === g || b.ownerDocument === v && t(v, b) ? 1 : k ? J(k, a) - J(k, b) : 0 : 4 & d ? -1 : 1);
            } : function(a, b) {
                if (a === b) return l = !0, 0;
                var c, d = 0, e = a.parentNode, f = b.parentNode, h = [ a ], i = [ b ];
                if (!e || !f) return a === g ? -1 : b === g ? 1 : e ? -1 : f ? 1 : k ? J(k, a) - J(k, b) : 0;
                if (e === f) return la(a, b);
                for (c = a; c = c.parentNode; ) h.unshift(c);
                for (c = b; c = c.parentNode; ) i.unshift(c);
                for (;h[d] === i[d]; ) d++;
                return d ? la(h[d], i[d]) : h[d] === v ? -1 : i[d] === v ? 1 : 0;
            }, g) : n;
        }, ga.matches = function(a, b) {
            return ga(a, null, null, b);
        }, ga.matchesSelector = function(a, b) {
            if ((a.ownerDocument || a) !== n && m(a), b = b.replace(U, "='$1']"), !(!c.matchesSelector || !p || r && r.test(b) || q && q.test(b))) try {
                var d = s.call(a, b);
                if (d || c.disconnectedMatch || a.document && 11 !== a.document.nodeType) return d;
            } catch (e) {}
            return 0 < ga(b, n, null, [ a ]).length;
        }, ga.contains = function(a, b) {
            return (a.ownerDocument || a) !== n && m(a), t(a, b);
        }, ga.attr = function(a, b) {
            (a.ownerDocument || a) !== n && m(a);
            var f = d.attrHandle[b.toLowerCase()], f = f && D.call(d.attrHandle, b.toLowerCase()) ? f(a, b, !p) : void 0;
            return void 0 !== f ? f : c.attributes || !p ? a.getAttribute(b) : (f = a.getAttributeNode(b)) && f.specified ? f.value : null;
        }, ga.error = function(a) {
            throw new Error("Syntax error, unrecognized expression: " + a);
        }, ga.uniqueSort = function(a) {
            var b, d = [], e = 0, f = 0;
            if (l = !c.detectDuplicates, k = !c.sortStable && a.slice(0), a.sort(B), l) {
                for (;b = a[f++]; ) b === a[f] && (e = d.push(f));
                for (;e--; ) a.splice(d[e], 1);
            }
            return k = null, a;
        }, e = ga.getText = function(a) {
            var b, c = "", d = 0, f = a.nodeType;
            if (f) {
                if (1 === f || 9 === f || 11 === f) {
                    if ("string" == typeof a.textContent) return a.textContent;
                    for (a = a.firstChild; a; a = a.nextSibling) c += e(a);
                } else if (3 === f || 4 === f) return a.nodeValue;
            } else for (;b = a[d++]; ) c += e(b);
            return c;
        }, (d = ga.selectors = {
            cacheLength: 50,
            createPseudo: ia,
            match: X,
            attrHandle: {},
            find: {},
            relative: {
                ">": {
                    dir: "parentNode",
                    first: !0
                },
                " ": {
                    dir: "parentNode"
                },
                "+": {
                    dir: "previousSibling",
                    first: !0
                },
                "~": {
                    dir: "previousSibling"
                }
            },
            preFilter: {
                ATTR: function(a) {
                    return a[1] = a[1].replace(ca, da), a[3] = (a[3] || a[4] || a[5] || "").replace(ca, da), 
                    "~=" === a[2] && (a[3] = " " + a[3] + " "), a.slice(0, 4);
                },
                CHILD: function(a) {
                    return a[1] = a[1].toLowerCase(), "nth" === a[1].slice(0, 3) ? (a[3] || ga.error(a[0]), 
                    a[4] = +(a[4] ? a[5] + (a[6] || 1) : 2 * ("even" === a[3] || "odd" === a[3])), a[5] = +(a[7] + a[8] || "odd" === a[3])) : a[3] && ga.error(a[0]), 
                    a;
                },
                PSEUDO: function(a) {
                    var b, c = !a[6] && a[2];
                    return X.CHILD.test(a[0]) ? null : (a[3] ? a[2] = a[4] || a[5] || "" : c && V.test(c) && (b = g(c, !0)) && (b = c.indexOf(")", c.length - b) - c.length) && (a[0] = a[0].slice(0, b), 
                    a[2] = c.slice(0, b)), a.slice(0, 3));
                }
            },
            filter: {
                TAG: function(a) {
                    var b = a.replace(ca, da).toLowerCase();
                    return "*" === a ? function() {
                        return !0;
                    } : function(a) {
                        return a.nodeName && a.nodeName.toLowerCase() === b;
                    };
                },
                CLASS: function(a) {
                    var b = y[a + " "];
                    return b || (b = new RegExp("(^|" + L + ")" + a + "(" + L + "|$)")) && y(a, function(a) {
                        return b.test("string" == typeof a.className && a.className || void 0 !== a.getAttribute && a.getAttribute("class") || "");
                    });
                },
                ATTR: function(a, b, c) {
                    return function(e) {
                        e = ga.attr(e, a);
                        return null == e ? "!=" === b : !b || (e += "", "=" === b ? e === c : "!=" === b ? e !== c : "^=" === b ? c && 0 === e.indexOf(c) : "*=" === b ? c && -1 < e.indexOf(c) : "$=" === b ? c && e.slice(-c.length) === c : "~=" === b ? -1 < (" " + e.replace(Q, " ") + " ").indexOf(c) : "|=" === b && (e === c || e.slice(0, c.length + 1) === c + "-"));
                    };
                },
                CHILD: function(a, b, c, d, e) {
                    var f = "nth" !== a.slice(0, 3), g = "last" !== a.slice(-4), h = "of-type" === b;
                    return 1 === d && 0 === e ? function(a) {
                        return !!a.parentNode;
                    } : function(b, c, i) {
                        var j, k, l, m, n, o, p = f != g ? "nextSibling" : "previousSibling", q = b.parentNode, r = h && b.nodeName.toLowerCase(), s = !i && !h;
                        if (q) {
                            if (f) {
                                for (;p; ) {
                                    for (l = b; l = l[p]; ) if (h ? l.nodeName.toLowerCase() === r : 1 === l.nodeType) return !1;
                                    o = p = "only" === a && !o && "nextSibling";
                                }
                                return !0;
                            }
                            if (o = [ g ? q.firstChild : q.lastChild ], g && s) {
                                for (n = (j = (k = q[u] || (q[u] = {}))[a] || [])[0] === w && j[1], m = j[0] === w && j[2], 
                                l = n && q.childNodes[n]; l = ++n && l && l[p] || (m = n = 0) || o.pop(); ) if (1 === l.nodeType && ++m && l === b) {
                                    k[a] = [ w, n, m ];
                                    break;
                                }
                            } else if (s && (j = (b[u] || (b[u] = {}))[a]) && j[0] === w) m = j[1]; else for (;(l = ++n && l && l[p] || (m = n = 0) || o.pop()) && ((h ? l.nodeName.toLowerCase() !== r : 1 !== l.nodeType) || !++m || (s && ((l[u] || (l[u] = {}))[a] = [ w, m ]), 
                            l !== b)); ) ;
                            return (m -= e) === d || m % d == 0 && 0 <= m / d;
                        }
                    };
                },
                PSEUDO: function(a, b) {
                    var c, e = d.pseudos[a] || d.setFilters[a.toLowerCase()] || ga.error("unsupported pseudo: " + a);
                    return e[u] ? e(b) : 1 < e.length ? (c = [ a, a, "", b ], d.setFilters.hasOwnProperty(a.toLowerCase()) ? ia(function(a, c) {
                        for (var d, f = e(a, b), g = f.length; g--; ) a[d = J(a, f[g])] = !(c[d] = f[g]);
                    }) : function(a) {
                        return e(a, 0, c);
                    }) : e;
                }
            },
            pseudos: {
                not: ia(function(a) {
                    var b = [], c = [], d = h(a.replace(R, "$1"));
                    return d[u] ? ia(function(a, b, c, e) {
                        for (var f, g = d(a, null, e, []), h = a.length; h--; ) (f = g[h]) && (a[h] = !(b[h] = f));
                    }) : function(a, e, f) {
                        return b[0] = a, d(b, null, f, c), b[0] = null, !c.pop();
                    };
                }),
                has: ia(function(a) {
                    return function(b) {
                        return 0 < ga(a, b).length;
                    };
                }),
                contains: ia(function(a) {
                    return a = a.replace(ca, da), function(b) {
                        return -1 < (b.textContent || b.innerText || e(b)).indexOf(a);
                    };
                }),
                lang: ia(function(a) {
                    return W.test(a || "") || ga.error("unsupported lang: " + a), a = a.replace(ca, da).toLowerCase(), 
                    function(b) {
                        var c;
                        do {
                            if (c = p ? b.lang : b.getAttribute("xml:lang") || b.getAttribute("lang")) return (c = c.toLowerCase()) === a || 0 === c.indexOf(a + "-");
                        } while ((b = b.parentNode) && 1 === b.nodeType);
                        return !1;
                    };
                }),
                target: function(b) {
                    var c = a.location && a.location.hash;
                    return c && c.slice(1) === b.id;
                },
                root: function(a) {
                    return a === o;
                },
                focus: function(a) {
                    return a === n.activeElement && (!n.hasFocus || n.hasFocus()) && !!(a.type || a.href || ~a.tabIndex);
                },
                enabled: function(a) {
                    return !1 === a.disabled;
                },
                disabled: function(a) {
                    return !0 === a.disabled;
                },
                checked: function(a) {
                    var b = a.nodeName.toLowerCase();
                    return "input" === b && !!a.checked || "option" === b && !!a.selected;
                },
                selected: function(a) {
                    return a.parentNode && a.parentNode.selectedIndex, !0 === a.selected;
                },
                empty: function(a) {
                    for (a = a.firstChild; a; a = a.nextSibling) if (a.nodeType < 6) return !1;
                    return !0;
                },
                parent: function(a) {
                    return !d.pseudos.empty(a);
                },
                header: function(a) {
                    return Z.test(a.nodeName);
                },
                input: function(a) {
                    return Y.test(a.nodeName);
                },
                button: function(a) {
                    var b = a.nodeName.toLowerCase();
                    return "input" === b && "button" === a.type || "button" === b;
                },
                text: function(b) {
                    return "input" === b.nodeName.toLowerCase() && "text" === b.type && (null == (b = b.getAttribute("type")) || "text" === b.toLowerCase());
                },
                first: oa(function() {
                    return [ 0 ];
                }),
                last: oa(function(a, b) {
                    return [ b - 1 ];
                }),
                eq: oa(function(a, b, c) {
                    return [ c < 0 ? c + b : c ];
                }),
                even: oa(function(a, b) {
                    for (var c = 0; c < b; c += 2) a.push(c);
                    return a;
                }),
                odd: oa(function(a, b) {
                    for (var c = 1; c < b; c += 2) a.push(c);
                    return a;
                }),
                lt: oa(function(a, b, c) {
                    for (var d = c < 0 ? c + b : c; 0 <= --d; ) a.push(d);
                    return a;
                }),
                gt: oa(function(a, b, c) {
                    for (var d = c < 0 ? c + b : c; ++d < b; ) a.push(d);
                    return a;
                })
            }
        }).pseudos.nth = d.pseudos.eq, {
            radio: !0,
            checkbox: !0,
            file: !0,
            password: !0,
            image: !0
        }) d.pseudos[b] = function(a) {
            return function(b) {
                return "input" === b.nodeName.toLowerCase() && b.type === a;
            };
        }(b);
        for (b in {
            submit: !0,
            reset: !0
        }) d.pseudos[b] = function(a) {
            return function(b) {
                var c = b.nodeName.toLowerCase();
                return ("input" === c || "button" === c) && b.type === a;
            };
        }(b);
        function qa() {}
        function ra(a) {
            for (var b = 0, c = a.length, d = ""; b < c; b++) d += a[b].value;
            return d;
        }
        function sa(a, b, c) {
            var d = b.dir, e = c && "parentNode" === d, f = x++;
            return b.first ? function(b, c, f) {
                for (;b = b[d]; ) if (1 === b.nodeType || e) return a(b, c, f);
            } : function(b, c, g) {
                var h, i, j = [ w, f ];
                if (g) {
                    for (;b = b[d]; ) if ((1 === b.nodeType || e) && a(b, c, g)) return !0;
                } else for (;b = b[d]; ) if (1 === b.nodeType || e) {
                    if ((h = (i = b[u] || (b[u] = {}))[d]) && h[0] === w && h[1] === f) return j[2] = h[2];
                    if ((i[d] = j)[2] = a(b, c, g)) return !0;
                }
            };
        }
        function ta(a) {
            return 1 < a.length ? function(b, c, d) {
                for (var e = a.length; e--; ) if (!a[e](b, c, d)) return !1;
                return !0;
            } : a[0];
        }
        function va(a, b, c, d, e) {
            for (var f, g = [], h = 0, i = a.length, j = null != b; h < i; h++) !(f = a[h]) || c && !c(f, d, e) || (g.push(f), 
            j && b.push(h));
            return g;
        }
        function wa(a, b, c, d, e, f) {
            return d && !d[u] && (d = wa(d)), e && !e[u] && (e = wa(e, f)), ia(function(f, g, h, i) {
                var j, k, l, m = [], n = [], o = g.length, p = f || function(a, b, c) {
                    for (var d = 0, e = b.length; d < e; d++) ga(a, b[d], c);
                    return c;
                }(b || "*", h.nodeType ? [ h ] : h, []), q = !a || !f && b ? p : va(p, m, a, h, i), r = c ? e || (f ? a : o || d) ? [] : g : q;
                if (c && c(q, r, h, i), d) for (j = va(r, n), d(j, [], h, i), k = j.length; k--; ) (l = j[k]) && (r[n[k]] = !(q[n[k]] = l));
                if (f) {
                    if (e || a) {
                        if (e) {
                            for (j = [], k = r.length; k--; ) (l = r[k]) && j.push(q[k] = l);
                            e(null, r = [], j, i);
                        }
                        for (k = r.length; k--; ) (l = r[k]) && -1 < (j = e ? J(f, l) : m[k]) && (f[j] = !(g[j] = l));
                    }
                } else r = va(r === g ? r.splice(o, r.length) : r), e ? e(null, g, r, i) : H.apply(g, r);
            });
        }
        function xa(a) {
            for (var b, c, e, f = a.length, g = d.relative[a[0].type], h = g || d.relative[" "], i = g ? 1 : 0, k = sa(function(a) {
                return a === b;
            }, h, !0), l = sa(function(a) {
                return -1 < J(b, a);
            }, h, !0), m = [ function(a, c, e) {
                e = !g && (e || c !== j) || ((b = c).nodeType ? k : l)(a, c, e);
                return b = null, e;
            } ]; i < f; i++) if (c = d.relative[a[i].type]) m = [ sa(ta(m), c) ]; else {
                if ((c = d.filter[a[i].type].apply(null, a[i].matches))[u]) {
                    for (e = ++i; e < f && !d.relative[a[e].type]; e++) ;
                    return wa(1 < i && ta(m), 1 < i && ra(a.slice(0, i - 1).concat({
                        value: " " === a[i - 2].type ? "*" : ""
                    })).replace(R, "$1"), c, i < e && xa(a.slice(i, e)), e < f && xa(a = a.slice(e)), e < f && ra(a));
                }
                m.push(c);
            }
            return ta(m);
        }
        function ya(a, b) {
            function f(f, g, h, i, k) {
                var l, m, o, p = 0, q = "0", r = f && [], s = [], t = j, u = f || e && d.find.TAG("*", k), v = w += null == t ? 1 : Math.random() || .1, x = u.length;
                for (k && (j = g !== n && g); q !== x && null != (l = u[q]); q++) {
                    if (e && l) {
                        for (m = 0; o = a[m++]; ) if (o(l, g, h)) {
                            i.push(l);
                            break;
                        }
                        k && (w = v);
                    }
                    c && ((l = !o && l) && p--, f && r.push(l));
                }
                if (p += q, c && q !== p) {
                    for (m = 0; o = b[m++]; ) o(r, s, g, h);
                    if (f) {
                        if (0 < p) for (;q--; ) r[q] || s[q] || (s[q] = F.call(i));
                        s = va(s);
                    }
                    H.apply(i, s), k && !f && 0 < s.length && 1 < p + b.length && ga.uniqueSort(i);
                }
                return k && (w = v, j = t), r;
            }
            var c = 0 < b.length, e = 0 < a.length;
            return c ? ia(f) : f;
        }
        return qa.prototype = d.filters = d.pseudos, d.setFilters = new qa(), g = ga.tokenize = function(a, b) {
            var c, e, f, g, h, i, j, k = z[a + " "];
            if (k) return b ? 0 : k.slice(0);
            for (h = a, i = [], j = d.preFilter; h; ) {
                for (g in c && !(e = S.exec(h)) || (e && (h = h.slice(e[0].length) || h), i.push(f = [])), 
                c = !1, (e = T.exec(h)) && (c = e.shift(), f.push({
                    value: c,
                    type: e[0].replace(R, " ")
                }), h = h.slice(c.length)), d.filter) !(e = X[g].exec(h)) || j[g] && !(e = j[g](e)) || (c = e.shift(), 
                f.push({
                    value: c,
                    type: g,
                    matches: e
                }), h = h.slice(c.length));
                if (!c) break;
            }
            return b ? h.length : h ? ga.error(a) : z(a, i).slice(0);
        }, h = ga.compile = function(a, b) {
            var c, d = [], e = [], f = A[a + " "];
            if (!f) {
                for (c = (b = b || g(a)).length; c--; ) ((f = xa(b[c]))[u] ? d : e).push(f);
                (f = A(a, ya(e, d))).selector = a;
            }
            return f;
        }, i = ga.select = function(a, b, e, f) {
            var i, j, k, l, m, n = "function" == typeof a && a, o = !f && g(a = n.selector || a);
            if (e = e || [], 1 === o.length) {
                if (2 < (j = o[0] = o[0].slice(0)).length && "ID" === (k = j[0]).type && c.getById && 9 === b.nodeType && p && d.relative[j[1].type]) {
                    if (!(b = (d.find.ID(k.matches[0].replace(ca, da), b) || [])[0])) return e;
                    n && (b = b.parentNode), a = a.slice(j.shift().value.length);
                }
                for (i = X.needsContext.test(a) ? 0 : j.length; i-- && (k = j[i], !d.relative[l = k.type]); ) if ((m = d.find[l]) && (f = m(k.matches[0].replace(ca, da), aa.test(j[0].type) && pa(b.parentNode) || b))) {
                    if (j.splice(i, 1), !(a = f.length && ra(j))) return H.apply(e, f), e;
                    break;
                }
            }
            return (n || h(a, o))(f, b, !p, e, aa.test(a) && pa(b.parentNode) || b), e;
        }, c.sortStable = u.split("").sort(B).join("") === u, c.detectDuplicates = !!l, 
        m(), c.sortDetached = ja(function(a) {
            return 1 & a.compareDocumentPosition(n.createElement("div"));
        }), ja(function(a) {
            return a.innerHTML = "<a href='#'></a>", "#" === a.firstChild.getAttribute("href");
        }) || ka("type|href|height|width", function(a, b, c) {
            return c ? void 0 : a.getAttribute(b, "type" === b.toLowerCase() ? 1 : 2);
        }), c.attributes && ja(function(a) {
            return a.innerHTML = "<input/>", a.firstChild.setAttribute("value", ""), "" === a.firstChild.getAttribute("value");
        }) || ka("value", function(a, b, c) {
            return c || "input" !== a.nodeName.toLowerCase() ? void 0 : a.defaultValue;
        }), ja(function(a) {
            return null == a.getAttribute("disabled");
        }) || ka(K, function(a, d, c) {
            return c ? void 0 : !0 === a[d] ? d.toLowerCase() : (d = a.getAttributeNode(d)) && d.specified ? d.value : null;
        }), ga;
    }(a);
    m.find = Yb, m.expr = Yb.selectors, m.expr[":"] = m.expr.pseudos, m.unique = Yb.uniqueSort, 
    m.text = Yb.getText, m.isXMLDoc = Yb.isXML, m.contains = Yb.contains;
    var t = m.expr.match.needsContext, u = /^<(\w+)\s*\/?>(?:<\/\1>|)$/, v = /^.[^:#\[\.,]*$/;
    function w(a, b, c) {
        if (m.isFunction(b)) return m.grep(a, function(a, d) {
            return !!b.call(a, d, a) !== c;
        });
        if (b.nodeType) return m.grep(a, function(a) {
            return a === b !== c;
        });
        if ("string" == typeof b) {
            if (v.test(b)) return m.filter(b, a, c);
            b = m.filter(b, a);
        }
        return m.grep(a, function(a) {
            return 0 <= m.inArray(a, b) !== c;
        });
    }
    m.filter = function(a, b, c) {
        var d = b[0];
        return c && (a = ":not(" + a + ")"), 1 === b.length && 1 === d.nodeType ? m.find.matchesSelector(d, a) ? [ d ] : [] : m.find.matches(a, m.grep(b, function(a) {
            return 1 === a.nodeType;
        }));
    }, m.fn.extend({
        find: function(a) {
            var b, c = [], d = this, e = d.length;
            if ("string" != typeof a) return this.pushStack(m(a).filter(function() {
                for (b = 0; b < e; b++) if (m.contains(d[b], this)) return !0;
            }));
            for (b = 0; b < e; b++) m.find(a, d[b], c);
            return (c = this.pushStack(1 < e ? m.unique(c) : c)).selector = this.selector ? this.selector + " " + a : a, 
            c;
        },
        filter: function(a) {
            return this.pushStack(w(this, a || [], !1));
        },
        not: function(a) {
            return this.pushStack(w(this, a || [], !0));
        },
        is: function(a) {
            return !!w(this, "string" == typeof a && t.test(a) ? m(a) : a || [], !1).length;
        }
    });
    var y = a.document, z = /^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/;
    (m.fn.init = function(a, b) {
        var c, d;
        if (!a) return this;
        if ("string" != typeof a) return a.nodeType ? (this.context = this[0] = a, this.length = 1, 
        this) : m.isFunction(a) ? void 0 !== x.ready ? x.ready(a) : a(m) : (void 0 !== a.selector && (this.selector = a.selector, 
        this.context = a.context), m.makeArray(a, this));
        if (!(c = "<" === a.charAt(0) && ">" === a.charAt(a.length - 1) && 3 <= a.length ? [ null, a, null ] : z.exec(a)) || !c[1] && b) return (!b || b.jquery ? b || x : this.constructor(b)).find(a);
        if (c[1]) {
            if (b = b instanceof m ? b[0] : b, m.merge(this, m.parseHTML(c[1], b && b.nodeType ? b.ownerDocument || b : y, !0)), 
            u.test(c[1]) && m.isPlainObject(b)) for (c in b) m.isFunction(this[c]) ? this[c](b[c]) : this.attr(c, b[c]);
            return this;
        }
        if ((d = y.getElementById(c[2])) && d.parentNode) {
            if (d.id !== c[2]) return x.find(a);
            this.length = 1, this[0] = d;
        }
        return this.context = y, this.selector = a, this;
    }).prototype = m.fn;
    var x = m(y), B = /^(?:parents|prev(?:Until|All))/, C = {
        children: !0,
        contents: !0,
        next: !0,
        prev: !0
    };
    function D(a, b) {
        for (;(a = a[b]) && 1 !== a.nodeType; ) ;
        return a;
    }
    m.extend({
        dir: function(a, b, c) {
            for (var d = [], e = a[b]; e && 9 !== e.nodeType && (void 0 === c || 1 !== e.nodeType || !m(e).is(c)); ) 1 === e.nodeType && d.push(e), 
            e = e[b];
            return d;
        },
        sibling: function(a, b) {
            for (var c = []; a; a = a.nextSibling) 1 === a.nodeType && a !== b && c.push(a);
            return c;
        }
    }), m.fn.extend({
        has: function(a) {
            var b, c = m(a, this), d = c.length;
            return this.filter(function() {
                for (b = 0; b < d; b++) if (m.contains(this, c[b])) return !0;
            });
        },
        closest: function(a, b) {
            for (var c, d = 0, e = this.length, f = [], g = t.test(a) || "string" != typeof a ? m(a, b || this.context) : 0; d < e; d++) for (c = this[d]; c && c !== b; c = c.parentNode) if (c.nodeType < 11 && (g ? -1 < g.index(c) : 1 === c.nodeType && m.find.matchesSelector(c, a))) {
                f.push(c);
                break;
            }
            return this.pushStack(1 < f.length ? m.unique(f) : f);
        },
        index: function(a) {
            return a ? "string" == typeof a ? m.inArray(this[0], m(a)) : m.inArray(a.jquery ? a[0] : a, this) : this[0] && this[0].parentNode ? this.first().prevAll().length : -1;
        },
        add: function(a, b) {
            return this.pushStack(m.unique(m.merge(this.get(), m(a, b))));
        },
        addBack: function(a) {
            return this.add(null == a ? this.prevObject : this.prevObject.filter(a));
        }
    }), m.each({
        parent: function(b) {
            b = b.parentNode;
            return b && 11 !== b.nodeType ? b : null;
        },
        parents: function(a) {
            return m.dir(a, "parentNode");
        },
        parentsUntil: function(a, b, c) {
            return m.dir(a, "parentNode", c);
        },
        next: function(a) {
            return D(a, "nextSibling");
        },
        prev: function(a) {
            return D(a, "previousSibling");
        },
        nextAll: function(a) {
            return m.dir(a, "nextSibling");
        },
        prevAll: function(a) {
            return m.dir(a, "previousSibling");
        },
        nextUntil: function(a, b, c) {
            return m.dir(a, "nextSibling", c);
        },
        prevUntil: function(a, b, c) {
            return m.dir(a, "previousSibling", c);
        },
        siblings: function(a) {
            return m.sibling((a.parentNode || {}).firstChild, a);
        },
        children: function(a) {
            return m.sibling(a.firstChild);
        },
        contents: function(a) {
            return m.nodeName(a, "iframe") ? a.contentDocument || a.contentWindow.document : m.merge([], a.childNodes);
        }
    }, function(a, b) {
        m.fn[a] = function(c, d) {
            var e = m.map(this, b, c);
            return (d = "Until" !== a.slice(-5) ? c : d) && "string" == typeof d && (e = m.filter(d, e)), 
            1 < this.length && (C[a] || (e = m.unique(e)), B.test(a) && (e = e.reverse())), 
            this.pushStack(e);
        };
    });
    var H, E = /\S+/g, F = {};
    function I() {
        y.addEventListener ? (y.removeEventListener("DOMContentLoaded", J, !1), a.removeEventListener("load", J, !1)) : (y.detachEvent("onreadystatechange", J), 
        a.detachEvent("onload", J));
    }
    function J() {
        !y.addEventListener && "load" !== event.type && "complete" !== y.readyState || (I(), 
        m.ready());
    }
    m.Callbacks = function(a) {
        a = "string" == typeof a ? F[a] || function(a) {
            var b = F[a] = {};
            return m.each(a.match(E) || [], function(a, c) {
                b[c] = !0;
            }), b;
        }(a) : m.extend({}, a);
        var b, c, d, e, f, g, h = [], i = !a.once && [], j = function(l) {
            for (c = a.memory && l, d = !0, f = g || 0, g = 0, e = h.length, b = !0; h && f < e; f++) if (!1 === h[f].apply(l[0], l[1]) && a.stopOnFalse) {
                c = !1;
                break;
            }
            b = !1, h && (i ? i.length && j(i.shift()) : c ? h = [] : k.disable());
        }, k = {
            add: function() {
                var d;
                return h && (d = h.length, function f(b) {
                    m.each(b, function(b, c) {
                        var d = m.type(c);
                        "function" === d ? a.unique && k.has(c) || h.push(c) : c && c.length && "string" !== d && f(c);
                    });
                }(arguments), b ? e = h.length : c && (g = d, j(c))), this;
            },
            remove: function() {
                return h && m.each(arguments, function(a, c) {
                    for (var d; -1 < (d = m.inArray(c, h, d)); ) h.splice(d, 1), b && (d <= e && e--, 
                    d <= f && f--);
                }), this;
            },
            has: function(a) {
                return a ? -1 < m.inArray(a, h) : !(!h || !h.length);
            },
            empty: function() {
                return h = [], e = 0, this;
            },
            disable: function() {
                return h = i = c = void 0, this;
            },
            disabled: function() {
                return !h;
            },
            lock: function() {
                return i = void 0, c || k.disable(), this;
            },
            locked: function() {
                return !i;
            },
            fireWith: function(a, c) {
                return !h || d && !i || (c = [ a, (c = c || []).slice ? c.slice() : c ], b ? i.push(c) : j(c)), 
                this;
            },
            fire: function() {
                return k.fireWith(this, arguments), this;
            },
            fired: function() {
                return !!d;
            }
        };
        return k;
    }, m.extend({
        Deferred: function(a) {
            var b = [ [ "resolve", "done", m.Callbacks("once memory"), "resolved" ], [ "reject", "fail", m.Callbacks("once memory"), "rejected" ], [ "notify", "progress", m.Callbacks("memory") ] ], c = "pending", d = {
                state: function() {
                    return c;
                },
                always: function() {
                    return e.done(arguments).fail(arguments), this;
                },
                then: function() {
                    var a = arguments;
                    return m.Deferred(function(c) {
                        m.each(b, function(b, f) {
                            var g = m.isFunction(a[b]) && a[b];
                            e[f[1]](function() {
                                var a = g && g.apply(this, arguments);
                                a && m.isFunction(a.promise) ? a.promise().done(c.resolve).fail(c.reject).progress(c.notify) : c[f[0] + "With"](this === d ? c.promise() : this, g ? [ a ] : arguments);
                            });
                        }), a = null;
                    }).promise();
                },
                promise: function(a) {
                    return null != a ? m.extend(a, d) : d;
                }
            }, e = {};
            return d.pipe = d.then, m.each(b, function(a, f) {
                var g = f[2], h = f[3];
                d[f[1]] = g.add, h && g.add(function() {
                    c = h;
                }, b[1 ^ a][2].disable, b[2][2].lock), e[f[0]] = function() {
                    return e[f[0] + "With"](this === e ? d : this, arguments), this;
                }, e[f[0] + "With"] = g.fireWith;
            }), d.promise(e), a && a.call(e, e), e;
        },
        when: function(a) {
            function h(a, b, c) {
                return function(e) {
                    b[a] = this, c[a] = 1 < arguments.length ? d.call(arguments) : e, c === i ? g.notifyWith(b, c) : --f || g.resolveWith(b, c);
                };
            }
            var i, j, k, b = 0, c = d.call(arguments), e = c.length, f = 1 !== e || a && m.isFunction(a.promise) ? e : 0, g = 1 === f ? a : m.Deferred();
            if (1 < e) for (i = new Array(e), j = new Array(e), k = new Array(e); b < e; b++) c[b] && m.isFunction(c[b].promise) ? c[b].promise().done(h(b, k, c)).fail(g.reject).progress(h(b, j, i)) : --f;
            return f || g.resolveWith(k, c), g.promise();
        }
    }), m.fn.ready = function(a) {
        return m.ready.promise().done(a), this;
    }, m.extend({
        isReady: !1,
        readyWait: 1,
        holdReady: function(a) {
            a ? m.readyWait++ : m.ready(!0);
        },
        ready: function(a) {
            if (!0 === a ? !--m.readyWait : !m.isReady) {
                if (!y.body) return setTimeout(m.ready);
                (m.isReady = !0) !== a && 0 < --m.readyWait || (H.resolveWith(y, [ m ]), m.fn.triggerHandler && (m(y).triggerHandler("ready"), 
                m(y).off("ready")));
            }
        }
    }), m.ready.promise = function(b) {
        if (!H) if (H = m.Deferred(), "complete" === y.readyState) setTimeout(m.ready); else if (y.addEventListener) y.addEventListener("DOMContentLoaded", J, !1), 
        a.addEventListener("load", J, !1); else {
            y.attachEvent("onreadystatechange", J), a.attachEvent("onload", J);
            var c = !1;
            try {
                c = null == a.frameElement && y.documentElement;
            } catch (d) {}
            c && c.doScroll && !function e() {
                if (!m.isReady) {
                    try {
                        c.doScroll("left");
                    } catch (a) {
                        return setTimeout(e, 50);
                    }
                    I(), m.ready();
                }
            }();
        }
        return H.promise(b);
    };
    var L, K = "undefined";
    for (L in m(k)) break;
    k.ownLast = "0" !== L, k.inlineBlockNeedsLayout = !1, m(function() {
        var a, d, c = y.getElementsByTagName("body")[0];
        c && c.style && (a = y.createElement("div"), (d = y.createElement("div")).style.cssText = "position:absolute;border:0;width:0;height:0;top:0;left:-9999px", 
        c.appendChild(d).appendChild(a), typeof a.style.zoom !== K && (a.style.cssText = "display:inline;margin:0;border:0;padding:1px;width:1px;zoom:1", 
        k.inlineBlockNeedsLayout = a = 3 === a.offsetWidth, a && (c.style.zoom = 1)), c.removeChild(d));
    }), function() {
        var a = y.createElement("div");
        if (null == k.deleteExpando) {
            k.deleteExpando = !0;
            try {
                delete a.test;
            } catch (b) {
                k.deleteExpando = !1;
            }
        }
        a = null;
    }(), m.acceptData = function(a) {
        var b = m.noData[(a.nodeName + " ").toLowerCase()], c = +a.nodeType || 1;
        return (1 === c || 9 === c) && (!b || !0 !== b && a.getAttribute("classid") === b);
    };
    var M = /^(?:\{[\w\W]*\}|\[[\w\W]*\])$/, N = /([A-Z])/g;
    function O(a, b, c) {
        if (void 0 === c && 1 === a.nodeType) {
            var d = "data-" + b.replace(N, "-$1").toLowerCase();
            if ("string" == typeof (c = a.getAttribute(d))) {
                try {
                    c = "true" === c || "false" !== c && ("null" === c ? null : +c + "" === c ? +c : M.test(c) ? m.parseJSON(c) : c);
                } catch (e) {}
                m.data(a, b, c);
            } else c = void 0;
        }
        return c;
    }
    function P(a) {
        for (var b in a) if (("data" !== b || !m.isEmptyObject(a[b])) && "toJSON" !== b) return;
        return 1;
    }
    function Q(a, b, d, e) {
        if (m.acceptData(a)) {
            var f, h = m.expando, i = a.nodeType, j = i ? m.cache : a, g = i ? a[h] : a[h] && h;
            if (g && j[g] && (e || j[g].data) || void 0 !== d || "string" != typeof b) return j[g = g || (i ? a[h] = c.pop() || m.guid++ : h)] || (j[g] = i ? {} : {
                toJSON: m.noop
            }), "object" != typeof b && "function" != typeof b || (e ? j[g] = m.extend(j[g], b) : j[g].data = m.extend(j[g].data, b)), 
            g = j[g], e || (g.data || (g.data = {}), g = g.data), void 0 !== d && (g[m.camelCase(b)] = d), 
            "string" == typeof b ? null == (f = g[b]) && (f = g[m.camelCase(b)]) : f = g, f;
        }
    }
    function R(a, b, c) {
        if (m.acceptData(a)) {
            var d, e, f = a.nodeType, g = f ? m.cache : a, h = f ? a[m.expando] : m.expando;
            if (g[h]) {
                if (b && (d = c ? g[h] : g[h].data)) {
                    e = (b = m.isArray(b) ? b.concat(m.map(b, m.camelCase)) : b in d ? [ b ] : (b = m.camelCase(b)) in d ? [ b ] : b.split(" ")).length;
                    for (;e--; ) delete d[b[e]];
                    if (c ? !P(d) : !m.isEmptyObject(d)) return;
                }
                (c || (delete g[h].data, P(g[h]))) && (f ? m.cleanData([ a ], !0) : k.deleteExpando || g != g.window ? delete g[h] : g[h] = null);
            }
        }
    }
    m.extend({
        cache: {},
        noData: {
            "applet ": !0,
            "embed ": !0,
            "object ": "clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"
        },
        hasData: function(a) {
            return !!(a = a.nodeType ? m.cache[a[m.expando]] : a[m.expando]) && !P(a);
        },
        data: function(a, b, c) {
            return Q(a, b, c);
        },
        removeData: function(a, b) {
            return R(a, b);
        },
        _data: function(a, b, c) {
            return Q(a, b, c, !0);
        },
        _removeData: function(a, b) {
            return R(a, b, !0);
        }
    }), m.fn.extend({
        data: function(a, b) {
            var c, d, e, f = this[0], g = f && f.attributes;
            if (void 0 !== a) return "object" == typeof a ? this.each(function() {
                m.data(this, a);
            }) : 1 < arguments.length ? this.each(function() {
                m.data(this, a, b);
            }) : f ? O(f, a, m.data(f, a)) : void 0;
            if (this.length && (e = m.data(f), 1 === f.nodeType && !m._data(f, "parsedAttrs"))) {
                for (c = g.length; c--; ) g[c] && (0 === (d = g[c].name).indexOf("data-") && O(f, d = m.camelCase(d.slice(5)), e[d]));
                m._data(f, "parsedAttrs", !0);
            }
            return e;
        },
        removeData: function(a) {
            return this.each(function() {
                m.removeData(this, a);
            });
        }
    }), m.extend({
        queue: function(a, b, c) {
            var d;
            return a ? (d = m._data(a, b = (b || "fx") + "queue"), c && (!d || m.isArray(c) ? d = m._data(a, b, m.makeArray(c)) : d.push(c)), 
            d || []) : void 0;
        },
        dequeue: function(a, b) {
            var c = m.queue(a, b = b || "fx"), d = c.length, e = c.shift(), f = m._queueHooks(a, b);
            "inprogress" === e && (e = c.shift(), d--), e && ("fx" === b && c.unshift("inprogress"), 
            delete f.stop, e.call(a, function() {
                m.dequeue(a, b);
            }, f)), !d && f && f.empty.fire();
        },
        _queueHooks: function(a, b) {
            var c = b + "queueHooks";
            return m._data(a, c) || m._data(a, c, {
                empty: m.Callbacks("once memory").add(function() {
                    m._removeData(a, b + "queue"), m._removeData(a, c);
                })
            });
        }
    }), m.fn.extend({
        queue: function(a, b) {
            var c = 2;
            return "string" != typeof a && (b = a, a = "fx", c--), arguments.length < c ? m.queue(this[0], a) : void 0 === b ? this : this.each(function() {
                var c = m.queue(this, a, b);
                m._queueHooks(this, a), "fx" === a && "inprogress" !== c[0] && m.dequeue(this, a);
            });
        },
        dequeue: function(a) {
            return this.each(function() {
                m.dequeue(this, a);
            });
        },
        clearQueue: function(a) {
            return this.queue(a || "fx", []);
        },
        promise: function(a, b) {
            function h() {
                --d || e.resolveWith(f, [ f ]);
            }
            var c, d = 1, e = m.Deferred(), f = this, g = this.length;
            for ("string" != typeof a && (b = a, a = void 0), a = a || "fx"; g--; ) (c = m._data(f[g], a + "queueHooks")) && c.empty && (d++, 
            c.empty.add(h));
            return h(), e.promise(b);
        }
    });
    function U(a, b) {
        return "none" === m.css(a = b || a, "display") || !m.contains(a.ownerDocument, a);
    }
    var Yb = /[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source, T = [ "Top", "Right", "Bottom", "Left" ], V = m.access = function(a, b, c, d, e, f, g) {
        var h = 0, i = a.length, j = null == c;
        if ("object" === m.type(c)) for (h in e = !0, c) m.access(a, b, h, c[h], !0, f, g); else if (void 0 !== d && (e = !0, 
        m.isFunction(d) || (g = !0), b = j ? g ? (b.call(a, d), null) : (j = b, function(a, b, c) {
            return j.call(m(a), c);
        }) : b)) for (;h < i; h++) b(a[h], c, g ? d : d.call(a[h], h, b(a[h], c)));
        return e ? a : j ? b.call(a) : i ? b(a[0], c) : f;
    }, W = /^(?:checkbox|radio)$/i;
    !function() {
        var a = y.createElement("input"), b = y.createElement("div"), c = y.createDocumentFragment();
        if (b.innerHTML = "  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>", 
        k.leadingWhitespace = 3 === b.firstChild.nodeType, k.tbody = !b.getElementsByTagName("tbody").length, 
        k.htmlSerialize = !!b.getElementsByTagName("link").length, k.html5Clone = "<:nav></:nav>" !== y.createElement("nav").cloneNode(!0).outerHTML, 
        a.type = "checkbox", a.checked = !0, c.appendChild(a), k.appendChecked = a.checked, 
        b.innerHTML = "<textarea>x</textarea>", k.noCloneChecked = !!b.cloneNode(!0).lastChild.defaultValue, 
        c.appendChild(b), b.innerHTML = "<input type='radio' checked='checked' name='t'/>", 
        k.checkClone = b.cloneNode(!0).cloneNode(!0).lastChild.checked, k.noCloneEvent = !0, 
        b.attachEvent && (b.attachEvent("onclick", function() {
            k.noCloneEvent = !1;
        }), b.cloneNode(!0).click()), null == k.deleteExpando) {
            k.deleteExpando = !0;
            try {
                delete b.test;
            } catch (d) {
                k.deleteExpando = !1;
            }
        }
    }(), function() {
        var b, c, d = y.createElement("div");
        for (b in {
            submit: !0,
            change: !0,
            focusin: !0
        }) c = "on" + b, (k[b + "Bubbles"] = c in a) || (d.setAttribute(c, "t"), k[b + "Bubbles"] = !1 === d.attributes[c].expando);
        d = null;
    }();
    var X = /^(?:input|select|textarea)$/i, Y = /^key/, Z = /^(?:mouse|pointer|contextmenu)|click/, $ = /^(?:focusinfocus|focusoutblur)$/, _ = /^([^.]*)(?:\.(.+)|)$/;
    function aa() {
        return !0;
    }
    function ba() {
        return !1;
    }
    function ca() {
        try {
            return y.activeElement;
        } catch (a) {}
    }
    function da(a) {
        var b = ea.split("|"), c = a.createDocumentFragment();
        if (c.createElement) for (;b.length; ) c.createElement(b.pop());
        return c;
    }
    m.event = {
        global: {},
        add: function(a, b, c, d, e) {
            var g, h, i, j, k, l, o, p, n, r = m._data(a);
            if (r) {
                for (c.handler && (c = (i = c).handler, e = i.selector), c.guid || (c.guid = m.guid++), 
                (g = r.events) || (g = r.events = {}), (k = r.handle) || ((k = r.handle = function(a) {
                    return typeof m === K || a && m.event.triggered === a.type ? void 0 : m.event.dispatch.apply(k.elem, arguments);
                }).elem = a), h = (b = (b || "").match(E) || [ "" ]).length; h--; ) o = n = (l = _.exec(b[h]) || [])[1], 
                p = (l[2] || "").split(".").sort(), o && (j = m.event.special[o] || {}, o = (e ? j.delegateType : j.bindType) || o, 
                j = m.event.special[o] || {}, l = m.extend({
                    type: o,
                    origType: n,
                    data: d,
                    handler: c,
                    guid: c.guid,
                    selector: e,
                    needsContext: e && m.expr.match.needsContext.test(e),
                    namespace: p.join(".")
                }, i), (n = g[o]) || ((n = g[o] = []).delegateCount = 0, j.setup && !1 !== j.setup.call(a, d, p, k) || (a.addEventListener ? a.addEventListener(o, k, !1) : a.attachEvent && a.attachEvent("on" + o, k))), 
                j.add && (j.add.call(a, l), l.handler.guid || (l.handler.guid = c.guid)), e ? n.splice(n.delegateCount++, 0, l) : n.push(l), 
                m.event.global[o] = !0);
                a = null;
            }
        },
        remove: function(a, b, c, d, e) {
            var f, g, h, i, j, k, l, n, o, p, q, r = m.hasData(a) && m._data(a);
            if (r && (k = r.events)) {
                for (j = (b = (b || "").match(E) || [ "" ]).length; j--; ) if (o = q = (h = _.exec(b[j]) || [])[1], 
                p = (h[2] || "").split(".").sort(), o) {
                    for (l = m.event.special[o] || {}, n = k[o = (d ? l.delegateType : l.bindType) || o] || [], 
                    h = h[2] && new RegExp("(^|\\.)" + p.join("\\.(?:.*\\.|)") + "(\\.|$)"), i = f = n.length; f--; ) g = n[f], 
                    !e && q !== g.origType || c && c.guid !== g.guid || h && !h.test(g.namespace) || d && d !== g.selector && ("**" !== d || !g.selector) || (n.splice(f, 1), 
                    g.selector && n.delegateCount--, l.remove && l.remove.call(a, g));
                    i && !n.length && (l.teardown && !1 !== l.teardown.call(a, p, r.handle) || m.removeEvent(a, o, r.handle), 
                    delete k[o]);
                } else for (o in k) m.event.remove(a, o + b[j], c, d, !0);
                m.isEmptyObject(k) && (delete r.handle, m._removeData(a, "events"));
            }
        },
        trigger: function(b, c, d, e) {
            var f, g, i, k, l, n, o = [ d || y ], p = j.call(b, "type") ? b.type : b, q = j.call(b, "namespace") ? b.namespace.split(".") : [], h = l = d = d || y;
            if (3 !== d.nodeType && 8 !== d.nodeType && !$.test(p + m.event.triggered) && (0 <= p.indexOf(".") && (p = (q = p.split(".")).shift(), 
            q.sort()), g = p.indexOf(":") < 0 && "on" + p, (b = b[m.expando] ? b : new m.Event(p, "object" == typeof b && b)).isTrigger = e ? 2 : 3, 
            b.namespace = q.join("."), b.namespace_re = b.namespace ? new RegExp("(^|\\.)" + q.join("\\.(?:.*\\.|)") + "(\\.|$)") : null, 
            b.result = void 0, b.target || (b.target = d), c = null == c ? [ b ] : m.makeArray(c, [ b ]), 
            k = m.event.special[p] || {}, e || !k.trigger || !1 !== k.trigger.apply(d, c))) {
                if (!e && !k.noBubble && !m.isWindow(d)) {
                    for (i = k.delegateType || p, $.test(i + p) || (h = h.parentNode); h; h = h.parentNode) o.push(h), 
                    l = h;
                    l === (d.ownerDocument || y) && o.push(l.defaultView || l.parentWindow || a);
                }
                for (n = 0; (h = o[n++]) && !b.isPropagationStopped(); ) b.type = 1 < n ? i : k.bindType || p, 
                (f = (m._data(h, "events") || {})[b.type] && m._data(h, "handle")) && f.apply(h, c), 
                (f = g && h[g]) && f.apply && m.acceptData(h) && (b.result = f.apply(h, c), !1 === b.result && b.preventDefault());
                if (b.type = p, !e && !b.isDefaultPrevented() && (!k._default || !1 === k._default.apply(o.pop(), c)) && m.acceptData(d) && g && d[p] && !m.isWindow(d)) {
                    (l = d[g]) && (d[g] = null), m.event.triggered = p;
                    try {
                        d[p]();
                    } catch (r) {}
                    m.event.triggered = void 0, l && (d[g] = l);
                }
                return b.result;
            }
        },
        dispatch: function(a) {
            a = m.event.fix(a);
            var b, c, f, g, h, i = d.call(arguments), j = (m._data(this, "events") || {})[a.type] || [], k = m.event.special[a.type] || {};
            if ((i[0] = a).delegateTarget = this, !k.preDispatch || !1 !== k.preDispatch.call(this, a)) {
                for (h = m.event.handlers.call(this, a, j), b = 0; (f = h[b++]) && !a.isPropagationStopped(); ) for (a.currentTarget = f.elem, 
                g = 0; (c = f.handlers[g++]) && !a.isImmediatePropagationStopped(); ) a.namespace_re && !a.namespace_re.test(c.namespace) || (a.handleObj = c, 
                a.data = c.data, void 0 !== (c = ((m.event.special[c.origType] || {}).handle || c.handler).apply(f.elem, i)) && !1 === (a.result = c) && (a.preventDefault(), 
                a.stopPropagation()));
                return k.postDispatch && k.postDispatch.call(this, a), a.result;
            }
        },
        handlers: function(a, b) {
            var c, d, e, f, g = [], h = b.delegateCount, i = a.target;
            if (h && i.nodeType && (!a.button || "click" !== a.type)) for (;i != this; i = i.parentNode || this) if (1 === i.nodeType && (!0 !== i.disabled || "click" !== a.type)) {
                for (e = [], f = 0; f < h; f++) void 0 === e[c = (d = b[f]).selector + " "] && (e[c] = d.needsContext ? 0 <= m(c, this).index(i) : m.find(c, this, null, [ i ]).length), 
                e[c] && e.push(d);
                e.length && g.push({
                    elem: i,
                    handlers: e
                });
            }
            return h < b.length && g.push({
                elem: this,
                handlers: b.slice(h)
            }), g;
        },
        fix: function(a) {
            if (a[m.expando]) return a;
            var b, c, d, e = a.type, f = a, g = this.fixHooks[e];
            for (g || (this.fixHooks[e] = g = Z.test(e) ? this.mouseHooks : Y.test(e) ? this.keyHooks : {}), 
            d = g.props ? this.props.concat(g.props) : this.props, a = new m.Event(f), b = d.length; b--; ) a[c = d[b]] = f[c];
            return a.target || (a.target = f.srcElement || y), 3 === a.target.nodeType && (a.target = a.target.parentNode), 
            a.metaKey = !!a.metaKey, g.filter ? g.filter(a, f) : a;
        },
        props: "altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),
        fixHooks: {},
        keyHooks: {
            props: "char charCode key keyCode".split(" "),
            filter: function(a, b) {
                return null == a.which && (a.which = null != b.charCode ? b.charCode : b.keyCode), 
                a;
            }
        },
        mouseHooks: {
            props: "button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),
            filter: function(a, b) {
                var c, e, f = b.button, g = b.fromElement;
                return null == a.pageX && null != b.clientX && (e = (c = a.target.ownerDocument || y).documentElement, 
                c = c.body, a.pageX = b.clientX + (e && e.scrollLeft || c && c.scrollLeft || 0) - (e && e.clientLeft || c && c.clientLeft || 0), 
                a.pageY = b.clientY + (e && e.scrollTop || c && c.scrollTop || 0) - (e && e.clientTop || c && c.clientTop || 0)), 
                !a.relatedTarget && g && (a.relatedTarget = g === a.target ? b.toElement : g), a.which || void 0 === f || (a.which = 1 & f ? 1 : 2 & f ? 3 : 4 & f ? 2 : 0), 
                a;
            }
        },
        special: {
            load: {
                noBubble: !0
            },
            focus: {
                trigger: function() {
                    if (this !== ca() && this.focus) try {
                        return this.focus(), !1;
                    } catch (a) {}
                },
                delegateType: "focusin"
            },
            blur: {
                trigger: function() {
                    return this === ca() && this.blur ? (this.blur(), !1) : void 0;
                },
                delegateType: "focusout"
            },
            click: {
                trigger: function() {
                    return m.nodeName(this, "input") && "checkbox" === this.type && this.click ? (this.click(), 
                    !1) : void 0;
                },
                _default: function(a) {
                    return m.nodeName(a.target, "a");
                }
            },
            beforeunload: {
                postDispatch: function(a) {
                    void 0 !== a.result && a.originalEvent && (a.originalEvent.returnValue = a.result);
                }
            }
        },
        simulate: function(e, b, c, d) {
            e = m.extend(new m.Event(), c, {
                type: e,
                isSimulated: !0,
                originalEvent: {}
            });
            d ? m.event.trigger(e, null, b) : m.event.dispatch.call(b, e), e.isDefaultPrevented() && c.preventDefault();
        }
    }, m.removeEvent = y.removeEventListener ? function(a, b, c) {
        a.removeEventListener && a.removeEventListener(b, c, !1);
    } : function(a, d, c) {
        d = "on" + d;
        a.detachEvent && (typeof a[d] === K && (a[d] = null), a.detachEvent(d, c));
    }, m.Event = function(a, b) {
        return this instanceof m.Event ? (a && a.type ? (this.originalEvent = a, this.type = a.type, 
        this.isDefaultPrevented = a.defaultPrevented || void 0 === a.defaultPrevented && !1 === a.returnValue ? aa : ba) : this.type = a, 
        b && m.extend(this, b), this.timeStamp = a && a.timeStamp || m.now(), void (this[m.expando] = !0)) : new m.Event(a, b);
    }, m.Event.prototype = {
        isDefaultPrevented: ba,
        isPropagationStopped: ba,
        isImmediatePropagationStopped: ba,
        preventDefault: function() {
            var a = this.originalEvent;
            this.isDefaultPrevented = aa, a && (a.preventDefault ? a.preventDefault() : a.returnValue = !1);
        },
        stopPropagation: function() {
            var a = this.originalEvent;
            this.isPropagationStopped = aa, a && (a.stopPropagation && a.stopPropagation(), 
            a.cancelBubble = !0);
        },
        stopImmediatePropagation: function() {
            var a = this.originalEvent;
            this.isImmediatePropagationStopped = aa, a && a.stopImmediatePropagation && a.stopImmediatePropagation(), 
            this.stopPropagation();
        }
    }, m.each({
        mouseenter: "mouseover",
        mouseleave: "mouseout",
        pointerenter: "pointerover",
        pointerleave: "pointerout"
    }, function(a, b) {
        m.event.special[a] = {
            delegateType: b,
            bindType: b,
            handle: function(a) {
                var c, e = a.relatedTarget, f = a.handleObj;
                return e && (e === this || m.contains(this, e)) || (a.type = f.origType, c = f.handler.apply(this, arguments), 
                a.type = b), c;
            }
        };
    }), k.submitBubbles || (m.event.special.submit = {
        setup: function() {
            return !m.nodeName(this, "form") && void m.event.add(this, "click._submit keypress._submit", function(c) {
                c = c.target, c = m.nodeName(c, "input") || m.nodeName(c, "button") ? c.form : void 0;
                c && !m._data(c, "submitBubbles") && (m.event.add(c, "submit._submit", function(a) {
                    a._submit_bubble = !0;
                }), m._data(c, "submitBubbles", !0));
            });
        },
        postDispatch: function(a) {
            a._submit_bubble && (delete a._submit_bubble, this.parentNode && !a.isTrigger && m.event.simulate("submit", this.parentNode, a, !0));
        },
        teardown: function() {
            return !m.nodeName(this, "form") && void m.event.remove(this, "._submit");
        }
    }), k.changeBubbles || (m.event.special.change = {
        setup: function() {
            return X.test(this.nodeName) ? ("checkbox" !== this.type && "radio" !== this.type || (m.event.add(this, "propertychange._change", function(a) {
                "checked" === a.originalEvent.propertyName && (this._just_changed = !0);
            }), m.event.add(this, "click._change", function(a) {
                this._just_changed && !a.isTrigger && (this._just_changed = !1), m.event.simulate("change", this, a, !0);
            })), !1) : void m.event.add(this, "beforeactivate._change", function(b) {
                b = b.target;
                X.test(b.nodeName) && !m._data(b, "changeBubbles") && (m.event.add(b, "change._change", function(a) {
                    !this.parentNode || a.isSimulated || a.isTrigger || m.event.simulate("change", this.parentNode, a, !0);
                }), m._data(b, "changeBubbles", !0));
            });
        },
        handle: function(a) {
            var b = a.target;
            return this !== b || a.isSimulated || a.isTrigger || "radio" !== b.type && "checkbox" !== b.type ? a.handleObj.handler.apply(this, arguments) : void 0;
        },
        teardown: function() {
            return m.event.remove(this, "._change"), !X.test(this.nodeName);
        }
    }), k.focusinBubbles || m.each({
        focus: "focusin",
        blur: "focusout"
    }, function(a, b) {
        function c(a) {
            m.event.simulate(b, a.target, m.event.fix(a), !0);
        }
        m.event.special[b] = {
            setup: function() {
                var d = this.ownerDocument || this, e = m._data(d, b);
                e || d.addEventListener(a, c, !0), m._data(d, b, (e || 0) + 1);
            },
            teardown: function() {
                var d = this.ownerDocument || this, e = m._data(d, b) - 1;
                e ? m._data(d, b, e) : (d.removeEventListener(a, c, !0), m._removeData(d, b));
            }
        };
    }), m.fn.extend({
        on: function(a, b, c, d, e) {
            var f, g;
            if ("object" == typeof a) {
                for (f in "string" != typeof b && (c = c || b, b = void 0), a) this.on(f, b, c, a[f], e);
                return this;
            }
            if (null == c && null == d ? (d = b, c = b = void 0) : null == d && ("string" == typeof b ? (d = c, 
            c = void 0) : (d = c, c = b, b = void 0)), !1 === d) d = ba; else if (!d) return this;
            return 1 === e && (g = d, (d = function(a) {
                return m().off(a), g.apply(this, arguments);
            }).guid = g.guid || (g.guid = m.guid++)), this.each(function() {
                m.event.add(this, a, d, c, b);
            });
        },
        one: function(a, b, c, d) {
            return this.on(a, b, c, d, 1);
        },
        off: function(a, b, c) {
            var d, e;
            if (a && a.preventDefault && a.handleObj) return d = a.handleObj, m(a.delegateTarget).off(d.namespace ? d.origType + "." + d.namespace : d.origType, d.selector, d.handler), 
            this;
            if ("object" != typeof a) return !1 !== b && "function" != typeof b || (c = b, b = void 0), 
            !1 === c && (c = ba), this.each(function() {
                m.event.remove(this, a, c, b);
            });
            for (e in a) this.off(e, b, a[e]);
            return this;
        },
        trigger: function(a, b) {
            return this.each(function() {
                m.event.trigger(a, b, this);
            });
        },
        triggerHandler: function(a, b) {
            var c = this[0];
            return c ? m.event.trigger(a, b, c, !0) : void 0;
        }
    });
    var ea = "abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video", fa = / jQuery\d+="(?:null|\d+)"/g, ga = new RegExp("<(?:" + ea + ")[\\s/>]", "i"), ha = /^\s+/, ia = /<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi, ja = /<([\w:]+)/, ka = /<tbody/i, la = /<|&#?\w+;/, ma = /<(?:script|style|link)/i, na = /checked\s*(?:[^=]|=\s*.checked.)/i, oa = /^$|\/(?:java|ecma)script/i, pa = /^true\/(.*)/, qa = /^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g, ra = {
        option: [ 1, "<select multiple='multiple'>", "</select>" ],
        legend: [ 1, "<fieldset>", "</fieldset>" ],
        area: [ 1, "<map>", "</map>" ],
        param: [ 1, "<object>", "</object>" ],
        thead: [ 1, "<table>", "</table>" ],
        tr: [ 2, "<table><tbody>", "</tbody></table>" ],
        col: [ 2, "<table><tbody></tbody><colgroup>", "</colgroup></table>" ],
        td: [ 3, "<table><tbody><tr>", "</tr></tbody></table>" ],
        _default: k.htmlSerialize ? [ 0, "", "" ] : [ 1, "X<div>", "</div>" ]
    }, ta = da(y).appendChild(y.createElement("div"));
    function ua(a, b) {
        var c, d, e = 0, f = typeof a.getElementsByTagName !== K ? a.getElementsByTagName(b || "*") : typeof a.querySelectorAll !== K ? a.querySelectorAll(b || "*") : void 0;
        if (!f) for (f = [], c = a.childNodes || a; null != (d = c[e]); e++) !b || m.nodeName(d, b) ? f.push(d) : m.merge(f, ua(d, b));
        return void 0 === b || b && m.nodeName(a, b) ? m.merge([ a ], f) : f;
    }
    function va(a) {
        W.test(a.type) && (a.defaultChecked = a.checked);
    }
    function wa(a, b) {
        return m.nodeName(a, "table") && m.nodeName(11 !== b.nodeType ? b : b.firstChild, "tr") ? a.getElementsByTagName("tbody")[0] || a.appendChild(a.ownerDocument.createElement("tbody")) : a;
    }
    function xa(a) {
        return a.type = (null !== m.find.attr(a, "type")) + "/" + a.type, a;
    }
    function ya(a) {
        var b = pa.exec(a.type);
        return b ? a.type = b[1] : a.removeAttribute("type"), a;
    }
    function za(a, b) {
        for (var c, d = 0; null != (c = a[d]); d++) m._data(c, "globalEval", !b || m._data(b[d], "globalEval"));
    }
    function Aa(g, b) {
        if (1 === b.nodeType && m.hasData(g)) {
            var c, d, e, f = m._data(g), g = m._data(b, f), h = f.events;
            if (h) for (c in delete g.handle, g.events = {}, h) for (d = 0, e = h[c].length; d < e; d++) m.event.add(b, c, h[c][d]);
            g.data && (g.data = m.extend({}, g.data));
        }
    }
    ra.optgroup = ra.option, ra.tbody = ra.tfoot = ra.colgroup = ra.caption = ra.thead, 
    ra.th = ra.td, m.extend({
        clone: function(a, b, c) {
            var d, e, f, g, h, i = m.contains(a.ownerDocument, a);
            if (k.html5Clone || m.isXMLDoc(a) || !ga.test("<" + a.nodeName + ">") ? f = a.cloneNode(!0) : (ta.innerHTML = a.outerHTML, 
            ta.removeChild(f = ta.firstChild)), !(k.noCloneEvent && k.noCloneChecked || 1 !== a.nodeType && 11 !== a.nodeType || m.isXMLDoc(a))) for (d = ua(f), 
            h = ua(a), g = 0; null != (e = h[g]); ++g) d[g] && function(a, b) {
                var c, d, e;
                if (1 === b.nodeType) {
                    if (c = b.nodeName.toLowerCase(), !k.noCloneEvent && b[m.expando]) {
                        for (d in (e = m._data(b)).events) m.removeEvent(b, d, e.handle);
                        b.removeAttribute(m.expando);
                    }
                    "script" === c && b.text !== a.text ? (xa(b).text = a.text, ya(b)) : "object" === c ? (b.parentNode && (b.outerHTML = a.outerHTML), 
                    k.html5Clone && a.innerHTML && !m.trim(b.innerHTML) && (b.innerHTML = a.innerHTML)) : "input" === c && W.test(a.type) ? (b.defaultChecked = b.checked = a.checked, 
                    b.value !== a.value && (b.value = a.value)) : "option" === c ? b.defaultSelected = b.selected = a.defaultSelected : "input" !== c && "textarea" !== c || (b.defaultValue = a.defaultValue);
                }
            }(e, d[g]);
            if (b) if (c) for (h = h || ua(a), d = d || ua(f), g = 0; null != (e = h[g]); g++) Aa(e, d[g]); else Aa(a, f);
            return 0 < (d = ua(f, "script")).length && za(d, !i && ua(a, "script")), d = h = e = null, 
            f;
        },
        buildFragment: function(a, b, c, d) {
            for (var e, f, g, h, i, j, l, n = a.length, o = da(b), p = [], q = 0; q < n; q++) if ((f = a[q]) || 0 === f) if ("object" === m.type(f)) m.merge(p, f.nodeType ? [ f ] : f); else if (la.test(f)) {
                for (h = h || o.appendChild(b.createElement("div")), i = (ja.exec(f) || [ "", "" ])[1].toLowerCase(), 
                l = ra[i] || ra._default, h.innerHTML = l[1] + f.replace(ia, "<$1></$2>") + l[2], 
                e = l[0]; e--; ) h = h.lastChild;
                if (!k.leadingWhitespace && ha.test(f) && p.push(b.createTextNode(ha.exec(f)[0])), 
                !k.tbody) for (e = (f = "table" !== i || ka.test(f) ? "<table>" !== l[1] || ka.test(f) ? 0 : h : h.firstChild) && f.childNodes.length; e--; ) m.nodeName(j = f.childNodes[e], "tbody") && !j.childNodes.length && f.removeChild(j);
                for (m.merge(p, h.childNodes), h.textContent = ""; h.firstChild; ) h.removeChild(h.firstChild);
                h = o.lastChild;
            } else p.push(b.createTextNode(f));
            for (h && o.removeChild(h), k.appendChecked || m.grep(ua(p, "input"), va), q = 0; f = p[q++]; ) if ((!d || -1 === m.inArray(f, d)) && (g = m.contains(f.ownerDocument, f), 
            h = ua(o.appendChild(f), "script"), g && za(h), c)) for (e = 0; f = h[e++]; ) oa.test(f.type || "") && c.push(f);
            return h = null, o;
        },
        cleanData: function(a, b) {
            for (var d, e, f, g, h = 0, i = m.expando, j = m.cache, l = k.deleteExpando, n = m.event.special; null != (d = a[h]); h++) if ((b || m.acceptData(d)) && (g = (f = d[i]) && j[f])) {
                if (g.events) for (e in g.events) n[e] ? m.event.remove(d, e) : m.removeEvent(d, e, g.handle);
                j[f] && (delete j[f], l ? delete d[i] : typeof d.removeAttribute !== K ? d.removeAttribute(i) : d[i] = null, 
                c.push(f));
            }
        }
    }), m.fn.extend({
        text: function(a) {
            return V(this, function(a) {
                return void 0 === a ? m.text(this) : this.empty().append((this[0] && this[0].ownerDocument || y).createTextNode(a));
            }, null, a, arguments.length);
        },
        append: function() {
            return this.domManip(arguments, function(a) {
                1 !== this.nodeType && 11 !== this.nodeType && 9 !== this.nodeType || wa(this, a).appendChild(a);
            });
        },
        prepend: function() {
            return this.domManip(arguments, function(a) {
                var b;
                1 !== this.nodeType && 11 !== this.nodeType && 9 !== this.nodeType || (b = wa(this, a)).insertBefore(a, b.firstChild);
            });
        },
        before: function() {
            return this.domManip(arguments, function(a) {
                this.parentNode && this.parentNode.insertBefore(a, this);
            });
        },
        after: function() {
            return this.domManip(arguments, function(a) {
                this.parentNode && this.parentNode.insertBefore(a, this.nextSibling);
            });
        },
        remove: function(a, b) {
            for (var c, d = a ? m.filter(a, this) : this, e = 0; null != (c = d[e]); e++) b || 1 !== c.nodeType || m.cleanData(ua(c)), 
            c.parentNode && (b && m.contains(c.ownerDocument, c) && za(ua(c, "script")), c.parentNode.removeChild(c));
            return this;
        },
        empty: function() {
            for (var a, b = 0; null != (a = this[b]); b++) {
                for (1 === a.nodeType && m.cleanData(ua(a, !1)); a.firstChild; ) a.removeChild(a.firstChild);
                a.options && m.nodeName(a, "select") && (a.options.length = 0);
            }
            return this;
        },
        clone: function(a, b) {
            return a = null != a && a, b = null == b ? a : b, this.map(function() {
                return m.clone(this, a, b);
            });
        },
        html: function(a) {
            return V(this, function(a) {
                var b = this[0] || {}, c = 0, d = this.length;
                if (void 0 === a) return 1 === b.nodeType ? b.innerHTML.replace(fa, "") : void 0;
                if (!("string" != typeof a || ma.test(a) || !k.htmlSerialize && ga.test(a) || !k.leadingWhitespace && ha.test(a) || ra[(ja.exec(a) || [ "", "" ])[1].toLowerCase()])) {
                    a = a.replace(ia, "<$1></$2>");
                    try {
                        for (;c < d; c++) 1 === (b = this[c] || {}).nodeType && (m.cleanData(ua(b, !1)), 
                        b.innerHTML = a);
                        b = 0;
                    } catch (e) {}
                }
                b && this.empty().append(a);
            }, null, a, arguments.length);
        },
        replaceWith: function() {
            var a = arguments[0];
            return this.domManip(arguments, function(b) {
                a = this.parentNode, m.cleanData(ua(this)), a && a.replaceChild(b, this);
            }), a && (a.length || a.nodeType) ? this : this.remove();
        },
        detach: function(a) {
            return this.remove(a, !0);
        },
        domManip: function(a, b) {
            a = e.apply([], a);
            var c, d, f, g, h, i, j = 0, l = this.length, n = this, o = l - 1, p = a[0], q = m.isFunction(p);
            if (q || 1 < l && "string" == typeof p && !k.checkClone && na.test(p)) return this.each(function(c) {
                var d = n.eq(c);
                q && (a[0] = p.call(this, c, d.html())), d.domManip(a, b);
            });
            if (l && (c = (i = m.buildFragment(a, this[0].ownerDocument, !1, this)).firstChild, 
            1 === i.childNodes.length && (i = c), c)) {
                for (f = (g = m.map(ua(i, "script"), xa)).length; j < l; j++) d = i, j !== o && (d = m.clone(d, !0, !0), 
                f && m.merge(g, ua(d, "script"))), b.call(this[j], d, j);
                if (f) for (h = g[g.length - 1].ownerDocument, m.map(g, ya), j = 0; j < f; j++) d = g[j], 
                oa.test(d.type || "") && !m._data(d, "globalEval") && m.contains(h, d) && (d.src ? m._evalUrl && m._evalUrl(d.src) : m.globalEval((d.text || d.textContent || d.innerHTML || "").replace(qa, "")));
                i = c = null;
            }
            return this;
        }
    }), m.each({
        appendTo: "append",
        prependTo: "prepend",
        insertBefore: "before",
        insertAfter: "after",
        replaceAll: "replaceWith"
    }, function(a, b) {
        m.fn[a] = function(a) {
            for (var c, d = 0, e = [], g = m(a), h = g.length - 1; d <= h; d++) c = d === h ? this : this.clone(!0), 
            m(g[d])[b](c), f.apply(e, c.get());
            return this.pushStack(e);
        };
    });
    var Ca, Da = {};
    function Ea(b, e) {
        var e = m(e.createElement(b)).appendTo(e.body), f = a.getDefaultComputedStyle && (f = a.getDefaultComputedStyle(e[0])) ? f.display : m.css(e[0], "display");
        return e.detach(), f;
    }
    function Fa(a) {
        var b = y, c = Da[a];
        return c || ("none" !== (c = Ea(a, b)) && c || ((b = ((Ca = (Ca || m("<iframe frameborder='0' width='0' height='0'/>")).appendTo(b.documentElement))[0].contentWindow || Ca[0].contentDocument).document).write(), 
        b.close(), c = Ea(a, b), Ca.detach()), Da[a] = c), c;
    }
    !function() {
        var a;
        k.shrinkWrapBlocks = function() {
            return null != a ? a : (a = !1, (c = y.getElementsByTagName("body")[0]) && c.style ? (b = y.createElement("div"), 
            (d = y.createElement("div")).style.cssText = "position:absolute;border:0;width:0;height:0;top:0;left:-9999px", 
            c.appendChild(d).appendChild(b), typeof b.style.zoom !== K && (b.style.cssText = "-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:1px;width:1px;zoom:1", 
            b.appendChild(y.createElement("div")).style.width = "5px", a = 3 !== b.offsetWidth), 
            c.removeChild(d), a) : void 0);
            var b, c, d;
        };
    }();
    var Ia, Ja, Ga = /^margin/, Ha = new RegExp("^(" + Yb + ")(?!px)[a-z%]+$", "i"), Ka = /^(top|right|bottom|left)$/;
    function La(a, b) {
        return {
            get: function() {
                var c = a();
                if (null != c) return c ? void delete this.get : (this.get = b).apply(this, arguments);
            }
        };
    }
    a.getComputedStyle ? (Ia = function(b) {
        return (b.ownerDocument.defaultView.opener ? b.ownerDocument.defaultView : a).getComputedStyle(b, null);
    }, Ja = function(e, f, c) {
        var d, h = e.style, g = (c = c || Ia(e)) ? c.getPropertyValue(f) || c[f] : void 0;
        return c && ("" !== g || m.contains(e.ownerDocument, e) || (g = m.style(e, f)), 
        Ha.test(g) && Ga.test(f) && (d = h.width, e = h.minWidth, f = h.maxWidth, h.minWidth = h.maxWidth = h.width = g, 
        g = c.width, h.width = d, h.minWidth = e, h.maxWidth = f)), void 0 === g ? g : g + "";
    }) : y.documentElement.currentStyle && (Ia = function(a) {
        return a.currentStyle;
    }, Ja = function(a, b, f) {
        var d, e, g, h = a.style;
        return null == (g = (f = f || Ia(a)) ? f[b] : void 0) && h && h[b] && (g = h[b]), 
        Ha.test(g) && !Ka.test(b) && (d = h.left, (f = (e = a.runtimeStyle) && e.left) && (e.left = a.currentStyle.left), 
        h.left = "fontSize" === b ? "1em" : g, g = h.pixelLeft + "px", h.left = d, f && (e.left = f)), 
        void 0 === g ? g : g + "" || "auto";
    }), function() {
        var b, c, e, f, g, h;
        function i() {
            var b, d, i, c = y.getElementsByTagName("body")[0];
            c && c.style && (b = y.createElement("div"), (d = y.createElement("div")).style.cssText = "position:absolute;border:0;width:0;height:0;top:0;left:-9999px", 
            c.appendChild(d).appendChild(b), b.style.cssText = "-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute", 
            e = f = !1, h = !0, a.getComputedStyle && (e = "1%" !== (a.getComputedStyle(b, null) || {}).top, 
            f = "4px" === (a.getComputedStyle(b, null) || {
                width: "4px"
            }).width, (i = b.appendChild(y.createElement("div"))).style.cssText = b.style.cssText = "-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0", 
            i.style.marginRight = i.style.width = "0", b.style.width = "1px", h = !parseFloat((a.getComputedStyle(i, null) || {}).marginRight), 
            b.removeChild(i)), b.innerHTML = "<table><tr><td></td><td>t</td></tr></table>", 
            (i = b.getElementsByTagName("td"))[0].style.cssText = "margin:0;border:0;padding:0;display:none", 
            (g = 0 === i[0].offsetHeight) && (i[0].style.display = "", i[1].style.display = "none", 
            g = 0 === i[0].offsetHeight), c.removeChild(d));
        }
        (b = y.createElement("div")).innerHTML = "  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>", 
        (c = (c = b.getElementsByTagName("a")[0]) && c.style) && (c.cssText = "float:left;opacity:.5", 
        k.opacity = "0.5" === c.opacity, k.cssFloat = !!c.cssFloat, b.style.backgroundClip = "content-box", 
        b.cloneNode(!0).style.backgroundClip = "", k.clearCloneStyle = "content-box" === b.style.backgroundClip, 
        k.boxSizing = "" === c.boxSizing || "" === c.MozBoxSizing || "" === c.WebkitBoxSizing, 
        m.extend(k, {
            reliableHiddenOffsets: function() {
                return null == g && i(), g;
            },
            boxSizingReliable: function() {
                return null == f && i(), f;
            },
            pixelPosition: function() {
                return null == e && i(), e;
            },
            reliableMarginRight: function() {
                return null == h && i(), h;
            }
        }));
    }(), m.swap = function(a, b, c, e) {
        var f, g = {};
        for (f in b) g[f] = a.style[f], a.style[f] = b[f];
        for (f in e = c.apply(a, e || []), b) a.style[f] = g[f];
        return e;
    };
    var Ma = /alpha\([^)]*\)/i, Na = /opacity\s*=\s*([^)]*)/, Oa = /^(none|table(?!-c[ea]).+)/, Pa = new RegExp("^(" + Yb + ")(.*)$", "i"), Qa = new RegExp("^([+-])=(" + Yb + ")", "i"), Ra = {
        position: "absolute",
        visibility: "hidden",
        display: "block"
    }, Sa = {
        letterSpacing: "0",
        fontWeight: "400"
    }, Ta = [ "Webkit", "O", "Moz", "ms" ];
    function Ua(a, b) {
        if (b in a) return b;
        for (var c = b.charAt(0).toUpperCase() + b.slice(1), d = b, e = Ta.length; e--; ) if ((b = Ta[e] + c) in a) return b;
        return d;
    }
    function Va(a, b) {
        for (var c, d, e, f = [], g = 0, h = a.length; g < h; g++) (d = a[g]).style && (f[g] = m._data(d, "olddisplay"), 
        c = d.style.display, b ? (f[g] || "none" !== c || (d.style.display = ""), "" === d.style.display && U(d) && (f[g] = m._data(d, "olddisplay", Fa(d.nodeName)))) : (e = U(d), 
        (c && "none" !== c || !e) && m._data(d, "olddisplay", e ? c : m.css(d, "display"))));
        for (g = 0; g < h; g++) (d = a[g]).style && (b && "none" !== d.style.display && "" !== d.style.display || (d.style.display = b ? f[g] || "" : "none"));
        return a;
    }
    function Wa(a, b, c) {
        var d = Pa.exec(b);
        return d ? Math.max(0, d[1] - (c || 0)) + (d[2] || "px") : b;
    }
    function Xa(a, b, c, d, e) {
        for (var f = c === (d ? "border" : "content") ? 4 : "width" === b ? 1 : 0, g = 0; f < 4; f += 2) "margin" === c && (g += m.css(a, c + T[f], !0, e)), 
        d ? ("content" === c && (g -= m.css(a, "padding" + T[f], !0, e)), "margin" !== c && (g -= m.css(a, "border" + T[f] + "Width", !0, e))) : (g += m.css(a, "padding" + T[f], !0, e), 
        "padding" !== c && (g += m.css(a, "border" + T[f] + "Width", !0, e)));
        return g;
    }
    function Ya(a, b, c) {
        var d = !0, e = "width" === b ? a.offsetWidth : a.offsetHeight, f = Ia(a), g = k.boxSizing && "border-box" === m.css(a, "boxSizing", !1, f);
        if (e <= 0 || null == e) {
            if (((e = Ja(a, b, f)) < 0 || null == e) && (e = a.style[b]), Ha.test(e)) return e;
            d = g && (k.boxSizingReliable() || e === a.style[b]), e = parseFloat(e) || 0;
        }
        return e + Xa(a, b, c || (g ? "border" : "content"), d, f) + "px";
    }
    function Za(a, b, c, d, e) {
        return new Za.prototype.init(a, b, c, d, e);
    }
    m.extend({
        cssHooks: {
            opacity: {
                get: function(c, b) {
                    if (b) {
                        c = Ja(c, "opacity");
                        return "" === c ? "1" : c;
                    }
                }
            }
        },
        cssNumber: {
            columnCount: !0,
            fillOpacity: !0,
            flexGrow: !0,
            flexShrink: !0,
            fontWeight: !0,
            lineHeight: !0,
            opacity: !0,
            order: !0,
            orphans: !0,
            widows: !0,
            zIndex: !0,
            zoom: !0
        },
        cssProps: {
            float: k.cssFloat ? "cssFloat" : "styleFloat"
        },
        style: function(a, b, c, d) {
            if (a && 3 !== a.nodeType && 8 !== a.nodeType && a.style) {
                var e, f, g, h = m.camelCase(b), i = a.style;
                if (b = m.cssProps[h] || (m.cssProps[h] = Ua(i, h)), g = m.cssHooks[b] || m.cssHooks[h], 
                void 0 === c) return g && "get" in g && void 0 !== (e = g.get(a, !1, d)) ? e : i[b];
                if ("string" === (f = typeof c) && (e = Qa.exec(c)) && (c = (e[1] + 1) * e[2] + parseFloat(m.css(a, b)), 
                f = "number"), null != c && c == c && ("number" !== f || m.cssNumber[h] || (c += "px"), 
                k.clearCloneStyle || "" !== c || 0 !== b.indexOf("background") || (i[b] = "inherit"), 
                !(g && "set" in g && void 0 === (c = g.set(a, c, d))))) try {
                    i[b] = c;
                } catch (j) {}
            }
        },
        css: function(a, e, c, d) {
            var f, g = m.camelCase(e);
            return e = m.cssProps[g] || (m.cssProps[g] = Ua(a.style, g)), "normal" === (f = void 0 === (f = (g = m.cssHooks[e] || m.cssHooks[g]) && "get" in g ? g.get(a, !0, c) : f) ? Ja(a, e, d) : f) && e in Sa && (f = Sa[e]), 
            "" === c || c ? (e = parseFloat(f), !0 === c || m.isNumeric(e) ? e || 0 : f) : f;
        }
    }), m.each([ "height", "width" ], function(a, b) {
        m.cssHooks[b] = {
            get: function(a, c, d) {
                return c ? Oa.test(m.css(a, "display")) && 0 === a.offsetWidth ? m.swap(a, Ra, function() {
                    return Ya(a, b, d);
                }) : Ya(a, b, d) : void 0;
            },
            set: function(a, c, d) {
                var e = d && Ia(a);
                return Wa(0, c, d ? Xa(a, b, d, k.boxSizing && "border-box" === m.css(a, "boxSizing", !1, e), e) : 0);
            }
        };
    }), k.opacity || (m.cssHooks.opacity = {
        get: function(a, b) {
            return Na.test((b && a.currentStyle ? a.currentStyle : a.style).filter || "") ? .01 * parseFloat(RegExp.$1) + "" : b ? "1" : "";
        },
        set: function(f, b) {
            var c = f.style, d = f.currentStyle, e = m.isNumeric(b) ? "alpha(opacity=" + 100 * b + ")" : "", f = d && d.filter || c.filter || "";
            ((c.zoom = 1) <= b || "" === b) && "" === m.trim(f.replace(Ma, "")) && c.removeAttribute && (c.removeAttribute("filter"), 
            "" === b || d && !d.filter) || (c.filter = Ma.test(f) ? f.replace(Ma, e) : f + " " + e);
        }
    }), m.cssHooks.marginRight = La(k.reliableMarginRight, function(a, b) {
        return b ? m.swap(a, {
            display: "inline-block"
        }, Ja, [ a, "marginRight" ]) : void 0;
    }), m.each({
        margin: "",
        padding: "",
        border: "Width"
    }, function(a, b) {
        m.cssHooks[a + b] = {
            expand: function(c) {
                for (var d = 0, e = {}, f = "string" == typeof c ? c.split(" ") : [ c ]; d < 4; d++) e[a + T[d] + b] = f[d] || f[d - 2] || f[0];
                return e;
            }
        }, Ga.test(a) || (m.cssHooks[a + b].set = Wa);
    }), m.fn.extend({
        css: function(a, b) {
            return V(this, function(a, b, c) {
                var d, e, f = {}, g = 0;
                if (m.isArray(b)) {
                    for (d = Ia(a), e = b.length; g < e; g++) f[b[g]] = m.css(a, b[g], !1, d);
                    return f;
                }
                return void 0 !== c ? m.style(a, b, c) : m.css(a, b);
            }, a, b, 1 < arguments.length);
        },
        show: function() {
            return Va(this, !0);
        },
        hide: function() {
            return Va(this);
        },
        toggle: function(a) {
            return "boolean" == typeof a ? a ? this.show() : this.hide() : this.each(function() {
                U(this) ? m(this).show() : m(this).hide();
            });
        }
    }), (m.Tween = Za).prototype = {
        constructor: Za,
        init: function(a, b, c, d, e, f) {
            this.elem = a, this.prop = c, this.easing = e || "swing", this.options = b, this.start = this.now = this.cur(), 
            this.end = d, this.unit = f || (m.cssNumber[c] ? "" : "px");
        },
        cur: function() {
            var a = Za.propHooks[this.prop];
            return (a && a.get ? a : Za.propHooks._default).get(this);
        },
        run: function(a) {
            var b, c = Za.propHooks[this.prop];
            return this.options.duration ? this.pos = b = m.easing[this.easing](a, this.options.duration * a, 0, 1, this.options.duration) : this.pos = b = a, 
            this.now = (this.end - this.start) * b + this.start, this.options.step && this.options.step.call(this.elem, this.now, this), 
            (c && c.set ? c : Za.propHooks._default).set(this), this;
        }
    }, Za.prototype.init.prototype = Za.prototype, Za.propHooks = {
        _default: {
            get: function(a) {
                var b;
                return null == a.elem[a.prop] || a.elem.style && null != a.elem.style[a.prop] ? (b = m.css(a.elem, a.prop, "")) && "auto" !== b ? b : 0 : a.elem[a.prop];
            },
            set: function(a) {
                m.fx.step[a.prop] ? m.fx.step[a.prop](a) : a.elem.style && (null != a.elem.style[m.cssProps[a.prop]] || m.cssHooks[a.prop]) ? m.style(a.elem, a.prop, a.now + a.unit) : a.elem[a.prop] = a.now;
            }
        }
    }, Za.propHooks.scrollTop = Za.propHooks.scrollLeft = {
        set: function(a) {
            a.elem.nodeType && a.elem.parentNode && (a.elem[a.prop] = a.now);
        }
    }, m.easing = {
        linear: function(a) {
            return a;
        },
        swing: function(a) {
            return .5 - Math.cos(a * Math.PI) / 2;
        }
    }, m.fx = Za.prototype.init, m.fx.step = {};
    var $a, _a, ab = /^(?:toggle|show|hide)$/, bb = new RegExp("^(?:([+-])=|)(" + Yb + ")([a-z%]*)$", "i"), cb = /queueHooks$/, db = [ function(a, b, c) {
        var d, e, f, g, h, i, j, n = this, o = {}, p = a.style, q = a.nodeType && U(a), r = m._data(a, "fxshow");
        for (d in c.queue || (null == (h = m._queueHooks(a, "fx")).unqueued && (h.unqueued = 0, 
        i = h.empty.fire, h.empty.fire = function() {
            h.unqueued || i();
        }), h.unqueued++, n.always(function() {
            n.always(function() {
                h.unqueued--, m.queue(a, "fx").length || h.empty.fire();
            });
        })), 1 === a.nodeType && ("height" in b || "width" in b) && (c.overflow = [ p.overflow, p.overflowX, p.overflowY ], 
        j = m.css(a, "display"), "inline" === ("none" === j ? m._data(a, "olddisplay") || Fa(a.nodeName) : j) && "none" === m.css(a, "float") && (k.inlineBlockNeedsLayout && "inline" !== Fa(a.nodeName) ? p.zoom = 1 : p.display = "inline-block")), 
        c.overflow && (p.overflow = "hidden", k.shrinkWrapBlocks() || n.always(function() {
            p.overflow = c.overflow[0], p.overflowX = c.overflow[1], p.overflowY = c.overflow[2];
        })), b) if (e = b[d], ab.exec(e)) {
            if (delete b[d], f = f || "toggle" === e, e === (q ? "hide" : "show")) {
                if ("show" !== e || !r || void 0 === r[d]) continue;
                q = !0;
            }
            o[d] = r && r[d] || m.style(a, d);
        } else j = void 0;
        if (m.isEmptyObject(o)) "inline" === ("none" === j ? Fa(a.nodeName) : j) && (p.display = j); else for (d in r ? "hidden" in r && (q = r.hidden) : r = m._data(a, "fxshow", {}), 
        f && (r.hidden = !q), q ? m(a).show() : n.done(function() {
            m(a).hide();
        }), n.done(function() {
            for (var b in m._removeData(a, "fxshow"), o) m.style(a, b, o[b]);
        }), o) g = hb(q ? r[d] : 0, d, n), d in r || (r[d] = g.start, q && (g.end = g.start, 
        g.start = "width" === d || "height" === d ? 1 : 0));
    } ], eb = {
        "*": [ function(a, e) {
            var c = this.createTween(a, e), d = c.cur(), e = bb.exec(e), f = e && e[3] || (m.cssNumber[a] ? "" : "px"), g = (m.cssNumber[a] || "px" !== f && +d) && bb.exec(m.css(c.elem, a)), h = 1, i = 20;
            if (g && g[3] !== f) for (f = f || g[3], e = e || [], g = +d || 1; m.style(c.elem, a, (g /= h = h || ".5") + f), 
            h !== (h = c.cur() / d) && 1 !== h && --i; ) ;
            return e && (g = c.start = +g || +d || 0, c.unit = f, c.end = e[1] ? g + (e[1] + 1) * e[2] : +e[2]), 
            c;
        } ]
    };
    function fb() {
        return setTimeout(function() {
            $a = void 0;
        }), $a = m.now();
    }
    function gb(a, b) {
        var c, d = {
            height: a
        }, e = 0;
        for (b = b ? 1 : 0; e < 4; e += 2 - b) d["margin" + (c = T[e])] = d["padding" + c] = a;
        return b && (d.opacity = d.width = a), d;
    }
    function hb(a, b, c) {
        for (var d, e = (eb[b] || []).concat(eb["*"]), f = 0, g = e.length; f < g; f++) if (d = e[f].call(c, b, a)) return d;
    }
    function kb(a, b, c) {
        var d, e, f = 0, g = db.length, h = m.Deferred().always(function() {
            delete i.elem;
        }), i = function() {
            if (e) return !1;
            for (var c = $a || fb(), c = Math.max(0, j.startTime + j.duration - c), f = 1 - (c / j.duration || 0), g = 0, i = j.tweens.length; g < i; g++) j.tweens[g].run(f);
            return h.notifyWith(a, [ j, f, c ]), f < 1 && i ? c : (h.resolveWith(a, [ j ]), 
            !1);
        }, j = h.promise({
            elem: a,
            props: m.extend({}, b),
            opts: m.extend(!0, {
                specialEasing: {}
            }, c),
            originalProperties: b,
            originalOptions: c,
            startTime: $a || fb(),
            duration: c.duration,
            tweens: [],
            createTween: function(d, c) {
                d = m.Tween(a, j.opts, d, c, j.opts.specialEasing[d] || j.opts.easing);
                return j.tweens.push(d), d;
            },
            stop: function(b) {
                var c = 0, d = b ? j.tweens.length : 0;
                if (e) return this;
                for (e = !0; c < d; c++) j.tweens[c].run(1);
                return b ? h.resolveWith(a, [ j, b ]) : h.rejectWith(a, [ j, b ]), this;
            }
        }), k = j.props;
        for (function(a, b) {
            var c, d, e, f, g;
            for (c in a) if (d = m.camelCase(c), e = b[d], f = a[c], m.isArray(f) && (e = f[1], 
            f = a[c] = f[0]), c !== d && (a[d] = f, delete a[c]), g = m.cssHooks[d], g && "expand" in g) for (c in f = g.expand(f), 
            delete a[d], f) c in a || (a[c] = f[c], b[c] = e); else b[d] = e;
        }(k, j.opts.specialEasing); f < g; f++) if (d = db[f].call(j, a, k, j.opts)) return d;
        return m.map(k, hb, j), m.isFunction(j.opts.start) && j.opts.start.call(a, j), m.fx.timer(m.extend(i, {
            elem: a,
            anim: j,
            queue: j.opts.queue
        })), j.progress(j.opts.progress).done(j.opts.done, j.opts.complete).fail(j.opts.fail).always(j.opts.always);
    }
    m.Animation = m.extend(kb, {
        tweener: function(a, b) {
            for (var c, d = 0, e = (a = m.isFunction(a) ? (b = a, [ "*" ]) : a.split(" ")).length; d < e; d++) c = a[d], 
            eb[c] = eb[c] || [], eb[c].unshift(b);
        },
        prefilter: function(a, b) {
            b ? db.unshift(a) : db.push(a);
        }
    }), m.speed = function(a, b, c) {
        var d = a && "object" == typeof a ? m.extend({}, a) : {
            complete: c || !c && b || m.isFunction(a) && a,
            duration: a,
            easing: c && b || b && !m.isFunction(b) && b
        };
        return d.duration = m.fx.off ? 0 : "number" == typeof d.duration ? d.duration : d.duration in m.fx.speeds ? m.fx.speeds[d.duration] : m.fx.speeds._default, 
        null != d.queue && !0 !== d.queue || (d.queue = "fx"), d.old = d.complete, d.complete = function() {
            m.isFunction(d.old) && d.old.call(this), d.queue && m.dequeue(this, d.queue);
        }, d;
    }, m.fn.extend({
        fadeTo: function(a, b, c, d) {
            return this.filter(U).css("opacity", 0).show().end().animate({
                opacity: b
            }, a, c, d);
        },
        animate: function(a, b, c, g) {
            var e = m.isEmptyObject(a), f = m.speed(b, c, g), g = function() {
                var b = kb(this, m.extend({}, a), f);
                (e || m._data(this, "finish")) && b.stop(!0);
            };
            return g.finish = g, e || !1 === f.queue ? this.each(g) : this.queue(f.queue, g);
        },
        stop: function(a, b, c) {
            function d(a) {
                var b = a.stop;
                delete a.stop, b(c);
            }
            return "string" != typeof a && (c = b, b = a, a = void 0), b && !1 !== a && this.queue(a || "fx", []), 
            this.each(function() {
                var b = !0, e = null != a && a + "queueHooks", f = m.timers, g = m._data(this);
                if (e) g[e] && g[e].stop && d(g[e]); else for (e in g) g[e] && g[e].stop && cb.test(e) && d(g[e]);
                for (e = f.length; e--; ) f[e].elem !== this || null != a && f[e].queue !== a || (f[e].anim.stop(c), 
                b = !1, f.splice(e, 1));
                !b && c || m.dequeue(this, a);
            });
        },
        finish: function(a) {
            return !1 !== a && (a = a || "fx"), this.each(function() {
                var b, c = m._data(this), d = c[a + "queue"], e = c[a + "queueHooks"], f = m.timers, g = d ? d.length : 0;
                for (c.finish = !0, m.queue(this, a, []), e && e.stop && e.stop.call(this, !0), 
                b = f.length; b--; ) f[b].elem === this && f[b].queue === a && (f[b].anim.stop(!0), 
                f.splice(b, 1));
                for (b = 0; b < g; b++) d[b] && d[b].finish && d[b].finish.call(this);
                delete c.finish;
            });
        }
    }), m.each([ "toggle", "show", "hide" ], function(a, b) {
        var c = m.fn[b];
        m.fn[b] = function(a, d, e) {
            return null == a || "boolean" == typeof a ? c.apply(this, arguments) : this.animate(gb(b, !0), a, d, e);
        };
    }), m.each({
        slideDown: gb("show"),
        slideUp: gb("hide"),
        slideToggle: gb("toggle"),
        fadeIn: {
            opacity: "show"
        },
        fadeOut: {
            opacity: "hide"
        },
        fadeToggle: {
            opacity: "toggle"
        }
    }, function(a, b) {
        m.fn[a] = function(a, c, d) {
            return this.animate(b, a, c, d);
        };
    }), m.timers = [], m.fx.tick = function() {
        var a, b = m.timers, c = 0;
        for ($a = m.now(); c < b.length; c++) (a = b[c])() || b[c] !== a || b.splice(c--, 1);
        b.length || m.fx.stop(), $a = void 0;
    }, m.fx.timer = function(a) {
        m.timers.push(a), a() ? m.fx.start() : m.timers.pop();
    }, m.fx.interval = 13, m.fx.start = function() {
        _a = _a || setInterval(m.fx.tick, m.fx.interval);
    }, m.fx.stop = function() {
        clearInterval(_a), _a = null;
    }, m.fx.speeds = {
        slow: 600,
        fast: 200,
        _default: 400
    }, m.fn.delay = function(a, b) {
        return a = m.fx && m.fx.speeds[a] || a, this.queue(b = b || "fx", function(b, c) {
            var d = setTimeout(b, a);
            c.stop = function() {
                clearTimeout(d);
            };
        });
    }, function() {
        var a, c, d, e, b = y.createElement("div");
        b.setAttribute("className", "t"), b.innerHTML = "  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>", 
        d = b.getElementsByTagName("a")[0], e = (c = y.createElement("select")).appendChild(y.createElement("option")), 
        a = b.getElementsByTagName("input")[0], d.style.cssText = "top:1px", k.getSetAttribute = "t" !== b.className, 
        k.style = /top/.test(d.getAttribute("style")), k.hrefNormalized = "/a" === d.getAttribute("href"), 
        k.checkOn = !!a.value, k.optSelected = e.selected, k.enctype = !!y.createElement("form").enctype, 
        c.disabled = !0, k.optDisabled = !e.disabled, (a = y.createElement("input")).setAttribute("value", ""), 
        k.input = "" === a.getAttribute("value"), a.value = "t", a.setAttribute("type", "radio"), 
        k.radioValue = "t" === a.value;
    }();
    var lb = /\r/g;
    m.fn.extend({
        val: function(a) {
            var b, c, d, e = this[0];
            return arguments.length ? (d = m.isFunction(a), this.each(function(e) {
                1 === this.nodeType && (null == (e = d ? a.call(this, e, m(this).val()) : a) ? e = "" : "number" == typeof e ? e += "" : m.isArray(e) && (e = m.map(e, function(a) {
                    return null == a ? "" : a + "";
                })), (b = m.valHooks[this.type] || m.valHooks[this.nodeName.toLowerCase()]) && "set" in b && void 0 !== b.set(this, e, "value") || (this.value = e));
            })) : e ? (b = m.valHooks[e.type] || m.valHooks[e.nodeName.toLowerCase()]) && "get" in b && void 0 !== (c = b.get(e, "value")) ? c : "string" == typeof (c = e.value) ? c.replace(lb, "") : null == c ? "" : c : void 0;
        }
    }), m.extend({
        valHooks: {
            option: {
                get: function(a) {
                    var b = m.find.attr(a, "value");
                    return null != b ? b : m.trim(m.text(a));
                }
            },
            select: {
                get: function(a) {
                    for (var b, d = a.options, e = a.selectedIndex, f = "select-one" === a.type || e < 0, g = f ? null : [], h = f ? e + 1 : d.length, i = e < 0 ? h : f ? e : 0; i < h; i++) if (!(!(b = d[i]).selected && i !== e || (k.optDisabled ? b.disabled : null !== b.getAttribute("disabled")) || b.parentNode.disabled && m.nodeName(b.parentNode, "optgroup"))) {
                        if (b = m(b).val(), f) return b;
                        g.push(b);
                    }
                    return g;
                },
                set: function(a, b) {
                    for (var c, d, e = a.options, f = m.makeArray(b), g = e.length; g--; ) if (d = e[g], 
                    0 <= m.inArray(m.valHooks.option.get(d), f)) try {
                        d.selected = c = !0;
                    } catch (h) {
                        d.scrollHeight;
                    } else d.selected = !1;
                    return c || (a.selectedIndex = -1), e;
                }
            }
        }
    }), m.each([ "radio", "checkbox" ], function() {
        m.valHooks[this] = {
            set: function(a, b) {
                return m.isArray(b) ? a.checked = 0 <= m.inArray(m(a).val(), b) : void 0;
            }
        }, k.checkOn || (m.valHooks[this].get = function(a) {
            return null === a.getAttribute("value") ? "on" : a.value;
        });
    });
    var mb, nb, ob = m.expr.attrHandle, pb = /^(?:checked|selected)$/i, qb = k.getSetAttribute, rb = k.input;
    m.fn.extend({
        attr: function(a, b) {
            return V(this, m.attr, a, b, 1 < arguments.length);
        },
        removeAttr: function(a) {
            return this.each(function() {
                m.removeAttr(this, a);
            });
        }
    }), m.extend({
        attr: function(a, b, c) {
            var d, e, f = a.nodeType;
            if (a && 3 !== f && 8 !== f && 2 !== f) return typeof a.getAttribute === K ? m.prop(a, b, c) : (1 === f && m.isXMLDoc(a) || (b = b.toLowerCase(), 
            d = m.attrHooks[b] || (m.expr.match.bool.test(b) ? nb : mb)), void 0 === c ? d && "get" in d && null !== (e = d.get(a, b)) ? e : null == (e = m.find.attr(a, b)) ? void 0 : e : null !== c ? d && "set" in d && void 0 !== (e = d.set(a, c, b)) ? e : (a.setAttribute(b, c + ""), 
            c) : void m.removeAttr(a, b));
        },
        removeAttr: function(a, b) {
            var c, d, e = 0, f = b && b.match(E);
            if (f && 1 === a.nodeType) for (;c = f[e++]; ) d = m.propFix[c] || c, m.expr.match.bool.test(c) ? rb && qb || !pb.test(c) ? a[d] = !1 : a[m.camelCase("default-" + c)] = a[d] = !1 : m.attr(a, c, ""), 
            a.removeAttribute(qb ? c : d);
        },
        attrHooks: {
            type: {
                set: function(a, b) {
                    if (!k.radioValue && "radio" === b && m.nodeName(a, "input")) {
                        var c = a.value;
                        return a.setAttribute("type", b), c && (a.value = c), b;
                    }
                }
            }
        }
    }), nb = {
        set: function(a, b, c) {
            return !1 === b ? m.removeAttr(a, c) : rb && qb || !pb.test(c) ? a.setAttribute(!qb && m.propFix[c] || c, c) : a[m.camelCase("default-" + c)] = a[c] = !0, 
            c;
        }
    }, m.each(m.expr.match.bool.source.match(/\w+/g), function(a, b) {
        var c = ob[b] || m.find.attr;
        ob[b] = rb && qb || !pb.test(b) ? function(a, b, d) {
            var e, f;
            return d || (f = ob[b], ob[b] = e, e = null != c(a, b, d) ? b.toLowerCase() : null, 
            ob[b] = f), e;
        } : function(a, b, c) {
            return c ? void 0 : a[m.camelCase("default-" + b)] ? b.toLowerCase() : null;
        };
    }), rb && qb || (m.attrHooks.value = {
        set: function(a, b, c) {
            return m.nodeName(a, "input") ? void (a.defaultValue = b) : mb && mb.set(a, b, c);
        }
    }), qb || (mb = {
        set: function(a, b, c) {
            var d = a.getAttributeNode(c);
            return d || a.setAttributeNode(d = a.ownerDocument.createAttribute(c)), d.value = b += "", 
            "value" === c || b === a.getAttribute(c) ? b : void 0;
        }
    }, ob.id = ob.name = ob.coords = function(a, d, c) {
        return c ? void 0 : (d = a.getAttributeNode(d)) && "" !== d.value ? d.value : null;
    }, m.valHooks.button = {
        get: function(a, c) {
            c = a.getAttributeNode(c);
            return c && c.specified ? c.value : void 0;
        },
        set: mb.set
    }, m.attrHooks.contenteditable = {
        set: function(a, b, c) {
            mb.set(a, "" !== b && b, c);
        }
    }, m.each([ "width", "height" ], function(a, b) {
        m.attrHooks[b] = {
            set: function(a, c) {
                return "" === c ? (a.setAttribute(b, "auto"), c) : void 0;
            }
        };
    })), k.style || (m.attrHooks.style = {
        get: function(a) {
            return a.style.cssText || void 0;
        },
        set: function(a, b) {
            return a.style.cssText = b + "";
        }
    });
    var sb = /^(?:input|select|textarea|button|object)$/i, tb = /^(?:a|area)$/i;
    m.fn.extend({
        prop: function(a, b) {
            return V(this, m.prop, a, b, 1 < arguments.length);
        },
        removeProp: function(a) {
            return a = m.propFix[a] || a, this.each(function() {
                try {
                    this[a] = void 0, delete this[a];
                } catch (b) {}
            });
        }
    }), m.extend({
        propFix: {
            for: "htmlFor",
            class: "className"
        },
        prop: function(a, b, c) {
            var d, e, g = a.nodeType;
            if (a && 3 !== g && 8 !== g && 2 !== g) return (1 !== g || !m.isXMLDoc(a)) && (b = m.propFix[b] || b, 
            e = m.propHooks[b]), void 0 !== c ? e && "set" in e && void 0 !== (d = e.set(a, c, b)) ? d : a[b] = c : e && "get" in e && null !== (d = e.get(a, b)) ? d : a[b];
        },
        propHooks: {
            tabIndex: {
                get: function(a) {
                    var b = m.find.attr(a, "tabindex");
                    return b ? parseInt(b, 10) : sb.test(a.nodeName) || tb.test(a.nodeName) && a.href ? 0 : -1;
                }
            }
        }
    }), k.hrefNormalized || m.each([ "href", "src" ], function(a, b) {
        m.propHooks[b] = {
            get: function(a) {
                return a.getAttribute(b, 4);
            }
        };
    }), k.optSelected || (m.propHooks.selected = {
        get: function(b) {
            b = b.parentNode;
            return b && (b.selectedIndex, b.parentNode && b.parentNode.selectedIndex), null;
        }
    }), m.each([ "tabIndex", "readOnly", "maxLength", "cellSpacing", "cellPadding", "rowSpan", "colSpan", "useMap", "frameBorder", "contentEditable" ], function() {
        m.propFix[this.toLowerCase()] = this;
    }), k.enctype || (m.propFix.enctype = "encoding");
    var ub = /[\t\r\n\f]/g;
    m.fn.extend({
        addClass: function(a) {
            var b, c, d, e, f, g, h = 0, i = this.length, j = "string" == typeof a && a;
            if (m.isFunction(a)) return this.each(function(b) {
                m(this).addClass(a.call(this, b, this.className));
            });
            if (j) for (b = (a || "").match(E) || []; h < i; h++) if (d = 1 === (c = this[h]).nodeType && (c.className ? (" " + c.className + " ").replace(ub, " ") : " ")) {
                for (f = 0; e = b[f++]; ) d.indexOf(" " + e + " ") < 0 && (d += e + " ");
                g = m.trim(d), c.className !== g && (c.className = g);
            }
            return this;
        },
        removeClass: function(a) {
            var b, c, d, e, f, g, h = 0, i = this.length, j = 0 === arguments.length || "string" == typeof a && a;
            if (m.isFunction(a)) return this.each(function(b) {
                m(this).removeClass(a.call(this, b, this.className));
            });
            if (j) for (b = (a || "").match(E) || []; h < i; h++) if (d = 1 === (c = this[h]).nodeType && (c.className ? (" " + c.className + " ").replace(ub, " ") : "")) {
                for (f = 0; e = b[f++]; ) for (;0 <= d.indexOf(" " + e + " "); ) d = d.replace(" " + e + " ", " ");
                g = a ? m.trim(d) : "", c.className !== g && (c.className = g);
            }
            return this;
        },
        toggleClass: function(a, b) {
            var c = typeof a;
            return "boolean" == typeof b && "string" == c ? b ? this.addClass(a) : this.removeClass(a) : this.each(m.isFunction(a) ? function(c) {
                m(this).toggleClass(a.call(this, c, this.className, b), b);
            } : function() {
                if ("string" == c) for (var b, d = 0, e = m(this), f = a.match(E) || []; b = f[d++]; ) e.hasClass(b) ? e.removeClass(b) : e.addClass(b); else c !== K && "boolean" != c || (this.className && m._data(this, "__className__", this.className), 
                this.className = !this.className && !1 !== a && m._data(this, "__className__") || "");
            });
        },
        hasClass: function(a) {
            for (var b = " " + a + " ", c = 0, d = this.length; c < d; c++) if (1 === this[c].nodeType && 0 <= (" " + this[c].className + " ").replace(ub, " ").indexOf(b)) return !0;
            return !1;
        }
    }), m.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "), function(a, b) {
        m.fn[b] = function(a, c) {
            return 0 < arguments.length ? this.on(b, null, a, c) : this.trigger(b);
        };
    }), m.fn.extend({
        hover: function(a, b) {
            return this.mouseenter(a).mouseleave(b || a);
        },
        bind: function(a, b, c) {
            return this.on(a, null, b, c);
        },
        unbind: function(a, b) {
            return this.off(a, null, b);
        },
        delegate: function(a, b, c, d) {
            return this.on(b, a, c, d);
        },
        undelegate: function(a, b, c) {
            return 1 === arguments.length ? this.off(a, "**") : this.off(b, a || "**", c);
        }
    });
    var vb = m.now(), wb = /\?/, xb = /(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;
    m.parseJSON = function(b) {
        if (a.JSON && a.JSON.parse) return a.JSON.parse(b + "");
        var c, d = null, e = m.trim(b + "");
        return e && !m.trim(e.replace(xb, function(a, b, e, f) {
            return 0 === (d = c && b ? 0 : d) ? a : (c = e || b, d += !f - !e, "");
        })) ? Function("return " + e)() : m.error("Invalid JSON: " + b);
    }, m.parseXML = function(b) {
        var c;
        if (!b || "string" != typeof b) return null;
        try {
            a.DOMParser ? c = new DOMParser().parseFromString(b, "text/xml") : ((c = new ActiveXObject("Microsoft.XMLDOM")).async = "false", 
            c.loadXML(b));
        } catch (e) {
            c = void 0;
        }
        return c && c.documentElement && !c.getElementsByTagName("parsererror").length || m.error("Invalid XML: " + b), 
        c;
    };
    var yb, zb, Ab = /#.*$/, Bb = /([?&])_=[^&]*/, Cb = /^(.*?):[ \t]*([^\r\n]*)\r?$/gm, Eb = /^(?:GET|HEAD)$/, Fb = /^\/\//, Gb = /^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/, Hb = {}, Ib = {}, Jb = "*/".concat("*");
    try {
        zb = location.href;
    } catch (Kb) {
        (zb = y.createElement("a")).href = "", zb = zb.href;
    }
    function Lb(a) {
        return function(b, c) {
            "string" != typeof b && (c = b, b = "*");
            var d, e = 0, f = b.toLowerCase().match(E) || [];
            if (m.isFunction(c)) for (;d = f[e++]; ) "+" === d.charAt(0) ? (d = d.slice(1) || "*", 
            (a[d] = a[d] || []).unshift(c)) : (a[d] = a[d] || []).push(c);
        };
    }
    function Mb(a, b, c, d) {
        var e = {}, f = a === Ib;
        function g(h) {
            var i;
            return e[h] = !0, m.each(a[h] || [], function(a, j) {
                j = j(b, c, d);
                return "string" != typeof j || f || e[j] ? f ? !(i = j) : void 0 : (b.dataTypes.unshift(j), 
                g(j), !1);
            }), i;
        }
        return g(b.dataTypes[0]) || !e["*"] && g("*");
    }
    function Nb(a, b) {
        var c, d, e = m.ajaxSettings.flatOptions || {};
        for (d in b) void 0 !== b[d] && ((e[d] ? a : c = c || {})[d] = b[d]);
        return c && m.extend(!0, a, c), a;
    }
    yb = Gb.exec(zb.toLowerCase()) || [], m.extend({
        active: 0,
        lastModified: {},
        etag: {},
        ajaxSettings: {
            url: zb,
            type: "GET",
            isLocal: /^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(yb[1]),
            global: !0,
            processData: !0,
            async: !0,
            contentType: "application/x-www-form-urlencoded; charset=UTF-8",
            accepts: {
                "*": Jb,
                text: "text/plain",
                html: "text/html",
                xml: "application/xml, text/xml",
                json: "application/json, text/javascript"
            },
            contents: {
                xml: /xml/,
                html: /html/,
                json: /json/
            },
            responseFields: {
                xml: "responseXML",
                text: "responseText",
                json: "responseJSON"
            },
            converters: {
                "* text": String,
                "text html": !0,
                "text json": m.parseJSON,
                "text xml": m.parseXML
            },
            flatOptions: {
                url: !0,
                context: !0
            }
        },
        ajaxSetup: function(a, b) {
            return b ? Nb(Nb(a, m.ajaxSettings), b) : Nb(m.ajaxSettings, a);
        },
        ajaxPrefilter: Lb(Hb),
        ajaxTransport: Lb(Ib),
        ajax: function(c, b) {
            "object" == typeof c && (b = c, c = void 0);
            var d, e, f, g, h, i, j, k = m.ajaxSetup({}, b = b || {}), l = k.context || k, n = k.context && (l.nodeType || l.jquery) ? m(l) : m.event, o = m.Deferred(), p = m.Callbacks("once memory"), q = k.statusCode || {}, r = {}, s = {}, t = 0, u = "canceled", v = {
                readyState: 0,
                getResponseHeader: function(a) {
                    var b;
                    if (2 === t) {
                        if (!j) for (j = {}; b = Cb.exec(f); ) j[b[1].toLowerCase()] = b[2];
                        b = j[a.toLowerCase()];
                    }
                    return null == b ? null : b;
                },
                getAllResponseHeaders: function() {
                    return 2 === t ? f : null;
                },
                setRequestHeader: function(a, b) {
                    var c = a.toLowerCase();
                    return t || (a = s[c] = s[c] || a, r[a] = b), this;
                },
                overrideMimeType: function(a) {
                    return t || (k.mimeType = a), this;
                },
                statusCode: function(a) {
                    if (a) if (t < 2) for (var b in a) q[b] = [ q[b], a[b] ]; else v.always(a[v.status]);
                    return this;
                },
                abort: function(b) {
                    b = b || u;
                    return i && i.abort(b), x(0, b), this;
                }
            };
            if (o.promise(v).complete = p.add, v.success = v.done, v.error = v.fail, k.url = ((c || k.url || zb) + "").replace(Ab, "").replace(Fb, yb[1] + "//"), 
            k.type = b.method || b.type || k.method || k.type, k.dataTypes = m.trim(k.dataType || "*").toLowerCase().match(E) || [ "" ], 
            null == k.crossDomain && (c = Gb.exec(k.url.toLowerCase()), k.crossDomain = !(!c || c[1] === yb[1] && c[2] === yb[2] && (c[3] || ("http:" === c[1] ? "80" : "443")) === (yb[3] || ("http:" === yb[1] ? "80" : "443")))), 
            k.data && k.processData && "string" != typeof k.data && (k.data = m.param(k.data, k.traditional)), 
            Mb(Hb, k, b, v), 2 === t) return v;
            for (d in (h = m.event && k.global) && 0 == m.active++ && m.event.trigger("ajaxStart"), 
            k.type = k.type.toUpperCase(), k.hasContent = !Eb.test(k.type), e = k.url, k.hasContent || (k.data && (e = k.url += (wb.test(e) ? "&" : "?") + k.data, 
            delete k.data), !1 === k.cache && (k.url = Bb.test(e) ? e.replace(Bb, "$1_=" + vb++) : e + (wb.test(e) ? "&" : "?") + "_=" + vb++)), 
            k.ifModified && (m.lastModified[e] && v.setRequestHeader("If-Modified-Since", m.lastModified[e]), 
            m.etag[e] && v.setRequestHeader("If-None-Match", m.etag[e])), (k.data && k.hasContent && !1 !== k.contentType || b.contentType) && v.setRequestHeader("Content-Type", k.contentType), 
            v.setRequestHeader("Accept", k.dataTypes[0] && k.accepts[k.dataTypes[0]] ? k.accepts[k.dataTypes[0]] + ("*" !== k.dataTypes[0] ? ", " + Jb + "; q=0.01" : "") : k.accepts["*"]), 
            k.headers) v.setRequestHeader(d, k.headers[d]);
            if (k.beforeSend && (!1 === k.beforeSend.call(l, v, k) || 2 === t)) return v.abort();
            for (d in u = "abort", {
                success: 1,
                error: 1,
                complete: 1
            }) v[d](k[d]);
            if (i = Mb(Ib, k, b, v)) {
                v.readyState = 1, h && n.trigger("ajaxSend", [ v, k ]), k.async && 0 < k.timeout && (g = setTimeout(function() {
                    v.abort("timeout");
                }, k.timeout));
                try {
                    t = 1, i.send(r, x);
                } catch (w) {
                    if (!(t < 2)) throw w;
                    x(-1, w);
                }
            } else x(-1, "No Transport");
            function x(a, b, w, j) {
                var r, s, u, x = b;
                2 !== t && (t = 2, g && clearTimeout(g), i = void 0, f = j || "", v.readyState = 0 < a ? 4 : 0, 
                j = 200 <= a && a < 300 || 304 === a, w && (u = function(a, b, c) {
                    for (var d, e, f, g, h = a.contents, i = a.dataTypes; "*" === i[0]; ) i.shift(), 
                    void 0 === e && (e = a.mimeType || b.getResponseHeader("Content-Type"));
                    if (e) for (g in h) if (h[g] && h[g].test(e)) {
                        i.unshift(g);
                        break;
                    }
                    if (i[0] in c) f = i[0]; else {
                        for (g in c) {
                            if (!i[0] || a.converters[g + " " + i[0]]) {
                                f = g;
                                break;
                            }
                            d = d || g;
                        }
                        f = f || d;
                    }
                    return f ? (f !== i[0] && i.unshift(f), c[f]) : void 0;
                }(k, v, w)), u = function(a, b, c, d) {
                    var e, f, g, h, i, j = {}, k = a.dataTypes.slice();
                    if (k[1]) for (g in a.converters) j[g.toLowerCase()] = a.converters[g];
                    for (f = k.shift(); f; ) if (a.responseFields[f] && (c[a.responseFields[f]] = b), 
                    !i && d && a.dataFilter && (b = a.dataFilter(b, a.dataType)), i = f, f = k.shift()) if ("*" === f) f = i; else if ("*" !== i && i !== f) {
                        if (!(g = j[i + " " + f] || j["* " + f])) for (e in j) if (h = e.split(" "), h[1] === f && (g = j[i + " " + h[0]] || j["* " + h[0]])) {
                            !0 === g ? g = j[e] : !0 !== j[e] && (f = h[0], k.unshift(h[1]));
                            break;
                        }
                        if (!0 !== g) if (g && a.throws) b = g(b); else try {
                            b = g(b);
                        } catch (l) {
                            return {
                                state: "parsererror",
                                error: g ? l : "No conversion from " + i + " to " + f
                            };
                        }
                    }
                    return {
                        state: "success",
                        data: b
                    };
                }(k, u, v, j), j ? (k.ifModified && ((w = v.getResponseHeader("Last-Modified")) && (m.lastModified[e] = w), 
                (w = v.getResponseHeader("etag")) && (m.etag[e] = w)), 204 === a || "HEAD" === k.type ? x = "nocontent" : 304 === a ? x = "notmodified" : (x = u.state, 
                r = u.data, j = !(s = u.error))) : (s = x, !a && x || (x = "error", a < 0 && (a = 0))), 
                v.status = a, v.statusText = (b || x) + "", j ? o.resolveWith(l, [ r, x, v ]) : o.rejectWith(l, [ v, x, s ]), 
                v.statusCode(q), q = void 0, h && n.trigger(j ? "ajaxSuccess" : "ajaxError", [ v, k, j ? r : s ]), 
                p.fireWith(l, [ v, x ]), h && (n.trigger("ajaxComplete", [ v, k ]), --m.active || m.event.trigger("ajaxStop")));
            }
            return v;
        },
        getJSON: function(a, b, c) {
            return m.get(a, b, c, "json");
        },
        getScript: function(a, b) {
            return m.get(a, void 0, b, "script");
        }
    }), m.each([ "get", "post" ], function(a, b) {
        m[b] = function(a, c, d, e) {
            return m.isFunction(c) && (e = e || d, d = c, c = void 0), m.ajax({
                url: a,
                type: b,
                dataType: e,
                data: c,
                success: d
            });
        };
    }), m._evalUrl = function(a) {
        return m.ajax({
            url: a,
            type: "GET",
            dataType: "script",
            async: !1,
            global: !1,
            throws: !0
        });
    }, m.fn.extend({
        wrapAll: function(a) {
            return m.isFunction(a) ? this.each(function(b) {
                m(this).wrapAll(a.call(this, b));
            }) : (this[0] && (b = m(a, this[0].ownerDocument).eq(0).clone(!0), this[0].parentNode && b.insertBefore(this[0]), 
            b.map(function() {
                for (var a = this; a.firstChild && 1 === a.firstChild.nodeType; ) a = a.firstChild;
                return a;
            }).append(this)), this);
            var b;
        },
        wrapInner: function(a) {
            return this.each(m.isFunction(a) ? function(b) {
                m(this).wrapInner(a.call(this, b));
            } : function() {
                var b = m(this), c = b.contents();
                c.length ? c.wrapAll(a) : b.append(a);
            });
        },
        wrap: function(a) {
            var b = m.isFunction(a);
            return this.each(function(c) {
                m(this).wrapAll(b ? a.call(this, c) : a);
            });
        },
        unwrap: function() {
            return this.parent().each(function() {
                m.nodeName(this, "body") || m(this).replaceWith(this.childNodes);
            }).end();
        }
    }), m.expr.filters.hidden = function(a) {
        return a.offsetWidth <= 0 && a.offsetHeight <= 0 || !k.reliableHiddenOffsets() && "none" === (a.style && a.style.display || m.css(a, "display"));
    }, m.expr.filters.visible = function(a) {
        return !m.expr.filters.hidden(a);
    };
    var Qb = /%20/g, Rb = /\[\]$/, Sb = /\r?\n/g, Tb = /^(?:submit|button|image|reset|file)$/i, Ub = /^(?:input|select|textarea|keygen)/i;
    m.param = function(a, b) {
        function e(a, b) {
            b = m.isFunction(b) ? b() : null == b ? "" : b, d[d.length] = encodeURIComponent(a) + "=" + encodeURIComponent(b);
        }
        var c, d = [];
        if (void 0 === b && (b = m.ajaxSettings && m.ajaxSettings.traditional), m.isArray(a) || a.jquery && !m.isPlainObject(a)) m.each(a, function() {
            e(this.name, this.value);
        }); else for (c in a) !function Vb(a, b, c, d) {
            if (m.isArray(b)) m.each(b, function(b, e) {
                c || Rb.test(a) ? d(a, e) : Vb(a + "[" + ("object" == typeof e ? b : "") + "]", e, c, d);
            }); else if (c || "object" !== m.type(b)) d(a, b); else for (var e in b) Vb(a + "[" + e + "]", b[e], c, d);
        }(c, a[c], b, e);
        return d.join("&").replace(Qb, "+");
    }, m.fn.extend({
        serialize: function() {
            return m.param(this.serializeArray());
        },
        serializeArray: function() {
            return this.map(function() {
                var a = m.prop(this, "elements");
                return a ? m.makeArray(a) : this;
            }).filter(function() {
                var a = this.type;
                return this.name && !m(this).is(":disabled") && Ub.test(this.nodeName) && !Tb.test(a) && (this.checked || !W.test(a));
            }).map(function(a, b) {
                var c = m(this).val();
                return null == c ? null : m.isArray(c) ? m.map(c, function(a) {
                    return {
                        name: b.name,
                        value: a.replace(Sb, "\r\n")
                    };
                }) : {
                    name: b.name,
                    value: c.replace(Sb, "\r\n")
                };
            }).get();
        }
    }), m.ajaxSettings.xhr = void 0 !== a.ActiveXObject ? function() {
        return !this.isLocal && /^(get|post|head|put|delete|options)$/i.test(this.type) && Zb() || function() {
            try {
                return new a.ActiveXObject("Microsoft.XMLHTTP");
            } catch (b) {}
        }();
    } : Zb;
    var Wb = 0, Xb = {}, Yb = m.ajaxSettings.xhr();
    function Zb() {
        try {
            return new a.XMLHttpRequest();
        } catch (b) {}
    }
    a.attachEvent && a.attachEvent("onunload", function() {
        for (var a in Xb) Xb[a](void 0, !0);
    }), k.cors = !!Yb && "withCredentials" in Yb, (Yb = k.ajax = !!Yb) && m.ajaxTransport(function(a) {
        var b;
        if (!a.crossDomain || k.cors) return {
            send: function(c, d) {
                var e, f = a.xhr(), g = ++Wb;
                if (f.open(a.type, a.url, a.async, a.username, a.password), a.xhrFields) for (e in a.xhrFields) f[e] = a.xhrFields[e];
                for (e in a.mimeType && f.overrideMimeType && f.overrideMimeType(a.mimeType), a.crossDomain || c["X-Requested-With"] || (c["X-Requested-With"] = "XMLHttpRequest"), 
                c) void 0 !== c[e] && f.setRequestHeader(e, c[e] + "");
                f.send(a.hasContent && a.data || null), b = function(c, e) {
                    var h, i, j;
                    if (b && (e || 4 === f.readyState)) if (delete Xb[g], b = void 0, f.onreadystatechange = m.noop, 
                    e) 4 !== f.readyState && f.abort(); else {
                        j = {}, h = f.status, "string" == typeof f.responseText && (j.text = f.responseText);
                        try {
                            i = f.statusText;
                        } catch (k) {
                            i = "";
                        }
                        h || !a.isLocal || a.crossDomain ? 1223 === h && (h = 204) : h = j.text ? 200 : 404;
                    }
                    j && d(h, i, j, f.getAllResponseHeaders());
                }, a.async ? 4 === f.readyState ? setTimeout(b) : f.onreadystatechange = Xb[g] = b : b();
            },
            abort: function() {
                b && b(void 0, !0);
            }
        };
    }), m.ajaxSetup({
        accepts: {
            script: "text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"
        },
        contents: {
            script: /(?:java|ecma)script/
        },
        converters: {
            "text script": function(a) {
                return m.globalEval(a), a;
            }
        }
    }), m.ajaxPrefilter("script", function(a) {
        void 0 === a.cache && (a.cache = !1), a.crossDomain && (a.type = "GET", a.global = !1);
    }), m.ajaxTransport("script", function(a) {
        if (a.crossDomain) {
            var b, c = y.head || m("head")[0] || y.documentElement;
            return {
                send: function(d, e) {
                    (b = y.createElement("script")).async = !0, a.scriptCharset && (b.charset = a.scriptCharset), 
                    b.src = a.url, b.onload = b.onreadystatechange = function(a, c) {
                        !c && b.readyState && !/loaded|complete/.test(b.readyState) || (b.onload = b.onreadystatechange = null, 
                        b.parentNode && b.parentNode.removeChild(b), b = null, c || e(200, "success"));
                    }, c.insertBefore(b, c.firstChild);
                },
                abort: function() {
                    b && b.onload(void 0, !0);
                }
            };
        }
    });
    var _b = [], ac = /(=)\?(?=&|$)|\?\?/;
    m.ajaxSetup({
        jsonp: "callback",
        jsonpCallback: function() {
            var a = _b.pop() || m.expando + "_" + vb++;
            return this[a] = !0, a;
        }
    }), m.ajaxPrefilter("json jsonp", function(b, c, d) {
        var e, f, g, h = !1 !== b.jsonp && (ac.test(b.url) ? "url" : "string" == typeof b.data && !(b.contentType || "").indexOf("application/x-www-form-urlencoded") && ac.test(b.data) && "data");
        return h || "jsonp" === b.dataTypes[0] ? (e = b.jsonpCallback = m.isFunction(b.jsonpCallback) ? b.jsonpCallback() : b.jsonpCallback, 
        h ? b[h] = b[h].replace(ac, "$1" + e) : !1 !== b.jsonp && (b.url += (wb.test(b.url) ? "&" : "?") + b.jsonp + "=" + e), 
        b.converters["script json"] = function() {
            return g || m.error(e + " was not called"), g[0];
        }, b.dataTypes[0] = "json", f = a[e], a[e] = function() {
            g = arguments;
        }, d.always(function() {
            a[e] = f, b[e] && (b.jsonpCallback = c.jsonpCallback, _b.push(e)), g && m.isFunction(f) && f(g[0]), 
            g = f = void 0;
        }), "script") : void 0;
    }), m.parseHTML = function(a, b, e) {
        if (!a || "string" != typeof a) return null;
        "boolean" == typeof b && (e = b, b = !1), b = b || y;
        var d = u.exec(a), e = !e && [];
        return d ? [ b.createElement(d[1]) ] : (d = m.buildFragment([ a ], b, e), e && e.length && m(e).remove(), 
        m.merge([], d.childNodes));
    };
    var bc = m.fn.load;
    m.fn.load = function(a, b, c) {
        if ("string" != typeof a && bc) return bc.apply(this, arguments);
        var d, e, f, g = this, h = a.indexOf(" ");
        return 0 <= h && (d = m.trim(a.slice(h, a.length)), a = a.slice(0, h)), m.isFunction(b) ? (c = b, 
        b = void 0) : b && "object" == typeof b && (f = "POST"), 0 < g.length && m.ajax({
            url: a,
            type: f,
            dataType: "html",
            data: b
        }).done(function(a) {
            e = arguments, g.html(d ? m("<div>").append(m.parseHTML(a)).find(d) : a);
        }).complete(c && function(a, b) {
            g.each(c, e || [ a.responseText, b, a ]);
        }), this;
    }, m.each([ "ajaxStart", "ajaxStop", "ajaxComplete", "ajaxError", "ajaxSuccess", "ajaxSend" ], function(a, b) {
        m.fn[b] = function(a) {
            return this.on(b, a);
        };
    }), m.expr.filters.animated = function(a) {
        return m.grep(m.timers, function(b) {
            return a === b.elem;
        }).length;
    };
    var cc = a.document.documentElement;
    function dc(a) {
        return m.isWindow(a) ? a : 9 === a.nodeType && (a.defaultView || a.parentWindow);
    }
    m.offset = {
        setOffset: function(a, b, c) {
            var f, g, h, e, d = m.css(a, "position"), l = m(a), n = {};
            "static" === d && (a.style.position = "relative"), h = l.offset(), f = m.css(a, "top"), 
            e = m.css(a, "left"), e = ("absolute" === d || "fixed" === d) && -1 < m.inArray("auto", [ f, e ]) ? (g = (d = l.position()).top, 
            d.left) : (g = parseFloat(f) || 0, parseFloat(e) || 0), null != (b = m.isFunction(b) ? b.call(a, c, h) : b).top && (n.top = b.top - h.top + g), 
            null != b.left && (n.left = b.left - h.left + e), "using" in b ? b.using.call(a, n) : l.css(n);
        }
    }, m.fn.extend({
        offset: function(a) {
            if (arguments.length) return void 0 === a ? this : this.each(function(b) {
                m.offset.setOffset(this, a, b);
            });
            var b, d = {
                top: 0,
                left: 0
            }, e = this[0], c = e && e.ownerDocument;
            return c ? (b = c.documentElement, m.contains(b, e) ? (typeof e.getBoundingClientRect !== K && (d = e.getBoundingClientRect()), 
            c = dc(c), {
                top: d.top + (c.pageYOffset || b.scrollTop) - (b.clientTop || 0),
                left: d.left + (c.pageXOffset || b.scrollLeft) - (b.clientLeft || 0)
            }) : d) : void 0;
        },
        position: function() {
            if (this[0]) {
                var a, b, c = {
                    top: 0,
                    left: 0
                }, d = this[0];
                return "fixed" === m.css(d, "position") ? b = d.getBoundingClientRect() : (a = this.offsetParent(), 
                b = this.offset(), (c = !m.nodeName(a[0], "html") ? a.offset() : c).top += m.css(a[0], "borderTopWidth", !0), 
                c.left += m.css(a[0], "borderLeftWidth", !0)), {
                    top: b.top - c.top - m.css(d, "marginTop", !0),
                    left: b.left - c.left - m.css(d, "marginLeft", !0)
                };
            }
        },
        offsetParent: function() {
            return this.map(function() {
                for (var a = this.offsetParent || cc; a && !m.nodeName(a, "html") && "static" === m.css(a, "position"); ) a = a.offsetParent;
                return a || cc;
            });
        }
    }), m.each({
        scrollLeft: "pageXOffset",
        scrollTop: "pageYOffset"
    }, function(a, b) {
        var c = /Y/.test(b);
        m.fn[a] = function(d) {
            return V(this, function(a, d, e) {
                var f = dc(a);
                return void 0 === e ? f ? b in f ? f[b] : f.document.documentElement[d] : a[d] : void (f ? f.scrollTo(c ? m(f).scrollLeft() : e, c ? e : m(f).scrollTop()) : a[d] = e);
            }, a, d, arguments.length, null);
        };
    }), m.each([ "top", "left" ], function(a, b) {
        m.cssHooks[b] = La(k.pixelPosition, function(a, c) {
            return c ? (c = Ja(a, b), Ha.test(c) ? m(a).position()[b] + "px" : c) : void 0;
        });
    }), m.each({
        Height: "height",
        Width: "width"
    }, function(a, b) {
        m.each({
            padding: "inner" + a,
            content: b,
            "": "outer" + a
        }, function(c, d) {
            m.fn[d] = function(d, e) {
                var f = arguments.length && (c || "boolean" != typeof d), g = c || (!0 === d || !0 === e ? "margin" : "border");
                return V(this, function(b, c, d) {
                    var e;
                    return m.isWindow(b) ? b.document.documentElement["client" + a] : 9 === b.nodeType ? (e = b.documentElement, 
                    Math.max(b.body["scroll" + a], e["scroll" + a], b.body["offset" + a], e["offset" + a], e["client" + a])) : void 0 === d ? m.css(b, c, g) : m.style(b, c, d, g);
                }, b, f ? d : void 0, f, null);
            };
        });
    }), m.fn.size = function() {
        return this.length;
    }, m.fn.andSelf = m.fn.addBack, "function" == typeof define && define.amd && define("jquery", [], function() {
        return m;
    });
    var ec = a.jQuery, fc = a.$;
    return m.noConflict = function(b) {
        return a.$ === m && (a.$ = fc), b && a.jQuery === m && (a.jQuery = ec), m;
    }, typeof b === K && (a.jQuery = a.$ = m), m;
}), function(e) {
    "function" == typeof define && define.amd ? define([ "jquery" ], e) : e(jQuery);
}(function(e) {
    function t(t, s) {
        var n, o, r = t.nodeName.toLowerCase();
        return "area" === r ? (o = (n = t.parentNode).name, !(!t.href || !o || "map" !== n.nodeName.toLowerCase()) && (!!(o = e("img[usemap='#" + o + "']")[0]) && i(o))) : (/^(input|select|textarea|button|object)$/.test(r) ? !t.disabled : "a" === r && t.href || s) && i(t);
    }
    function i(t) {
        return e.expr.filters.visible(t) && !e(t).parents().addBack().filter(function() {
            return "hidden" === e.css(this, "visibility");
        }).length;
    }
    e.ui = e.ui || {}, e.extend(e.ui, {
        version: "1.11.4",
        keyCode: {
            BACKSPACE: 8,
            COMMA: 188,
            DELETE: 46,
            DOWN: 40,
            END: 35,
            ENTER: 13,
            ESCAPE: 27,
            HOME: 36,
            LEFT: 37,
            PAGE_DOWN: 34,
            PAGE_UP: 33,
            PERIOD: 190,
            RIGHT: 39,
            SPACE: 32,
            TAB: 9,
            UP: 38
        }
    }), e.fn.extend({
        scrollParent: function(a) {
            var i = this.css("position"), s = "absolute" === i, n = a ? /(auto|scroll|hidden)/ : /(auto|scroll)/, a = this.parents().filter(function() {
                var t = e(this);
                return (!s || "static" !== t.css("position")) && n.test(t.css("overflow") + t.css("overflow-y") + t.css("overflow-x"));
            }).eq(0);
            return "fixed" !== i && a.length ? a : e(this[0].ownerDocument || document);
        },
        uniqueId: function() {
            var e = 0;
            return function() {
                return this.each(function() {
                    this.id || (this.id = "ui-id-" + ++e);
                });
            };
        }(),
        removeUniqueId: function() {
            return this.each(function() {
                /^ui-id-\d+$/.test(this.id) && e(this).removeAttr("id");
            });
        }
    }), e.extend(e.expr[":"], {
        data: e.expr.createPseudo ? e.expr.createPseudo(function(t) {
            return function(i) {
                return !!e.data(i, t);
            };
        }) : function(t, i, s) {
            return !!e.data(t, s[3]);
        },
        focusable: function(i) {
            return t(i, !isNaN(e.attr(i, "tabindex")));
        },
        tabbable: function(i) {
            var s = e.attr(i, "tabindex"), n = isNaN(s);
            return (n || 0 <= s) && t(i, !n);
        }
    }), e("<a>").outerWidth(1).jquery || e.each([ "Width", "Height" ], function(t, i) {
        function s(t, i, s, a) {
            return e.each(n, function() {
                i -= parseFloat(e.css(t, "padding" + this)) || 0, s && (i -= parseFloat(e.css(t, "border" + this + "Width")) || 0), 
                a && (i -= parseFloat(e.css(t, "margin" + this)) || 0);
            }), i;
        }
        var n = "Width" === i ? [ "Left", "Right" ] : [ "Top", "Bottom" ], a = i.toLowerCase(), o = {
            innerWidth: e.fn.innerWidth,
            innerHeight: e.fn.innerHeight,
            outerWidth: e.fn.outerWidth,
            outerHeight: e.fn.outerHeight
        };
        e.fn["inner" + i] = function(t) {
            return void 0 === t ? o["inner" + i].call(this) : this.each(function() {
                e(this).css(a, s(this, t) + "px");
            });
        }, e.fn["outer" + i] = function(t, n) {
            return "number" != typeof t ? o["outer" + i].call(this, t) : this.each(function() {
                e(this).css(a, s(this, t, !0, n) + "px");
            });
        };
    }), e.fn.addBack || (e.fn.addBack = function(e) {
        return this.add(null == e ? this.prevObject : this.prevObject.filter(e));
    }), e("<a>").data("a-b", "a").removeData("a-b").data("a-b") && (e.fn.removeData = function(t) {
        return function(i) {
            return arguments.length ? t.call(this, e.camelCase(i)) : t.call(this);
        };
    }(e.fn.removeData)), e.ui.ie = !!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()), 
    e.fn.extend({
        focus: function(t) {
            return function(i, s) {
                return "number" == typeof i ? this.each(function() {
                    var t = this;
                    setTimeout(function() {
                        e(t).focus(), s && s.call(t);
                    }, i);
                }) : t.apply(this, arguments);
            };
        }(e.fn.focus),
        disableSelection: function() {
            var e = "onselectstart" in document.createElement("div") ? "selectstart" : "mousedown";
            return function() {
                return this.bind(e + ".ui-disableSelection", function(e) {
                    e.preventDefault();
                });
            };
        }(),
        enableSelection: function() {
            return this.unbind(".ui-disableSelection");
        },
        zIndex: function(t) {
            if (void 0 !== t) return this.css("zIndex", t);
            if (this.length) for (var i, s, n = e(this[0]); n.length && n[0] !== document; ) {
                if (("absolute" === (i = n.css("position")) || "relative" === i || "fixed" === i) && (s = parseInt(n.css("zIndex"), 10), 
                !isNaN(s) && 0 !== s)) return s;
                n = n.parent();
            }
            return 0;
        }
    }), e.ui.plugin = {
        add: function(t, i, s) {
            var n, a = e.ui[t].prototype;
            for (n in s) a.plugins[n] = a.plugins[n] || [], a.plugins[n].push([ i, s[n] ]);
        },
        call: function(e, t, i, s) {
            var n, a = e.plugins[t];
            if (a && (s || e.element[0].parentNode && 11 !== e.element[0].parentNode.nodeType)) for (n = 0; a.length > n; n++) e.options[a[n][0]] && a[n][1].apply(e.element, i);
        }
    };
    var s = 0, n = Array.prototype.slice;
    e.cleanData = function(t) {
        return function(i) {
            for (var s, n, a = 0; null != (n = i[a]); a++) try {
                (s = e._data(n, "events")) && s.remove && e(n).triggerHandler("remove");
            } catch (o) {}
            t(i);
        };
    }(e.cleanData), e.widget = function(t, i, s) {
        var n, a, o, r, h = {}, l = t.split(".")[0];
        return t = t.split(".")[1], s || (s = i, i = e.Widget), e.expr[":"][(n = l + "-" + t).toLowerCase()] = function(t) {
            return !!e.data(t, n);
        }, e[l] = e[l] || {}, a = e[l][t], o = e[l][t] = function(e, t) {
            return this._createWidget ? void (arguments.length && this._createWidget(e, t)) : new o(e, t);
        }, e.extend(o, a, {
            version: s.version,
            _proto: e.extend({}, s),
            _childConstructors: []
        }), (r = new i()).options = e.widget.extend({}, r.options), e.each(s, function(t, s) {
            return e.isFunction(s) ? void (h[t] = function() {
                function e() {
                    return i.prototype[t].apply(this, arguments);
                }
                function n(e) {
                    return i.prototype[t].apply(this, e);
                }
                return function() {
                    var t, i = this._super, a = this._superApply;
                    return this._super = e, this._superApply = n, t = s.apply(this, arguments), this._super = i, 
                    this._superApply = a, t;
                };
            }()) : void (h[t] = s);
        }), o.prototype = e.widget.extend(r, {
            widgetEventPrefix: a && r.widgetEventPrefix || t
        }, h, {
            constructor: o,
            namespace: l,
            widgetName: t,
            widgetFullName: n
        }), a ? (e.each(a._childConstructors, function(t, i) {
            var s = i.prototype;
            e.widget(s.namespace + "." + s.widgetName, o, i._proto);
        }), delete a._childConstructors) : i._childConstructors.push(o), e.widget.bridge(t, o), 
        o;
    }, e.widget.extend = function(t) {
        for (var i, s, a = n.call(arguments, 1), o = 0, r = a.length; o < r; o++) for (i in a[o]) s = a[o][i], 
        a[o].hasOwnProperty(i) && void 0 !== s && (t[i] = e.isPlainObject(s) ? e.isPlainObject(t[i]) ? e.widget.extend({}, t[i], s) : e.widget.extend({}, s) : s);
        return t;
    }, e.widget.bridge = function(t, i) {
        var s = i.prototype.widgetFullName || t;
        e.fn[t] = function(a) {
            var o = "string" == typeof a, r = n.call(arguments, 1), h = this;
            return o ? this.each(function() {
                var i, n = e.data(this, s);
                return "instance" === a ? (h = n, !1) : n ? e.isFunction(n[a]) && "_" !== a.charAt(0) ? (i = n[a].apply(n, r)) !== n && void 0 !== i ? (h = i && i.jquery ? h.pushStack(i.get()) : i, 
                !1) : void 0 : e.error("no such method '" + a + "' for " + t + " widget instance") : e.error("cannot call methods on " + t + " prior to initialization; attempted to call method '" + a + "'");
            }) : (r.length && (a = e.widget.extend.apply(null, [ a ].concat(r))), this.each(function() {
                var t = e.data(this, s);
                t ? (t.option(a || {}), t._init && t._init()) : e.data(this, s, new i(a, this));
            })), h;
        };
    }, e.Widget = function() {}, e.Widget._childConstructors = [], e.Widget.prototype = {
        widgetName: "widget",
        widgetEventPrefix: "",
        defaultElement: "<div>",
        options: {
            disabled: !1,
            create: null
        },
        _createWidget: function(t, i) {
            i = e(i || this.defaultElement || this)[0], this.element = e(i), this.uuid = s++, 
            this.eventNamespace = "." + this.widgetName + this.uuid, this.bindings = e(), this.hoverable = e(), 
            this.focusable = e(), i !== this && (e.data(i, this.widgetFullName, this), this._on(!0, this.element, {
                remove: function(e) {
                    e.target === i && this.destroy();
                }
            }), this.document = e(i.style ? i.ownerDocument : i.document || i), this.window = e(this.document[0].defaultView || this.document[0].parentWindow)), 
            this.options = e.widget.extend({}, this.options, this._getCreateOptions(), t), this._create(), 
            this._trigger("create", null, this._getCreateEventData()), this._init();
        },
        _getCreateOptions: e.noop,
        _getCreateEventData: e.noop,
        _create: e.noop,
        _init: e.noop,
        destroy: function() {
            this._destroy(), this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)), 
            this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName + "-disabled ui-state-disabled"), 
            this.bindings.unbind(this.eventNamespace), this.hoverable.removeClass("ui-state-hover"), 
            this.focusable.removeClass("ui-state-focus");
        },
        _destroy: e.noop,
        widget: function() {
            return this.element;
        },
        option: function(t, i) {
            var s, n, a, o = t;
            if (0 === arguments.length) return e.widget.extend({}, this.options);
            if ("string" == typeof t) if (o = {}, t = (s = t.split(".")).shift(), s.length) {
                for (n = o[t] = e.widget.extend({}, this.options[t]), a = 0; s.length - 1 > a; a++) n[s[a]] = n[s[a]] || {}, 
                n = n[s[a]];
                if (t = s.pop(), 1 === arguments.length) return void 0 === n[t] ? null : n[t];
                n[t] = i;
            } else {
                if (1 === arguments.length) return void 0 === this.options[t] ? null : this.options[t];
                o[t] = i;
            }
            return this._setOptions(o), this;
        },
        _setOptions: function(e) {
            for (var t in e) this._setOption(t, e[t]);
            return this;
        },
        _setOption: function(e, t) {
            return this.options[e] = t, "disabled" === e && (this.widget().toggleClass(this.widgetFullName + "-disabled", !!t), 
            t && (this.hoverable.removeClass("ui-state-hover"), this.focusable.removeClass("ui-state-focus"))), 
            this;
        },
        enable: function() {
            return this._setOptions({
                disabled: !1
            });
        },
        disable: function() {
            return this._setOptions({
                disabled: !0
            });
        },
        _on: function(t, i, s) {
            var n, a = this;
            "boolean" != typeof t && (s = i, i = t, t = !1), s ? (i = n = e(i), this.bindings = this.bindings.add(i)) : (s = i, 
            i = this.element, n = this.widget()), e.each(s, function(l, o) {
                function r() {
                    return t || !0 !== a.options.disabled && !e(this).hasClass("ui-state-disabled") ? ("string" == typeof o ? a[o] : o).apply(a, arguments) : void 0;
                }
                "string" != typeof o && (r.guid = o.guid = o.guid || r.guid || e.guid++);
                var u = l.match(/^([\w:-]*)\s*(.*)$/), l = u[1] + a.eventNamespace, u = u[2];
                u ? n.delegate(u, l, r) : i.bind(l, r);
            });
        },
        _off: function(t, i) {
            i = (i || "").split(" ").join(this.eventNamespace + " ") + this.eventNamespace, 
            t.unbind(i).undelegate(i), this.bindings = e(this.bindings.not(t).get()), this.focusable = e(this.focusable.not(t).get()), 
            this.hoverable = e(this.hoverable.not(t).get());
        },
        _delay: function(e, t) {
            var s = this;
            return setTimeout(function() {
                return ("string" == typeof e ? s[e] : e).apply(s, arguments);
            }, t || 0);
        },
        _hoverable: function(t) {
            this.hoverable = this.hoverable.add(t), this._on(t, {
                mouseenter: function(t) {
                    e(t.currentTarget).addClass("ui-state-hover");
                },
                mouseleave: function(t) {
                    e(t.currentTarget).removeClass("ui-state-hover");
                }
            });
        },
        _focusable: function(t) {
            this.focusable = this.focusable.add(t), this._on(t, {
                focusin: function(t) {
                    e(t.currentTarget).addClass("ui-state-focus");
                },
                focusout: function(t) {
                    e(t.currentTarget).removeClass("ui-state-focus");
                }
            });
        },
        _trigger: function(t, i, s) {
            var n, a, o = this.options[t];
            if (s = s || {}, (i = e.Event(i)).type = (t === this.widgetEventPrefix ? t : this.widgetEventPrefix + t).toLowerCase(), 
            i.target = this.element[0], a = i.originalEvent) for (n in a) n in i || (i[n] = a[n]);
            return this.element.trigger(i, s), !(e.isFunction(o) && !1 === o.apply(this.element[0], [ i ].concat(s)) || i.isDefaultPrevented());
        }
    }, e.each({
        show: "fadeIn",
        hide: "fadeOut"
    }, function(t, i) {
        e.Widget.prototype["_" + t] = function(s, n, a) {
            var r = (n = "string" == typeof n ? {
                effect: n
            } : n) ? !0 !== n && "number" != typeof n && n.effect || i : t, o = !e.isEmptyObject(n = "number" == typeof (n = n || {}) ? {
                duration: n
            } : n);
            n.complete = a, n.delay && s.delay(n.delay), o && e.effects && e.effects.effect[r] ? s[t](n) : r !== t && s[r] ? s[r](n.duration, n.easing, a) : s.queue(function(i) {
                e(this)[t](), a && a.call(s[0]), i();
            });
        };
    }), e.widget;
    var a = !1;
    e(document).mouseup(function() {
        a = !1;
    }), e.widget("ui.mouse", {
        version: "1.11.4",
        options: {
            cancel: "input,textarea,button,select,option",
            distance: 1,
            delay: 0
        },
        _mouseInit: function() {
            var t = this;
            this.element.bind("mousedown." + this.widgetName, function(e) {
                return t._mouseDown(e);
            }).bind("click." + this.widgetName, function(i) {
                return !0 === e.data(i.target, t.widgetName + ".preventClickEvent") ? (e.removeData(i.target, t.widgetName + ".preventClickEvent"), 
                i.stopImmediatePropagation(), !1) : void 0;
            }), this.started = !1;
        },
        _mouseDestroy: function() {
            this.element.unbind("." + this.widgetName), this._mouseMoveDelegate && this.document.unbind("mousemove." + this.widgetName, this._mouseMoveDelegate).unbind("mouseup." + this.widgetName, this._mouseUpDelegate);
        },
        _mouseDown: function(t) {
            if (!a) {
                this._mouseMoved = !1, this._mouseStarted && this._mouseUp(t), this._mouseDownEvent = t;
                var i = this, s = 1 === t.which, n = !("string" != typeof this.options.cancel || !t.target.nodeName) && e(t.target).closest(this.options.cancel).length;
                return s && !n && this._mouseCapture(t) && (this.mouseDelayMet = !this.options.delay, 
                this.mouseDelayMet || (this._mouseDelayTimer = setTimeout(function() {
                    i.mouseDelayMet = !0;
                }, this.options.delay)), this._mouseDistanceMet(t) && this._mouseDelayMet(t) && (this._mouseStarted = !1 !== this._mouseStart(t), 
                !this._mouseStarted) ? t.preventDefault() : (!0 === e.data(t.target, this.widgetName + ".preventClickEvent") && e.removeData(t.target, this.widgetName + ".preventClickEvent"), 
                this._mouseMoveDelegate = function(e) {
                    return i._mouseMove(e);
                }, this._mouseUpDelegate = function(e) {
                    return i._mouseUp(e);
                }, this.document.bind("mousemove." + this.widgetName, this._mouseMoveDelegate).bind("mouseup." + this.widgetName, this._mouseUpDelegate), 
                t.preventDefault(), a = !0)), !0;
            }
        },
        _mouseMove: function(t) {
            if (this._mouseMoved) {
                if (e.ui.ie && (!document.documentMode || document.documentMode < 9) && !t.button) return this._mouseUp(t);
                if (!t.which) return this._mouseUp(t);
            }
            return (t.which || t.button) && (this._mouseMoved = !0), this._mouseStarted ? (this._mouseDrag(t), 
            t.preventDefault()) : (this._mouseDistanceMet(t) && this._mouseDelayMet(t) && (this._mouseStarted = !1 !== this._mouseStart(this._mouseDownEvent, t), 
            this._mouseStarted ? this._mouseDrag(t) : this._mouseUp(t)), !this._mouseStarted);
        },
        _mouseUp: function(t) {
            return this.document.unbind("mousemove." + this.widgetName, this._mouseMoveDelegate).unbind("mouseup." + this.widgetName, this._mouseUpDelegate), 
            this._mouseStarted && (this._mouseStarted = !1, t.target === this._mouseDownEvent.target && e.data(t.target, this.widgetName + ".preventClickEvent", !0), 
            this._mouseStop(t)), a = !1;
        },
        _mouseDistanceMet: function(e) {
            return Math.max(Math.abs(this._mouseDownEvent.pageX - e.pageX), Math.abs(this._mouseDownEvent.pageY - e.pageY)) >= this.options.distance;
        },
        _mouseDelayMet: function() {
            return this.mouseDelayMet;
        },
        _mouseStart: function() {},
        _mouseDrag: function() {},
        _mouseStop: function() {},
        _mouseCapture: function() {
            return !0;
        }
    }), e.widget("ui.draggable", e.ui.mouse, {
        version: "1.11.4",
        widgetEventPrefix: "drag",
        options: {
            addClasses: !0,
            appendTo: "parent",
            axis: !1,
            connectToSortable: !1,
            containment: !1,
            cursor: "auto",
            cursorAt: !1,
            grid: !1,
            handle: !1,
            helper: "original",
            iframeFix: !1,
            opacity: !1,
            refreshPositions: !1,
            revert: !1,
            revertDuration: 500,
            scope: "default",
            scroll: !0,
            scrollSensitivity: 20,
            scrollSpeed: 20,
            snap: !1,
            snapMode: "both",
            snapTolerance: 20,
            stack: !1,
            zIndex: !1,
            drag: null,
            start: null,
            stop: null
        },
        _create: function() {
            "original" === this.options.helper && this._setPositionRelative(), this.options.addClasses && this.element.addClass("ui-draggable"), 
            this.options.disabled && this.element.addClass("ui-draggable-disabled"), this._setHandleClassName(), 
            this._mouseInit();
        },
        _setOption: function(e, t) {
            this._super(e, t), "handle" === e && (this._removeHandleClassName(), this._setHandleClassName());
        },
        _destroy: function() {
            return (this.helper || this.element).is(".ui-draggable-dragging") ? void (this.destroyOnClear = !0) : (this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"), 
            this._removeHandleClassName(), void this._mouseDestroy());
        },
        _mouseCapture: function(t) {
            var i = this.options;
            return this._blurActiveElement(t), !(this.helper || i.disabled || 0 < e(t.target).closest(".ui-resizable-handle").length) && (this.handle = this._getHandle(t), 
            !!this.handle && (this._blockFrames(!0 === i.iframeFix ? "iframe" : i.iframeFix), 
            !0));
        },
        _blockFrames: function(t) {
            this.iframeBlocks = this.document.find(t).map(function() {
                var t = e(this);
                return e("<div>").css("position", "absolute").appendTo(t.parent()).outerWidth(t.outerWidth()).outerHeight(t.outerHeight()).offset(t.offset())[0];
            });
        },
        _unblockFrames: function() {
            this.iframeBlocks && (this.iframeBlocks.remove(), delete this.iframeBlocks);
        },
        _blurActiveElement: function(t) {
            var i = this.document[0];
            if (this.handleElement.is(t.target)) try {
                i.activeElement && "body" !== i.activeElement.nodeName.toLowerCase() && e(i.activeElement).blur();
            } catch (s) {}
        },
        _mouseStart: function(t) {
            var i = this.options;
            return this.helper = this._createHelper(t), this.helper.addClass("ui-draggable-dragging"), 
            this._cacheHelperProportions(), e.ui.ddmanager && (e.ui.ddmanager.current = this), 
            this._cacheMargins(), this.cssPosition = this.helper.css("position"), this.scrollParent = this.helper.scrollParent(!0), 
            this.offsetParent = this.helper.offsetParent(), this.hasFixedAncestor = 0 < this.helper.parents().filter(function() {
                return "fixed" === e(this).css("position");
            }).length, this.positionAbs = this.element.offset(), this._refreshOffsets(t), this.originalPosition = this.position = this._generatePosition(t, !1), 
            this.originalPageX = t.pageX, this.originalPageY = t.pageY, i.cursorAt && this._adjustOffsetFromHelper(i.cursorAt), 
            this._setContainment(), !1 === this._trigger("start", t) ? (this._clear(), !1) : (this._cacheHelperProportions(), 
            e.ui.ddmanager && !i.dropBehaviour && e.ui.ddmanager.prepareOffsets(this, t), this._normalizeRightBottom(), 
            this._mouseDrag(t, !0), e.ui.ddmanager && e.ui.ddmanager.dragStart(this, t), !0);
        },
        _refreshOffsets: function(e) {
            this.offset = {
                top: this.positionAbs.top - this.margins.top,
                left: this.positionAbs.left - this.margins.left,
                scroll: !1,
                parent: this._getParentOffset(),
                relative: this._getRelativeOffset()
            }, this.offset.click = {
                left: e.pageX - this.offset.left,
                top: e.pageY - this.offset.top
            };
        },
        _mouseDrag: function(t, s) {
            if (this.hasFixedAncestor && (this.offset.parent = this._getParentOffset()), this.position = this._generatePosition(t, !0), 
            this.positionAbs = this._convertPositionTo("absolute"), !s) {
                s = this._uiHash();
                if (!1 === this._trigger("drag", t, s)) return this._mouseUp({}), !1;
                this.position = s.position;
            }
            return this.helper[0].style.left = this.position.left + "px", this.helper[0].style.top = this.position.top + "px", 
            e.ui.ddmanager && e.ui.ddmanager.drag(this, t), !1;
        },
        _mouseStop: function(t) {
            var i = this, s = !1;
            return e.ui.ddmanager && !this.options.dropBehaviour && (s = e.ui.ddmanager.drop(this, t)), 
            this.dropped && (s = this.dropped, this.dropped = !1), "invalid" === this.options.revert && !s || "valid" === this.options.revert && s || !0 === this.options.revert || e.isFunction(this.options.revert) && this.options.revert.call(this.element, s) ? e(this.helper).animate(this.originalPosition, parseInt(this.options.revertDuration, 10), function() {
                !1 !== i._trigger("stop", t) && i._clear();
            }) : !1 !== this._trigger("stop", t) && this._clear(), !1;
        },
        _mouseUp: function(t) {
            return this._unblockFrames(), e.ui.ddmanager && e.ui.ddmanager.dragStop(this, t), 
            this.handleElement.is(t.target) && this.element.focus(), e.ui.mouse.prototype._mouseUp.call(this, t);
        },
        cancel: function() {
            return this.helper.is(".ui-draggable-dragging") ? this._mouseUp({}) : this._clear(), 
            this;
        },
        _getHandle: function(t) {
            return !this.options.handle || !!e(t.target).closest(this.element.find(this.options.handle)).length;
        },
        _setHandleClassName: function() {
            this.handleElement = this.options.handle ? this.element.find(this.options.handle) : this.element, 
            this.handleElement.addClass("ui-draggable-handle");
        },
        _removeHandleClassName: function() {
            this.handleElement.removeClass("ui-draggable-handle");
        },
        _createHelper: function(n) {
            var i = this.options, s = e.isFunction(i.helper), n = s ? e(i.helper.apply(this.element[0], [ n ])) : "clone" === i.helper ? this.element.clone().removeAttr("id") : this.element;
            return n.parents("body").length || n.appendTo("parent" === i.appendTo ? this.element[0].parentNode : i.appendTo), 
            s && n[0] === this.element[0] && this._setPositionRelative(), n[0] === this.element[0] || /(fixed|absolute)/.test(n.css("position")) || n.css("position", "absolute"), 
            n;
        },
        _setPositionRelative: function() {
            /^(?:r|a|f)/.test(this.element.css("position")) || (this.element[0].style.position = "relative");
        },
        _adjustOffsetFromHelper: function(t) {
            "string" == typeof t && (t = t.split(" ")), "left" in (t = e.isArray(t) ? {
                left: +t[0],
                top: +t[1] || 0
            } : t) && (this.offset.click.left = t.left + this.margins.left), "right" in t && (this.offset.click.left = this.helperProportions.width - t.right + this.margins.left), 
            "top" in t && (this.offset.click.top = t.top + this.margins.top), "bottom" in t && (this.offset.click.top = this.helperProportions.height - t.bottom + this.margins.top);
        },
        _isRootNode: function(e) {
            return /(html|body)/i.test(e.tagName) || e === this.document[0];
        },
        _getParentOffset: function() {
            var t = this.offsetParent.offset(), i = this.document[0];
            return "absolute" === this.cssPosition && this.scrollParent[0] !== i && e.contains(this.scrollParent[0], this.offsetParent[0]) && (t.left += this.scrollParent.scrollLeft(), 
            t.top += this.scrollParent.scrollTop()), {
                top: (t = this._isRootNode(this.offsetParent[0]) ? {
                    top: 0,
                    left: 0
                } : t).top + (parseInt(this.offsetParent.css("borderTopWidth"), 10) || 0),
                left: t.left + (parseInt(this.offsetParent.css("borderLeftWidth"), 10) || 0)
            };
        },
        _getRelativeOffset: function() {
            if ("relative" !== this.cssPosition) return {
                top: 0,
                left: 0
            };
            var e = this.element.position(), t = this._isRootNode(this.scrollParent[0]);
            return {
                top: e.top - (parseInt(this.helper.css("top"), 10) || 0) + (t ? 0 : this.scrollParent.scrollTop()),
                left: e.left - (parseInt(this.helper.css("left"), 10) || 0) + (t ? 0 : this.scrollParent.scrollLeft())
            };
        },
        _cacheMargins: function() {
            this.margins = {
                left: parseInt(this.element.css("marginLeft"), 10) || 0,
                top: parseInt(this.element.css("marginTop"), 10) || 0,
                right: parseInt(this.element.css("marginRight"), 10) || 0,
                bottom: parseInt(this.element.css("marginBottom"), 10) || 0
            };
        },
        _cacheHelperProportions: function() {
            this.helperProportions = {
                width: this.helper.outerWidth(),
                height: this.helper.outerHeight()
            };
        },
        _setContainment: function() {
            var i, t = this.options, s = this.document[0];
            return this.relativeContainer = null, t.containment ? "window" === t.containment ? void (this.containment = [ e(window).scrollLeft() - this.offset.relative.left - this.offset.parent.left, e(window).scrollTop() - this.offset.relative.top - this.offset.parent.top, e(window).scrollLeft() + e(window).width() - this.helperProportions.width - this.margins.left, e(window).scrollTop() + (e(window).height() || s.body.parentNode.scrollHeight) - this.helperProportions.height - this.margins.top ]) : "document" === t.containment ? void (this.containment = [ 0, 0, e(s).width() - this.helperProportions.width - this.margins.left, (e(s).height() || s.body.parentNode.scrollHeight) - this.helperProportions.height - this.margins.top ]) : t.containment.constructor === Array ? void (this.containment = t.containment) : ("parent" === t.containment && (t.containment = this.helper[0].parentNode), 
            void ((s = (i = e(t.containment))[0]) && (t = /(scroll|auto)/.test(i.css("overflow")), 
            this.containment = [ (parseInt(i.css("borderLeftWidth"), 10) || 0) + (parseInt(i.css("paddingLeft"), 10) || 0), (parseInt(i.css("borderTopWidth"), 10) || 0) + (parseInt(i.css("paddingTop"), 10) || 0), (t ? Math.max(s.scrollWidth, s.offsetWidth) : s.offsetWidth) - (parseInt(i.css("borderRightWidth"), 10) || 0) - (parseInt(i.css("paddingRight"), 10) || 0) - this.helperProportions.width - this.margins.left - this.margins.right, (t ? Math.max(s.scrollHeight, s.offsetHeight) : s.offsetHeight) - (parseInt(i.css("borderBottomWidth"), 10) || 0) - (parseInt(i.css("paddingBottom"), 10) || 0) - this.helperProportions.height - this.margins.top - this.margins.bottom ], 
            this.relativeContainer = i))) : void (this.containment = null);
        },
        _convertPositionTo: function(s, t) {
            t = t || this.position;
            var i = "absolute" === s ? 1 : -1, s = this._isRootNode(this.scrollParent[0]);
            return {
                top: t.top + this.offset.relative.top * i + this.offset.parent.top * i - ("fixed" === this.cssPosition ? -this.offset.scroll.top : s ? 0 : this.offset.scroll.top) * i,
                left: t.left + this.offset.relative.left * i + this.offset.parent.left * i - ("fixed" === this.cssPosition ? -this.offset.scroll.left : s ? 0 : this.offset.scroll.left) * i
            };
        },
        _generatePosition: function(a, t) {
            var i, o = this.options, r = this._isRootNode(this.scrollParent[0]), h = a.pageX, l = a.pageY;
            return r && this.offset.scroll || (this.offset.scroll = {
                top: this.scrollParent.scrollTop(),
                left: this.scrollParent.scrollLeft()
            }), t && (this.containment && (i = this.relativeContainer ? (i = this.relativeContainer.offset(), 
            [ this.containment[0] + i.left, this.containment[1] + i.top, this.containment[2] + i.left, this.containment[3] + i.top ]) : this.containment, 
            a.pageX - this.offset.click.left < i[0] && (h = i[0] + this.offset.click.left), 
            a.pageY - this.offset.click.top < i[1] && (l = i[1] + this.offset.click.top), a.pageX - this.offset.click.left > i[2] && (h = i[2] + this.offset.click.left), 
            a.pageY - this.offset.click.top > i[3] && (l = i[3] + this.offset.click.top)), o.grid && (a = o.grid[1] ? this.originalPageY + Math.round((l - this.originalPageY) / o.grid[1]) * o.grid[1] : this.originalPageY, 
            l = !i || a - this.offset.click.top >= i[1] || a - this.offset.click.top > i[3] ? a : a - this.offset.click.top >= i[1] ? a - o.grid[1] : a + o.grid[1], 
            a = o.grid[0] ? this.originalPageX + Math.round((h - this.originalPageX) / o.grid[0]) * o.grid[0] : this.originalPageX, 
            h = !i || a - this.offset.click.left >= i[0] || a - this.offset.click.left > i[2] ? a : a - this.offset.click.left >= i[0] ? a - o.grid[0] : a + o.grid[0]), 
            "y" === o.axis && (h = this.originalPageX), "x" === o.axis && (l = this.originalPageY)), 
            {
                top: l - this.offset.click.top - this.offset.relative.top - this.offset.parent.top + ("fixed" === this.cssPosition ? -this.offset.scroll.top : r ? 0 : this.offset.scroll.top),
                left: h - this.offset.click.left - this.offset.relative.left - this.offset.parent.left + ("fixed" === this.cssPosition ? -this.offset.scroll.left : r ? 0 : this.offset.scroll.left)
            };
        },
        _clear: function() {
            this.helper.removeClass("ui-draggable-dragging"), this.helper[0] === this.element[0] || this.cancelHelperRemoval || this.helper.remove(), 
            this.helper = null, this.cancelHelperRemoval = !1, this.destroyOnClear && this.destroy();
        },
        _normalizeRightBottom: function() {
            "y" !== this.options.axis && "auto" !== this.helper.css("right") && (this.helper.width(this.helper.width()), 
            this.helper.css("right", "auto")), "x" !== this.options.axis && "auto" !== this.helper.css("bottom") && (this.helper.height(this.helper.height()), 
            this.helper.css("bottom", "auto"));
        },
        _trigger: function(t, i, s) {
            return s = s || this._uiHash(), e.ui.plugin.call(this, t, [ i, s, this ], !0), /^(drag|start|stop)/.test(t) && (this.positionAbs = this._convertPositionTo("absolute"), 
            s.offset = this.positionAbs), e.Widget.prototype._trigger.call(this, t, i, s);
        },
        plugins: {},
        _uiHash: function() {
            return {
                helper: this.helper,
                position: this.position,
                originalPosition: this.originalPosition,
                offset: this.positionAbs
            };
        }
    }), e.ui.plugin.add("draggable", "connectToSortable", {
        start: function(t, i, s) {
            var n = e.extend({}, i, {
                item: s.element
            });
            s.sortables = [], e(s.options.connectToSortable).each(function() {
                var i = e(this).sortable("instance");
                i && !i.options.disabled && (s.sortables.push(i), i.refreshPositions(), i._trigger("activate", t, n));
            });
        },
        stop: function(t, i, s) {
            var n = e.extend({}, i, {
                item: s.element
            });
            s.cancelHelperRemoval = !1, e.each(s.sortables, function() {
                var e = this;
                e.isOver ? (e.isOver = 0, s.cancelHelperRemoval = !0, e.cancelHelperRemoval = !1, 
                e._storedCSS = {
                    position: e.placeholder.css("position"),
                    top: e.placeholder.css("top"),
                    left: e.placeholder.css("left")
                }, e._mouseStop(t), e.options.helper = e.options._helper) : (e.cancelHelperRemoval = !0, 
                e._trigger("deactivate", t, n));
            });
        },
        drag: function(t, i, s) {
            e.each(s.sortables, function() {
                var n = !1, a = this;
                a.positionAbs = s.positionAbs, a.helperProportions = s.helperProportions, a.offset.click = s.offset.click, 
                a._intersectsWith(a.containerCache) && (n = !0, e.each(s.sortables, function() {
                    return this.positionAbs = s.positionAbs, this.helperProportions = s.helperProportions, 
                    this.offset.click = s.offset.click, n = this !== a && this._intersectsWith(this.containerCache) && e.contains(a.element[0], this.element[0]) ? !1 : n;
                })), n ? (a.isOver || (a.isOver = 1, s._parent = i.helper.parent(), a.currentItem = i.helper.appendTo(a.element).data("ui-sortable-item", !0), 
                a.options._helper = a.options.helper, a.options.helper = function() {
                    return i.helper[0];
                }, t.target = a.currentItem[0], a._mouseCapture(t, !0), a._mouseStart(t, !0, !0), 
                a.offset.click.top = s.offset.click.top, a.offset.click.left = s.offset.click.left, 
                a.offset.parent.left -= s.offset.parent.left - a.offset.parent.left, a.offset.parent.top -= s.offset.parent.top - a.offset.parent.top, 
                s._trigger("toSortable", t), s.dropped = a.element, e.each(s.sortables, function() {
                    this.refreshPositions();
                }), s.currentItem = s.element, a.fromOutside = s), a.currentItem && (a._mouseDrag(t), 
                i.position = a.position)) : a.isOver && (a.isOver = 0, a.cancelHelperRemoval = !0, 
                a.options._revert = a.options.revert, a.options.revert = !1, a._trigger("out", t, a._uiHash(a)), 
                a._mouseStop(t, !0), a.options.revert = a.options._revert, a.options.helper = a.options._helper, 
                a.placeholder && a.placeholder.remove(), i.helper.appendTo(s._parent), s._refreshOffsets(t), 
                i.position = s._generatePosition(t, !0), s._trigger("fromSortable", t), s.dropped = !1, 
                e.each(s.sortables, function() {
                    this.refreshPositions();
                }));
            });
        }
    }), e.ui.plugin.add("draggable", "cursor", {
        start: function(t, i, a) {
            var n = e("body"), a = a.options;
            n.css("cursor") && (a._cursor = n.css("cursor")), n.css("cursor", a.cursor);
        },
        stop: function(t, i, n) {
            n = n.options;
            n._cursor && e("body").css("cursor", n._cursor);
        }
    }), e.ui.plugin.add("draggable", "opacity", {
        start: function(t, n, a) {
            n = e(n.helper), a = a.options;
            n.css("opacity") && (a._opacity = n.css("opacity")), n.css("opacity", a.opacity);
        },
        stop: function(t, i, n) {
            n = n.options;
            n._opacity && e(i.helper).css("opacity", n._opacity);
        }
    }), e.ui.plugin.add("draggable", "scroll", {
        start: function(e, t, i) {
            i.scrollParentNotHidden || (i.scrollParentNotHidden = i.helper.scrollParent(!1)), 
            i.scrollParentNotHidden[0] !== i.document[0] && "HTML" !== i.scrollParentNotHidden[0].tagName && (i.overflowOffset = i.scrollParentNotHidden.offset());
        },
        drag: function(t, i, s) {
            var n = s.options, a = !1, o = s.scrollParentNotHidden[0], r = s.document[0];
            o !== r && "HTML" !== o.tagName ? (n.axis && "x" === n.axis || (s.overflowOffset.top + o.offsetHeight - t.pageY < n.scrollSensitivity ? o.scrollTop = a = o.scrollTop + n.scrollSpeed : t.pageY - s.overflowOffset.top < n.scrollSensitivity && (o.scrollTop = a = o.scrollTop - n.scrollSpeed)), 
            n.axis && "y" === n.axis || (s.overflowOffset.left + o.offsetWidth - t.pageX < n.scrollSensitivity ? o.scrollLeft = a = o.scrollLeft + n.scrollSpeed : t.pageX - s.overflowOffset.left < n.scrollSensitivity && (o.scrollLeft = a = o.scrollLeft - n.scrollSpeed))) : (n.axis && "x" === n.axis || (t.pageY - e(r).scrollTop() < n.scrollSensitivity ? a = e(r).scrollTop(e(r).scrollTop() - n.scrollSpeed) : e(window).height() - (t.pageY - e(r).scrollTop()) < n.scrollSensitivity && (a = e(r).scrollTop(e(r).scrollTop() + n.scrollSpeed))), 
            n.axis && "y" === n.axis || (t.pageX - e(r).scrollLeft() < n.scrollSensitivity ? a = e(r).scrollLeft(e(r).scrollLeft() - n.scrollSpeed) : e(window).width() - (t.pageX - e(r).scrollLeft()) < n.scrollSensitivity && (a = e(r).scrollLeft(e(r).scrollLeft() + n.scrollSpeed)))), 
            !1 !== a && e.ui.ddmanager && !n.dropBehaviour && e.ui.ddmanager.prepareOffsets(s, t);
        }
    }), e.ui.plugin.add("draggable", "snap", {
        start: function(t, i, s) {
            var n = s.options;
            s.snapElements = [], e(n.snap.constructor !== String ? n.snap.items || ":data(ui-draggable)" : n.snap).each(function() {
                var t = e(this), i = t.offset();
                this !== s.element[0] && s.snapElements.push({
                    item: this,
                    width: t.outerWidth(),
                    height: t.outerHeight(),
                    top: i.top,
                    left: i.left
                });
            });
        },
        drag: function(t, i, s) {
            for (var n, a, o, r, h, l, u, d, p, f = s.options, m = f.snapTolerance, g = i.offset.left, v = g + s.helperProportions.width, y = i.offset.top, b = y + s.helperProportions.height, c = s.snapElements.length - 1; 0 <= c; c--) l = (h = s.snapElements[c].left - s.margins.left) + s.snapElements[c].width, 
            d = (u = s.snapElements[c].top - s.margins.top) + s.snapElements[c].height, v < h - m || l + m < g || b < u - m || d + m < y || !e.contains(s.snapElements[c].item.ownerDocument, s.snapElements[c].item) ? (s.snapElements[c].snapping && s.options.snap.release && s.options.snap.release.call(s.element, t, e.extend(s._uiHash(), {
                snapItem: s.snapElements[c].item
            })), s.snapElements[c].snapping = !1) : ("inner" !== f.snapMode && (n = m >= Math.abs(u - b), 
            a = m >= Math.abs(d - y), o = m >= Math.abs(h - v), r = m >= Math.abs(l - g), n && (i.position.top = s._convertPositionTo("relative", {
                top: u - s.helperProportions.height,
                left: 0
            }).top), a && (i.position.top = s._convertPositionTo("relative", {
                top: d,
                left: 0
            }).top), o && (i.position.left = s._convertPositionTo("relative", {
                top: 0,
                left: h - s.helperProportions.width
            }).left), r && (i.position.left = s._convertPositionTo("relative", {
                top: 0,
                left: l
            }).left)), p = n || a || o || r, "outer" !== f.snapMode && (n = m >= Math.abs(u - y), 
            a = m >= Math.abs(d - b), o = m >= Math.abs(h - g), r = m >= Math.abs(l - v), n && (i.position.top = s._convertPositionTo("relative", {
                top: u,
                left: 0
            }).top), a && (i.position.top = s._convertPositionTo("relative", {
                top: d - s.helperProportions.height,
                left: 0
            }).top), o && (i.position.left = s._convertPositionTo("relative", {
                top: 0,
                left: h
            }).left), r && (i.position.left = s._convertPositionTo("relative", {
                top: 0,
                left: l - s.helperProportions.width
            }).left)), !s.snapElements[c].snapping && (n || a || o || r || p) && s.options.snap.snap && s.options.snap.snap.call(s.element, t, e.extend(s._uiHash(), {
                snapItem: s.snapElements[c].item
            })), s.snapElements[c].snapping = n || a || o || r || p);
        }
    }), e.ui.plugin.add("draggable", "stack", {
        start: function(t, i, o) {
            var n, o = o.options, o = e.makeArray(e(o.stack)).sort(function(t, i) {
                return (parseInt(e(t).css("zIndex"), 10) || 0) - (parseInt(e(i).css("zIndex"), 10) || 0);
            });
            o.length && (n = parseInt(e(o[0]).css("zIndex"), 10) || 0, e(o).each(function(t) {
                e(this).css("zIndex", n + t);
            }), this.css("zIndex", n + o.length));
        }
    }), e.ui.plugin.add("draggable", "zIndex", {
        start: function(t, n, a) {
            n = e(n.helper), a = a.options;
            n.css("zIndex") && (a._zIndex = n.css("zIndex")), n.css("zIndex", a.zIndex);
        },
        stop: function(t, i, n) {
            n = n.options;
            n._zIndex && e(i.helper).css("zIndex", n._zIndex);
        }
    }), e.ui.draggable, e.widget("ui.droppable", {
        version: "1.11.4",
        widgetEventPrefix: "drop",
        options: {
            accept: "*",
            activeClass: !1,
            addClasses: !0,
            greedy: !1,
            hoverClass: !1,
            scope: "default",
            tolerance: "intersect",
            activate: null,
            deactivate: null,
            drop: null,
            out: null,
            over: null
        },
        _create: function() {
            var t, i = this.options, s = i.accept;
            this.isover = !1, this.isout = !0, this.accept = e.isFunction(s) ? s : function(e) {
                return e.is(s);
            }, this.proportions = function() {
                return arguments.length ? void (t = arguments[0]) : t = t || {
                    width: this.element[0].offsetWidth,
                    height: this.element[0].offsetHeight
                };
            }, this._addToManager(i.scope), i.addClasses && this.element.addClass("ui-droppable");
        },
        _addToManager: function(t) {
            e.ui.ddmanager.droppables[t] = e.ui.ddmanager.droppables[t] || [], e.ui.ddmanager.droppables[t].push(this);
        },
        _splice: function(e) {
            for (var t = 0; e.length > t; t++) e[t] === this && e.splice(t, 1);
        },
        _destroy: function() {
            var t = e.ui.ddmanager.droppables[this.options.scope];
            this._splice(t), this.element.removeClass("ui-droppable ui-droppable-disabled");
        },
        _setOption: function(t, i) {
            var s;
            "accept" === t ? this.accept = e.isFunction(i) ? i : function(e) {
                return e.is(i);
            } : "scope" === t && (s = e.ui.ddmanager.droppables[this.options.scope], this._splice(s), 
            this._addToManager(i)), this._super(t, i);
        },
        _activate: function(t) {
            var i = e.ui.ddmanager.current;
            this.options.activeClass && this.element.addClass(this.options.activeClass), i && this._trigger("activate", t, this.ui(i));
        },
        _deactivate: function(t) {
            var i = e.ui.ddmanager.current;
            this.options.activeClass && this.element.removeClass(this.options.activeClass), 
            i && this._trigger("deactivate", t, this.ui(i));
        },
        _over: function(t) {
            var i = e.ui.ddmanager.current;
            i && (i.currentItem || i.element)[0] !== this.element[0] && this.accept.call(this.element[0], i.currentItem || i.element) && (this.options.hoverClass && this.element.addClass(this.options.hoverClass), 
            this._trigger("over", t, this.ui(i)));
        },
        _out: function(t) {
            var i = e.ui.ddmanager.current;
            i && (i.currentItem || i.element)[0] !== this.element[0] && this.accept.call(this.element[0], i.currentItem || i.element) && (this.options.hoverClass && this.element.removeClass(this.options.hoverClass), 
            this._trigger("out", t, this.ui(i)));
        },
        _drop: function(t, i) {
            var s = i || e.ui.ddmanager.current, n = !1;
            return !(!s || (s.currentItem || s.element)[0] === this.element[0]) && (this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function() {
                var i = e(this).droppable("instance");
                return i.options.greedy && !i.options.disabled && i.options.scope === s.options.scope && i.accept.call(i.element[0], s.currentItem || s.element) && e.ui.intersect(s, e.extend(i, {
                    offset: i.element.offset()
                }), i.options.tolerance, t) ? !(n = !0) : void 0;
            }), !n && (!!this.accept.call(this.element[0], s.currentItem || s.element) && (this.options.activeClass && this.element.removeClass(this.options.activeClass), 
            this.options.hoverClass && this.element.removeClass(this.options.hoverClass), this._trigger("drop", t, this.ui(s)), 
            this.element)));
        },
        ui: function(e) {
            return {
                draggable: e.currentItem || e.element,
                helper: e.helper,
                position: e.position,
                offset: e.positionAbs
            };
        }
    }), e.ui.intersect = function() {
        function e(e, t, i) {
            return t <= e && e < t + i;
        }
        return function(t, i, s, n) {
            if (!i.offset) return !1;
            var a = (t.positionAbs || t.position.absolute).left + t.margins.left, o = (t.positionAbs || t.position.absolute).top + t.margins.top, r = a + t.helperProportions.width, h = o + t.helperProportions.height, l = i.offset.left, u = i.offset.top, d = l + i.proportions().width, c = u + i.proportions().height;
            switch (s) {
              case "fit":
                return l <= a && r <= d && u <= o && h <= c;

              case "intersect":
                return a + t.helperProportions.width / 2 > l && d > r - t.helperProportions.width / 2 && o + t.helperProportions.height / 2 > u && c > h - t.helperProportions.height / 2;

              case "pointer":
                return e(n.pageY, u, i.proportions().height) && e(n.pageX, l, i.proportions().width);

              case "touch":
                return (u <= o && o <= c || u <= h && h <= c || o < u && c < h) && (l <= a && a <= d || l <= r && r <= d || a < l && d < r);

              default:
                return !1;
            }
        };
    }(), e.ui.ddmanager = {
        current: null,
        droppables: {
            default: []
        },
        prepareOffsets: function(t, i) {
            var s, n, a = e.ui.ddmanager.droppables[t.options.scope] || [], o = i ? i.type : null, r = (t.currentItem || t.element).find(":data(ui-droppable)").addBack();
            e: for (s = 0; a.length > s; s++) if (!(a[s].options.disabled || t && !a[s].accept.call(a[s].element[0], t.currentItem || t.element))) {
                for (n = 0; r.length > n; n++) if (r[n] === a[s].element[0]) {
                    a[s].proportions().height = 0;
                    continue e;
                }
                a[s].visible = "none" !== a[s].element.css("display"), a[s].visible && ("mousedown" === o && a[s]._activate.call(a[s], i), 
                a[s].offset = a[s].element.offset(), a[s].proportions({
                    width: a[s].element[0].offsetWidth,
                    height: a[s].element[0].offsetHeight
                }));
            }
        },
        drop: function(t, i) {
            var s = !1;
            return e.each((e.ui.ddmanager.droppables[t.options.scope] || []).slice(), function() {
                this.options && (!this.options.disabled && this.visible && e.ui.intersect(t, this, this.options.tolerance, i) && (s = this._drop.call(this, i) || s), 
                !this.options.disabled && this.visible && this.accept.call(this.element[0], t.currentItem || t.element) && (this.isout = !0, 
                this.isover = !1, this._deactivate.call(this, i)));
            }), s;
        },
        dragStart: function(t, i) {
            t.element.parentsUntil("body").bind("scroll.droppable", function() {
                t.options.refreshPositions || e.ui.ddmanager.prepareOffsets(t, i);
            });
        },
        drag: function(t, i) {
            t.options.refreshPositions && e.ui.ddmanager.prepareOffsets(t, i), e.each(e.ui.ddmanager.droppables[t.options.scope] || [], function() {
                var s, n, a, r;
                this.options.disabled || this.greedyChild || !this.visible || (r = !(a = e.ui.intersect(t, this, this.options.tolerance, i)) && this.isover ? "isout" : a && !this.isover ? "isover" : null) && (this.options.greedy && (n = this.options.scope, 
                (a = this.element.parents(":data(ui-droppable)").filter(function() {
                    return e(this).droppable("instance").options.scope === n;
                })).length && ((s = e(a[0]).droppable("instance")).greedyChild = "isover" === r)), 
                s && "isover" === r && (s.isover = !1, s.isout = !0, s._out.call(s, i)), this[r] = !0, 
                this["isout" === r ? "isover" : "isout"] = !1, this["isover" === r ? "_over" : "_out"].call(this, i), 
                s && "isout" === r && (s.isout = !1, s.isover = !0, s._over.call(s, i)));
            });
        },
        dragStop: function(t, i) {
            t.element.parentsUntil("body").unbind("scroll.droppable"), t.options.refreshPositions || e.ui.ddmanager.prepareOffsets(t, i);
        }
    }, e.ui.droppable, e.widget("ui.resizable", e.ui.mouse, {
        version: "1.11.4",
        widgetEventPrefix: "resize",
        options: {
            alsoResize: !1,
            animate: !1,
            animateDuration: "slow",
            animateEasing: "swing",
            aspectRatio: !1,
            autoHide: !1,
            containment: !1,
            ghost: !1,
            grid: !1,
            handles: "e,s,se",
            helper: !1,
            maxHeight: null,
            maxWidth: null,
            minHeight: 10,
            minWidth: 10,
            zIndex: 90,
            resize: null,
            start: null,
            stop: null
        },
        _num: function(e) {
            return parseInt(e, 10) || 0;
        },
        _isNumber: function(e) {
            return !isNaN(parseInt(e, 10));
        },
        _hasScroll: function(t, n) {
            if ("hidden" === e(t).css("overflow")) return !1;
            var s = n && "left" === n ? "scrollLeft" : "scrollTop", n = !1;
            return 0 < t[s] || (t[s] = 1, n = 0 < t[s], t[s] = 0, n);
        },
        _create: function() {
            var t, i, s, n, o = this, r = this.options;
            if (this.element.addClass("ui-resizable"), e.extend(this, {
                _aspectRatio: !!r.aspectRatio,
                aspectRatio: r.aspectRatio,
                originalElement: this.element,
                _proportionallyResizeElements: [],
                _helper: r.helper || r.ghost || r.animate ? r.helper || "ui-resizable-helper" : null
            }), this.element[0].nodeName.match(/^(canvas|textarea|input|select|button|img)$/i) && (this.element.wrap(e("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({
                position: this.element.css("position"),
                width: this.element.outerWidth(),
                height: this.element.outerHeight(),
                top: this.element.css("top"),
                left: this.element.css("left")
            })), this.element = this.element.parent().data("ui-resizable", this.element.resizable("instance")), 
            this.elementIsWrapper = !0, this.element.css({
                marginLeft: this.originalElement.css("marginLeft"),
                marginTop: this.originalElement.css("marginTop"),
                marginRight: this.originalElement.css("marginRight"),
                marginBottom: this.originalElement.css("marginBottom")
            }), this.originalElement.css({
                marginLeft: 0,
                marginTop: 0,
                marginRight: 0,
                marginBottom: 0
            }), this.originalResizeStyle = this.originalElement.css("resize"), this.originalElement.css("resize", "none"), 
            this._proportionallyResizeElements.push(this.originalElement.css({
                position: "static",
                zoom: 1,
                display: "block"
            })), this.originalElement.css({
                margin: this.originalElement.css("margin")
            }), this._proportionallyResize()), this.handles = r.handles || (e(".ui-resizable-handle", this.element).length ? {
                n: ".ui-resizable-n",
                e: ".ui-resizable-e",
                s: ".ui-resizable-s",
                w: ".ui-resizable-w",
                se: ".ui-resizable-se",
                sw: ".ui-resizable-sw",
                ne: ".ui-resizable-ne",
                nw: ".ui-resizable-nw"
            } : "e,s,se"), this._handles = e(), this.handles.constructor === String) for ("all" === this.handles && (this.handles = "n,e,s,w,se,sw,ne,nw"), 
            t = this.handles.split(","), this.handles = {}, i = 0; t.length > i; i++) s = e.trim(t[i]), 
            (n = e("<div class='ui-resizable-handle " + ("ui-resizable-" + s) + "'></div>")).css({
                zIndex: r.zIndex
            }), "se" === s && n.addClass("ui-icon ui-icon-gripsmall-diagonal-se"), this.handles[s] = ".ui-resizable-" + s, 
            this.element.append(n);
            this._renderAxis = function(t) {
                var i, n, a;
                for (i in t = t || this.element, this.handles) this.handles[i].constructor === String ? this.handles[i] = this.element.children(this.handles[i]).first().show() : (this.handles[i].jquery || this.handles[i].nodeType) && (this.handles[i] = e(this.handles[i]), 
                this._on(this.handles[i], {
                    mousedown: o._mouseDown
                })), this.elementIsWrapper && this.originalElement[0].nodeName.match(/^(textarea|input|select|button)$/i) && (n = e(this.handles[i], this.element), 
                a = /sw|ne|nw|se|n|s/.test(i) ? n.outerHeight() : n.outerWidth(), n = [ "padding", /ne|nw|n/.test(i) ? "Top" : /se|sw|s/.test(i) ? "Bottom" : /^e$/.test(i) ? "Right" : "Left" ].join(""), 
                t.css(n, a), this._proportionallyResize()), this._handles = this._handles.add(this.handles[i]);
            }, this._renderAxis(this.element), this._handles = this._handles.add(this.element.find(".ui-resizable-handle")), 
            this._handles.disableSelection(), this._handles.mouseover(function() {
                o.resizing || (this.className && (n = this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)), 
                o.axis = n && n[1] ? n[1] : "se");
            }), r.autoHide && (this._handles.hide(), e(this.element).addClass("ui-resizable-autohide").mouseenter(function() {
                r.disabled || (e(this).removeClass("ui-resizable-autohide"), o._handles.show());
            }).mouseleave(function() {
                r.disabled || o.resizing || (e(this).addClass("ui-resizable-autohide"), o._handles.hide());
            })), this._mouseInit();
        },
        _destroy: function() {
            this._mouseDestroy();
            function i(t) {
                e(t).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove();
            }
            var t;
            return this.elementIsWrapper && (i(this.element), t = this.element, this.originalElement.css({
                position: t.css("position"),
                width: t.outerWidth(),
                height: t.outerHeight(),
                top: t.css("top"),
                left: t.css("left")
            }).insertAfter(t), t.remove()), this.originalElement.css("resize", this.originalResizeStyle), 
            i(this.originalElement), this;
        },
        _mouseCapture: function(t) {
            var i, s, n = !1;
            for (i in this.handles) s = e(this.handles[i])[0], s !== t.target && !e.contains(s, t.target) || (n = !0);
            return !this.options.disabled && n;
        },
        _mouseStart: function(t) {
            var i, s, n = this.options, o = this.element;
            return this.resizing = !0, this._renderProxy(), i = this._num(this.helper.css("left")), 
            s = this._num(this.helper.css("top")), n.containment && (i += e(n.containment).scrollLeft() || 0, 
            s += e(n.containment).scrollTop() || 0), this.offset = this.helper.offset(), this.position = {
                left: i,
                top: s
            }, this.size = this._helper ? {
                width: this.helper.width(),
                height: this.helper.height()
            } : {
                width: o.width(),
                height: o.height()
            }, this.originalSize = this._helper ? {
                width: o.outerWidth(),
                height: o.outerHeight()
            } : {
                width: o.width(),
                height: o.height()
            }, this.sizeDiff = {
                width: o.outerWidth() - o.width(),
                height: o.outerHeight() - o.height()
            }, this.originalPosition = {
                left: i,
                top: s
            }, this.originalMousePosition = {
                left: t.pageX,
                top: t.pageY
            }, this.aspectRatio = "number" == typeof n.aspectRatio ? n.aspectRatio : this.originalSize.width / this.originalSize.height || 1, 
            n = e(".ui-resizable-" + this.axis).css("cursor"), e("body").css("cursor", "auto" === n ? this.axis + "-resize" : n), 
            o.addClass("ui-resizable-resizing"), this._propagate("start", t), !0;
        },
        _mouseDrag: function(t) {
            var s = this.originalMousePosition, h = this.axis, o = t.pageX - s.left || 0, s = t.pageY - s.top || 0, h = this._change[h];
            return this._updatePrevProperties(), h && (s = h.apply(this, [ t, o, s ]), this._updateVirtualBoundaries(t.shiftKey), 
            (this._aspectRatio || t.shiftKey) && (s = this._updateRatio(s, t)), s = this._respectSize(s, t), 
            this._updateCache(s), this._propagate("resize", t), s = this._applyChanges(), !this._helper && this._proportionallyResizeElements.length && this._proportionallyResize(), 
            e.isEmptyObject(s) || (this._updatePrevProperties(), this._trigger("resize", t, this.ui()), 
            this._applyChanges())), !1;
        },
        _mouseStop: function(t) {
            this.resizing = !1;
            var o, r, h, l = this.options, u = this;
            return this._helper && (h = (o = (r = this._proportionallyResizeElements).length && /textarea/i.test(r[0].nodeName)) && this._hasScroll(r[0], "left") ? 0 : u.sizeDiff.height, 
            r = o ? 0 : u.sizeDiff.width, o = {
                width: u.helper.width() - r,
                height: u.helper.height() - h
            }, r = parseInt(u.element.css("left"), 10) + (u.position.left - u.originalPosition.left) || null, 
            h = parseInt(u.element.css("top"), 10) + (u.position.top - u.originalPosition.top) || null, 
            l.animate || this.element.css(e.extend(o, {
                top: h,
                left: r
            })), u.helper.height(u.size.height), u.helper.width(u.size.width), this._helper && !l.animate && this._proportionallyResize()), 
            e("body").css("cursor", "auto"), this.element.removeClass("ui-resizable-resizing"), 
            this._propagate("stop", t), this._helper && this.helper.remove(), !1;
        },
        _updatePrevProperties: function() {
            this.prevPosition = {
                top: this.position.top,
                left: this.position.left
            }, this.prevSize = {
                width: this.size.width,
                height: this.size.height
            };
        },
        _applyChanges: function() {
            var e = {};
            return this.position.top !== this.prevPosition.top && (e.top = this.position.top + "px"), 
            this.position.left !== this.prevPosition.left && (e.left = this.position.left + "px"), 
            this.size.width !== this.prevSize.width && (e.width = this.size.width + "px"), this.size.height !== this.prevSize.height && (e.height = this.size.height + "px"), 
            this.helper.css(e), e;
        },
        _updateVirtualBoundaries: function(n) {
            var t, s, i = this.options, a = {
                minWidth: this._isNumber(i.minWidth) ? i.minWidth : 0,
                maxWidth: this._isNumber(i.maxWidth) ? i.maxWidth : 1 / 0,
                minHeight: this._isNumber(i.minHeight) ? i.minHeight : 0,
                maxHeight: this._isNumber(i.maxHeight) ? i.maxHeight : 1 / 0
            };
            (this._aspectRatio || n) && (t = a.minHeight * this.aspectRatio, s = a.minWidth / this.aspectRatio, 
            i = a.maxHeight * this.aspectRatio, n = a.maxWidth / this.aspectRatio, t > a.minWidth && (a.minWidth = t), 
            s > a.minHeight && (a.minHeight = s), a.maxWidth > i && (a.maxWidth = i), a.maxHeight > n && (a.maxHeight = n)), 
            this._vBoundaries = a;
        },
        _updateCache: function(e) {
            this.offset = this.helper.offset(), this._isNumber(e.left) && (this.position.left = e.left), 
            this._isNumber(e.top) && (this.position.top = e.top), this._isNumber(e.height) && (this.size.height = e.height), 
            this._isNumber(e.width) && (this.size.width = e.width);
        },
        _updateRatio: function(e) {
            var t = this.position, i = this.size, s = this.axis;
            return this._isNumber(e.height) ? e.width = e.height * this.aspectRatio : this._isNumber(e.width) && (e.height = e.width / this.aspectRatio), 
            "sw" === s && (e.left = t.left + (i.width - e.width), e.top = null), "nw" === s && (e.top = t.top + (i.height - e.height), 
            e.left = t.left + (i.width - e.width)), e;
        },
        _respectSize: function(e) {
            var t = this._vBoundaries, u = this.axis, s = this._isNumber(e.width) && t.maxWidth && t.maxWidth < e.width, n = this._isNumber(e.height) && t.maxHeight && t.maxHeight < e.height, a = this._isNumber(e.width) && t.minWidth && t.minWidth > e.width, o = this._isNumber(e.height) && t.minHeight && t.minHeight > e.height, r = this.originalPosition.left + this.originalSize.width, h = this.position.top + this.size.height, l = /sw|nw|w/.test(u), u = /nw|ne|n/.test(u);
            return a && (e.width = t.minWidth), o && (e.height = t.minHeight), s && (e.width = t.maxWidth), 
            n && (e.height = t.maxHeight), a && l && (e.left = r - t.minWidth), s && l && (e.left = r - t.maxWidth), 
            o && u && (e.top = h - t.minHeight), n && u && (e.top = h - t.maxHeight), e.width || e.height || e.left || !e.top ? e.width || e.height || e.top || !e.left || (e.left = null) : e.top = null, 
            e;
        },
        _getPaddingPlusBorderDimensions: function(e) {
            for (var t = 0, i = [], s = [ e.css("borderTopWidth"), e.css("borderRightWidth"), e.css("borderBottomWidth"), e.css("borderLeftWidth") ], n = [ e.css("paddingTop"), e.css("paddingRight"), e.css("paddingBottom"), e.css("paddingLeft") ]; t < 4; t++) i[t] = parseInt(s[t], 10) || 0, 
            i[t] += parseInt(n[t], 10) || 0;
            return {
                height: i[0] + i[2],
                width: i[1] + i[3]
            };
        },
        _proportionallyResize: function() {
            if (this._proportionallyResizeElements.length) for (var e, t = 0, i = this.helper || this.element; this._proportionallyResizeElements.length > t; t++) e = this._proportionallyResizeElements[t], 
            this.outerDimensions || (this.outerDimensions = this._getPaddingPlusBorderDimensions(e)), 
            e.css({
                height: i.height() - this.outerDimensions.height || 0,
                width: i.width() - this.outerDimensions.width || 0
            });
        },
        _renderProxy: function() {
            var t = this.element, i = this.options;
            this.elementOffset = t.offset(), this._helper ? (this.helper = this.helper || e("<div style='overflow:hidden;'></div>"), 
            this.helper.addClass(this._helper).css({
                width: this.element.outerWidth() - 1,
                height: this.element.outerHeight() - 1,
                position: "absolute",
                left: this.elementOffset.left + "px",
                top: this.elementOffset.top + "px",
                zIndex: ++i.zIndex
            }), this.helper.appendTo("body").disableSelection()) : this.helper = this.element;
        },
        _change: {
            e: function(e, t) {
                return {
                    width: this.originalSize.width + t
                };
            },
            w: function(e, t) {
                var i = this.originalSize;
                return {
                    left: this.originalPosition.left + t,
                    width: i.width - t
                };
            },
            n: function(e, t, i) {
                var s = this.originalSize;
                return {
                    top: this.originalPosition.top + i,
                    height: s.height - i
                };
            },
            s: function(e, t, i) {
                return {
                    height: this.originalSize.height + i
                };
            },
            se: function(t, i, s) {
                return e.extend(this._change.s.apply(this, arguments), this._change.e.apply(this, [ t, i, s ]));
            },
            sw: function(t, i, s) {
                return e.extend(this._change.s.apply(this, arguments), this._change.w.apply(this, [ t, i, s ]));
            },
            ne: function(t, i, s) {
                return e.extend(this._change.n.apply(this, arguments), this._change.e.apply(this, [ t, i, s ]));
            },
            nw: function(t, i, s) {
                return e.extend(this._change.n.apply(this, arguments), this._change.w.apply(this, [ t, i, s ]));
            }
        },
        _propagate: function(t, i) {
            e.ui.plugin.call(this, t, [ i, this.ui() ]), "resize" !== t && this._trigger(t, i, this.ui());
        },
        plugins: {},
        ui: function() {
            return {
                originalElement: this.originalElement,
                element: this.element,
                helper: this.helper,
                position: this.position,
                size: this.size,
                originalSize: this.originalSize,
                originalPosition: this.originalPosition
            };
        }
    }), e.ui.plugin.add("resizable", "animate", {
        stop: function(t) {
            var i = e(this).resizable("instance"), s = i.options, n = i._proportionallyResizeElements, h = n.length && /textarea/i.test(n[0].nodeName), u = h && i._hasScroll(n[0], "left") ? 0 : i.sizeDiff.height, l = h ? 0 : i.sizeDiff.width, h = {
                width: i.size.width - l,
                height: i.size.height - u
            }, l = parseInt(i.element.css("left"), 10) + (i.position.left - i.originalPosition.left) || null, u = parseInt(i.element.css("top"), 10) + (i.position.top - i.originalPosition.top) || null;
            i.element.animate(e.extend(h, u && l ? {
                top: u,
                left: l
            } : {}), {
                duration: s.animateDuration,
                easing: s.animateEasing,
                step: function() {
                    var s = {
                        width: parseInt(i.element.css("width"), 10),
                        height: parseInt(i.element.css("height"), 10),
                        top: parseInt(i.element.css("top"), 10),
                        left: parseInt(i.element.css("left"), 10)
                    };
                    n && n.length && e(n[0]).css({
                        width: s.width,
                        height: s.height
                    }), i._updateCache(s), i._propagate("resize", t);
                }
            });
        }
    }), e.ui.plugin.add("resizable", "containment", {
        start: function() {
            var t, i, h = e(this).resizable("instance"), s = h.options, r = h.element, o = s.containment, c = o instanceof e ? o.get(0) : /parent/.test(o) ? r.parent().get(0) : o;
            c && (h.containerElement = e(c), /document/.test(o) || o === document ? (h.containerOffset = {
                left: 0,
                top: 0
            }, h.containerPosition = {
                left: 0,
                top: 0
            }, h.parentData = {
                element: e(document),
                left: 0,
                top: 0,
                width: e(document).width(),
                height: e(document).height() || document.body.parentNode.scrollHeight
            }) : (t = e(c), i = [], e([ "Top", "Right", "Left", "Bottom" ]).each(function(e, s) {
                i[e] = h._num(t.css("padding" + s));
            }), h.containerOffset = t.offset(), h.containerPosition = t.position(), h.containerSize = {
                height: t.innerHeight() - i[3],
                width: t.innerWidth() - i[1]
            }, s = h.containerOffset, r = h.containerSize.height, o = h.containerSize.width, 
            o = h._hasScroll(c, "left") ? c.scrollWidth : o, r = h._hasScroll(c) ? c.scrollHeight : r, 
            h.parentData = {
                element: c,
                left: s.left,
                top: s.top,
                width: o,
                height: r
            }));
        },
        resize: function(p) {
            var o = e(this).resizable("instance"), n = o.options, s = o.containerOffset, i = o.position, u = o._aspectRatio || p.shiftKey, d = {
                top: 0,
                left: 0
            }, c = o.containerElement, p = !0;
            c[0] !== document && /static/.test(c.css("position")) && (d = s), i.left < (o._helper ? s.left : 0) && (o.size.width = o.size.width + (o._helper ? o.position.left - s.left : o.position.left - d.left), 
            u && (o.size.height = o.size.width / o.aspectRatio, p = !1), o.position.left = n.helper ? s.left : 0), 
            i.top < (o._helper ? s.top : 0) && (o.size.height = o.size.height + (o._helper ? o.position.top - s.top : o.position.top), 
            u && (o.size.width = o.size.height * o.aspectRatio, p = !1), o.position.top = o._helper ? s.top : 0), 
            n = o.containerElement.get(0) === o.element.parent().get(0), i = /relative|absolute/.test(o.containerElement.css("position")), 
            n && i ? (o.offset.left = o.parentData.left + o.position.left, o.offset.top = o.parentData.top + o.position.top) : (o.offset.left = o.element.offset().left, 
            o.offset.top = o.element.offset().top), i = Math.abs(o.sizeDiff.width + (o._helper ? o.offset.left - d.left : o.offset.left - s.left)), 
            s = Math.abs(o.sizeDiff.height + (o._helper ? o.offset.top - d.top : o.offset.top - s.top)), 
            i + o.size.width >= o.parentData.width && (o.size.width = o.parentData.width - i, 
            u && (o.size.height = o.size.width / o.aspectRatio, p = !1)), s + o.size.height >= o.parentData.height && (o.size.height = o.parentData.height - s, 
            u && (o.size.width = o.size.height * o.aspectRatio, p = !1)), p || (o.position.left = o.prevPosition.left, 
            o.position.top = o.prevPosition.top, o.size.width = o.prevSize.width, o.size.height = o.prevSize.height);
        },
        stop: function() {
            var t = e(this).resizable("instance"), i = t.options, s = t.containerOffset, n = t.containerPosition, a = t.containerElement, l = e(t.helper), r = l.offset(), h = l.outerWidth() - t.sizeDiff.width, l = l.outerHeight() - t.sizeDiff.height;
            t._helper && !i.animate && /relative/.test(a.css("position")) && e(this).css({
                left: r.left - n.left - s.left,
                width: h,
                height: l
            }), t._helper && !i.animate && /static/.test(a.css("position")) && e(this).css({
                left: r.left - n.left - s.left,
                width: h,
                height: l
            });
        }
    }), e.ui.plugin.add("resizable", "alsoResize", {
        start: function() {
            var i = e(this).resizable("instance").options;
            e(i.alsoResize).each(function() {
                var t = e(this);
                t.data("ui-resizable-alsoresize", {
                    width: parseInt(t.width(), 10),
                    height: parseInt(t.height(), 10),
                    left: parseInt(t.css("left"), 10),
                    top: parseInt(t.css("top"), 10)
                });
            });
        },
        resize: function(t, i) {
            var s = e(this).resizable("instance"), n = s.options, a = s.originalSize, o = s.originalPosition, r = {
                height: s.size.height - a.height || 0,
                width: s.size.width - a.width || 0,
                top: s.position.top - o.top || 0,
                left: s.position.left - o.left || 0
            };
            e(n.alsoResize).each(function() {
                var t = e(this), s = e(this).data("ui-resizable-alsoresize"), n = {}, a = t.parents(i.originalElement[0]).length ? [ "width", "height" ] : [ "width", "height", "top", "left" ];
                e.each(a, function(e, t) {
                    var i = (s[t] || 0) + (r[t] || 0);
                    i && 0 <= i && (n[t] = i || null);
                }), t.css(n);
            });
        },
        stop: function() {
            e(this).removeData("resizable-alsoresize");
        }
    }), e.ui.plugin.add("resizable", "ghost", {
        start: function() {
            var t = e(this).resizable("instance"), i = t.options, s = t.size;
            t.ghost = t.originalElement.clone(), t.ghost.css({
                opacity: .25,
                display: "block",
                position: "relative",
                height: s.height,
                width: s.width,
                margin: 0,
                left: 0,
                top: 0
            }).addClass("ui-resizable-ghost").addClass("string" == typeof i.ghost ? i.ghost : ""), 
            t.ghost.appendTo(t.helper);
        },
        resize: function() {
            var t = e(this).resizable("instance");
            t.ghost && t.ghost.css({
                position: "relative",
                height: t.size.height,
                width: t.size.width
            });
        },
        stop: function() {
            var t = e(this).resizable("instance");
            t.ghost && t.helper && t.helper.get(0).removeChild(t.ghost.get(0));
        }
    }), e.ui.plugin.add("resizable", "grid", {
        resize: function() {
            var t, i = e(this).resizable("instance"), s = i.options, y = i.size, a = i.originalSize, o = i.originalPosition, r = i.axis, h = "number" == typeof s.grid ? [ s.grid, s.grid ] : s.grid, l = h[0] || 1, u = h[1] || 1, d = Math.round((y.width - a.width) / l) * l, c = Math.round((y.height - a.height) / u) * u, p = a.width + d, f = a.height + c, m = s.maxWidth && p > s.maxWidth, g = s.maxHeight && f > s.maxHeight, v = s.minWidth && s.minWidth > p, y = s.minHeight && s.minHeight > f;
            s.grid = h, v && (p += l), y && (f += u), m && (p -= l), g && (f -= u), /^(se|s|e)$/.test(r) ? (i.size.width = p, 
            i.size.height = f) : /^(ne)$/.test(r) ? (i.size.width = p, i.size.height = f, i.position.top = o.top - c) : /^(sw)$/.test(r) ? (i.size.width = p, 
            i.size.height = f, i.position.left = o.left - d) : ((f - u <= 0 || p - l <= 0) && (t = i._getPaddingPlusBorderDimensions(this)), 
            0 < f - u ? (i.size.height = f, i.position.top = o.top - c) : (f = u - t.height, 
            i.size.height = f, i.position.top = o.top + a.height - f), 0 < p - l ? (i.size.width = p, 
            i.position.left = o.left - d) : (p = l - t.width, i.size.width = p, i.position.left = o.left + a.width - p));
        }
    }), e.ui.resizable, e.widget("ui.selectable", e.ui.mouse, {
        version: "1.11.4",
        options: {
            appendTo: "body",
            autoRefresh: !0,
            distance: 0,
            filter: "*",
            tolerance: "touch",
            selected: null,
            selecting: null,
            start: null,
            stop: null,
            unselected: null,
            unselecting: null
        },
        _create: function() {
            var t, i = this;
            this.element.addClass("ui-selectable"), this.dragged = !1, this.refresh = function() {
                (t = e(i.options.filter, i.element[0])).addClass("ui-selectee"), t.each(function() {
                    var t = e(this), i = t.offset();
                    e.data(this, "selectable-item", {
                        element: this,
                        $element: t,
                        left: i.left,
                        top: i.top,
                        right: i.left + t.outerWidth(),
                        bottom: i.top + t.outerHeight(),
                        startselected: !1,
                        selected: t.hasClass("ui-selected"),
                        selecting: t.hasClass("ui-selecting"),
                        unselecting: t.hasClass("ui-unselecting")
                    });
                });
            }, this.refresh(), this.selectees = t.addClass("ui-selectee"), this._mouseInit(), 
            this.helper = e("<div class='ui-selectable-helper'></div>");
        },
        _destroy: function() {
            this.selectees.removeClass("ui-selectee").removeData("selectable-item"), this.element.removeClass("ui-selectable ui-selectable-disabled"), 
            this._mouseDestroy();
        },
        _mouseStart: function(t) {
            var i = this, s = this.options;
            this.opos = [ t.pageX, t.pageY ], this.options.disabled || (this.selectees = e(s.filter, this.element[0]), 
            this._trigger("start", t), e(s.appendTo).append(this.helper), this.helper.css({
                left: t.pageX,
                top: t.pageY,
                width: 0,
                height: 0
            }), s.autoRefresh && this.refresh(), this.selectees.filter(".ui-selected").each(function() {
                var s = e.data(this, "selectable-item");
                s.startselected = !0, t.metaKey || t.ctrlKey || (s.$element.removeClass("ui-selected"), 
                s.selected = !1, s.$element.addClass("ui-unselecting"), s.unselecting = !0, i._trigger("unselecting", t, {
                    unselecting: s.element
                }));
            }), e(t.target).parents().addBack().each(function() {
                var s, n = e.data(this, "selectable-item");
                return n ? (s = !t.metaKey && !t.ctrlKey || !n.$element.hasClass("ui-selected"), 
                n.$element.removeClass(s ? "ui-unselecting" : "ui-selected").addClass(s ? "ui-selecting" : "ui-unselecting"), 
                n.unselecting = !s, n.selecting = s, (n.selected = s) ? i._trigger("selecting", t, {
                    selecting: n.element
                }) : i._trigger("unselecting", t, {
                    unselecting: n.element
                }), !1) : void 0;
            }));
        },
        _mouseDrag: function(t) {
            if (this.dragged = !0, !this.options.disabled) {
                var i, s = this, n = this.options, a = this.opos[0], o = this.opos[1], r = t.pageX, h = t.pageY;
                return r < a && (i = r, r = a, a = i), h < o && (i = h, h = o, o = i), this.helper.css({
                    left: a,
                    top: o,
                    width: r - a,
                    height: h - o
                }), this.selectees.each(function() {
                    var i = e.data(this, "selectable-item"), l = !1;
                    i && i.element !== s.element[0] && ("touch" === n.tolerance ? l = !(i.left > r || a > i.right || i.top > h || o > i.bottom) : "fit" === n.tolerance && (l = i.left > a && r > i.right && i.top > o && h > i.bottom), 
                    l ? (i.selected && (i.$element.removeClass("ui-selected"), i.selected = !1), i.unselecting && (i.$element.removeClass("ui-unselecting"), 
                    i.unselecting = !1), i.selecting || (i.$element.addClass("ui-selecting"), i.selecting = !0, 
                    s._trigger("selecting", t, {
                        selecting: i.element
                    }))) : (i.selecting && ((t.metaKey || t.ctrlKey) && i.startselected ? (i.$element.removeClass("ui-selecting"), 
                    i.selecting = !1, i.$element.addClass("ui-selected"), i.selected = !0) : (i.$element.removeClass("ui-selecting"), 
                    i.selecting = !1, i.startselected && (i.$element.addClass("ui-unselecting"), i.unselecting = !0), 
                    s._trigger("unselecting", t, {
                        unselecting: i.element
                    }))), i.selected && (t.metaKey || t.ctrlKey || i.startselected || (i.$element.removeClass("ui-selected"), 
                    i.selected = !1, i.$element.addClass("ui-unselecting"), i.unselecting = !0, s._trigger("unselecting", t, {
                        unselecting: i.element
                    })))));
                }), !1;
            }
        },
        _mouseStop: function(t) {
            var i = this;
            return this.dragged = !1, e(".ui-unselecting", this.element[0]).each(function() {
                var s = e.data(this, "selectable-item");
                s.$element.removeClass("ui-unselecting"), s.unselecting = !1, s.startselected = !1, 
                i._trigger("unselected", t, {
                    unselected: s.element
                });
            }), e(".ui-selecting", this.element[0]).each(function() {
                var s = e.data(this, "selectable-item");
                s.$element.removeClass("ui-selecting").addClass("ui-selected"), s.selecting = !1, 
                s.selected = !0, s.startselected = !0, i._trigger("selected", t, {
                    selected: s.element
                });
            }), this._trigger("stop", t), this.helper.remove(), !1;
        }
    }), e.widget("ui.sortable", e.ui.mouse, {
        version: "1.11.4",
        widgetEventPrefix: "sort",
        ready: !1,
        options: {
            appendTo: "parent",
            axis: !1,
            connectWith: !1,
            containment: !1,
            cursor: "auto",
            cursorAt: !1,
            dropOnEmpty: !0,
            forcePlaceholderSize: !1,
            forceHelperSize: !1,
            grid: !1,
            handle: !1,
            helper: "original",
            items: "> *",
            opacity: !1,
            placeholder: !1,
            revert: !1,
            scroll: !0,
            scrollSensitivity: 20,
            scrollSpeed: 20,
            scope: "default",
            tolerance: "intersect",
            zIndex: 1e3,
            activate: null,
            beforeStop: null,
            change: null,
            deactivate: null,
            out: null,
            over: null,
            receive: null,
            remove: null,
            sort: null,
            start: null,
            stop: null,
            update: null
        },
        _isOverAxis: function(e, t, i) {
            return t <= e && e < t + i;
        },
        _isFloating: function(e) {
            return /left|right/.test(e.css("float")) || /inline|table-cell/.test(e.css("display"));
        },
        _create: function() {
            this.containerCache = {}, this.element.addClass("ui-sortable"), this.refresh(), 
            this.offset = this.element.offset(), this._mouseInit(), this._setHandleClassName(), 
            this.ready = !0;
        },
        _setOption: function(e, t) {
            this._super(e, t), "handle" === e && this._setHandleClassName();
        },
        _setHandleClassName: function() {
            this.element.find(".ui-sortable-handle").removeClass("ui-sortable-handle"), e.each(this.items, function() {
                (this.instance.options.handle ? this.item.find(this.instance.options.handle) : this.item).addClass("ui-sortable-handle");
            });
        },
        _destroy: function() {
            this.element.removeClass("ui-sortable ui-sortable-disabled").find(".ui-sortable-handle").removeClass("ui-sortable-handle"), 
            this._mouseDestroy();
            for (var e = this.items.length - 1; 0 <= e; e--) this.items[e].item.removeData(this.widgetName + "-item");
            return this;
        },
        _mouseCapture: function(t, i) {
            var s = null, n = !1, a = this;
            return !this.reverting && (!this.options.disabled && "static" !== this.options.type && (this._refreshItems(t), 
            e(t.target).parents().each(function() {
                return e.data(this, a.widgetName + "-item") === a ? (s = e(this), !1) : void 0;
            }), !!(s = e.data(t.target, a.widgetName + "-item") === a ? e(t.target) : s) && (!(this.options.handle && !i && (e(this.options.handle, s).find("*").addBack().each(function() {
                this === t.target && (n = !0);
            }), !n)) && (this.currentItem = s, this._removeCurrentsFromItems(), !0))));
        },
        _mouseStart: function(t, i, s) {
            var n, a, o = this.options;
            if ((this.currentContainer = this).refreshPositions(), this.helper = this._createHelper(t), 
            this._cacheHelperProportions(), this._cacheMargins(), this.scrollParent = this.helper.scrollParent(), 
            this.offset = this.currentItem.offset(), this.offset = {
                top: this.offset.top - this.margins.top,
                left: this.offset.left - this.margins.left
            }, e.extend(this.offset, {
                click: {
                    left: t.pageX - this.offset.left,
                    top: t.pageY - this.offset.top
                },
                parent: this._getParentOffset(),
                relative: this._getRelativeOffset()
            }), this.helper.css("position", "absolute"), this.cssPosition = this.helper.css("position"), 
            this.originalPosition = this._generatePosition(t), this.originalPageX = t.pageX, 
            this.originalPageY = t.pageY, o.cursorAt && this._adjustOffsetFromHelper(o.cursorAt), 
            this.domPosition = {
                prev: this.currentItem.prev()[0],
                parent: this.currentItem.parent()[0]
            }, this.helper[0] !== this.currentItem[0] && this.currentItem.hide(), this._createPlaceholder(), 
            o.containment && this._setContainment(), o.cursor && "auto" !== o.cursor && (a = this.document.find("body"), 
            this.storedCursor = a.css("cursor"), a.css("cursor", o.cursor), this.storedStylesheet = e("<style>*{ cursor: " + o.cursor + " !important; }</style>").appendTo(a)), 
            o.opacity && (this.helper.css("opacity") && (this._storedOpacity = this.helper.css("opacity")), 
            this.helper.css("opacity", o.opacity)), o.zIndex && (this.helper.css("zIndex") && (this._storedZIndex = this.helper.css("zIndex")), 
            this.helper.css("zIndex", o.zIndex)), this.scrollParent[0] !== this.document[0] && "HTML" !== this.scrollParent[0].tagName && (this.overflowOffset = this.scrollParent.offset()), 
            this._trigger("start", t, this._uiHash()), this._preserveHelperProportions || this._cacheHelperProportions(), 
            !s) for (n = this.containers.length - 1; 0 <= n; n--) this.containers[n]._trigger("activate", t, this._uiHash(this));
            return e.ui.ddmanager && (e.ui.ddmanager.current = this), e.ui.ddmanager && !o.dropBehaviour && e.ui.ddmanager.prepareOffsets(this, t), 
            this.dragging = !0, this.helper.addClass("ui-sortable-helper"), this._mouseDrag(t), 
            !0;
        },
        _mouseDrag: function(t) {
            var i, s, n, a, o = this.options, r = !1;
            for (this.position = this._generatePosition(t), this.positionAbs = this._convertPositionTo("absolute"), 
            this.lastPositionAbs || (this.lastPositionAbs = this.positionAbs), this.options.scroll && (this.scrollParent[0] !== this.document[0] && "HTML" !== this.scrollParent[0].tagName ? (this.overflowOffset.top + this.scrollParent[0].offsetHeight - t.pageY < o.scrollSensitivity ? this.scrollParent[0].scrollTop = r = this.scrollParent[0].scrollTop + o.scrollSpeed : t.pageY - this.overflowOffset.top < o.scrollSensitivity && (this.scrollParent[0].scrollTop = r = this.scrollParent[0].scrollTop - o.scrollSpeed), 
            this.overflowOffset.left + this.scrollParent[0].offsetWidth - t.pageX < o.scrollSensitivity ? this.scrollParent[0].scrollLeft = r = this.scrollParent[0].scrollLeft + o.scrollSpeed : t.pageX - this.overflowOffset.left < o.scrollSensitivity && (this.scrollParent[0].scrollLeft = r = this.scrollParent[0].scrollLeft - o.scrollSpeed)) : (t.pageY - this.document.scrollTop() < o.scrollSensitivity ? r = this.document.scrollTop(this.document.scrollTop() - o.scrollSpeed) : this.window.height() - (t.pageY - this.document.scrollTop()) < o.scrollSensitivity && (r = this.document.scrollTop(this.document.scrollTop() + o.scrollSpeed)), 
            t.pageX - this.document.scrollLeft() < o.scrollSensitivity ? r = this.document.scrollLeft(this.document.scrollLeft() - o.scrollSpeed) : this.window.width() - (t.pageX - this.document.scrollLeft()) < o.scrollSensitivity && (r = this.document.scrollLeft(this.document.scrollLeft() + o.scrollSpeed))), 
            !1 !== r && e.ui.ddmanager && !o.dropBehaviour && e.ui.ddmanager.prepareOffsets(this, t)), 
            this.positionAbs = this._convertPositionTo("absolute"), this.options.axis && "y" === this.options.axis || (this.helper[0].style.left = this.position.left + "px"), 
            this.options.axis && "x" === this.options.axis || (this.helper[0].style.top = this.position.top + "px"), 
            i = this.items.length - 1; 0 <= i; i--) if (n = (s = this.items[i]).item[0], (a = this._intersectsWithPointer(s)) && s.instance === this.currentContainer && n !== this.currentItem[0] && this.placeholder[1 === a ? "next" : "prev"]()[0] !== n && !e.contains(this.placeholder[0], n) && ("semi-dynamic" !== this.options.type || !e.contains(this.element[0], n))) {
                if (this.direction = 1 === a ? "down" : "up", "pointer" !== this.options.tolerance && !this._intersectsWithSides(s)) break;
                this._rearrange(t, s), this._trigger("change", t, this._uiHash());
                break;
            }
            return this._contactContainers(t), e.ui.ddmanager && e.ui.ddmanager.drag(this, t), 
            this._trigger("sort", t, this._uiHash()), this.lastPositionAbs = this.positionAbs, 
            !1;
        },
        _mouseStop: function(t, i) {
            var s, n, a, o;
            if (t) return e.ui.ddmanager && !this.options.dropBehaviour && e.ui.ddmanager.drop(this, t), 
            this.options.revert ? (n = (s = this).placeholder.offset(), o = {}, (a = this.options.axis) && "x" !== a || (o.left = n.left - this.offset.parent.left - this.margins.left + (this.offsetParent[0] === this.document[0].body ? 0 : this.offsetParent[0].scrollLeft)), 
            a && "y" !== a || (o.top = n.top - this.offset.parent.top - this.margins.top + (this.offsetParent[0] === this.document[0].body ? 0 : this.offsetParent[0].scrollTop)), 
            this.reverting = !0, e(this.helper).animate(o, parseInt(this.options.revert, 10) || 500, function() {
                s._clear(t);
            })) : this._clear(t, i), !1;
        },
        cancel: function() {
            if (this.dragging) {
                this._mouseUp({
                    target: null
                }), "original" === this.options.helper ? this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper") : this.currentItem.show();
                for (var t = this.containers.length - 1; 0 <= t; t--) this.containers[t]._trigger("deactivate", null, this._uiHash(this)), 
                this.containers[t].containerCache.over && (this.containers[t]._trigger("out", null, this._uiHash(this)), 
                this.containers[t].containerCache.over = 0);
            }
            return this.placeholder && (this.placeholder[0].parentNode && this.placeholder[0].parentNode.removeChild(this.placeholder[0]), 
            "original" !== this.options.helper && this.helper && this.helper[0].parentNode && this.helper.remove(), 
            e.extend(this, {
                helper: null,
                dragging: !1,
                reverting: !1,
                _noFinalSort: null
            }), this.domPosition.prev ? e(this.domPosition.prev).after(this.currentItem) : e(this.domPosition.parent).prepend(this.currentItem)), 
            this;
        },
        serialize: function(t) {
            var i = this._getItemsAsjQuery(t && t.connected), s = [];
            return t = t || {}, e(i).each(function() {
                var i = (e(t.item || this).attr(t.attribute || "id") || "").match(t.expression || /(.+)[\-=_](.+)/);
                i && s.push((t.key || i[1] + "[]") + "=" + (t.key && t.expression ? i[1] : i[2]));
            }), !s.length && t.key && s.push(t.key + "="), s.join("&");
        },
        toArray: function(t) {
            var i = this._getItemsAsjQuery(t && t.connected), s = [];
            return t = t || {}, i.each(function() {
                s.push(e(t.item || this).attr(t.attribute || "id") || "");
            }), s;
        },
        _intersectsWith: function(e) {
            var t = this.positionAbs.left, i = t + this.helperProportions.width, s = this.positionAbs.top, n = s + this.helperProportions.height, a = e.left, o = a + e.width, r = e.top, h = r + e.height, d = this.offset.click.top, c = this.offset.click.left, d = "x" === this.options.axis || r < s + d && s + d < h, c = "y" === this.options.axis || a < t + c && t + c < o;
            return "pointer" === this.options.tolerance || this.options.forcePointerForContainers || "pointer" !== this.options.tolerance && this.helperProportions[this.floating ? "width" : "height"] > e[this.floating ? "width" : "height"] ? d && c : t + this.helperProportions.width / 2 > a && o > i - this.helperProportions.width / 2 && s + this.helperProportions.height / 2 > r && h > n - this.helperProportions.height / 2;
        },
        _intersectsWithPointer: function(s) {
            var n = "x" === this.options.axis || this._isOverAxis(this.positionAbs.top + this.offset.click.top, s.top, s.height), a = "y" === this.options.axis || this._isOverAxis(this.positionAbs.left + this.offset.click.left, s.left, s.width), s = n && a, n = this._getDragVerticalDirection(), a = this._getDragHorizontalDirection();
            return !!s && (this.floating ? a && "right" === a || "down" === n ? 2 : 1 : n && ("down" === n ? 2 : 1));
        },
        _intersectsWithSides: function(n) {
            var t = this._isOverAxis(this.positionAbs.top + this.offset.click.top, n.top + n.height / 2, n.height), i = this._isOverAxis(this.positionAbs.left + this.offset.click.left, n.left + n.width / 2, n.width), s = this._getDragVerticalDirection(), n = this._getDragHorizontalDirection();
            return this.floating && n ? "right" === n && i || "left" === n && !i : s && ("down" === s && t || "up" === s && !t);
        },
        _getDragVerticalDirection: function() {
            var e = this.positionAbs.top - this.lastPositionAbs.top;
            return 0 != e && (0 < e ? "down" : "up");
        },
        _getDragHorizontalDirection: function() {
            var e = this.positionAbs.left - this.lastPositionAbs.left;
            return 0 != e && (0 < e ? "right" : "left");
        },
        refresh: function(e) {
            return this._refreshItems(e), this._setHandleClassName(), this.refreshPositions(), 
            this;
        },
        _connectWith: function() {
            var e = this.options;
            return e.connectWith.constructor === String ? [ e.connectWith ] : e.connectWith;
        },
        _getItemsAsjQuery: function(t) {
            function i() {
                r.push(this);
            }
            var s, n, a, o, r = [], h = [], l = this._connectWith();
            if (l && t) for (s = l.length - 1; 0 <= s; s--) for (n = (a = e(l[s], this.document[0])).length - 1; 0 <= n; n--) (o = e.data(a[n], this.widgetFullName)) && o !== this && !o.options.disabled && h.push([ e.isFunction(o.options.items) ? o.options.items.call(o.element) : e(o.options.items, o.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"), o ]);
            for (h.push([ e.isFunction(this.options.items) ? this.options.items.call(this.element, null, {
                options: this.options,
                item: this.currentItem
            }) : e(this.options.items, this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"), this ]), 
            s = h.length - 1; 0 <= s; s--) h[s][0].each(i);
            return e(r);
        },
        _removeCurrentsFromItems: function() {
            var t = this.currentItem.find(":data(" + this.widgetName + "-item)");
            this.items = e.grep(this.items, function(e) {
                for (var i = 0; t.length > i; i++) if (t[i] === e.item[0]) return !1;
                return !0;
            });
        },
        _refreshItems: function(t) {
            this.items = [], this.containers = [ this ];
            var i, s, n, a, o, r, h, l, u = this.items, d = [ [ e.isFunction(this.options.items) ? this.options.items.call(this.element[0], t, {
                item: this.currentItem
            }) : e(this.options.items, this.element), this ] ], c = this._connectWith();
            if (c && this.ready) for (i = c.length - 1; 0 <= i; i--) for (s = (n = e(c[i], this.document[0])).length - 1; 0 <= s; s--) (a = e.data(n[s], this.widgetFullName)) && a !== this && !a.options.disabled && (d.push([ e.isFunction(a.options.items) ? a.options.items.call(a.element[0], t, {
                item: this.currentItem
            }) : e(a.options.items, a.element), a ]), this.containers.push(a));
            for (i = d.length - 1; 0 <= i; i--) for (o = d[i][1], l = (r = d[i][s = 0]).length; s < l; s++) (h = e(r[s])).data(this.widgetName + "-item", o), 
            u.push({
                item: h,
                instance: o,
                width: 0,
                height: 0,
                left: 0,
                top: 0
            });
        },
        refreshPositions: function(t) {
            var i, s, n, a;
            for (this.floating = !!this.items.length && ("x" === this.options.axis || this._isFloating(this.items[0].item)), 
            this.offsetParent && this.helper && (this.offset.parent = this._getParentOffset()), 
            i = this.items.length - 1; 0 <= i; i--) (s = this.items[i]).instance !== this.currentContainer && this.currentContainer && s.item[0] !== this.currentItem[0] || (n = this.options.toleranceElement ? e(this.options.toleranceElement, s.item) : s.item, 
            t || (s.width = n.outerWidth(), s.height = n.outerHeight()), a = n.offset(), s.left = a.left, 
            s.top = a.top);
            if (this.options.custom && this.options.custom.refreshContainers) this.options.custom.refreshContainers.call(this); else for (i = this.containers.length - 1; 0 <= i; i--) a = this.containers[i].element.offset(), 
            this.containers[i].containerCache.left = a.left, this.containers[i].containerCache.top = a.top, 
            this.containers[i].containerCache.width = this.containers[i].element.outerWidth(), 
            this.containers[i].containerCache.height = this.containers[i].element.outerHeight();
            return this;
        },
        _createPlaceholder: function(t) {
            var i, s = (t = t || this).options;
            s.placeholder && s.placeholder.constructor !== String || (i = s.placeholder, s.placeholder = {
                element: function() {
                    var s = t.currentItem[0].nodeName.toLowerCase(), n = e("<" + s + ">", t.document[0]).addClass(i || t.currentItem[0].className + " ui-sortable-placeholder").removeClass("ui-sortable-helper");
                    return "tbody" === s ? t._createTrPlaceholder(t.currentItem.find("tr").eq(0), e("<tr>", t.document[0]).appendTo(n)) : "tr" === s ? t._createTrPlaceholder(t.currentItem, n) : "img" === s && n.attr("src", t.currentItem.attr("src")), 
                    i || n.css("visibility", "hidden"), n;
                },
                update: function(e, n) {
                    i && !s.forcePlaceholderSize || (n.height() || n.height(t.currentItem.innerHeight() - parseInt(t.currentItem.css("paddingTop") || 0, 10) - parseInt(t.currentItem.css("paddingBottom") || 0, 10)), 
                    n.width() || n.width(t.currentItem.innerWidth() - parseInt(t.currentItem.css("paddingLeft") || 0, 10) - parseInt(t.currentItem.css("paddingRight") || 0, 10)));
                }
            }), t.placeholder = e(s.placeholder.element.call(t.element, t.currentItem)), t.currentItem.after(t.placeholder), 
            s.placeholder.update(t, t.placeholder);
        },
        _createTrPlaceholder: function(t, i) {
            var s = this;
            t.children().each(function() {
                e("<td>&#160;</td>", s.document[0]).attr("colspan", e(this).attr("colspan") || 1).appendTo(i);
            });
        },
        _contactContainers: function(t) {
            for (var s, n, a, o, r, h, l, u, d, c = null, p = null, i = this.containers.length - 1; 0 <= i; i--) if (!e.contains(this.currentItem[0], this.containers[i].element[0])) if (this._intersectsWith(this.containers[i].containerCache)) {
                if (c && e.contains(this.containers[i].element[0], c.element[0])) continue;
                c = this.containers[i], p = i;
            } else this.containers[i].containerCache.over && (this.containers[i]._trigger("out", t, this._uiHash(this)), 
            this.containers[i].containerCache.over = 0);
            if (c) if (1 === this.containers.length) this.containers[p].containerCache.over || (this.containers[p]._trigger("over", t, this._uiHash(this)), 
            this.containers[p].containerCache.over = 1); else {
                for (n = 1e4, a = null, o = (u = c.floating || this._isFloating(this.currentItem)) ? "left" : "top", 
                r = u ? "width" : "height", d = u ? "clientX" : "clientY", s = this.items.length - 1; 0 <= s; s--) e.contains(this.containers[p].element[0], this.items[s].item[0]) && this.items[s].item[0] !== this.currentItem[0] && (h = this.items[s].item.offset()[o], 
                l = !1, t[d] - h > this.items[s][r] / 2 && (l = !0), n > Math.abs(t[d] - h) && (n = Math.abs(t[d] - h), 
                a = this.items[s], this.direction = l ? "up" : "down"));
                (a || this.options.dropOnEmpty) && (this.currentContainer !== this.containers[p] ? (a ? this._rearrange(t, a, null, !0) : this._rearrange(t, null, this.containers[p].element, !0), 
                this._trigger("change", t, this._uiHash()), this.containers[p]._trigger("change", t, this._uiHash(this)), 
                this.currentContainer = this.containers[p], this.options.placeholder.update(this.currentContainer, this.placeholder), 
                this.containers[p]._trigger("over", t, this._uiHash(this)), this.containers[p].containerCache.over = 1) : this.currentContainer.containerCache.over || (this.containers[p]._trigger("over", t, this._uiHash()), 
                this.currentContainer.containerCache.over = 1));
            }
        },
        _createHelper: function(s) {
            var i = this.options, s = e.isFunction(i.helper) ? e(i.helper.apply(this.element[0], [ s, this.currentItem ])) : "clone" === i.helper ? this.currentItem.clone() : this.currentItem;
            return s.parents("body").length || e("parent" !== i.appendTo ? i.appendTo : this.currentItem[0].parentNode)[0].appendChild(s[0]), 
            s[0] === this.currentItem[0] && (this._storedCSS = {
                width: this.currentItem[0].style.width,
                height: this.currentItem[0].style.height,
                position: this.currentItem.css("position"),
                top: this.currentItem.css("top"),
                left: this.currentItem.css("left")
            }), s[0].style.width && !i.forceHelperSize || s.width(this.currentItem.width()), 
            s[0].style.height && !i.forceHelperSize || s.height(this.currentItem.height()), 
            s;
        },
        _adjustOffsetFromHelper: function(t) {
            "string" == typeof t && (t = t.split(" ")), "left" in (t = e.isArray(t) ? {
                left: +t[0],
                top: +t[1] || 0
            } : t) && (this.offset.click.left = t.left + this.margins.left), "right" in t && (this.offset.click.left = this.helperProportions.width - t.right + this.margins.left), 
            "top" in t && (this.offset.click.top = t.top + this.margins.top), "bottom" in t && (this.offset.click.top = this.helperProportions.height - t.bottom + this.margins.top);
        },
        _getParentOffset: function() {
            this.offsetParent = this.helper.offsetParent();
            var t = this.offsetParent.offset();
            return "absolute" === this.cssPosition && this.scrollParent[0] !== this.document[0] && e.contains(this.scrollParent[0], this.offsetParent[0]) && (t.left += this.scrollParent.scrollLeft(), 
            t.top += this.scrollParent.scrollTop()), {
                top: (t = this.offsetParent[0] === this.document[0].body || this.offsetParent[0].tagName && "html" === this.offsetParent[0].tagName.toLowerCase() && e.ui.ie ? {
                    top: 0,
                    left: 0
                } : t).top + (parseInt(this.offsetParent.css("borderTopWidth"), 10) || 0),
                left: t.left + (parseInt(this.offsetParent.css("borderLeftWidth"), 10) || 0)
            };
        },
        _getRelativeOffset: function() {
            if ("relative" !== this.cssPosition) return {
                top: 0,
                left: 0
            };
            var e = this.currentItem.position();
            return {
                top: e.top - (parseInt(this.helper.css("top"), 10) || 0) + this.scrollParent.scrollTop(),
                left: e.left - (parseInt(this.helper.css("left"), 10) || 0) + this.scrollParent.scrollLeft()
            };
        },
        _cacheMargins: function() {
            this.margins = {
                left: parseInt(this.currentItem.css("marginLeft"), 10) || 0,
                top: parseInt(this.currentItem.css("marginTop"), 10) || 0
            };
        },
        _cacheHelperProportions: function() {
            this.helperProportions = {
                width: this.helper.outerWidth(),
                height: this.helper.outerHeight()
            };
        },
        _setContainment: function() {
            var t, i, s = this.options;
            "parent" === s.containment && (s.containment = this.helper[0].parentNode), "document" !== s.containment && "window" !== s.containment || (this.containment = [ 0 - this.offset.relative.left - this.offset.parent.left, 0 - this.offset.relative.top - this.offset.parent.top, "document" === s.containment ? this.document.width() : this.window.width() - this.helperProportions.width - this.margins.left, ("document" === s.containment ? this.document.width() : this.window.height() || this.document[0].body.parentNode.scrollHeight) - this.helperProportions.height - this.margins.top ]), 
            /^(document|window|parent)$/.test(s.containment) || (t = e(s.containment)[0], i = e(s.containment).offset(), 
            s = "hidden" !== e(t).css("overflow"), this.containment = [ i.left + (parseInt(e(t).css("borderLeftWidth"), 10) || 0) + (parseInt(e(t).css("paddingLeft"), 10) || 0) - this.margins.left, i.top + (parseInt(e(t).css("borderTopWidth"), 10) || 0) + (parseInt(e(t).css("paddingTop"), 10) || 0) - this.margins.top, i.left + (s ? Math.max(t.scrollWidth, t.offsetWidth) : t.offsetWidth) - (parseInt(e(t).css("borderLeftWidth"), 10) || 0) - (parseInt(e(t).css("paddingRight"), 10) || 0) - this.helperProportions.width - this.margins.left, i.top + (s ? Math.max(t.scrollHeight, t.offsetHeight) : t.offsetHeight) - (parseInt(e(t).css("borderTopWidth"), 10) || 0) - (parseInt(e(t).css("paddingBottom"), 10) || 0) - this.helperProportions.height - this.margins.top ]);
        },
        _convertPositionTo: function(a, i) {
            i = i || this.position;
            var s = "absolute" === a ? 1 : -1, n = "absolute" !== this.cssPosition || this.scrollParent[0] !== this.document[0] && e.contains(this.scrollParent[0], this.offsetParent[0]) ? this.scrollParent : this.offsetParent, a = /(html|body)/i.test(n[0].tagName);
            return {
                top: i.top + this.offset.relative.top * s + this.offset.parent.top * s - ("fixed" === this.cssPosition ? -this.scrollParent.scrollTop() : a ? 0 : n.scrollTop()) * s,
                left: i.left + this.offset.relative.left * s + this.offset.parent.left * s - ("fixed" === this.cssPosition ? -this.scrollParent.scrollLeft() : a ? 0 : n.scrollLeft()) * s
            };
        },
        _generatePosition: function(s) {
            var n = this.options, a = s.pageX, o = s.pageY, r = "absolute" !== this.cssPosition || this.scrollParent[0] !== this.document[0] && e.contains(this.scrollParent[0], this.offsetParent[0]) ? this.scrollParent : this.offsetParent, h = /(html|body)/i.test(r[0].tagName);
            return "relative" !== this.cssPosition || this.scrollParent[0] !== this.document[0] && this.scrollParent[0] !== this.offsetParent[0] || (this.offset.relative = this._getRelativeOffset()), 
            this.originalPosition && (this.containment && (s.pageX - this.offset.click.left < this.containment[0] && (a = this.containment[0] + this.offset.click.left), 
            s.pageY - this.offset.click.top < this.containment[1] && (o = this.containment[1] + this.offset.click.top), 
            s.pageX - this.offset.click.left > this.containment[2] && (a = this.containment[2] + this.offset.click.left), 
            s.pageY - this.offset.click.top > this.containment[3] && (o = this.containment[3] + this.offset.click.top)), 
            n.grid && (s = this.originalPageY + Math.round((o - this.originalPageY) / n.grid[1]) * n.grid[1], 
            o = !this.containment || s - this.offset.click.top >= this.containment[1] && s - this.offset.click.top <= this.containment[3] ? s : s - this.offset.click.top >= this.containment[1] ? s - n.grid[1] : s + n.grid[1], 
            s = this.originalPageX + Math.round((a - this.originalPageX) / n.grid[0]) * n.grid[0], 
            a = !this.containment || s - this.offset.click.left >= this.containment[0] && s - this.offset.click.left <= this.containment[2] ? s : s - this.offset.click.left >= this.containment[0] ? s - n.grid[0] : s + n.grid[0])), 
            {
                top: o - this.offset.click.top - this.offset.relative.top - this.offset.parent.top + ("fixed" === this.cssPosition ? -this.scrollParent.scrollTop() : h ? 0 : r.scrollTop()),
                left: a - this.offset.click.left - this.offset.relative.left - this.offset.parent.left + ("fixed" === this.cssPosition ? -this.scrollParent.scrollLeft() : h ? 0 : r.scrollLeft())
            };
        },
        _rearrange: function(e, t, i, s) {
            i ? i[0].appendChild(this.placeholder[0]) : t.item[0].parentNode.insertBefore(this.placeholder[0], "down" === this.direction ? t.item[0] : t.item[0].nextSibling), 
            this.counter = this.counter ? ++this.counter : 1;
            var n = this.counter;
            this._delay(function() {
                n === this.counter && this.refreshPositions(!s);
            });
        },
        _clear: function(e, t) {
            function i(e, t, i) {
                return function(s) {
                    i._trigger(e, s, t._uiHash(t));
                };
            }
            this.reverting = !1;
            var s, n = [];
            if (!this._noFinalSort && this.currentItem.parent().length && this.placeholder.before(this.currentItem), 
            this._noFinalSort = null, this.helper[0] === this.currentItem[0]) {
                for (s in this._storedCSS) "auto" !== this._storedCSS[s] && "static" !== this._storedCSS[s] || (this._storedCSS[s] = "");
                this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper");
            } else this.currentItem.show();
            for (this.fromOutside && !t && n.push(function(e) {
                this._trigger("receive", e, this._uiHash(this.fromOutside));
            }), !this.fromOutside && this.domPosition.prev === this.currentItem.prev().not(".ui-sortable-helper")[0] && this.domPosition.parent === this.currentItem.parent()[0] || t || n.push(function(e) {
                this._trigger("update", e, this._uiHash());
            }), this !== this.currentContainer && (t || (n.push(function(e) {
                this._trigger("remove", e, this._uiHash());
            }), n.push(function(e) {
                return function(t) {
                    e._trigger("receive", t, this._uiHash(this));
                };
            }.call(this, this.currentContainer)), n.push(function(e) {
                return function(t) {
                    e._trigger("update", t, this._uiHash(this));
                };
            }.call(this, this.currentContainer)))), s = this.containers.length - 1; 0 <= s; s--) t || n.push(i("deactivate", this, this.containers[s])), 
            this.containers[s].containerCache.over && (n.push(i("out", this, this.containers[s])), 
            this.containers[s].containerCache.over = 0);
            if (this.storedCursor && (this.document.find("body").css("cursor", this.storedCursor), 
            this.storedStylesheet.remove()), this._storedOpacity && this.helper.css("opacity", this._storedOpacity), 
            this._storedZIndex && this.helper.css("zIndex", "auto" === this._storedZIndex ? "" : this._storedZIndex), 
            this.dragging = !1, t || this._trigger("beforeStop", e, this._uiHash()), this.placeholder[0].parentNode.removeChild(this.placeholder[0]), 
            this.cancelHelperRemoval || (this.helper[0] !== this.currentItem[0] && this.helper.remove(), 
            this.helper = null), !t) {
                for (s = 0; n.length > s; s++) n[s].call(this, e);
                this._trigger("stop", e, this._uiHash());
            }
            return this.fromOutside = !1, !this.cancelHelperRemoval;
        },
        _trigger: function() {
            !1 === e.Widget.prototype._trigger.apply(this, arguments) && this.cancel();
        },
        _uiHash: function(t) {
            var i = t || this;
            return {
                helper: i.helper,
                placeholder: i.placeholder || e([]),
                position: i.position,
                originalPosition: i.originalPosition,
                offset: i.positionAbs,
                item: i.currentItem,
                sender: t ? t.element : null
            };
        }
    }), e.widget("ui.tabs", {
        version: "1.11.4",
        delay: 300,
        options: {
            active: null,
            collapsible: !1,
            event: "click",
            heightStyle: "content",
            hide: null,
            show: null,
            activate: null,
            beforeActivate: null,
            beforeLoad: null,
            load: null
        },
        _isLocal: function() {
            var e = /#.*$/;
            return function(t) {
                var i = (t = t.cloneNode(!1)).href.replace(e, ""), s = location.href.replace(e, "");
                try {
                    i = decodeURIComponent(i);
                } catch (n) {}
                try {
                    s = decodeURIComponent(s);
                } catch (n) {}
                return 1 < t.hash.length && i === s;
            };
        }(),
        _create: function() {
            var t = this, i = this.options;
            this.running = !1, this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible", i.collapsible), 
            this._processTabs(), i.active = this._initialActive(), e.isArray(i.disabled) && (i.disabled = e.unique(i.disabled.concat(e.map(this.tabs.filter(".ui-state-disabled"), function(e) {
                return t.tabs.index(e);
            }))).sort()), this.active = !1 !== this.options.active && this.anchors.length ? this._findActive(i.active) : e(), 
            this._refresh(), this.active.length && this.load(i.active);
        },
        _initialActive: function() {
            var t = this.options.active, i = this.options.collapsible, s = location.hash.substring(1);
            return null === t && (s && this.tabs.each(function(i, n) {
                return e(n).attr("aria-controls") === s ? (t = i, !1) : void 0;
            }), null !== (t = null === t ? this.tabs.index(this.tabs.filter(".ui-tabs-active")) : t) && -1 !== t || (t = !!this.tabs.length && 0)), 
            !1 !== t && (-1 === (t = this.tabs.index(this.tabs.eq(t))) && (t = !i && 0)), t = !i && !1 === t && this.anchors.length ? 0 : t;
        },
        _getCreateEventData: function() {
            return {
                tab: this.active,
                panel: this.active.length ? this._getPanelForTab(this.active) : e()
            };
        },
        _tabKeydown: function(t) {
            var i = e(this.document[0].activeElement).closest("li"), s = this.tabs.index(i), n = !0;
            if (!this._handlePageNav(t)) {
                switch (t.keyCode) {
                  case e.ui.keyCode.RIGHT:
                  case e.ui.keyCode.DOWN:
                    s++;
                    break;

                  case e.ui.keyCode.UP:
                  case e.ui.keyCode.LEFT:
                    n = !1, s--;
                    break;

                  case e.ui.keyCode.END:
                    s = this.anchors.length - 1;
                    break;

                  case e.ui.keyCode.HOME:
                    s = 0;
                    break;

                  case e.ui.keyCode.SPACE:
                    return t.preventDefault(), clearTimeout(this.activating), void this._activate(s);

                  case e.ui.keyCode.ENTER:
                    return t.preventDefault(), clearTimeout(this.activating), void this._activate(s !== this.options.active && s);

                  default:
                    return;
                }
                t.preventDefault(), clearTimeout(this.activating), s = this._focusNextTab(s, n), 
                t.ctrlKey || t.metaKey || (i.attr("aria-selected", "false"), this.tabs.eq(s).attr("aria-selected", "true"), 
                this.activating = this._delay(function() {
                    this.option("active", s);
                }, this.delay));
            }
        },
        _panelKeydown: function(t) {
            this._handlePageNav(t) || t.ctrlKey && t.keyCode === e.ui.keyCode.UP && (t.preventDefault(), 
            this.active.focus());
        },
        _handlePageNav: function(t) {
            return t.altKey && t.keyCode === e.ui.keyCode.PAGE_UP ? (this._activate(this._focusNextTab(this.options.active - 1, !1)), 
            !0) : t.altKey && t.keyCode === e.ui.keyCode.PAGE_DOWN ? (this._activate(this._focusNextTab(this.options.active + 1, !0)), 
            !0) : void 0;
        },
        _findNextTab: function(t, i) {
            for (var n = this.tabs.length - 1; -1 !== e.inArray(t = (t = n < t ? 0 : t) < 0 ? n : t, this.options.disabled); ) t = i ? t + 1 : t - 1;
            return t;
        },
        _focusNextTab: function(e, t) {
            return e = this._findNextTab(e, t), this.tabs.eq(e).focus(), e;
        },
        _setOption: function(e, t) {
            return "active" === e ? void this._activate(t) : "disabled" === e ? void this._setupDisabled(t) : (this._super(e, t), 
            "collapsible" === e && (this.element.toggleClass("ui-tabs-collapsible", t), t || !1 !== this.options.active || this._activate(0)), 
            "event" === e && this._setupEvents(t), void ("heightStyle" === e && this._setupHeightStyle(t)));
        },
        _sanitizeSelector: function(e) {
            return e ? e.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g, "\\$&") : "";
        },
        refresh: function() {
            var t = this.options, i = this.tablist.children(":has(a[href])");
            t.disabled = e.map(i.filter(".ui-state-disabled"), function(e) {
                return i.index(e);
            }), this._processTabs(), !1 !== t.active && this.anchors.length ? this.active.length && !e.contains(this.tablist[0], this.active[0]) ? this.tabs.length === t.disabled.length ? (t.active = !1, 
            this.active = e()) : this._activate(this._findNextTab(Math.max(0, t.active - 1), !1)) : t.active = this.tabs.index(this.active) : (t.active = !1, 
            this.active = e()), this._refresh();
        },
        _refresh: function() {
            this._setupDisabled(this.options.disabled), this._setupEvents(this.options.event), 
            this._setupHeightStyle(this.options.heightStyle), this.tabs.not(this.active).attr({
                "aria-selected": "false",
                "aria-expanded": "false",
                tabIndex: -1
            }), this.panels.not(this._getPanelForTab(this.active)).hide().attr({
                "aria-hidden": "true"
            }), this.active.length ? (this.active.addClass("ui-tabs-active ui-state-active").attr({
                "aria-selected": "true",
                "aria-expanded": "true",
                tabIndex: 0
            }), this._getPanelForTab(this.active).show().attr({
                "aria-hidden": "false"
            })) : this.tabs.eq(0).attr("tabIndex", 0);
        },
        _processTabs: function() {
            var t = this, i = this.tabs, s = this.anchors, n = this.panels;
            this.tablist = this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role", "tablist").delegate("> li", "mousedown" + this.eventNamespace, function(t) {
                e(this).is(".ui-state-disabled") && t.preventDefault();
            }).delegate(".ui-tabs-anchor", "focus" + this.eventNamespace, function() {
                e(this).closest("li").is(".ui-state-disabled") && this.blur();
            }), this.tabs = this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({
                role: "tab",
                tabIndex: -1
            }), this.anchors = this.tabs.map(function() {
                return e("a", this)[0];
            }).addClass("ui-tabs-anchor").attr({
                role: "presentation",
                tabIndex: -1
            }), this.panels = e(), this.anchors.each(function(i, s) {
                var n, a, o, r = e(s).uniqueId().attr("id"), h = e(s).closest("li"), l = h.attr("aria-controls");
                t._isLocal(s) ? (o = (n = s.hash).substring(1), a = t.element.find(t._sanitizeSelector(n))) : (o = h.attr("aria-controls") || e({}).uniqueId()[0].id, 
                (a = t.element.find(n = "#" + o)).length || (a = t._createPanel(o)).insertAfter(t.panels[i - 1] || t.tablist), 
                a.attr("aria-live", "polite")), a.length && (t.panels = t.panels.add(a)), l && h.data("ui-tabs-aria-controls", l), 
                h.attr({
                    "aria-controls": o,
                    "aria-labelledby": r
                }), a.attr("aria-labelledby", r);
            }), this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role", "tabpanel"), 
            i && (this._off(i.not(this.tabs)), this._off(s.not(this.anchors)), this._off(n.not(this.panels)));
        },
        _getList: function() {
            return this.tablist || this.element.find("ol,ul").eq(0);
        },
        _createPanel: function(t) {
            return e("<div>").attr("id", t).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy", !0);
        },
        _setupDisabled: function(t) {
            e.isArray(t) && (t.length ? t.length === this.anchors.length && (t = !0) : t = !1);
            for (var i, s = 0; i = this.tabs[s]; s++) !0 === t || -1 !== e.inArray(s, t) ? e(i).addClass("ui-state-disabled").attr("aria-disabled", "true") : e(i).removeClass("ui-state-disabled").removeAttr("aria-disabled");
            this.options.disabled = t;
        },
        _setupEvents: function(t) {
            var i = {};
            t && e.each(t.split(" "), function(e, t) {
                i[t] = "_eventHandler";
            }), this._off(this.anchors.add(this.tabs).add(this.panels)), this._on(!0, this.anchors, {
                click: function(e) {
                    e.preventDefault();
                }
            }), this._on(this.anchors, i), this._on(this.tabs, {
                keydown: "_tabKeydown"
            }), this._on(this.panels, {
                keydown: "_panelKeydown"
            }), this._focusable(this.tabs), this._hoverable(this.tabs);
        },
        _setupHeightStyle: function(t) {
            var i, s = this.element.parent();
            "fill" === t ? (i = s.height(), i -= this.element.outerHeight() - this.element.height(), 
            this.element.siblings(":visible").each(function() {
                var t = e(this), s = t.css("position");
                "absolute" !== s && "fixed" !== s && (i -= t.outerHeight(!0));
            }), this.element.children().not(this.panels).each(function() {
                i -= e(this).outerHeight(!0);
            }), this.panels.each(function() {
                e(this).height(Math.max(0, i - e(this).innerHeight() + e(this).height()));
            }).css("overflow", "auto")) : "auto" === t && (i = 0, this.panels.each(function() {
                i = Math.max(i, e(this).height("").height());
            }).height(i));
        },
        _eventHandler: function(t) {
            var i = this.options, u = this.active, a = e(t.currentTarget).closest("li"), o = a[0] === u[0], r = o && i.collapsible, h = r ? e() : this._getPanelForTab(a), l = u.length ? this._getPanelForTab(u) : e(), u = {
                oldTab: u,
                oldPanel: l,
                newTab: r ? e() : a,
                newPanel: h
            };
            t.preventDefault(), a.hasClass("ui-state-disabled") || a.hasClass("ui-tabs-loading") || this.running || o && !i.collapsible || !1 === this._trigger("beforeActivate", t, u) || (i.active = !r && this.tabs.index(a), 
            this.active = o ? e() : a, this.xhr && this.xhr.abort(), l.length || h.length || e.error("jQuery UI Tabs: Mismatching fragment identifier."), 
            h.length && this.load(this.tabs.index(a), t), this._toggle(t, u));
        },
        _toggle: function(t, i) {
            function s() {
                a.running = !1, a._trigger("activate", t, i);
            }
            function n() {
                i.newTab.closest("li").addClass("ui-tabs-active ui-state-active"), o.length && a.options.show ? a._show(o, a.options.show, s) : (o.show(), 
                s());
            }
            var a = this, o = i.newPanel, r = i.oldPanel;
            this.running = !0, r.length && this.options.hide ? this._hide(r, this.options.hide, function() {
                i.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"), n();
            }) : (i.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"), r.hide(), 
            n()), r.attr("aria-hidden", "true"), i.oldTab.attr({
                "aria-selected": "false",
                "aria-expanded": "false"
            }), o.length && r.length ? i.oldTab.attr("tabIndex", -1) : o.length && this.tabs.filter(function() {
                return 0 === e(this).attr("tabIndex");
            }).attr("tabIndex", -1), o.attr("aria-hidden", "false"), i.newTab.attr({
                "aria-selected": "true",
                "aria-expanded": "true",
                tabIndex: 0
            });
        },
        _activate: function(i) {
            var i = this._findActive(i);
            i[0] !== this.active[0] && (i = (i = !i.length ? this.active : i).find(".ui-tabs-anchor")[0], 
            this._eventHandler({
                target: i,
                currentTarget: i,
                preventDefault: e.noop
            }));
        },
        _findActive: function(t) {
            return !1 === t ? e() : this.tabs.eq(t);
        },
        _getIndex: function(e) {
            return e = "string" == typeof e ? this.anchors.index(this.anchors.filter("[href$='" + e + "']")) : e;
        },
        _destroy: function() {
            this.xhr && this.xhr.abort(), this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible"), 
            this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role"), 
            this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeUniqueId(), 
            this.tablist.unbind(this.eventNamespace), this.tabs.add(this.panels).each(function() {
                e.data(this, "ui-tabs-destroy") ? e(this).remove() : e(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role");
            }), this.tabs.each(function() {
                var t = e(this), i = t.data("ui-tabs-aria-controls");
                i ? t.attr("aria-controls", i).removeData("ui-tabs-aria-controls") : t.removeAttr("aria-controls");
            }), this.panels.show(), "content" !== this.options.heightStyle && this.panels.css("height", "");
        },
        enable: function(t) {
            var i = this.options.disabled;
            !1 !== i && (i = void 0 !== t && (t = this._getIndex(t), e.isArray(i) ? e.map(i, function(e) {
                return e !== t ? e : null;
            }) : e.map(this.tabs, function(e, i) {
                return i !== t ? i : null;
            })), this._setupDisabled(i));
        },
        disable: function(t) {
            var i = this.options.disabled;
            if (!0 !== i) {
                if (void 0 === t) i = !0; else {
                    if (t = this._getIndex(t), -1 !== e.inArray(t, i)) return;
                    i = e.isArray(i) ? e.merge([ t ], i).sort() : [ t ];
                }
                this._setupDisabled(i);
            }
        },
        load: function(a, i) {
            a = this._getIndex(a);
            function h(e, t) {
                "abort" === t && s.panels.stop(!1, !0), n.removeClass("ui-tabs-loading"), o.removeAttr("aria-busy"), 
                e === s.xhr && delete s.xhr;
            }
            var s = this, n = this.tabs.eq(a), a = n.find(".ui-tabs-anchor"), o = this._getPanelForTab(n), r = {
                tab: n,
                panel: o
            };
            this._isLocal(a[0]) || (this.xhr = e.ajax(this._ajaxSettings(a, i, r)), this.xhr && "canceled" !== this.xhr.statusText && (n.addClass("ui-tabs-loading"), 
            o.attr("aria-busy", "true"), this.xhr.done(function(e, t, n) {
                setTimeout(function() {
                    o.html(e), s._trigger("load", i, r), h(n, t);
                }, 1);
            }).fail(function(e, t) {
                setTimeout(function() {
                    h(e, t);
                }, 1);
            })));
        },
        _ajaxSettings: function(t, i, s) {
            var n = this;
            return {
                url: t.attr("href"),
                beforeSend: function(t, a) {
                    return n._trigger("beforeLoad", i, e.extend({
                        jqXHR: t,
                        ajaxSettings: a
                    }, s));
                }
            };
        },
        _getPanelForTab: function(i) {
            i = e(i).attr("aria-controls");
            return this.element.find(this._sanitizeSelector("#" + i));
        }
    });
}), function(t, e) {
    "object" == typeof exports && "object" == typeof module ? module.exports = e() : "function" == typeof define && define.amd ? define("Noty", [], e) : "object" == typeof exports ? exports.Noty = e() : t.Noty = e();
}(this, function() {
    return t = [ function(t, e, n) {
        "use strict";
        function u(t, e, n) {
            var o = 3 < arguments.length && void 0 !== arguments[3] && arguments[3];
            e = e.split(" ");
            for (var i = 0; i < e.length; i++) document.addEventListener ? t.addEventListener(e[i], n, o) : document.attachEvent && t.attachEvent("on" + e[i], n);
        }
        function a(t, e) {
            return 0 <= ("string" == typeof t ? t : f(t)).indexOf(" " + e + " ");
        }
        function d(t) {
            t.parentNode && t.parentNode.removeChild(t);
        }
        function f(t) {
            return (" " + (t && t.className || "") + " ").replace(/\s+/gi, " ");
        }
        Object.defineProperty(e, "__esModule", {
            value: !0
        }), e.css = e.deepExtend = e.animationEndEvents = void 0;
        var v = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function(t) {
            return typeof t;
        } : function(t) {
            return t && "function" == typeof Symbol && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : typeof t;
        };
        e.inArray = function(t, e, n) {
            var o = void 0;
            if (n) {
                for (o in e) if (e.hasOwnProperty(o) && e[o] === t) return !0;
            } else for (o in e) if (e.hasOwnProperty(o) && e[o] === t) return !0;
            return !1;
        }, e.stopPropagation = function(t) {
            void 0 !== (t = t || window.event).stopPropagation ? t.stopPropagation() : t.cancelBubble = !0;
        }, e.generateID = function() {
            return "noty_" + (0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : "") + "_" + "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g, function(t) {
                var e = 16 * Math.random() | 0;
                return ("x" === t ? e : 3 & e | 8).toString(16);
            });
        }, e.outerHeight = function(n) {
            var e = n.offsetHeight, n = window.getComputedStyle(n);
            return e + (parseInt(n.marginTop) + parseInt(n.marginBottom));
        }, e.addListener = u, e.hasClass = a, e.addClass = function(t, e) {
            var n = f(t), o = n + e;
            a(n, e) || (t.className = o.substring(1));
        }, e.removeClass = function(t, e) {
            var n = f(t), o = void 0;
            a(t, e) && (o = n.replace(" " + e + " ", " "), t.className = o.substring(1, o.length - 1));
        }, e.remove = d, e.classList = f, e.visibilityChangeFlow = function() {
            function o() {
                b.PageHidden ? setTimeout(function() {
                    Object.keys(b.Store).forEach(function(t) {
                        b.Store.hasOwnProperty(t) && b.Store[t].options.visibilityControl && b.Store[t].stop();
                    });
                }, 100) : setTimeout(function() {
                    Object.keys(b.Store).forEach(function(t) {
                        b.Store.hasOwnProperty(t) && b.Store[t].options.visibilityControl && b.Store[t].resume();
                    }), b.queueRenderAll();
                }, 100);
            }
            var s = void 0, a = void 0;
            void 0 !== document.hidden ? (s = "hidden", a = "visibilitychange") : void 0 !== document.msHidden ? (s = "msHidden", 
            a = "msvisibilitychange") : void 0 !== document.webkitHidden && (s = "webkitHidden", 
            a = "webkitvisibilitychange"), a && u(document, a, function() {
                b.PageHidden = document[s], o();
            }), u(window, "blur", function() {
                b.PageHidden = !0, o();
            }), u(window, "focus", function() {
                b.PageHidden = !1, o();
            });
        }, e.createAudioElements = function(t) {
            var e;
            t.hasSound && (e = document.createElement("audio"), t.options.sounds.sources.forEach(function(t) {
                var n = document.createElement("source");
                n.src = t, n.type = "audio/" + t.match(/\.([^.]+)$/)[1], e.appendChild(n);
            }), (t.barDom || document.querySelector("body")).appendChild(e), e.volume = t.options.sounds.volume, 
            t.soundPlayed || (e.play(), t.soundPlayed = !0), e.onended = function() {
                d(e);
            });
        };
        var b = function(t) {
            if (t && t.__esModule) return t;
            var e = {};
            if (null != t) for (var n in t) Object.prototype.hasOwnProperty.call(t, n) && (e[n] = t[n]);
            return e.default = t, e;
        }(n(1));
        e.animationEndEvents = "webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend", 
        e.deepExtend = function t(e) {
            e = e || {};
            for (var n = 1; n < arguments.length; n++) {
                var o = arguments[n];
                if (o) for (var i in o) o.hasOwnProperty(i) && (!Array.isArray(o[i]) && "object" === v(o[i]) && null !== o[i] ? e[i] = t(e[i], o[i]) : e[i] = o[i]);
            }
            return e;
        }, e.css = function() {
            function n(n) {
                return n = function(t) {
                    return t.replace(/^-ms-/, "ms-").replace(/-([\da-z])/gi, function(t, e) {
                        return e.toUpperCase();
                    });
                }(n), r[n] || (r[n] = function(t) {
                    var e = document.body.style;
                    if (t in e) return t;
                    for (var r, n = i.length, o = t.charAt(0).toUpperCase() + t.slice(1); n--; ) if ((r = i[n] + o) in e) return r;
                    return t;
                }(n));
            }
            function o(t, e, o) {
                e = n(e), t.style[e] = o;
            }
            var i = [ "Webkit", "O", "Moz", "ms" ], r = {};
            return function(t, e) {
                var n = arguments, i = void 0, r = void 0;
                if (2 === n.length) for (i in e) e.hasOwnProperty(i) && void 0 !== (r = e[i]) && e.hasOwnProperty(i) && o(t, i, r); else o(t, n[1], n[2]);
            };
        }();
    }, function(t, e, n) {
        "use strict";
        function s() {
            var e = 0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : "global";
            !E.hasOwnProperty(e) || (e = E[e].queue.shift()) && e.show();
        }
        function l(t) {
            return !(!t.options.buttons || !Object.keys(t.options.buttons).length);
        }
        function v(t) {
            t.options.timeout && (t.options.progressBar && t.progressDom && k.css(t.progressDom, {
                transition: "width " + t.options.timeout + "ms linear",
                width: "0%"
            }), clearTimeout(t.closeTimer), t.closeTimer = setTimeout(function() {
                t.close();
            }, t.options.timeout));
        }
        function y(t) {
            t.options.timeout && t.closeTimer && (clearTimeout(t.closeTimer), t.closeTimer = -1, 
            t.options.progressBar && t.progressDom && k.css(t.progressDom, {
                transition: "width 0ms linear",
                width: "100%"
            }));
        }
        function b(t, e) {
            t.listeners.hasOwnProperty(e) && t.listeners[e].forEach(function(e) {
                "function" == typeof e && e.apply(t);
            });
        }
        Object.defineProperty(e, "__esModule", {
            value: !0
        }), e.Defaults = e.Store = e.Queues = e.DefaultMaxVisible = e.docTitle = e.DocModalCount = e.PageHidden = void 0, 
        e.getQueueCounts = function() {
            var t = 0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : "global", e = 0, n = x;
            return E.hasOwnProperty(t) && (n = E[t].maxVisible, Object.keys(P).forEach(function(n) {
                P[n].options.queue !== t || P[n].closed || e++;
            })), {
                current: e,
                maxVisible: n
            };
        }, e.addToQueue = function(t) {
            E.hasOwnProperty(t.options.queue) || (E[t.options.queue] = {
                maxVisible: x,
                queue: []
            }), E[t.options.queue].queue.push(t);
        }, e.removeFromQueue = function(t) {
            var e;
            E.hasOwnProperty(t.options.queue) && (e = [], Object.keys(E[t.options.queue].queue).forEach(function(n) {
                E[t.options.queue].queue[n].id !== t.id && e.push(E[t.options.queue].queue[n]);
            }), E[t.options.queue].queue = e);
        }, e.queueRender = s, e.queueRenderAll = function() {
            Object.keys(E).forEach(function(t) {
                s(t);
            });
        }, e.ghostFix = function(t) {
            var e = k.generateID("ghost"), n = document.createElement("div");
            n.setAttribute("id", e), k.css(n, {
                height: k.outerHeight(t.barDom) + "px"
            }), t.barDom.insertAdjacentHTML("afterend", n.outerHTML), k.remove(t.barDom), n = document.getElementById(e), 
            k.addClass(n, "noty_fix_effects_height"), k.addListener(n, k.animationEndEvents, function() {
                k.remove(n);
            });
        }, e.build = function(t) {
            !function(t) {
                var e;
                t.options.container ? t.layoutDom = document.querySelector(t.options.container) : (e = "noty_layout__" + t.options.layout, 
                t.layoutDom = document.querySelector("div#" + e), t.layoutDom || (t.layoutDom = document.createElement("div"), 
                t.layoutDom.setAttribute("id", e), t.layoutDom.setAttribute("role", "alert"), t.layoutDom.setAttribute("aria-live", "polite"), 
                k.addClass(t.layoutDom, "noty_layout"), document.querySelector("body").appendChild(t.layoutDom)));
            }(t);
            var e = '<div class="noty_body">' + t.options.text + "</div>" + function(t) {
                if (l(t)) {
                    var e = document.createElement("div");
                    return k.addClass(e, "noty_buttons"), Object.keys(t.options.buttons).forEach(function(n) {
                        e.appendChild(t.options.buttons[n].dom);
                    }), t.options.buttons.forEach(function(t) {
                        e.appendChild(t.dom);
                    }), e.outerHTML;
                }
                return "";
            }(t) + '<div class="noty_progressbar"></div>';
            t.barDom = document.createElement("div"), t.barDom.setAttribute("id", t.id), k.addClass(t.barDom, "noty_bar noty_type__" + t.options.type + " noty_theme__" + t.options.theme), 
            t.barDom.innerHTML = e, b(t, "onTemplate");
        }, e.hasButtons = l, e.handleModal = function(t) {
            t.options.modal && (0 === C && function() {
                var t = document.querySelector("body"), e = document.createElement("div");
                k.addClass(e, "noty_modal"), t.insertBefore(e, t.firstChild), k.addClass(e, "noty_modal_open"), 
                k.addListener(e, k.animationEndEvents, function() {
                    k.removeClass(e, "noty_modal_open");
                });
            }(), e.DocModalCount = C += 1);
        }, e.handleModalClose = function(t) {
            var n;
            t.options.modal && 0 < C && (e.DocModalCount = --C, C <= 0) && ((n = document.querySelector(".noty_modal")) && (k.removeClass(n, "noty_modal_open"), 
            k.addClass(n, "noty_modal_close"), k.addListener(n, k.animationEndEvents, function() {
                k.remove(n);
            })));
        }, e.queueClose = v, e.dequeueClose = y, e.fire = b, e.openFlow = function(t) {
            b(t, "afterShow"), v(t), k.addListener(t.barDom, "mouseenter", function() {
                y(t);
            }), k.addListener(t.barDom, "mouseleave", function() {
                v(t);
            });
        }, e.closeFlow = function(t) {
            delete P[t.id], t.closing = !1, b(t, "afterClose"), k.remove(t.barDom), 0 !== t.layoutDom.querySelectorAll(".noty_bar").length || t.options.container || k.remove(t.layoutDom), 
            (k.inArray("docVisible", t.options.titleCount.conditions) || k.inArray("docHidden", t.options.titleCount.conditions)) && D.decrement(), 
            s(t.options.queue);
        };
        var k = function(t) {
            if (t && t.__esModule) return t;
            var e = {};
            if (null != t) for (var n in t) Object.prototype.hasOwnProperty.call(t, n) && (e[n] = t[n]);
            return e.default = t, e;
        }(n(0)), C = (e.PageHidden = !1, e.DocModalCount = 0), S = {
            originalTitle: null,
            count: 0,
            changed: !1,
            timer: -1
        }, D = e.docTitle = {
            increment: function() {
                S.count++, D._update();
            },
            decrement: function() {
                --S.count <= 0 ? D._clear() : D._update();
            },
            _update: function() {
                var t = document.title;
                S.changed ? document.title = "(" + S.count + ") " + S.originalTitle : (S.originalTitle = t, 
                document.title = "(" + S.count + ") " + t, S.changed = !0);
            },
            _clear: function() {
                S.changed && (S.count = 0, document.title = S.originalTitle, S.changed = !1);
            }
        }, x = e.DefaultMaxVisible = 5, E = e.Queues = {
            global: {
                maxVisible: x,
                queue: []
            }
        }, P = e.Store = {};
        e.Defaults = {
            type: "alert",
            layout: "topRight",
            theme: "mint",
            text: "",
            timeout: !1,
            progressBar: !0,
            closeWith: [ "click" ],
            animation: {
                open: "noty_effects_open",
                close: "noty_effects_close"
            },
            id: !1,
            force: !1,
            killer: !1,
            queue: "global",
            container: !1,
            buttons: [],
            callbacks: {
                beforeShow: null,
                onShow: null,
                afterShow: null,
                onClose: null,
                afterClose: null,
                onClick: null,
                onHover: null,
                onTemplate: null
            },
            sounds: {
                sources: [],
                volume: 1,
                conditions: []
            },
            titleCount: {
                conditions: []
            },
            modal: !1,
            visibilityControl: !1
        };
    }, function(t, e, n) {
        "use strict";
        Object.defineProperty(e, "__esModule", {
            value: !0
        }), e.NotyButton = void 0;
        var r = function(t) {
            if (t && t.__esModule) return t;
            var e = {};
            if (null != t) for (var n in t) Object.prototype.hasOwnProperty.call(t, n) && (e[n] = t[n]);
            return e.default = t, e;
        }(n(0));
        e.NotyButton = function t(e, n, i) {
            var s = this, u = 3 < arguments.length && void 0 !== arguments[3] ? arguments[3] : {};
            return function(t, e) {
                if (!(t instanceof e)) throw new TypeError("Cannot call a class as a function");
            }(this, t), this.dom = document.createElement("button"), this.dom.innerHTML = e, 
            this.id = u.id = u.id || r.generateID("button"), this.cb = i, Object.keys(u).forEach(function(t) {
                s.dom.setAttribute(t, u[t]);
            }), r.addClass(this.dom, n || "noty_btn"), this;
        };
    }, function(t, e, n) {
        "use strict";
        Object.defineProperty(e, "__esModule", {
            value: !0
        });
        var i = function() {
            function t(t, e) {
                for (var n = 0; n < e.length; n++) {
                    var o = e[n];
                    o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), 
                    Object.defineProperty(t, o.key, o);
                }
            }
            return function(e, n, o) {
                return n && t(e.prototype, n), o && t(e, o), e;
            };
        }();
        e.Push = function() {
            function t() {
                var e = 0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : "/service-worker.js";
                return function(t, e) {
                    if (!(t instanceof e)) throw new TypeError("Cannot call a class as a function");
                }(this, t), this.subData = {}, this.workerPath = e, this.listeners = {
                    onPermissionGranted: [],
                    onPermissionDenied: [],
                    onSubscriptionSuccess: [],
                    onSubscriptionCancel: [],
                    onWorkerError: [],
                    onWorkerSuccess: [],
                    onWorkerNotSupported: []
                }, this;
            }
            return i(t, [ {
                key: "on",
                value: function(t) {
                    var e = 1 < arguments.length && void 0 !== arguments[1] ? arguments[1] : function() {};
                    return "function" == typeof e && this.listeners.hasOwnProperty(t) && this.listeners[t].push(e), 
                    this;
                }
            }, {
                key: "fire",
                value: function(t) {
                    var e = this, n = 1 < arguments.length && void 0 !== arguments[1] ? arguments[1] : [];
                    this.listeners.hasOwnProperty(t) && this.listeners[t].forEach(function(t) {
                        "function" == typeof t && t.apply(e, n);
                    });
                }
            }, {
                key: "create",
                value: function() {
                    console.log("NOT IMPLEMENTED YET");
                }
            }, {
                key: "isSupported",
                value: function() {
                    var t = !1;
                    try {
                        t = window.Notification || window.webkitNotifications || navigator.mozNotification || window.external && void 0 !== window.external.msIsSiteMode();
                    } catch (t) {}
                    return t;
                }
            }, {
                key: "getPermissionStatus",
                value: function() {
                    var t = "default";
                    if (window.Notification && window.Notification.permissionLevel) t = window.Notification.permissionLevel; else if (window.webkitNotifications && window.webkitNotifications.checkPermission) switch (window.webkitNotifications.checkPermission()) {
                      case 1:
                        t = "default";
                        break;

                      case 0:
                        t = "granted";
                        break;

                      default:
                        t = "denied";
                    } else window.Notification && window.Notification.permission ? t = window.Notification.permission : navigator.mozNotification ? t = "granted" : window.external && void 0 !== window.external.msIsSiteMode() && (t = window.external.msIsSiteMode() ? "granted" : "default");
                    return t.toString().toLowerCase();
                }
            }, {
                key: "getEndpoint",
                value: function(n) {
                    var e = n.endpoint, n = n.subscriptionId;
                    return n && -1 === e.indexOf(n) && (e += "/" + n), e;
                }
            }, {
                key: "isSWRegistered",
                value: function() {
                    try {
                        return "activated" === navigator.serviceWorker.controller.state;
                    } catch (t) {
                        return !1;
                    }
                }
            }, {
                key: "unregisterWorker",
                value: function() {
                    var t = this;
                    "serviceWorker" in navigator && navigator.serviceWorker.getRegistrations().then(function(e) {
                        var n = !0, o = !1, i = void 0;
                        try {
                            for (var r, s = e[Symbol.iterator](); !(n = (r = s.next()).done); n = !0) r.value.unregister(), 
                            t.fire("onSubscriptionCancel");
                        } catch (t) {
                            o = !0, i = t;
                        } finally {
                            try {
                                !n && s.return && s.return();
                            } finally {
                                if (o) throw i;
                            }
                        }
                    });
                }
            }, {
                key: "requestSubscription",
                value: function() {
                    function i(o) {
                        "granted" === o ? (t.fire("onPermissionGranted"), "serviceWorker" in navigator ? navigator.serviceWorker.register(t.workerPath).then(function() {
                            navigator.serviceWorker.ready.then(function(t) {
                                n.fire("onWorkerSuccess"), t.pushManager.subscribe({
                                    userVisibleOnly: e
                                }).then(function(t) {
                                    var e = t.getKey("p256dh"), o = t.getKey("auth");
                                    n.subData = {
                                        endpoint: n.getEndpoint(t),
                                        p256dh: e ? window.btoa(String.fromCharCode.apply(null, new Uint8Array(e))) : null,
                                        auth: o ? window.btoa(String.fromCharCode.apply(null, new Uint8Array(o))) : null
                                    }, n.fire("onSubscriptionSuccess", [ n.subData ]);
                                }).catch(function(t) {
                                    n.fire("onWorkerError", [ t ]);
                                });
                            });
                        }) : n.fire("onWorkerNotSupported")) : "denied" === o && (t.fire("onPermissionDenied"), 
                        t.unregisterWorker());
                    }
                    var t = this, e = !(0 < arguments.length && void 0 !== arguments[0]) || arguments[0], n = this, o = this.getPermissionStatus();
                    "default" === o ? window.Notification && window.Notification.requestPermission ? window.Notification.requestPermission(i) : window.webkitNotifications && window.webkitNotifications.checkPermission && window.webkitNotifications.requestPermission(i) : i(o);
                }
            } ]), t;
        }();
    }, function(t, e, n) {
        !function(e, o) {
            !function(n) {
                t.exports = n();
            }(function() {
                "use strict";
                function i(t) {
                    return "function" == typeof t;
                }
                function a() {
                    var t = setTimeout;
                    return function() {
                        return t(c, 1);
                    };
                }
                function c() {
                    for (var t = 0; t < I; t += 2) (0, X[t])(X[t + 1]), X[t] = void 0, X[t + 1] = void 0;
                    I = 0;
                }
                function l(t, e) {
                    var n = arguments, o = this, i = new this.constructor(f);
                    void 0 === i[tt] && A(i);
                    var r = o._state;
                    return r ? function() {
                        var t = n[r - 1];
                        U(function() {
                            return P(r, i, t, o._result);
                        });
                    }() : S(o, i, t, e), i;
                }
                function d(t) {
                    if (t && "object" == typeof t && t.constructor === this) return t;
                    var n = new this(f);
                    return g(n, t), n;
                }
                function f() {}
                function m(t) {
                    try {
                        return t.then;
                    } catch (t) {
                        return it.error = t, it;
                    }
                }
                function y(t, e, n) {
                    U(function(t) {
                        var o = !1, i = function(t, e, n, o) {
                            try {
                                t.call(e, n, o);
                            } catch (t) {
                                return t;
                            }
                        }(n, e, function(n) {
                            o || (o = !0, (e !== n ? g : k)(t, n));
                        }, function(e) {
                            o || (o = !0, C(t, e));
                        }, t._label);
                        !o && i && (o = !0, C(t, i));
                    }, t);
                }
                function w(t, e, n) {
                    e.constructor === t.constructor && n === l && e.constructor.resolve === d ? function(t, e) {
                        e._state === nt ? k(t, e._result) : e._state === ot ? C(t, e._result) : S(e, void 0, function(e) {
                            return g(t, e);
                        }, function(e) {
                            return C(t, e);
                        });
                    }(t, e) : n === it ? (C(t, it.error), it.error = null) : void 0 !== n && i(n) ? y(t, e, n) : k(t, e);
                }
                function g(e, n) {
                    e === n ? C(e, new TypeError("You cannot resolve a promise with itself")) : function(t) {
                        var e = typeof t;
                        return null !== t && ("object" == e || "function" == e);
                    }(n) ? w(e, n, m(n)) : k(e, n);
                }
                function _(t) {
                    t._onerror && t._onerror(t._result), D(t);
                }
                function k(t, e) {
                    t._state === et && (t._result = e, t._state = nt, 0 !== t._subscribers.length && U(D, t));
                }
                function C(t, e) {
                    t._state === et && (t._state = ot, t._result = e, U(_, t));
                }
                function S(t, e, n, o) {
                    var i = t._subscribers, r = i.length;
                    t._onerror = null, i[r] = e, i[r + nt] = n, i[r + ot] = o, 0 === r && t._state && U(D, t);
                }
                function D(t) {
                    var e = t._subscribers, n = t._state;
                    if (0 !== e.length) {
                        for (var o, i = void 0, r = t._result, s = 0; s < e.length; s += 3) o = e[s], i = e[s + n], 
                        o ? P(n, o, i, r) : i(r);
                        t._subscribers.length = 0;
                    }
                }
                function x() {
                    this.error = null;
                }
                function P(t, e, n, o) {
                    var r = i(n), s = void 0, u = void 0, a = void 0, c = void 0;
                    if (r) {
                        if ((s = function(t, e) {
                            try {
                                return t(e);
                            } catch (t) {
                                return rt.error = t, rt;
                            }
                        }(n, o)) === rt ? (c = !0, u = s.error, s.error = null) : a = !0, e === s) return void C(e, new TypeError("A promises callback cannot return that same promise."));
                    } else s = o, a = !0;
                    e._state !== et || (r && a ? g(e, s) : c ? C(e, u) : t === nt ? k(e, s) : t === ot && C(e, s));
                }
                function A(t) {
                    t[tt] = st++, t._state = void 0, t._result = void 0, t._subscribers = [];
                }
                function M(t, e) {
                    this._instanceConstructor = t, this.promise = new t(f), this.promise[tt] || A(this.promise), 
                    F(e) ? (this.length = e.length, this._remaining = e.length, this._result = new Array(this.length), 
                    0 === this.length ? k(this.promise, this._result) : (this.length = this.length || 0, 
                    this._enumerate(e), 0 === this._remaining && k(this.promise, this._result))) : C(this.promise, new Error("Array Methods must be provided an Array"));
                }
                function Q(t) {
                    this[tt] = st++, this._result = this._state = void 0, this._subscribers = [], f !== t && ("function" != typeof t && function() {
                        throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");
                    }(), this instanceof Q ? function(t, e) {
                        try {
                            e(function(e) {
                                g(t, e);
                            }, function(e) {
                                C(t, e);
                            });
                        } catch (e) {
                            C(t, e);
                        }
                    }(this, t) : function() {
                        throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");
                    }());
                }
                var F = Array.isArray || function(t) {
                    return "[object Array]" === Object.prototype.toString.call(t);
                }, I = 0, R = void 0, z = void 0, U = function(t, e) {
                    X[I] = t, X[I + 1] = e, 2 === (I += 2) && (z ? z(c) : Z());
                }, Y = "undefined" != typeof window ? window : void 0, J = Y || {}, G = J.MutationObserver || J.WebKitMutationObserver, $ = "undefined" == typeof self && void 0 !== e && "[object process]" === {}.toString.call(e), J = "undefined" != typeof Uint8ClampedArray && "undefined" != typeof importScripts && "undefined" != typeof MessageChannel, X = new Array(1e3), Z = void 0, Z = $ ? function() {
                    return e.nextTick(c);
                } : (G ? function() {
                    var t = 0, e = new G(c), n = document.createTextNode("");
                    return e.observe(n, {
                        characterData: !0
                    }), function() {
                        n.data = t = ++t % 2;
                    };
                } : J ? function() {
                    var t = new MessageChannel();
                    return t.port1.onmessage = c, function() {
                        return t.port2.postMessage(0);
                    };
                } : void 0 === Y ? function() {
                    try {
                        var t = n(9);
                        return void 0 !== (R = t.runOnLoop || t.runOnContext) ? function() {
                            R(c);
                        } : a();
                    } catch (t) {
                        return a();
                    }
                } : a)(), tt = Math.random().toString(36).substring(16), et = void 0, nt = 1, ot = 2, it = new x(), rt = new x(), st = 0;
                return M.prototype._enumerate = function(t) {
                    for (var e = 0; this._state === et && e < t.length; e++) this._eachEntry(t[e], e);
                }, M.prototype._eachEntry = function(t, e) {
                    var i, r, n = this._instanceConstructor, o = n.resolve;
                    o === d ? (i = m(t)) === l && t._state !== et ? this._settledAt(t._state, e, t._result) : "function" != typeof i ? (this._remaining--, 
                    this._result[e] = t) : n === Q ? (w(r = new n(f), t, i), this._willSettleAt(r, e)) : this._willSettleAt(new n(function(e) {
                        return e(t);
                    }), e) : this._willSettleAt(o(t), e);
                }, M.prototype._settledAt = function(t, e, n) {
                    var o = this.promise;
                    o._state === et && (this._remaining--, t === ot ? C(o, n) : this._result[e] = n), 
                    0 === this._remaining && k(o, this._result);
                }, M.prototype._willSettleAt = function(t, e) {
                    var n = this;
                    S(t, void 0, function(t) {
                        return n._settledAt(nt, e, t);
                    }, function(t) {
                        return n._settledAt(ot, e, t);
                    });
                }, Q.all = function(t) {
                    return new M(this, t).promise;
                }, Q.race = function(t) {
                    var e = this;
                    return new e(F(t) ? function(n, o) {
                        for (var i = t.length, r = 0; r < i; r++) e.resolve(t[r]).then(n, o);
                    } : function(t, e) {
                        return e(new TypeError("You must pass an array to race."));
                    });
                }, Q.resolve = d, Q.reject = function(t) {
                    var n = new this(f);
                    return C(n, t), n;
                }, Q._setScheduler = function(t) {
                    z = t;
                }, Q._setAsap = function(t) {
                    U = t;
                }, Q._asap = U, Q.prototype = {
                    constructor: Q,
                    then: l,
                    catch: function(t) {
                        return this.then(null, t);
                    }
                }, Q.polyfill = function() {
                    var t = void 0;
                    if (void 0 !== o) t = o; else if ("undefined" != typeof self) t = self; else try {
                        t = Function("return this")();
                    } catch (t) {
                        throw new Error("polyfill failed because global object is unavailable in this environment");
                    }
                    var e = t.Promise;
                    if (e) {
                        var n = null;
                        try {
                            n = Object.prototype.toString.call(e.resolve());
                        } catch (t) {}
                        if ("[object Promise]" === n && !e.cast) return;
                    }
                    t.Promise = Q;
                }, Q.Promise = Q;
            });
        }.call(e, n(7), n(8));
    }, function(t, e) {}, function(t, e, p) {
        "use strict";
        function o(t) {
            if (t && t.__esModule) return t;
            var e = {};
            if (null != t) for (var n in t) Object.prototype.hasOwnProperty.call(t, n) && (e[n] = t[n]);
            return e.default = t, e;
        }
        Object.defineProperty(e, "__esModule", {
            value: !0
        });
        var r = function() {
            function t(t, e) {
                for (var n = 0; n < e.length; n++) {
                    var o = e[n];
                    o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), 
                    Object.defineProperty(t, o.key, o);
                }
            }
            return function(e, n, o) {
                return n && t(e.prototype, n), o && t(e, o), e;
            };
        }();
        p(5);
        var s = p(4), u = s && s.__esModule ? s : {
            default: s
        }, c = o(p(0)), d = o(p(1)), f = p(2), h = p(3), p = function() {
            function t() {
                var e = 0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : {};
                return function(t, e) {
                    if (!(t instanceof e)) throw new TypeError("Cannot call a class as a function");
                }(this, t), this.options = c.deepExtend({}, d.Defaults, e), d.Store[this.options.id] || (this.id = this.options.id || c.generateID("bar"), 
                this.closeTimer = -1, this.barDom = null, this.layoutDom = null, this.progressDom = null, 
                this.showing = !1, this.shown = !1, this.closed = !1, this.closing = !1, this.killable = this.options.timeout || 0 < this.options.closeWith.length, 
                this.hasSound = 0 < this.options.sounds.sources.length, this.soundPlayed = !1, this.listeners = {
                    beforeShow: [],
                    onShow: [],
                    afterShow: [],
                    onClose: [],
                    afterClose: [],
                    onClick: [],
                    onHover: [],
                    onTemplate: []
                }, this.promises = {
                    show: null,
                    close: null
                }, this.on("beforeShow", this.options.callbacks.beforeShow), this.on("onShow", this.options.callbacks.onShow), 
                this.on("afterShow", this.options.callbacks.afterShow), this.on("onClose", this.options.callbacks.onClose), 
                this.on("afterClose", this.options.callbacks.afterClose), this.on("onClick", this.options.callbacks.onClick), 
                this.on("onHover", this.options.callbacks.onHover), this.on("onTemplate", this.options.callbacks.onTemplate), 
                this);
            }
            return r(t, [ {
                key: "on",
                value: function(t) {
                    var e = 1 < arguments.length && void 0 !== arguments[1] ? arguments[1] : function() {};
                    return "function" == typeof e && this.listeners.hasOwnProperty(t) && this.listeners[t].push(e), 
                    this;
                }
            }, {
                key: "show",
                value: function() {
                    var e = this;
                    if (this.showing || this.shown) return this;
                    !0 === this.options.killer ? t.closeAll() : "string" == typeof this.options.killer && t.closeAll(this.options.killer);
                    var o = d.getQueueCounts(this.options.queue);
                    return o.current >= o.maxVisible || d.PageHidden && this.options.visibilityControl ? (d.addToQueue(this), 
                    d.PageHidden && this.hasSound && c.inArray("docHidden", this.options.sounds.conditions) && c.createAudioElements(this), 
                    d.PageHidden && c.inArray("docHidden", this.options.titleCount.conditions) && d.docTitle.increment(), 
                    this) : (d.Store[this.id] = this, d.fire(this, "beforeShow"), this.showing = !0, 
                    this.closing ? this.showing = !1 : (d.build(this), d.handleModal(this), this.options.force ? this.layoutDom.insertBefore(this.barDom, this.layoutDom.firstChild) : this.layoutDom.appendChild(this.barDom), 
                    this.hasSound && !this.soundPlayed && c.inArray("docVisible", this.options.sounds.conditions) && c.createAudioElements(this), 
                    c.inArray("docVisible", this.options.titleCount.conditions) && d.docTitle.increment(), 
                    this.shown = !0, this.closed = !1, d.hasButtons(this) && Object.keys(this.options.buttons).forEach(function(t) {
                        var n = e.barDom.querySelector("#" + e.options.buttons[t].id);
                        c.addListener(n, "click", function(n) {
                            c.stopPropagation(n), e.options.buttons[t].cb(e);
                        });
                    }), this.progressDom = this.barDom.querySelector(".noty_progressbar"), c.inArray("click", this.options.closeWith) && (c.addClass(this.barDom, "noty_close_with_click"), 
                    c.addListener(this.barDom, "click", function(t) {
                        c.stopPropagation(t), d.fire(e, "onClick"), e.close();
                    }, !1)), c.addListener(this.barDom, "mouseenter", function() {
                        d.fire(e, "onHover");
                    }, !1), this.options.timeout && c.addClass(this.barDom, "noty_has_timeout"), this.options.progressBar && c.addClass(this.barDom, "noty_has_progressbar"), 
                    c.inArray("button", this.options.closeWith) && (c.addClass(this.barDom, "noty_close_with_button"), 
                    o = document.createElement("div"), c.addClass(o, "noty_close_button"), o.innerHTML = "×", 
                    this.barDom.appendChild(o), c.addListener(o, "click", function(t) {
                        c.stopPropagation(t), e.close();
                    }, !1)), d.fire(this, "onShow"), null === this.options.animation.open ? this.promises.show = new u.default(function(t) {
                        t();
                    }) : "function" == typeof this.options.animation.open ? this.promises.show = new u.default(this.options.animation.open.bind(this)) : (c.addClass(this.barDom, this.options.animation.open), 
                    this.promises.show = new u.default(function(t) {
                        c.addListener(e.barDom, c.animationEndEvents, function() {
                            c.removeClass(e.barDom, e.options.animation.open), t();
                        });
                    })), this.promises.show.then(function() {
                        var t = e;
                        setTimeout(function() {
                            d.openFlow(t);
                        }, 100);
                    })), this);
                }
            }, {
                key: "stop",
                value: function() {
                    return d.dequeueClose(this), this;
                }
            }, {
                key: "resume",
                value: function() {
                    return d.queueClose(this), this;
                }
            }, {
                key: "setTimeout",
                value: function(t) {
                    function e(e) {
                        return t.apply(this, arguments);
                    }
                    return e.toString = function() {
                        return t.toString();
                    }, e;
                }(function(t) {
                    var e;
                    return this.stop(), this.options.timeout = t, this.barDom && (this.options.timeout ? c.addClass(this.barDom, "noty_has_timeout") : c.removeClass(this.barDom, "noty_has_timeout"), 
                    e = this, setTimeout(function() {
                        e.resume();
                    }, 100)), this;
                })
            }, {
                key: "setText",
                value: function(t) {
                    var e = 1 < arguments.length && void 0 !== arguments[1] && arguments[1];
                    return this.barDom && (this.barDom.querySelector(".noty_body").innerHTML = t), e && (this.options.text = t), 
                    this;
                }
            }, {
                key: "setType",
                value: function(t) {
                    var e = this, n = 1 < arguments.length && void 0 !== arguments[1] && arguments[1];
                    return this.barDom && (c.classList(this.barDom).split(" ").forEach(function(t) {
                        "noty_type__" === t.substring(0, 11) && c.removeClass(e.barDom, t);
                    }), c.addClass(this.barDom, "noty_type__" + t)), n && (this.options.type = t), this;
                }
            }, {
                key: "setTheme",
                value: function(t) {
                    var e = this, n = 1 < arguments.length && void 0 !== arguments[1] && arguments[1];
                    return this.barDom && (c.classList(this.barDom).split(" ").forEach(function(t) {
                        "noty_theme__" === t.substring(0, 12) && c.removeClass(e.barDom, t);
                    }), c.addClass(this.barDom, "noty_theme__" + t)), n && (this.options.theme = t), 
                    this;
                }
            }, {
                key: "close",
                value: function() {
                    var t = this;
                    return this.closed || (this.shown ? (d.fire(this, "onClose"), this.closing = !0, 
                    null === this.options.animation.close || !1 === this.options.animation.close ? this.promises.close = new u.default(function(t) {
                        t();
                    }) : "function" == typeof this.options.animation.close ? this.promises.close = new u.default(this.options.animation.close.bind(this)) : (c.addClass(this.barDom, this.options.animation.close), 
                    this.promises.close = new u.default(function(e) {
                        c.addListener(t.barDom, c.animationEndEvents, function() {
                            t.options.force ? c.remove(t.barDom) : d.ghostFix(t), e();
                        });
                    })), this.promises.close.then(function() {
                        d.closeFlow(t), d.handleModalClose(t);
                    }), this.closed = !0) : d.removeFromQueue(this)), this;
                }
            } ], [ {
                key: "closeAll",
                value: function() {
                    var t = 0 < arguments.length && void 0 !== arguments[0] && arguments[0];
                    return Object.keys(d.Store).forEach(function(e) {
                        t ? d.Store[e].options.queue === t && d.Store[e].killable && d.Store[e].close() : d.Store[e].killable && d.Store[e].close();
                    }), this;
                }
            }, {
                key: "clearQueue",
                value: function() {
                    var t = 0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : "global";
                    return d.Queues.hasOwnProperty(t) && (d.Queues[t].queue = []), this;
                }
            }, {
                key: "overrideDefaults",
                value: function(t) {
                    return d.Defaults = c.deepExtend({}, d.Defaults, t), this;
                }
            }, {
                key: "setMaxVisible",
                value: function() {
                    var t = 0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : d.DefaultMaxVisible, e = 1 < arguments.length && void 0 !== arguments[1] ? arguments[1] : "global";
                    return d.Queues.hasOwnProperty(e) || (d.Queues[e] = {
                        maxVisible: t,
                        queue: []
                    }), d.Queues[e].maxVisible = t, this;
                }
            }, {
                key: "button",
                value: function(t) {
                    return new f.NotyButton(t, 1 < arguments.length && void 0 !== arguments[1] ? arguments[1] : null, arguments[2], 3 < arguments.length && void 0 !== arguments[3] ? arguments[3] : {});
                }
            }, {
                key: "version",
                value: function() {
                    return "3.2.0-beta";
                }
            }, {
                key: "Push",
                value: function(t) {
                    return new h.Push(t);
                }
            }, {
                key: "Queues",
                get: function() {
                    return d.Queues;
                }
            }, {
                key: "PageHidden",
                get: function() {
                    return d.PageHidden;
                }
            } ]), t;
        }();
        e.default = p, "undefined" != typeof window && c.visibilityChangeFlow(), t.exports = e.default;
    }, function(f, e) {
        function n() {
            throw new Error("setTimeout has not been defined");
        }
        function o() {
            throw new Error("clearTimeout has not been defined");
        }
        function i(t) {
            if (l === setTimeout) return setTimeout(t, 0);
            if ((l === n || !l) && setTimeout) return l = setTimeout, setTimeout(t, 0);
            try {
                return l(t, 0);
            } catch (e) {
                try {
                    return l.call(null, t, 0);
                } catch (e) {
                    return l.call(this, t, 0);
                }
            }
        }
        function s() {
            m && h && (m = !1, h.length ? p = h.concat(p) : v = -1, p.length && u());
        }
        function u() {
            if (!m) {
                var t = i(s);
                m = !0;
                for (var e = p.length; e; ) {
                    for (h = p, p = []; ++v < e; ) h && h[v].run();
                    v = -1, e = p.length;
                }
                h = null, m = !1, function(t) {
                    if (d === clearTimeout) return clearTimeout(t);
                    if ((d === o || !d) && clearTimeout) return d = clearTimeout, clearTimeout(t);
                    try {
                        d(t);
                    } catch (e) {
                        try {
                            return d.call(null, t);
                        } catch (e) {
                            return d.call(this, t);
                        }
                    }
                }(t);
            }
        }
        function a(t, e) {
            this.fun = t, this.array = e;
        }
        function c() {}
        var l, d, f = f.exports = {};
        !function() {
            try {
                l = "function" == typeof setTimeout ? setTimeout : n;
            } catch (t) {
                l = n;
            }
            try {
                d = "function" == typeof clearTimeout ? clearTimeout : o;
            } catch (t) {
                d = o;
            }
        }();
        var h, p = [], m = !1, v = -1;
        f.nextTick = function(t) {
            var e = new Array(arguments.length - 1);
            if (1 < arguments.length) for (var n = 1; n < arguments.length; n++) e[n - 1] = arguments[n];
            p.push(new a(t, e)), 1 !== p.length || m || i(u);
        }, a.prototype.run = function() {
            this.fun.apply(null, this.array);
        }, f.title = "browser", f.browser = !0, f.env = {}, f.argv = [], f.version = "", 
        f.versions = {}, f.on = c, f.addListener = c, f.once = c, f.off = c, f.removeListener = c, 
        f.removeAllListeners = c, f.emit = c, f.prependListener = c, f.prependOnceListener = c, 
        f.listeners = function(t) {
            return [];
        }, f.binding = function(t) {
            throw new Error("process.binding is not supported");
        }, f.cwd = function() {
            return "/";
        }, f.chdir = function(t) {
            throw new Error("process.chdir is not supported");
        }, f.umask = function() {
            return 0;
        };
    }, function(t, e) {
        var n = function() {
            return this;
        }();
        try {
            n = n || Function("return this")() || (0, eval)("this");
        } catch (t) {
            "object" == typeof window && (n = window);
        }
        t.exports = n;
    }, function(t, e) {} ], n = {}, e.m = t, e.c = n, e.i = function(t) {
        return t;
    }, e.d = function(t, n, o) {
        e.o(t, n) || Object.defineProperty(t, n, {
            configurable: !1,
            enumerable: !0,
            get: o
        });
    }, e.n = function(t) {
        var n = t && t.__esModule ? function() {
            return t.default;
        } : function() {
            return t;
        };
        return e.d(n, "a", n), n;
    }, e.o = function(t, e) {
        return Object.prototype.hasOwnProperty.call(t, e);
    }, e.p = "", e(e.s = 6);
    function e(o) {
        if (n[o]) return n[o].exports;
        var i = n[o] = {
            i: o,
            l: !1,
            exports: {}
        };
        return t[o].call(i.exports, i, i.exports, e), i.l = !0, i.exports;
    }
    var t, n;
}), function(a, b) {
    "use strict";
    "function" == typeof define && define.amd ? define([ "jquery" ], b) : "object" == typeof exports ? module.exports = b(require("jquery")) : a.bootbox = b(a.jQuery);
}(this, function a(b, c) {
    "use strict";
    function e(a, c, d) {
        a.stopPropagation(), a.preventDefault(), b.isFunction(d) && !1 === d(a) || c.modal("hide");
    }
    function g(a, c) {
        var d = 0;
        b.each(a, function(a, b) {
            c(a, b, d++);
        });
    }
    function h(a) {
        var c, d;
        if ("object" != typeof a) throw new Error("Please supply an object of options");
        if (!a.message) throw new Error("Please specify a message");
        return (a = b.extend({}, o, a)).buttons || (a.buttons = {}), a.backdrop = !!a.backdrop && "static", 
        c = a.buttons, d = function(a) {
            var b, c = 0;
            for (b in a) c++;
            return c;
        }(c), g(c, function(a, e, f) {
            if (b.isFunction(e) && (e = c[a] = {
                callback: e
            }), "object" !== b.type(e)) throw new Error("button with key " + a + " must be an object");
            e.label || (e.label = a), e.className || (e.className = d <= 2 && f === d - 1 ? "btn-primary" : "btn-default");
        }), a;
    }
    function j(a, c, d) {
        return b.extend(!0, {}, a, function(a, b) {
            var c = a.length, d = {};
            if (c < 1 || 2 < c) throw new Error("Invalid argument length");
            return 2 === c || "string" == typeof a[0] ? (d[b[0]] = a[0], d[b[1]] = a[1]) : d = a[0], 
            d;
        }(c, d));
    }
    function k(a, b, c, d) {
        return m(j({
            className: "bootbox-" + a,
            buttons: l.apply(null, b)
        }, d, c), b);
    }
    function l() {
        for (var a = {}, b = 0, c = arguments.length; b < c; b++) {
            var g = arguments[b], f = g.toLowerCase(), g = g.toUpperCase();
            a[f] = {
                label: function(a) {
                    var b = q[o.locale];
                    return (b || q.en)[a];
                }(g)
            };
        }
        return a;
    }
    function m(a, b) {
        var d = {};
        return g(b, function(a, b) {
            d[b] = !0;
        }), g(a.buttons, function(a) {
            if (d[a] === c) throw new Error("button key " + a + " is not allowed (options are " + b.join("\n") + ")");
        }), a;
    }
    var n = {
        dialog: "<div class='bootbox modal' tabindex='-1' role='dialog'><div class='modal-dialog'><div class='modal-content'><div class='modal-body'><div class='bootbox-body'></div></div></div></div></div>",
        header: "<div class='modal-header'><h4 class='modal-title'></h4></div>",
        footer: "<div class='modal-footer'></div>",
        closeButton: "<button type='button' class='bootbox-close-button close' data-dismiss='modal' aria-hidden='true'>&times;</button>",
        form: "<form class='bootbox-form'></form>",
        inputs: {
            text: "<input class='bootbox-input bootbox-input-text form-control' autocomplete=off type=text />",
            textarea: "<textarea class='bootbox-input bootbox-input-textarea form-control'></textarea>",
            email: "<input class='bootbox-input bootbox-input-email form-control' autocomplete='off' type='email' />",
            select: "<select class='bootbox-input bootbox-input-select form-control'></select>",
            checkbox: "<div class='checkbox'><label><input class='bootbox-input bootbox-input-checkbox' type='checkbox' /></label></div>",
            date: "<input class='bootbox-input bootbox-input-date form-control' autocomplete=off type='date' />",
            time: "<input class='bootbox-input bootbox-input-time form-control' autocomplete=off type='time' />",
            number: "<input class='bootbox-input bootbox-input-number form-control' autocomplete=off type='number' />",
            password: "<input class='bootbox-input bootbox-input-password form-control' autocomplete='off' type='password' />"
        }
    }, o = {
        locale: "en",
        backdrop: !0,
        animate: !0,
        className: null,
        closeButton: !0,
        show: !0,
        container: "body"
    }, p = {
        alert: function() {
            var a = k("alert", [ "ok" ], [ "message", "callback" ], arguments);
            if (a.callback && !b.isFunction(a.callback)) throw new Error("alert requires callback property to be a function when provided");
            return a.buttons.ok.callback = a.onEscape = function() {
                return !b.isFunction(a.callback) || a.callback();
            }, p.dialog(a);
        },
        confirm: function() {
            var a = k("confirm", [ "cancel", "confirm" ], [ "message", "callback" ], arguments);
            if (a.buttons.cancel.callback = a.onEscape = function() {
                return a.callback(!1);
            }, a.buttons.confirm.callback = function() {
                return a.callback(!0);
            }, !b.isFunction(a.callback)) throw new Error("confirm requires a callback");
            return p.dialog(a);
        },
        prompt: function() {
            var e, h, f = b(n.form), a = m(j({
                className: "bootbox-prompt",
                buttons: l("cancel", "confirm"),
                value: "",
                inputType: "text"
            }, arguments, [ "title", "callback" ]), [ "cancel", "confirm" ]), i = a.show === c || a.show, q = document.createElement("input");
            if (q.setAttribute("type", a.inputType), [ "date", "time", "number" ][a.inputType] && (a.inputType = q.type), 
            a.message = f, a.buttons.cancel.callback = a.onEscape = function() {
                return a.callback(null);
            }, a.buttons.confirm.callback = function() {
                switch (a.inputType) {
                  case "text":
                  case "textarea":
                  case "email":
                  case "select":
                  case "date":
                  case "time":
                  case "number":
                  case "password":
                    c = h.val();
                    break;

                  case "checkbox":
                    var d = h.find("input:checked"), c = [];
                    g(d, function(a, d) {
                        c.push(b(d).val());
                    });
                }
                return a.callback(c);
            }, a.show = !1, !a.title) throw new Error("prompt requires a title");
            if (!b.isFunction(a.callback)) throw new Error("prompt requires a callback");
            if (!n.inputs[a.inputType]) throw new Error("invalid prompt type");
            switch (h = b(n.inputs[a.inputType]), a.inputType) {
              case "text":
              case "textarea":
              case "email":
              case "date":
              case "time":
              case "number":
              case "password":
                h.val(a.value);
                break;

              case "select":
                var k, r = {};
                if (!(k = a.inputOptions || []).length) throw new Error("prompt with select requires options");
                g(k, function(a, d) {
                    var e = h;
                    if (d.value === c || d.text === c) throw new Error("given options in wrong format");
                    d.group && (r[d.group] || (r[d.group] = b("<optgroup/>").attr("label", d.group)), 
                    e = r[d.group]), e.append("<option value='" + d.value + "'>" + d.text + "</option>");
                }), g(r, function(a, b) {
                    h.append(b);
                }), h.val(a.value);
                break;

              case "checkbox":
                var s = b.isArray(a.value) ? a.value : [ a.value ];
                if (!(k = a.inputOptions || []).length) throw new Error("prompt with checkbox requires options");
                if (!k[0].value || !k[0].text) throw new Error("given options in wrong format");
                h = b("<div/>"), g(k, function(c, d) {
                    var e = b(n.inputs[a.inputType]);
                    e.find("input").attr("value", d.value), e.find("label").append(d.text), g(s, function(a, b) {
                        b === d.value && e.find("input").prop("checked", !0);
                    }), h.append(e);
                });
            }
            return a.placeholder && h.attr("placeholder", a.placeholder), a.pattern && h.attr("pattern", a.pattern), 
            f.append(h), f.on("submit", function(a) {
                a.preventDefault(), e.find(".btn-primary").click();
            }), (e = p.dialog(a)).off("shown.bs.modal"), e.on("shown.bs.modal", function() {
                h.focus();
            }), !0 === i && e.modal("show"), e;
        },
        dialog: function(a) {
            a = h(a);
            var c = b(n.dialog), d = c.find(".modal-body"), k = a.buttons, i = "", j = {
                onEscape: a.onEscape
            };
            return g(k, function(a, b) {
                i += "<button data-bb-handler='" + a + "' type='button' class='btn " + b.className + "'>" + b.label + "</button>", 
                j[a] = b.callback;
            }), d.find(".bootbox-body").html(a.message), !0 === a.animate && c.addClass("fade"), 
            a.className && c.addClass(a.className), a.title && d.before(n.header), a.closeButton && (k = b(n.closeButton), 
            a.title ? c.find(".modal-header").prepend(k) : k.css("margin-top", "-10px").prependTo(d)), 
            a.title && c.find(".modal-title").html(a.title), i.length && (d.after(n.footer), 
            c.find(".modal-footer").html(i)), c.on("hidden.bs.modal", function(a) {
                a.target === this && c.remove();
            }), c.on("shown.bs.modal", function() {
                c.find(".btn-primary:first").focus();
            }), c.on("escape.close.bb", function(a) {
                j.onEscape && e(a, c, j.onEscape);
            }), c.on("click", ".modal-footer button", function(a) {
                var d = b(this).data("bb-handler");
                e(a, c, j[d]);
            }), c.on("click", ".bootbox-close-button", function(a) {
                e(a, c, j.onEscape);
            }), c.on("keyup", function(a) {
                27 === a.which && c.trigger("escape.close.bb");
            }), b(a.container).append(c), c.modal({
                backdrop: a.backdrop,
                keyboard: !1,
                show: !1
            }), a.show && c.modal("show"), c;
        },
        setDefaults: function() {
            var a = {};
            2 === arguments.length ? a[arguments[0]] = arguments[1] : a = arguments[0], b.extend(o, a);
        },
        hideAll: function() {
            b(".bootbox").modal("hide");
        }
    }, q = {
        br: {
            OK: "OK",
            CANCEL: "Cancelar",
            CONFIRM: "Sim"
        },
        da: {
            OK: "OK",
            CANCEL: "Annuller",
            CONFIRM: "Accepter"
        },
        de: {
            OK: "OK",
            CANCEL: "Abbrechen",
            CONFIRM: "Akzeptieren"
        },
        en: {
            OK: "OK",
            CANCEL: "Cancel",
            CONFIRM: "OK"
        },
        es: {
            OK: "OK",
            CANCEL: "Cancelar",
            CONFIRM: "Aceptar"
        },
        fi: {
            OK: "OK",
            CANCEL: "Peruuta",
            CONFIRM: "OK"
        },
        fr: {
            OK: "OK",
            CANCEL: "Annuler",
            CONFIRM: "D'accord"
        },
        he: {
            OK: "אישור",
            CANCEL: "ביטול",
            CONFIRM: "אישור"
        },
        it: {
            OK: "OK",
            CANCEL: "Annulla",
            CONFIRM: "Conferma"
        },
        lt: {
            OK: "Gerai",
            CANCEL: "Atšaukti",
            CONFIRM: "Patvirtinti"
        },
        lv: {
            OK: "Labi",
            CANCEL: "Atcelt",
            CONFIRM: "Apstiprināt"
        },
        nl: {
            OK: "OK",
            CANCEL: "Annuleren",
            CONFIRM: "Accepteren"
        },
        no: {
            OK: "OK",
            CANCEL: "Avbryt",
            CONFIRM: "OK"
        },
        pl: {
            OK: "OK",
            CANCEL: "Anuluj",
            CONFIRM: "Potwierdź"
        },
        ru: {
            OK: "OK",
            CANCEL: "Отмена",
            CONFIRM: "Применить"
        },
        sv: {
            OK: "OK",
            CANCEL: "Avbryt",
            CONFIRM: "OK"
        },
        tr: {
            OK: "Tamam",
            CANCEL: "İptal",
            CONFIRM: "Onayla"
        },
        zh_CN: {
            OK: "OK",
            CANCEL: "取消",
            CONFIRM: "确认"
        },
        zh_TW: {
            OK: "OK",
            CANCEL: "取消",
            CONFIRM: "確認"
        }
    };
    return p.init = function(c) {
        return a(c || b);
    }, p;
}), "undefined" == typeof jQuery) throw new Error("Bootstrap's JavaScript requires jQuery");

!function(a) {
    "use strict";
    a.fn.emulateTransitionEnd = function(b) {
        var c = !1, d = this;
        a(this).one(a.support.transition.end, function() {
            c = !0;
        });
        return setTimeout(function() {
            c || a(d).trigger(a.support.transition.end);
        }, b), this;
    }, a(function() {
        a.support.transition = function() {
            var c, a = document.createElement("bootstrap"), b = {
                WebkitTransition: "webkitTransitionEnd",
                MozTransition: "transitionend",
                OTransition: "oTransitionEnd otransitionend",
                transition: "transitionend"
            };
            for (c in b) if (void 0 !== a.style[c]) return {
                end: b[c]
            };
            return !1;
        }();
    });
}(jQuery), function(a) {
    "use strict";
    function c(c) {
        a(c).on("click", b, this.close);
    }
    var b = '[data-dismiss="alert"]';
    c.prototype.close = function(b) {
        function c() {
            f.trigger("closed.bs.alert").remove();
        }
        var d = a(this), e = d.attr("data-target");
        e || (e = (e = d.attr("href")) && e.replace(/.*(?=#[^\s]*$)/, ""));
        var f = a(e);
        b && b.preventDefault(), (f = !f.length ? d.hasClass("alert") ? d : d.parent() : f).trigger(b = a.Event("close.bs.alert")), 
        b.isDefaultPrevented() || (f.removeClass("in"), a.support.transition && f.hasClass("fade") ? f.one(a.support.transition.end, c).emulateTransitionEnd(150) : c());
    };
    var d = a.fn.alert;
    a.fn.alert = function(b) {
        return this.each(function() {
            var d = a(this), e = d.data("bs.alert");
            e || d.data("bs.alert", e = new c(this)), "string" == typeof b && e[b].call(d);
        });
    }, a.fn.alert.Constructor = c, a.fn.alert.noConflict = function() {
        return a.fn.alert = d, this;
    }, a(document).on("click.bs.alert.data-api", b, c.prototype.close);
}(jQuery), function(a) {
    "use strict";
    var b = function(c, d) {
        this.$element = a(c), this.options = a.extend({}, b.DEFAULTS, d), this.isLoading = !1;
    };
    b.DEFAULTS = {
        loadingText: "loading..."
    }, b.prototype.setState = function(b) {
        var c = "disabled", d = this.$element, e = d.is("input") ? "val" : "html", f = d.data();
        b += "Text", f.resetText || d.data("resetText", d[e]()), d[e](f[b] || this.options[b]), 
        setTimeout(a.proxy(function() {
            "loadingText" == b ? (this.isLoading = !0, d.addClass(c).attr(c, c)) : this.isLoading && (this.isLoading = !1, 
            d.removeClass(c).removeAttr(c));
        }, this), 0);
    }, b.prototype.toggle = function() {
        var c, a = !0, b = this.$element.closest('[data-toggle="buttons"]');
        b.length && ("radio" == (c = this.$element.find("input")).prop("type") && (c.prop("checked") && this.$element.hasClass("active") ? a = !1 : b.find(".active").removeClass("active")), 
        a && c.prop("checked", !this.$element.hasClass("active")).trigger("change")), a && this.$element.toggleClass("active");
    };
    var c = a.fn.button;
    a.fn.button = function(c) {
        return this.each(function() {
            var d = a(this), e = d.data("bs.button");
            e || d.data("bs.button", e = new b(this, "object" == typeof c && c)), "toggle" == c ? e.toggle() : c && e.setState(c);
        });
    }, a.fn.button.Constructor = b, a.fn.button.noConflict = function() {
        return a.fn.button = c, this;
    }, a(document).on("click.bs.button.data-api", "[data-toggle^=button]", function(b) {
        var c = a(b.target);
        (c = !c.hasClass("btn") ? c.closest(".btn") : c).button("toggle"), b.preventDefault();
    });
}(jQuery), function(a) {
    "use strict";
    function b(b, c) {
        this.$element = a(b), this.$indicators = this.$element.find(".carousel-indicators"), 
        this.options = c, this.paused = this.sliding = this.interval = this.$active = this.$items = null, 
        "hover" == this.options.pause && this.$element.on("mouseenter", a.proxy(this.pause, this)).on("mouseleave", a.proxy(this.cycle, this));
    }
    b.DEFAULTS = {
        interval: 5e3,
        pause: "hover",
        wrap: !0
    }, b.prototype.cycle = function(b) {
        return b || (this.paused = !1), this.interval && clearInterval(this.interval), this.options.interval && !this.paused && (this.interval = setInterval(a.proxy(this.next, this), this.options.interval)), 
        this;
    }, b.prototype.getActiveIndex = function() {
        return this.$active = this.$element.find(".item.active"), this.$items = this.$active.parent().children(), 
        this.$items.index(this.$active);
    }, b.prototype.to = function(b) {
        var c = this, d = this.getActiveIndex();
        return b > this.$items.length - 1 || b < 0 ? void 0 : this.sliding ? this.$element.one("slid.bs.carousel", function() {
            c.to(b);
        }) : d == b ? this.pause().cycle() : this.slide(d < b ? "next" : "prev", a(this.$items[b]));
    }, b.prototype.pause = function(b) {
        return b || (this.paused = !0), this.$element.find(".next, .prev").length && a.support.transition && (this.$element.trigger(a.support.transition.end), 
        this.cycle(!0)), this.interval = clearInterval(this.interval), this;
    }, b.prototype.next = function() {
        return this.sliding ? void 0 : this.slide("next");
    }, b.prototype.prev = function() {
        return this.sliding ? void 0 : this.slide("prev");
    }, b.prototype.slide = function(b, j) {
        var d = this.$element.find(".item.active"), e = j || d[b](), f = this.interval, g = "next" == b ? "left" : "right", j = "next" == b ? "first" : "last", i = this;
        if (!e.length) {
            if (!this.options.wrap) return;
            e = this.$element.find(".item")[j]();
        }
        if (e.hasClass("active")) return this.sliding = !1;
        j = a.Event("slide.bs.carousel", {
            relatedTarget: e[0],
            direction: g
        });
        return this.$element.trigger(j), j.isDefaultPrevented() ? void 0 : (this.sliding = !0, 
        f && this.pause(), this.$indicators.length && (this.$indicators.find(".active").removeClass("active"), 
        this.$element.one("slid.bs.carousel", function() {
            var b = a(i.$indicators.children()[i.getActiveIndex()]);
            b && b.addClass("active");
        })), a.support.transition && this.$element.hasClass("slide") ? (e.addClass(b), e[0].offsetWidth, 
        d.addClass(g), e.addClass(g), d.one(a.support.transition.end, function() {
            e.removeClass([ b, g ].join(" ")).addClass("active"), d.removeClass([ "active", g ].join(" ")), 
            i.sliding = !1, setTimeout(function() {
                i.$element.trigger("slid.bs.carousel");
            }, 0);
        }).emulateTransitionEnd(1e3 * d.css("transition-duration").slice(0, -1))) : (d.removeClass("active"), 
        e.addClass("active"), this.sliding = !1, this.$element.trigger("slid.bs.carousel")), 
        f && this.cycle(), this);
    };
    var c = a.fn.carousel;
    a.fn.carousel = function(c) {
        return this.each(function() {
            var d = a(this), e = d.data("bs.carousel"), f = a.extend({}, b.DEFAULTS, d.data(), "object" == typeof c && c), g = "string" == typeof c ? c : f.slide;
            e || d.data("bs.carousel", e = new b(this, f)), "number" == typeof c ? e.to(c) : g ? e[g]() : f.interval && e.pause().cycle();
        });
    }, a.fn.carousel.Constructor = b, a.fn.carousel.noConflict = function() {
        return a.fn.carousel = c, this;
    }, a(document).on("click.bs.carousel.data-api", "[data-slide], [data-slide-to]", function(b) {
        var d = a(this), e = a(d.attr("data-target") || (g = d.attr("href")) && g.replace(/.*(?=#[^\s]+$)/, "")), f = a.extend({}, e.data(), d.data()), g = d.attr("data-slide-to");
        g && (f.interval = !1), e.carousel(f), (g = d.attr("data-slide-to")) && e.data("bs.carousel").to(g), 
        b.preventDefault();
    }), a(window).on("load", function() {
        a('[data-ride="carousel"]').each(function() {
            var b = a(this);
            b.carousel(b.data());
        });
    });
}(jQuery), function(a) {
    "use strict";
    var b = function(c, d) {
        this.$element = a(c), this.options = a.extend({}, b.DEFAULTS, d), this.transitioning = null, 
        this.options.parent && (this.$parent = a(this.options.parent)), this.options.toggle && this.toggle();
    };
    b.DEFAULTS = {
        toggle: !0
    }, b.prototype.dimension = function() {
        return this.$element.hasClass("width") ? "width" : "height";
    }, b.prototype.show = function() {
        if (!this.transitioning && !this.$element.hasClass("in")) {
            var g = a.Event("show.bs.collapse");
            if (this.$element.trigger(g), !g.isDefaultPrevented()) {
                g = this.$parent && this.$parent.find("> .panel > .in");
                if (g && g.length) {
                    var f = g.data("bs.collapse");
                    if (f && f.transitioning) return;
                    g.collapse("hide"), f || g.data("bs.collapse", null);
                }
                var e = this.dimension();
                this.$element.removeClass("collapse").addClass("collapsing")[e](0), this.transitioning = 1;
                f = function() {
                    this.$element.removeClass("collapsing").addClass("collapse in")[e]("auto"), this.transitioning = 0, 
                    this.$element.trigger("shown.bs.collapse");
                };
                if (!a.support.transition) return f.call(this);
                g = a.camelCase([ "scroll", e ].join("-"));
                this.$element.one(a.support.transition.end, a.proxy(f, this)).emulateTransitionEnd(350)[e](this.$element[0][g]);
            }
        }
    }, b.prototype.hide = function() {
        if (!this.transitioning && this.$element.hasClass("in")) {
            var d = a.Event("hide.bs.collapse");
            if (this.$element.trigger(d), !d.isDefaultPrevented()) {
                var c = this.dimension();
                this.$element[c](this.$element[c]())[0].offsetHeight, this.$element.addClass("collapsing").removeClass("collapse").removeClass("in"), 
                this.transitioning = 1;
                d = function() {
                    this.transitioning = 0, this.$element.trigger("hidden.bs.collapse").removeClass("collapsing").addClass("collapse");
                };
                return a.support.transition ? void this.$element[c](0).one(a.support.transition.end, a.proxy(d, this)).emulateTransitionEnd(350) : d.call(this);
            }
        }
    }, b.prototype.toggle = function() {
        this[this.$element.hasClass("in") ? "hide" : "show"]();
    };
    var c = a.fn.collapse;
    a.fn.collapse = function(c) {
        return this.each(function() {
            var d = a(this), e = d.data("bs.collapse"), f = a.extend({}, b.DEFAULTS, d.data(), "object" == typeof c && c);
            !e && f.toggle && "show" == c && (c = !c), e || d.data("bs.collapse", e = new b(this, f)), 
            "string" == typeof c && e[c]();
        });
    }, a.fn.collapse.Constructor = b, a.fn.collapse.noConflict = function() {
        return a.fn.collapse = c, this;
    }, a(document).on("click.bs.collapse.data-api", "[data-toggle=collapse]", function(h) {
        var d = a(this), j = d.attr("data-target") || h.preventDefault() || (i = d.attr("href")) && i.replace(/.*(?=#[^\s]+$)/, ""), f = a(j), g = f.data("bs.collapse"), h = g ? "toggle" : d.data(), i = d.attr("data-parent"), j = i && a(i);
        g && g.transitioning || (j && j.find('[data-toggle=collapse][data-parent="' + i + '"]').not(d).addClass("collapsed"), 
        d[f.hasClass("in") ? "addClass" : "removeClass"]("collapsed")), f.collapse(h);
    });
}(jQuery), function(a) {
    "use strict";
    function b(b) {
        a(".dropdown-backdrop").remove(), a(e).each(function() {
            var d = c(a(this)), e = {
                relatedTarget: this
            };
            d.hasClass("open") && (d.trigger(b = a.Event("hide.bs.dropdown", e)), b.isDefaultPrevented() || d.removeClass("open").trigger("hidden.bs.dropdown", e));
        });
    }
    function c(b) {
        var d = b.attr("data-target"), d = (d = !d ? (d = b.attr("href")) && /#[A-Za-z]/.test(d) && d.replace(/.*(?=#[^\s]*$)/, "") : d) && a(d);
        return d && d.length ? d : b.parent();
    }
    function f(b) {
        a(b).on("click.bs.dropdown", this.toggle);
    }
    var e = "[data-toggle=dropdown]";
    f.prototype.toggle = function(d) {
        var e = a(this);
        if (!e.is(".disabled, :disabled")) {
            var f = c(e), h = f.hasClass("open");
            if (b(), !h) {
                "ontouchstart" in document.documentElement && !f.closest(".navbar-nav").length && a('<div class="dropdown-backdrop"/>').insertAfter(a(this)).on("click", b);
                h = {
                    relatedTarget: this
                };
                if (f.trigger(d = a.Event("show.bs.dropdown", h)), d.isDefaultPrevented()) return;
                f.toggleClass("open").trigger("shown.bs.dropdown", h), e.focus();
            }
            return !1;
        }
    }, f.prototype.keydown = function(b) {
        if (/(38|40|27)/.test(b.keyCode)) {
            var j = a(this);
            if (b.preventDefault(), b.stopPropagation(), !j.is(".disabled, :disabled")) {
                var i = c(j), g = i.hasClass("open");
                if (!g || g && 27 == b.keyCode) return 27 == b.which && i.find(e).focus(), j.click();
                j = " li:not(.divider):visible a", i = i.find("[role=menu]" + j + ", [role=listbox]" + j);
                i.length && (j = i.index(i.filter(":focus")), 38 == b.keyCode && 0 < j && j--, 40 == b.keyCode && j < i.length - 1 && j++, 
                i.eq(j = !~j ? 0 : j).focus());
            }
        }
    };
    var g = a.fn.dropdown;
    a.fn.dropdown = function(b) {
        return this.each(function() {
            var c = a(this), d = c.data("bs.dropdown");
            d || c.data("bs.dropdown", d = new f(this)), "string" == typeof b && d[b].call(c);
        });
    }, a.fn.dropdown.Constructor = f, a.fn.dropdown.noConflict = function() {
        return a.fn.dropdown = g, this;
    }, a(document).on("click.bs.dropdown.data-api", b).on("click.bs.dropdown.data-api", ".dropdown form", function(a) {
        a.stopPropagation();
    }).on("click.bs.dropdown.data-api", e, f.prototype.toggle).on("keydown.bs.dropdown.data-api", e + ", [role=menu], [role=listbox]", f.prototype.keydown);
}(jQuery), function(a) {
    "use strict";
    function b(b, c) {
        this.options = c, this.$element = a(b), this.$backdrop = this.isShown = null, this.options.remote && this.$element.find(".modal-content").load(this.options.remote, a.proxy(function() {
            this.$element.trigger("loaded.bs.modal");
        }, this));
    }
    b.DEFAULTS = {
        backdrop: !0,
        keyboard: !0,
        show: !0
    }, b.prototype.toggle = function(a) {
        return this[this.isShown ? "hide" : "show"](a);
    }, b.prototype.show = function(b) {
        var c = this, d = a.Event("show.bs.modal", {
            relatedTarget: b
        });
        this.$element.trigger(d), this.isShown || d.isDefaultPrevented() || (this.isShown = !0, 
        this.escape(), this.$element.on("click.dismiss.bs.modal", '[data-dismiss="modal"]', a.proxy(this.hide, this)), 
        this.backdrop(function() {
            var d = a.support.transition && c.$element.hasClass("fade");
            c.$element.parent().length || c.$element.appendTo(document.body), c.$element.show().scrollTop(0), 
            d && c.$element[0].offsetWidth, c.$element.addClass("in").attr("aria-hidden", !1), 
            c.enforceFocus();
            var e = a.Event("shown.bs.modal", {
                relatedTarget: b
            });
            d ? c.$element.find(".modal-dialog").one(a.support.transition.end, function() {
                c.$element.focus().trigger(e);
            }).emulateTransitionEnd(300) : c.$element.focus().trigger(e);
        }));
    }, b.prototype.hide = function(b) {
        b && b.preventDefault(), b = a.Event("hide.bs.modal"), this.$element.trigger(b), 
        this.isShown && !b.isDefaultPrevented() && (this.isShown = !1, this.escape(), a(document).off("focusin.bs.modal"), 
        this.$element.removeClass("in").attr("aria-hidden", !0).off("click.dismiss.bs.modal"), 
        a.support.transition && this.$element.hasClass("fade") ? this.$element.one(a.support.transition.end, a.proxy(this.hideModal, this)).emulateTransitionEnd(300) : this.hideModal());
    }, b.prototype.enforceFocus = function() {
        a(document).off("focusin.bs.modal").on("focusin.bs.modal", a.proxy(function(a) {
            this.$element[0] === a.target || this.$element.has(a.target).length || this.$element.focus();
        }, this));
    }, b.prototype.escape = function() {
        this.isShown && this.options.keyboard ? this.$element.on("keyup.dismiss.bs.modal", a.proxy(function(a) {
            27 == a.which && this.hide();
        }, this)) : this.isShown || this.$element.off("keyup.dismiss.bs.modal");
    }, b.prototype.hideModal = function() {
        var a = this;
        this.$element.hide(), this.backdrop(function() {
            a.removeBackdrop(), a.$element.trigger("hidden.bs.modal");
        });
    }, b.prototype.removeBackdrop = function() {
        this.$backdrop && this.$backdrop.remove(), this.$backdrop = null;
    }, b.prototype.backdrop = function(b) {
        var d, c = this.$element.hasClass("fade") ? "fade" : "";
        this.isShown && this.options.backdrop ? (d = a.support.transition && c, this.$backdrop = a('<div class="modal-backdrop ' + c + '" />').appendTo(document.body), 
        this.$element.on("click.dismiss.bs.modal", a.proxy(function(a) {
            a.target === a.currentTarget && ("static" == this.options.backdrop ? this.$element[0].focus.call(this.$element[0]) : this.hide.call(this));
        }, this)), d && this.$backdrop[0].offsetWidth, this.$backdrop.addClass("in"), b && (d ? this.$backdrop.one(a.support.transition.end, b).emulateTransitionEnd(150) : b())) : !this.isShown && this.$backdrop ? (this.$backdrop.removeClass("in"), 
        a.support.transition && this.$element.hasClass("fade") ? this.$backdrop.one(a.support.transition.end, b).emulateTransitionEnd(150) : b()) : b && b();
    };
    var c = a.fn.modal;
    a.fn.modal = function(c, d) {
        return this.each(function() {
            var e = a(this), f = e.data("bs.modal"), g = a.extend({}, b.DEFAULTS, e.data(), "object" == typeof c && c);
            f || e.data("bs.modal", f = new b(this, g)), "string" == typeof c ? f[c](d) : g.show && f.show(d);
        });
    }, a.fn.modal.Constructor = b, a.fn.modal.noConflict = function() {
        return a.fn.modal = c, this;
    }, a(document).on("click.bs.modal.data-api", '[data-toggle="modal"]', function(b) {
        var c = a(this), f = c.attr("href"), e = a(c.attr("data-target") || f && f.replace(/.*(?=#[^\s]+$)/, "")), f = e.data("bs.modal") ? "toggle" : a.extend({
            remote: !/#/.test(f) && f
        }, e.data(), c.data());
        c.is("a") && b.preventDefault(), e.modal(f, this).one("hide", function() {
            c.is(":visible") && c.focus();
        });
    }), a(document).on("show.bs.modal", ".modal", function() {
        a(document.body).addClass("modal-open");
    }).on("hidden.bs.modal", ".modal", function() {
        a(document.body).removeClass("modal-open");
    });
}(jQuery), function(a) {
    "use strict";
    function b(a, b) {
        this.type = this.options = this.enabled = this.timeout = this.hoverState = this.$element = null, 
        this.init("tooltip", a, b);
    }
    b.DEFAULTS = {
        animation: !0,
        placement: "top",
        selector: !1,
        template: '<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',
        trigger: "hover focus",
        title: "",
        delay: 0,
        html: !1,
        container: !1
    }, b.prototype.init = function(b, c, d) {
        this.enabled = !0, this.type = b, this.$element = a(c), this.options = this.getOptions(d);
        for (var e = this.options.trigger.split(" "), f = e.length; f--; ) {
            var i, g = e[f];
            "click" == g ? this.$element.on("click." + this.type, this.options.selector, a.proxy(this.toggle, this)) : "manual" != g && (i = "hover" == g ? "mouseleave" : "focusout", 
            this.$element.on(("hover" == g ? "mouseenter" : "focusin") + "." + this.type, this.options.selector, a.proxy(this.enter, this)), 
            this.$element.on(i + "." + this.type, this.options.selector, a.proxy(this.leave, this)));
        }
        this.options.selector ? this._options = a.extend({}, this.options, {
            trigger: "manual",
            selector: ""
        }) : this.fixTitle();
    }, b.prototype.getDefaults = function() {
        return b.DEFAULTS;
    }, b.prototype.getOptions = function(b) {
        return (b = a.extend({}, this.getDefaults(), this.$element.data(), b)).delay && "number" == typeof b.delay && (b.delay = {
            show: b.delay,
            hide: b.delay
        }), b;
    }, b.prototype.getDelegateOptions = function() {
        var b = {}, c = this.getDefaults();
        return this._options && a.each(this._options, function(a, d) {
            c[a] != d && (b[a] = d);
        }), b;
    }, b.prototype.enter = function(b) {
        var c = b instanceof this.constructor ? b : a(b.currentTarget)[this.type](this.getDelegateOptions()).data("bs." + this.type);
        return clearTimeout(c.timeout), c.hoverState = "in", c.options.delay && c.options.delay.show ? void (c.timeout = setTimeout(function() {
            "in" == c.hoverState && c.show();
        }, c.options.delay.show)) : c.show();
    }, b.prototype.leave = function(b) {
        var c = b instanceof this.constructor ? b : a(b.currentTarget)[this.type](this.getDelegateOptions()).data("bs." + this.type);
        return clearTimeout(c.timeout), c.hoverState = "out", c.options.delay && c.options.delay.hide ? void (c.timeout = setTimeout(function() {
            "out" == c.hoverState && c.hide();
        }, c.options.delay.hide)) : c.hide();
    }, b.prototype.show = function() {
        var c, d, h, i, l, n, o, p, q, r, m = a.Event("show.bs." + this.type);
        this.hasContent() && this.enabled && (this.$element.trigger(m), m.isDefaultPrevented() || (d = (c = this).tip(), 
        this.setContent(), this.options.animation && d.addClass("fade"), r = "function" == typeof this.options.placement ? this.options.placement.call(this, d[0], this.$element[0]) : this.options.placement, 
        (o = (n = /\s?auto?\s?/i).test(r)) && (r = r.replace(n, "") || "top"), d.detach().css({
            top: 0,
            left: 0,
            display: "block"
        }).addClass(r), this.options.container ? d.appendTo(this.options.container) : d.insertAfter(this.$element), 
        h = this.getPosition(), i = d[0].offsetWidth, q = d[0].offsetHeight, o && (p = this.$element.parent(), 
        l = r, m = document.documentElement.scrollTop || document.body.scrollTop, n = "body" == this.options.container ? window.innerWidth : p.outerWidth(), 
        o = "body" == this.options.container ? window.innerHeight : p.outerHeight(), p = "body" == this.options.container ? 0 : p.offset().left, 
        r = "bottom" == r && h.top + h.height + q - m > o ? "top" : "top" == r && h.top - m - q < 0 ? "bottom" : "right" == r && h.right + i > n ? "left" : "left" == r && h.left - i < p ? "right" : r, 
        d.removeClass(l).addClass(r)), q = this.getCalculatedOffset(r, h, i, q), this.applyPlacement(q, r), 
        this.hoverState = null, r = function() {
            c.$element.trigger("shown.bs." + c.type);
        }, a.support.transition && this.$tip.hasClass("fade") ? d.one(a.support.transition.end, r).emulateTransitionEnd(150) : r()));
    }, b.prototype.applyPlacement = function(b, l) {
        var d, e = this.tip(), f = e[0].offsetWidth, g = e[0].offsetHeight, j = parseInt(e.css("margin-top"), 10), k = parseInt(e.css("margin-left"), 10);
        isNaN(j) && (j = 0), isNaN(k) && (k = 0), b.top = b.top + j, b.left = b.left + k, 
        a.offset.setOffset(e[0], a.extend({
            using: function(a) {
                e.css({
                    top: Math.round(a.top),
                    left: Math.round(a.left)
                });
            }
        }, b), 0), e.addClass("in");
        j = e[0].offsetWidth, k = e[0].offsetHeight;
        "top" == l && k != g && (d = !0, b.top = b.top + g - k), /bottom|top/.test(l) ? (b.left < (l = 0) && (l = -2 * b.left, 
        b.left = 0, e.offset(b), j = e[0].offsetWidth, k = e[0].offsetHeight), this.replaceArrow(l - f + j, j, "left")) : this.replaceArrow(k - g, k, "top"), 
        d && e.offset(b);
    }, b.prototype.replaceArrow = function(a, b, c) {
        this.arrow().css(c, a ? 50 * (1 - a / b) + "%" : "");
    }, b.prototype.setContent = function() {
        var a = this.tip(), b = this.getTitle();
        a.find(".tooltip-inner")[this.options.html ? "html" : "text"](b), a.removeClass("fade in top bottom left right");
    }, b.prototype.hide = function() {
        function b() {
            "in" != c.hoverState && d.detach(), c.$element.trigger("hidden.bs." + c.type);
        }
        var c = this, d = this.tip(), e = a.Event("hide.bs." + this.type);
        return this.$element.trigger(e), e.isDefaultPrevented() ? void 0 : (d.removeClass("in"), 
        a.support.transition && this.$tip.hasClass("fade") ? d.one(a.support.transition.end, b).emulateTransitionEnd(150) : b(), 
        this.hoverState = null, this);
    }, b.prototype.fixTitle = function() {
        var a = this.$element;
        !a.attr("title") && "string" == typeof a.attr("data-original-title") || a.attr("data-original-title", a.attr("title") || "").attr("title", "");
    }, b.prototype.hasContent = function() {
        return this.getTitle();
    }, b.prototype.getPosition = function() {
        var b = this.$element[0];
        return a.extend({}, "function" == typeof b.getBoundingClientRect ? b.getBoundingClientRect() : {
            width: b.offsetWidth,
            height: b.offsetHeight
        }, this.$element.offset());
    }, b.prototype.getCalculatedOffset = function(a, b, c, d) {
        return "bottom" == a ? {
            top: b.top + b.height,
            left: b.left + b.width / 2 - c / 2
        } : "top" == a ? {
            top: b.top - d,
            left: b.left + b.width / 2 - c / 2
        } : "left" == a ? {
            top: b.top + b.height / 2 - d / 2,
            left: b.left - c
        } : {
            top: b.top + b.height / 2 - d / 2,
            left: b.left + b.width
        };
    }, b.prototype.getTitle = function() {
        var b = this.$element, c = this.options;
        return b.attr("data-original-title") || ("function" == typeof c.title ? c.title.call(b[0]) : c.title);
    }, b.prototype.tip = function() {
        return this.$tip = this.$tip || a(this.options.template);
    }, b.prototype.arrow = function() {
        return this.$arrow = this.$arrow || this.tip().find(".tooltip-arrow");
    }, b.prototype.validate = function() {
        this.$element[0].parentNode || (this.hide(), this.$element = null, this.options = null);
    }, b.prototype.enable = function() {
        this.enabled = !0;
    }, b.prototype.disable = function() {
        this.enabled = !1;
    }, b.prototype.toggleEnabled = function() {
        this.enabled = !this.enabled;
    }, b.prototype.toggle = function(c) {
        c = c ? a(c.currentTarget)[this.type](this.getDelegateOptions()).data("bs." + this.type) : this;
        c.tip().hasClass("in") ? c.leave(c) : c.enter(c);
    }, b.prototype.destroy = function() {
        clearTimeout(this.timeout), this.hide().$element.off("." + this.type).removeData("bs." + this.type);
    };
    var c = a.fn.tooltip;
    a.fn.tooltip = function(c) {
        return this.each(function() {
            var d = a(this), e = d.data("bs.tooltip");
            !e && "destroy" == c || (e || d.data("bs.tooltip", e = new b(this, "object" == typeof c && c)), 
            "string" == typeof c && e[c]());
        });
    }, a.fn.tooltip.Constructor = b, a.fn.tooltip.noConflict = function() {
        return a.fn.tooltip = c, this;
    };
}(jQuery), function(a) {
    "use strict";
    function b(a, b) {
        this.init("popover", a, b);
    }
    if (!a.fn.tooltip) throw new Error("Popover requires tooltip.js");
    b.DEFAULTS = a.extend({}, a.fn.tooltip.Constructor.DEFAULTS, {
        placement: "right",
        trigger: "click",
        content: "",
        template: '<div class="popover"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'
    }), ((b.prototype = a.extend({}, a.fn.tooltip.Constructor.prototype)).constructor = b).prototype.getDefaults = function() {
        return b.DEFAULTS;
    }, b.prototype.setContent = function() {
        var a = this.tip(), b = this.getTitle(), c = this.getContent();
        a.find(".popover-title")[this.options.html ? "html" : "text"](b), a.find(".popover-content")[this.options.html ? "string" == typeof c ? "html" : "append" : "text"](c), 
        a.removeClass("fade top bottom left right in"), a.find(".popover-title").html() || a.find(".popover-title").hide();
    }, b.prototype.hasContent = function() {
        return this.getTitle() || this.getContent();
    }, b.prototype.getContent = function() {
        var a = this.$element, b = this.options;
        return a.attr("data-content") || ("function" == typeof b.content ? b.content.call(a[0]) : b.content);
    }, b.prototype.arrow = function() {
        return this.$arrow = this.$arrow || this.tip().find(".arrow");
    }, b.prototype.tip = function() {
        return this.$tip || (this.$tip = a(this.options.template)), this.$tip;
    };
    var c = a.fn.popover;
    a.fn.popover = function(c) {
        return this.each(function() {
            var d = a(this), e = d.data("bs.popover");
            !e && "destroy" == c || (e || d.data("bs.popover", e = new b(this, "object" == typeof c && c)), 
            "string" == typeof c && e[c]());
        });
    }, a.fn.popover.Constructor = b, a.fn.popover.noConflict = function() {
        return a.fn.popover = c, this;
    };
}(jQuery), function(a) {
    "use strict";
    function b(e, d) {
        var f = a.proxy(this.process, this);
        this.$element = a(a(e).is("body") ? window : e), this.$body = a("body"), this.$scrollElement = this.$element.on("scroll.bs.scroll-spy.data-api", f), 
        this.options = a.extend({}, b.DEFAULTS, d), this.selector = (this.options.target || (e = a(e).attr("href")) && e.replace(/.*(?=#[^\s]+$)/, "") || "") + " .nav li > a", 
        this.offsets = a([]), this.targets = a([]), this.activeTarget = null, this.refresh(), 
        this.process();
    }
    b.DEFAULTS = {
        offset: 10
    }, b.prototype.refresh = function() {
        var b = this.$element[0] == window ? "offset" : "position";
        this.offsets = a([]), this.targets = a([]);
        var c = this;
        this.$body.find(this.selector).map(function() {
            var f = a(this), e = f.data("target") || f.attr("href"), f = /^#./.test(e) && a(e);
            return f && f.length && f.is(":visible") ? [ [ f[b]().top + (!a.isWindow(c.$scrollElement.get(0)) && c.$scrollElement.scrollTop()), e ] ] : null;
        }).sort(function(a, b) {
            return a[0] - b[0];
        }).each(function() {
            c.offsets.push(this[0]), c.targets.push(this[1]);
        });
    }, b.prototype.process = function() {
        var a, b = this.$scrollElement.scrollTop() + this.options.offset, d = (this.$scrollElement[0].scrollHeight || this.$body[0].scrollHeight) - this.$scrollElement.height(), e = this.offsets, f = this.targets, g = this.activeTarget;
        if (d <= b) return g != (a = f.last()[0]) && this.activate(a);
        if (g && b <= e[0]) return g != (a = f[0]) && this.activate(a);
        for (a = e.length; a--; ) g != f[a] && b >= e[a] && (!e[a + 1] || b <= e[a + 1]) && this.activate(f[a]);
    }, b.prototype.activate = function(d) {
        this.activeTarget = d, a(this.selector).parentsUntil(this.options.target, ".active").removeClass("active");
        d = this.selector + '[data-target="' + d + '"],' + this.selector + '[href="' + d + '"]', 
        d = a(d).parents("li").addClass("active");
        (d = d.parent(".dropdown-menu").length ? d.closest("li.dropdown").addClass("active") : d).trigger("activate.bs.scrollspy");
    };
    var c = a.fn.scrollspy;
    a.fn.scrollspy = function(c) {
        return this.each(function() {
            var d = a(this), e = d.data("bs.scrollspy");
            e || d.data("bs.scrollspy", e = new b(this, "object" == typeof c && c)), "string" == typeof c && e[c]();
        });
    }, a.fn.scrollspy.Constructor = b, a.fn.scrollspy.noConflict = function() {
        return a.fn.scrollspy = c, this;
    }, a(window).on("load", function() {
        a('[data-spy="scroll"]').each(function() {
            var b = a(this);
            b.scrollspy(b.data());
        });
    });
}(jQuery), function(a) {
    "use strict";
    function b(b) {
        this.element = a(b);
    }
    b.prototype.show = function() {
        var e, f, b = this.element, c = b.closest("ul:not(.dropdown-menu)"), g = b.data("target");
        g || (g = (g = b.attr("href")) && g.replace(/.*(?=#[^\s]*$)/, "")), b.parent("li").hasClass("active") || (e = c.find(".active:last a")[0], 
        f = a.Event("show.bs.tab", {
            relatedTarget: e
        }), b.trigger(f), f.isDefaultPrevented() || (g = a(g), this.activate(b.parent("li"), c), 
        this.activate(g, g.parent(), function() {
            b.trigger({
                type: "shown.bs.tab",
                relatedTarget: e
            });
        })));
    }, b.prototype.activate = function(b, c, d) {
        function e() {
            f.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"), 
            b.addClass("active"), g ? (b[0].offsetWidth, b.addClass("in")) : b.removeClass("fade"), 
            b.parent(".dropdown-menu") && b.closest("li.dropdown").addClass("active"), d && d();
        }
        var f = c.find("> .active"), g = d && a.support.transition && f.hasClass("fade");
        g ? f.one(a.support.transition.end, e).emulateTransitionEnd(150) : e(), f.removeClass("in");
    };
    var c = a.fn.tab;
    a.fn.tab = function(c) {
        return this.each(function() {
            var d = a(this), e = d.data("bs.tab");
            e || d.data("bs.tab", e = new b(this)), "string" == typeof c && e[c]();
        });
    }, a.fn.tab.Constructor = b, a.fn.tab.noConflict = function() {
        return a.fn.tab = c, this;
    }, a(document).on("click.bs.tab.data-api", '[data-toggle="tab"], [data-toggle="pill"]', function(b) {
        b.preventDefault(), a(this).tab("show");
    });
}(jQuery), function(a) {
    "use strict";
    var b = function(c, d) {
        this.options = a.extend({}, b.DEFAULTS, d), this.$window = a(window).on("scroll.bs.affix.data-api", a.proxy(this.checkPosition, this)).on("click.bs.affix.data-api", a.proxy(this.checkPositionWithEventLoop, this)), 
        this.$element = a(c), this.affixed = this.unpin = this.pinnedOffset = null, this.checkPosition();
    };
    b.RESET = "affix affix-top affix-bottom", b.DEFAULTS = {
        offset: 0
    }, b.prototype.getPinnedOffset = function() {
        if (this.pinnedOffset) return this.pinnedOffset;
        this.$element.removeClass(b.RESET).addClass("affix");
        var a = this.$window.scrollTop(), c = this.$element.offset();
        return this.pinnedOffset = c.top - a;
    }, b.prototype.checkPositionWithEventLoop = function() {
        setTimeout(a.proxy(this.checkPosition, this), 1);
    }, b.prototype.checkPosition = function() {
        var c, f, h, i, j, k;
        this.$element.is(":visible") && (c = a(document).height(), j = this.$window.scrollTop(), 
        i = this.$element.offset(), k = (f = this.options.offset).top, h = f.bottom, "top" == this.affixed && (i.top += j), 
        "object" != typeof f && (h = k = f), "function" == typeof k && (k = f.top(this.$element)), 
        "function" == typeof h && (h = f.bottom(this.$element)), i = !(null != this.unpin && j + this.unpin <= i.top) && (null != h && i.top + this.$element.height() >= c - h ? "bottom" : null != k && j <= k && "top"), 
        this.affixed !== i && (this.unpin && this.$element.css("top", ""), k = a.Event((j = "affix" + (i ? "-" + i : "")) + ".bs.affix"), 
        this.$element.trigger(k), k.isDefaultPrevented() || (this.affixed = i, this.unpin = "bottom" == i ? this.getPinnedOffset() : null, 
        this.$element.removeClass(b.RESET).addClass(j).trigger(a.Event(j.replace("affix", "affixed"))), 
        "bottom" == i && this.$element.offset({
            top: c - h - this.$element.height()
        }))));
    };
    var c = a.fn.affix;
    a.fn.affix = function(c) {
        return this.each(function() {
            var d = a(this), e = d.data("bs.affix");
            e || d.data("bs.affix", e = new b(this, "object" == typeof c && c)), "string" == typeof c && e[c]();
        });
    }, a.fn.affix.Constructor = b, a.fn.affix.noConflict = function() {
        return a.fn.affix = c, this;
    }, a(window).on("load", function() {
        a('[data-spy="affix"]').each(function() {
            var b = a(this), c = b.data();
            c.offset = c.offset || {}, c.offsetBottom && (c.offset.bottom = c.offsetBottom), 
            c.offsetTop && (c.offset.top = c.offsetTop), b.affix(c);
        });
    });
}(jQuery), function($) {
    "use strict";
    function ContextMenu(element, options) {
        this.$element = $(element), this.before = options.before || this.before, this.onItem = options.onItem || this.onItem, 
        this.scopes = options.scopes || null, options.target && this.$element.data("target", options.target), 
        this.listen();
    }
    ContextMenu.prototype = {
        constructor: ContextMenu,
        show: function(e) {
            var $menu, tp, relatedTarget = {
                relatedTarget: this
            };
            if (!this.isDisabled() && (this.closemenu(), this.before.call(this, e, $(e.currentTarget)))) return ($menu = this.getMenu()).trigger($.Event("show.bs.context", relatedTarget)), 
            tp = this.getPosition(e, $menu), $menu.attr("style", "").css(tp).addClass("open").on("click.context.data-api", "li:not(.divider)", $.proxy(this.onItem, this, $(e.currentTarget))).trigger("shown.bs.context", relatedTarget), 
            $("html").on("click.context.data-api", $menu.selector, $.proxy(this.closemenu, this)), 
            !1;
        },
        closemenu: function(e) {
            var relatedTarget, $menu = this.getMenu();
            if ($menu.hasClass("open")) return $menu.trigger($.Event("hide.bs.context", relatedTarget = {
                relatedTarget: this
            })), $menu.removeClass("open").off("click.context.data-api", "li:not(.divider)").trigger("hidden.bs.context", relatedTarget), 
            $("html").off("click.context.data-api", $menu.selector), !1;
        },
        before: function(e) {
            return !0;
        },
        onItem: function(e) {
            return !0;
        },
        listen: function() {
            this.$element.on("contextmenu.context.data-api", this.scopes, $.proxy(this.show, this)), 
            $("html").on("click.context.data-api", $.proxy(this.closemenu, this));
        },
        destroy: function() {
            this.$element.off(".context.data-api").removeData("context"), $("html").off(".context.data-api");
        },
        isDisabled: function() {
            return this.$element.hasClass(".disabled") || this.$element.attr("disabled");
        },
        getMenu: function() {
            var selector = (selector = this.$element.data("target")) || (selector = this.$element.attr("href")) && selector.replace(/.*(?=#[^\s]*$)/, ""), $menu = $(selector);
            return $menu && $menu.length ? $menu : this.$element.find(selector);
        },
        getPosition: function(menuHeight, parentOffset) {
            var X = menuHeight.clientX, Y = menuHeight.clientY, boundsX = $(window).width(), boundsY = $(window).height(), menuWidth = parentOffset.find(".dropdown-menu").outerWidth(), menuHeight = parentOffset.find(".dropdown-menu").outerHeight(), Y = boundsY < Y + menuHeight ? {
                top: Y - menuHeight + $(window).scrollTop()
            } : {
                top: Y + $(window).scrollTop()
            }, X = boundsX < X + menuWidth && 0 < X - menuWidth ? {
                left: X - menuWidth + $(window).scrollLeft()
            } : {
                left: X + $(window).scrollLeft()
            }, parentOffset = parentOffset.offsetParent().offset();
            return X.left = X.left - parentOffset.left, Y.top = Y.top - parentOffset.top, $.extend({
                position: "absolute",
                "z-index": 9999
            }, Y, X);
        }
    }, $.fn.contextmenu = function(option, e) {
        return this.each(function() {
            var $this = $(this), data = $this.data("context");
            data || $this.data("context", data = new ContextMenu($this, "object" == typeof option && option)), 
            "string" == typeof option && data[option].call(data, e);
        });
    }, $.fn.contextmenu.Constructor = ContextMenu, $(document).on("contextmenu.context.data-api", '[data-toggle="context"]', function(e) {
        $(this).contextmenu("show", e), e.preventDefault();
    });
}(jQuery), function(e, t) {
    "object" == typeof exports && "object" == typeof module ? module.exports = t() : "function" == typeof define && define.amd ? define([], t) : "object" == typeof exports ? exports.Dropbox = t() : e.Dropbox = t();
}(this, function() {
    return e = [ function(e, t, n) {
        n = n(14);
        e.exports = n;
    }, function(e, t, r) {
        !function(t, n) {
            !function(r) {
                e.exports = r();
            }(function() {
                "use strict";
                function i(e) {
                    return "function" == typeof e;
                }
                function l() {
                    var e = setTimeout;
                    return function() {
                        return e(h, 1);
                    };
                }
                function h() {
                    for (var e = 0; e < $; e += 2) (0, re[e])(re[e + 1]), re[e] = void 0, re[e + 1] = void 0;
                    $ = 0;
                }
                function d(e, t) {
                    var r = arguments, n = this, i = new this.constructor(m);
                    void 0 === i[ie] && U(i);
                    var s = n._state;
                    return s ? function() {
                        var e = r[s - 1];
                        V(function() {
                            return S(s, i, e, n._result);
                        });
                    }() : C(n, i, e, t), i;
                }
                function _(e) {
                    if (e && "object" == typeof e && e.constructor === this) return e;
                    var r = new this(m);
                    return x(r, e), r;
                }
                function m() {}
                function g(e) {
                    try {
                        return e.then;
                    } catch (e) {
                        return ae.error = e, ae;
                    }
                }
                function q(e, t, r) {
                    V(function(e) {
                        var n = !1, i = function(e, t, r, n) {
                            try {
                                e.call(t, r, n);
                            } catch (e) {
                                return e;
                            }
                        }(r, t, function(r) {
                            n || (n = !0, (t !== r ? x : A)(e, r));
                        }, function(t) {
                            n || (n = !0, E(e, t));
                        }, e._label);
                        !n && i && (n = !0, E(e, i));
                    }, e);
                }
                function T(e, t, r) {
                    t.constructor === e.constructor && r === d && t.constructor.resolve === _ ? function(e, t) {
                        t._state === oe ? A(e, t._result) : t._state === ue ? E(e, t._result) : C(t, void 0, function(t) {
                            return x(e, t);
                        }, function(t) {
                            return E(e, t);
                        });
                    }(e, t) : r === ae ? (E(e, ae.error), ae.error = null) : void 0 !== r && i(r) ? q(e, t, r) : A(e, t);
                }
                function x(t, r) {
                    t === r ? E(t, new TypeError("You cannot resolve a promise with itself")) : function(e) {
                        var t = typeof e;
                        return null !== e && ("object" == t || "function" == t);
                    }(r) ? T(t, r, g(r)) : A(t, r);
                }
                function k(e) {
                    e._onerror && e._onerror(e._result), R(e);
                }
                function A(e, t) {
                    e._state === se && (e._result = t, e._state = oe, 0 !== e._subscribers.length && V(R, e));
                }
                function E(e, t) {
                    e._state === se && (e._state = ue, e._result = t, V(k, e));
                }
                function C(e, t, r, n) {
                    var i = e._subscribers, s = i.length;
                    e._onerror = null, i[s] = t, i[s + oe] = r, i[s + ue] = n, 0 === s && e._state && V(R, e);
                }
                function R(e) {
                    var t = e._subscribers, r = e._state;
                    if (0 !== t.length) {
                        for (var n, i = void 0, s = e._result, o = 0; o < t.length; o += 3) n = t[o], i = t[o + r], 
                        n ? S(r, n, i, s) : i(s);
                        e._subscribers.length = 0;
                    }
                }
                function L() {
                    this.error = null;
                }
                function S(e, t, r, n) {
                    var s = i(r), o = void 0, u = void 0, a = void 0, c = void 0;
                    if (s) {
                        if ((o = function(e, t) {
                            try {
                                return e(t);
                            } catch (e) {
                                return ce.error = e, ce;
                            }
                        }(r, n)) === ce ? (c = !0, u = o.error, o.error = null) : a = !0, t === o) return void E(t, new TypeError("A promises callback cannot return that same promise."));
                    } else o = n, a = !0;
                    t._state !== se || (s && a ? x(t, o) : c ? E(t, u) : e === oe ? A(t, o) : e === ue && E(t, o));
                }
                function U(e) {
                    e[ie] = pe++, e._state = void 0, e._result = void 0, e._subscribers = [];
                }
                function F(e, t) {
                    this._instanceConstructor = e, this.promise = new e(m), this.promise[ie] || U(this.promise), 
                    J(t) ? (this.length = t.length, this._remaining = t.length, this._result = new Array(this.length), 
                    0 === this.length ? A(this.promise, this._result) : (this.length = this.length || 0, 
                    this._enumerate(t), 0 === this._remaining && A(this.promise, this._result))) : E(this.promise, new Error("Array Methods must be provided an Array"));
                }
                function z(e) {
                    this[ie] = pe++, this._result = this._state = void 0, this._subscribers = [], m !== e && ("function" != typeof e && function() {
                        throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");
                    }(), this instanceof z ? function(e, t) {
                        try {
                            t(function(t) {
                                x(e, t);
                            }, function(t) {
                                E(e, t);
                            });
                        } catch (t) {
                            E(e, t);
                        }
                    }(this, e) : function() {
                        throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");
                    }());
                }
                var J = Array.isArray || function(e) {
                    return "[object Array]" === Object.prototype.toString.call(e);
                }, $ = 0, W = void 0, Q = void 0, V = function(e, t) {
                    re[$] = e, re[$ + 1] = t, 2 === ($ += 2) && (Q ? Q(h) : ne());
                }, K = "undefined" != typeof window ? window : void 0, te = K || {}, Z = te.MutationObserver || te.WebKitMutationObserver, ee = "undefined" == typeof self && void 0 !== t && "[object process]" === {}.toString.call(t), te = "undefined" != typeof Uint8ClampedArray && "undefined" != typeof importScripts && "undefined" != typeof MessageChannel, re = new Array(1e3), ne = void 0, ne = ee ? function() {
                    return t.nextTick(h);
                } : (Z ? function() {
                    var e = 0, t = new Z(h), r = document.createTextNode("");
                    return t.observe(r, {
                        characterData: !0
                    }), function() {
                        r.data = e = ++e % 2;
                    };
                } : te ? function() {
                    var e = new MessageChannel();
                    return e.port1.onmessage = h, function() {
                        return e.port2.postMessage(0);
                    };
                } : void 0 === K ? function() {
                    try {
                        var e = r(20);
                        return void 0 !== (W = e.runOnLoop || e.runOnContext) ? function() {
                            W(h);
                        } : l();
                    } catch (e) {
                        return l();
                    }
                } : l)(), ie = Math.random().toString(36).substring(16), se = void 0, oe = 1, ue = 2, ae = new L(), ce = new L(), pe = 0;
                return F.prototype._enumerate = function(e) {
                    for (var t = 0; this._state === se && t < e.length; t++) this._eachEntry(e[t], t);
                }, F.prototype._eachEntry = function(e, t) {
                    var i, s, r = this._instanceConstructor, n = r.resolve;
                    n === _ ? (i = g(e)) === d && e._state !== se ? this._settledAt(e._state, t, e._result) : "function" != typeof i ? (this._remaining--, 
                    this._result[t] = e) : r === z ? (T(s = new r(m), e, i), this._willSettleAt(s, t)) : this._willSettleAt(new r(function(t) {
                        return t(e);
                    }), t) : this._willSettleAt(n(e), t);
                }, F.prototype._settledAt = function(e, t, r) {
                    var n = this.promise;
                    n._state === se && (this._remaining--, e === ue ? E(n, r) : this._result[t] = r), 
                    0 === this._remaining && A(n, this._result);
                }, F.prototype._willSettleAt = function(e, t) {
                    var r = this;
                    C(e, void 0, function(e) {
                        return r._settledAt(oe, t, e);
                    }, function(e) {
                        return r._settledAt(ue, t, e);
                    });
                }, z.all = function(e) {
                    return new F(this, e).promise;
                }, z.race = function(e) {
                    var t = this;
                    return new t(J(e) ? function(r, n) {
                        for (var i = e.length, s = 0; s < i; s++) t.resolve(e[s]).then(r, n);
                    } : function(e, t) {
                        return t(new TypeError("You must pass an array to race."));
                    });
                }, z.resolve = _, z.reject = function(e) {
                    var r = new this(m);
                    return E(r, e), r;
                }, z._setScheduler = function(e) {
                    Q = e;
                }, z._setAsap = function(e) {
                    V = e;
                }, z._asap = V, z.prototype = {
                    constructor: z,
                    then: d,
                    catch: function(e) {
                        return this.then(null, e);
                    }
                }, z.polyfill = function() {
                    var e = void 0;
                    if (void 0 !== n) e = n; else if ("undefined" != typeof self) e = self; else try {
                        e = Function("return this")();
                    } catch (e) {
                        throw new Error("polyfill failed because global object is unavailable in this environment");
                    }
                    var t = e.Promise;
                    if (t) {
                        var r = null;
                        try {
                            r = Object.prototype.toString.call(t.resolve());
                        } catch (e) {}
                        if ("[object Promise]" === r && !t.cast) return;
                    }
                    e.Promise = z;
                }, z.Promise = z;
            });
        }.call(t, r(8), function() {
            return this;
        }());
    }, function(e, t, r) {
        function n() {}
        function i(e) {
            if (!_(e)) return e;
            var r, t = [];
            for (r in e) !function s(e, t, r) {
                if (null != r) if (Array.isArray(r)) r.forEach(function(r) {
                    s(e, t, r);
                }); else if (_(r)) for (var n in r) s(e, t + "[" + n + "]", r[n]); else e.push(encodeURIComponent(t) + "=" + encodeURIComponent(r)); else null === r && e.push(encodeURIComponent(t));
            }(t, r, e[r]);
            return t.join("&");
        }
        function o(e) {
            for (var t, r, n = {}, i = e.split("&"), s = 0, o = i.length; s < o; ++s) -1 == (r = (t = i[s]).indexOf("=")) ? n[decodeURIComponent(t)] = "" : n[decodeURIComponent(t.slice(0, r))] = decodeURIComponent(t.slice(r + 1));
            return n;
        }
        function a(e) {
            return /[\/+]json($|[^-\w])/.test(e);
        }
        function c(e) {
            this.req = e, this.xhr = this.req.xhr, this.text = "HEAD" != this.req.method && ("" === this.xhr.responseType || "text" === this.xhr.responseType) || void 0 === this.xhr.responseType ? this.xhr.responseText : null, 
            this.statusText = this.req.xhr.statusText;
            var t = this.xhr.status;
            this._setStatusProperties(t = 1223 === t ? 204 : t), this.header = this.headers = function(e) {
                for (var r, n, i, s = e.split(/\r?\n/), o = {}, u = 0, a = s.length; u < a; ++u) -1 !== (i = (r = s[u]).indexOf(":")) && (n = r.slice(0, i).toLowerCase(), 
                i = g(r.slice(i + 1)), o[n] = i);
                return o;
            }(this.xhr.getAllResponseHeaders()), this.header["content-type"] = this.xhr.getResponseHeader("content-type"), 
            this._setHeaderProperties(this.header), null === this.text && e._responseType ? this.body = this.xhr.response : this.body = "HEAD" != this.req.method ? this._parseBody(this.text || this.xhr.response) : null;
        }
        function p(e, t) {
            var r = this;
            this._query = this._query || [], this.method = e, this.url = t, this.header = {}, 
            this._header = {}, this.on("end", function() {
                var n, e = null, t = null;
                try {
                    t = new c(r);
                } catch (t) {
                    return (e = new Error("Parser is unable to parse the response")).parse = !0, e.original = t, 
                    r.xhr ? (e.rawResponse = void 0 === r.xhr.responseType ? r.xhr.responseText : r.xhr.response, 
                    e.status = r.xhr.status || null, e.statusCode = e.status) : (e.rawResponse = null, 
                    e.status = null), r.callback(e);
                }
                r.emit("response", t);
                try {
                    r._isResponseOK(t) || (n = new Error(t.statusText || "Unsuccessful HTTP response"));
                } catch (e) {
                    n = e;
                }
                n ? (n.original = e, n.response = t, n.status = t.status, r.callback(n, t)) : r.callback(null, t);
            });
        }
        function l(n, t, r) {
            n = v("DELETE", n);
            return "function" == typeof t && (r = t, t = null), t && n.send(t), r && n.end(r), 
            n;
        }
        var h = "undefined" != typeof window ? window : "undefined" != typeof self ? self : (console.warn("Using browser-only version of superagent in non-browser environment"), 
        this), f = r(7), d = r(10), _ = r(4), m = r(11), y = r(9), v = t = e.exports = function(e, r) {
            return "function" == typeof r ? new t.Request("GET", e).end(r) : 1 == arguments.length ? new t.Request("GET", e) : new t.Request(e, r);
        };
        t.Request = p, v.getXHR = function() {
            if (!(!h.XMLHttpRequest || h.location && "file:" == h.location.protocol && h.ActiveXObject)) return new XMLHttpRequest();
            try {
                return new ActiveXObject("Microsoft.XMLHTTP");
            } catch (e) {}
            try {
                return new ActiveXObject("Msxml2.XMLHTTP.6.0");
            } catch (e) {}
            try {
                return new ActiveXObject("Msxml2.XMLHTTP.3.0");
            } catch (e) {}
            try {
                return new ActiveXObject("Msxml2.XMLHTTP");
            } catch (e) {}
            throw Error("Browser-only version of superagent could not find XHR");
        };
        var g = "".trim ? function(e) {
            return e.trim();
        } : function(e) {
            return e.replace(/(^\s*|\s*$)/g, "");
        };
        v.serializeObject = i, v.parseString = o, v.types = {
            html: "text/html",
            json: "application/json",
            xml: "text/xml",
            urlencoded: "application/x-www-form-urlencoded",
            form: "application/x-www-form-urlencoded",
            "form-data": "application/x-www-form-urlencoded"
        }, v.serialize = {
            "application/x-www-form-urlencoded": i,
            "application/json": JSON.stringify
        }, v.parse = {
            "application/x-www-form-urlencoded": o,
            "application/json": JSON.parse
        }, m(c.prototype), c.prototype._parseBody = function(e) {
            var t = v.parse[this.type];
            return this.req._parser ? this.req._parser(this, e) : (t = !t && a(this.type) ? v.parse["application/json"] : t) && e && (e.length || e instanceof Object) ? t(e) : null;
        }, c.prototype.toError = function() {
            var i = this.req, t = i.method, r = i.url, i = "cannot " + t + " " + r + " (" + this.status + ")", i = new Error(i);
            return i.status = this.status, i.method = t, i.url = r, i;
        }, v.Response = c, f(p.prototype), d(p.prototype), p.prototype.type = function(e) {
            return this.set("Content-Type", v.types[e] || e), this;
        }, p.prototype.accept = function(e) {
            return this.set("Accept", v.types[e] || e), this;
        }, p.prototype.auth = function(e, t, r) {
            "object" == typeof (t = 1 === arguments.length ? "" : t) && null !== t && (r = t, 
            t = ""), r = r || {
                type: "function" == typeof btoa ? "basic" : "auto"
            };
            return this._auth(e, t, r, function(e) {
                if ("function" == typeof btoa) return btoa(e);
                throw new Error("Cannot use basic auth, btoa is not a function");
            });
        }, p.prototype.query = function(e) {
            return (e = "string" != typeof e ? i(e) : e) && this._query.push(e), this;
        }, p.prototype.attach = function(e, t, r) {
            if (t) {
                if (this._data) throw Error("superagent can't mix .send() and .attach()");
                this._getFormData().append(e, t, r || t.name);
            }
            return this;
        }, p.prototype._getFormData = function() {
            return this._formData || (this._formData = new h.FormData()), this._formData;
        }, p.prototype.callback = function(e, t) {
            if (this._shouldRetry(e, t)) return this._retry();
            var r = this._callback;
            this.clearTimeout(), e && (this._maxRetries && (e.retries = this._retries - 1), 
            this.emit("error", e)), r(e, t);
        }, p.prototype.crossDomainError = function() {
            var e = new Error("Request has been terminated\nPossible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc.");
            e.crossDomain = !0, e.status = this.status, e.method = this.method, e.url = this.url, 
            this.callback(e);
        }, p.prototype.buffer = p.prototype.ca = p.prototype.agent = function() {
            return console.warn("This is not supported in browser version of superagent"), this;
        }, p.prototype.pipe = p.prototype.write = function() {
            throw Error("Streaming is not supported in browser version of superagent");
        }, p.prototype._isHost = function(e) {
            return e && "object" == typeof e && !Array.isArray(e) && "[object Object]" !== Object.prototype.toString.call(e);
        }, p.prototype.end = function(e) {
            return this._endCalled && console.warn("Warning: .end() was called twice. This is not supported in superagent"), 
            this._endCalled = !0, this._callback = e || n, this._finalizeQueryString(), this._end();
        }, p.prototype._end = function() {
            var e = this, t = this.xhr = v.getXHR(), r = this._formData || this._data;
            this._setTimeouts(), t.onreadystatechange = function() {
                var n, r = t.readyState;
                if (2 <= r && e._responseTimeoutTimer && clearTimeout(e._responseTimeoutTimer), 
                4 == r) {
                    try {
                        n = t.status;
                    } catch (e) {
                        n = 0;
                    }
                    if (!n) return e.timedout || e._aborted ? void 0 : e.crossDomainError();
                    e.emit("end");
                }
            };
            var i, o, s = function(t, r) {
                0 < r.total && (r.percent = r.loaded / r.total * 100), r.direction = t, e.emit("progress", r);
            };
            if (this.hasListeners("progress")) try {
                t.onprogress = s.bind(null, "download"), t.upload && (t.upload.onprogress = s.bind(null, "upload"));
            } catch (e) {}
            try {
                this.username && this.password ? t.open(this.method, this.url, !0, this.username, this.password) : t.open(this.method, this.url, !0);
            } catch (e) {
                return this.callback(e);
            }
            for (o in this._withCredentials && (t.withCredentials = !0), this._formData || "GET" == this.method || "HEAD" == this.method || "string" == typeof r || this._isHost(r) || (i = this._header["content-type"], 
            (s = !(s = this._serializer || v.serialize[i ? i.split(";")[0] : ""]) && a(i) ? v.serialize["application/json"] : s) && (r = s(r))), 
            this.header) null != this.header[o] && this.header.hasOwnProperty(o) && t.setRequestHeader(o, this.header[o]);
            return this._responseType && (t.responseType = this._responseType), this.emit("request", this), 
            t.send(void 0 !== r ? r : null), this;
        }, v.agent = function() {
            return new y();
        }, [ "GET", "POST", "OPTIONS", "PATCH", "PUT", "DELETE" ].forEach(function(e) {
            y.prototype[e.toLowerCase()] = function(n, r) {
                n = new v.Request(e, n);
                return this._setDefaults(n), r && n.end(r), n;
            };
        }), y.prototype.del = y.prototype.delete, v.get = function(n, t, r) {
            n = v("GET", n);
            return "function" == typeof t && (r = t, t = null), t && n.query(t), r && n.end(r), 
            n;
        }, v.head = function(n, t, r) {
            n = v("HEAD", n);
            return "function" == typeof t && (r = t, t = null), t && n.query(t), r && n.end(r), 
            n;
        }, v.options = function(n, t, r) {
            n = v("OPTIONS", n);
            return "function" == typeof t && (r = t, t = null), t && n.send(t), r && n.end(r), 
            n;
        }, v.del = l, v.delete = l, v.patch = function(n, t, r) {
            n = v("PATCH", n);
            return "function" == typeof t && (r = t, t = null), t && n.send(t), r && n.end(r), 
            n;
        }, v.post = function(n, t, r) {
            n = v("POST", n);
            return "function" == typeof t && (r = t, t = null), t && n.send(t), r && n.end(r), 
            n;
        }, v.put = function(n, t, r) {
            n = v("PUT", n);
            return "function" == typeof t && (r = t, t = null), t && n.send(t), r && n.end(r), 
            n;
        };
    }, function(e, t) {
        e.exports = function(e) {
            return "https://" + e + ".dropboxapi.com/2/";
        };
    }, function(e, t) {
        "use strict";
        e.exports = function(e) {
            return null !== e && "object" == typeof e;
        };
    }, function(e, t) {
        var n = /[\u007f-\uffff]/g;
        e.exports = function(e) {
            return JSON.stringify(e).replace(n, function(e) {
                return "\\u" + ("000" + e.charCodeAt(0).toString(16)).slice(-4);
            });
        };
    }, function(e, t, r) {
        var n, i = r(16);
        r(15), (n = function(e) {
            this.accessToken = (e = e || {}).accessToken, this.clientId = e.clientId, this.selectUser = e.selectUser;
        }).prototype.setAccessToken = function(e) {
            this.accessToken = e;
        }, n.prototype.getAccessToken = function() {
            return this.accessToken;
        }, n.prototype.setClientId = function(e) {
            this.clientId = e;
        }, n.prototype.getClientId = function() {
            return this.clientId;
        }, n.prototype.getAuthenticationUrl = function(e, t) {
            var r = this.getClientId();
            if (!r) throw new Error("A client id is required. You can set the client id using .setClientId().");
            if (!e) throw new Error("A redirect uri is required.");
            return r = "https://www.dropbox.com/oauth2/authorize?response_type=token&client_id=" + r, 
            e && (r = r + "&redirect_uri=" + e), r = t ? r + "&state=" + t : r;
        }, n.prototype.authenticateWithCordova = function(e, t) {
            function o(e) {
                window.setTimeout(function() {
                    i.close();
                }, 10), t();
            }
            function u(r) {
                var o, u, c;
                -1 < r.url.indexOf("&error=") ? (window.setTimeout(function() {
                    i.close();
                }, 10), t()) : (u = r.url.indexOf(o = "#access_token="), c = r.url.indexOf("&token_type="), 
                -1 < u && (u += o.length, window.setTimeout(function() {
                    i.close();
                }, 10), c = r.url.substring(u, c), e(c)));
            }
            var n = this.getAuthenticationUrl("https://www.dropbox.com/1/oauth2/redirect_receiver"), i = window.open(n, "_blank"), s = !1, a = function(e) {
                s || (i.removeEventListener("loaderror", o), i.removeEventListener("loadstop", u), 
                i.removeEventListener("exit", a), s = !0);
            };
            i.addEventListener("loaderror", o), i.addEventListener("loadstop", u), i.addEventListener("exit", a);
        }, n.prototype.request = function(e, t, r, n, s) {
            var o = null;
            switch (s) {
              case i.RPC:
                o = this.getRpcRequest();
                break;

              case i.DOWNLOAD:
                o = this.getDownloadRequest();
                break;

              case i.UPLOAD:
                o = this.getUploadRequest();
                break;

              default:
                throw new Error("Invalid request style: " + s);
            }
            return o(e, t, r, n, this.getAccessToken(), this.selectUser);
        }, n.prototype.setRpcRequest = function(e) {
            n.prototype.rpcRequest = e;
        }, n.prototype.getRpcRequest = function() {
            return n.prototype.rpcRequest = void 0 === n.prototype.rpcRequest ? r(18) : n.prototype.rpcRequest;
        }, n.prototype.setDownloadRequest = function(e) {
            n.prototype.downloadRequest = e;
        }, n.prototype.getDownloadRequest = function() {
            return n.prototype.downloadRequest = void 0 === n.prototype.downloadRequest ? r(13) : n.prototype.downloadRequest;
        }, n.prototype.setUploadRequest = function(e) {
            n.prototype.uploadRequest = e;
        }, n.prototype.getUploadRequest = function() {
            return n.prototype.uploadRequest = void 0 === n.prototype.uploadRequest ? r(19) : n.prototype.uploadRequest;
        }, e.exports = n;
    }, function(e, t, r) {
        function n(e) {
            if (e) return function(e) {
                for (var t in n.prototype) e[t] = n.prototype[t];
                return e;
            }(e);
        }
        (e.exports = n).prototype.on = n.prototype.addEventListener = function(e, t) {
            return this._callbacks = this._callbacks || {}, (this._callbacks["$" + e] = this._callbacks["$" + e] || []).push(t), 
            this;
        }, n.prototype.once = function(e, t) {
            function r() {
                this.off(e, r), t.apply(this, arguments);
            }
            return r.fn = t, this.on(e, r), this;
        }, n.prototype.off = n.prototype.removeListener = n.prototype.removeAllListeners = n.prototype.removeEventListener = function(e, t) {
            if (this._callbacks = this._callbacks || {}, 0 == arguments.length) return this._callbacks = {}, 
            this;
            var r = this._callbacks["$" + e];
            if (!r) return this;
            if (1 == arguments.length) return delete this._callbacks["$" + e], this;
            for (var n, i = 0; i < r.length; i++) if ((n = r[i]) === t || n.fn === t) {
                r.splice(i, 1);
                break;
            }
            return this;
        }, n.prototype.emit = function(e) {
            this._callbacks = this._callbacks || {};
            var t = [].slice.call(arguments, 1), r = this._callbacks["$" + e];
            if (r) for (var n = 0, i = (r = r.slice(0)).length; n < i; ++n) r[n].apply(this, t);
            return this;
        }, n.prototype.listeners = function(e) {
            return this._callbacks = this._callbacks || {}, this._callbacks["$" + e] || [];
        }, n.prototype.hasListeners = function(e) {
            return !!this.listeners(e).length;
        };
    }, function(h, t) {
        function r() {
            throw new Error("setTimeout has not been defined");
        }
        function n() {
            throw new Error("clearTimeout has not been defined");
        }
        function i(e) {
            if (p === setTimeout) return setTimeout(e, 0);
            if ((p === r || !p) && setTimeout) return p = setTimeout, setTimeout(e, 0);
            try {
                return p(e, 0);
            } catch (t) {
                try {
                    return p.call(null, e, 0);
                } catch (t) {
                    return p.call(this, e, 0);
                }
            }
        }
        function o() {
            _ && f && (_ = !1, f.length ? d = f.concat(d) : m = -1, d.length && u());
        }
        function u() {
            if (!_) {
                var e = i(o);
                _ = !0;
                for (var t = d.length; t; ) {
                    for (f = d, d = []; ++m < t; ) f && f[m].run();
                    m = -1, t = d.length;
                }
                f = null, _ = !1, function(e) {
                    if (l === clearTimeout) return clearTimeout(e);
                    if ((l === n || !l) && clearTimeout) return l = clearTimeout, clearTimeout(e);
                    try {
                        l(e);
                    } catch (t) {
                        try {
                            return l.call(null, e);
                        } catch (t) {
                            return l.call(this, e);
                        }
                    }
                }(e);
            }
        }
        function a(e, t) {
            this.fun = e, this.array = t;
        }
        function c() {}
        var p, l, h = h.exports = {};
        !function() {
            try {
                p = "function" == typeof setTimeout ? setTimeout : r;
            } catch (e) {
                p = r;
            }
            try {
                l = "function" == typeof clearTimeout ? clearTimeout : n;
            } catch (e) {
                l = n;
            }
        }();
        var f, d = [], _ = !1, m = -1;
        h.nextTick = function(e) {
            var t = new Array(arguments.length - 1);
            if (1 < arguments.length) for (var r = 1; r < arguments.length; r++) t[r - 1] = arguments[r];
            d.push(new a(e, t)), 1 !== d.length || _ || i(u);
        }, a.prototype.run = function() {
            this.fun.apply(null, this.array);
        }, h.title = "browser", h.browser = !0, h.env = {}, h.argv = [], h.version = "", 
        h.versions = {}, h.on = c, h.addListener = c, h.once = c, h.off = c, h.removeListener = c, 
        h.removeAllListeners = c, h.emit = c, h.prependListener = c, h.prependOnceListener = c, 
        h.listeners = function(e) {
            return [];
        }, h.binding = function(e) {
            throw new Error("process.binding is not supported");
        }, h.cwd = function() {
            return "/";
        }, h.chdir = function(e) {
            throw new Error("process.chdir is not supported");
        }, h.umask = function() {
            return 0;
        };
    }, function(e, t) {
        function r() {
            this._defaults = [];
        }
        [ "use", "on", "once", "set", "query", "type", "accept", "auth", "withCredentials", "sortQuery", "retry", "ok", "redirects", "timeout", "buffer", "serialize", "parse", "ca", "key", "pfx", "cert" ].forEach(function(e) {
            r.prototype[e] = function() {
                return this._defaults.push({
                    fn: e,
                    arguments: arguments
                }), this;
            };
        }), r.prototype._setDefaults = function(e) {
            this._defaults.forEach(function(t) {
                e[t.fn].apply(e, t.arguments);
            });
        }, e.exports = r;
    }, function(e, t, r) {
        "use strict";
        function n(e) {
            if (e) return function(e) {
                for (var t in n.prototype) e[t] = n.prototype[t];
                return e;
            }(e);
        }
        var s = r(4);
        (e.exports = n).prototype.clearTimeout = function() {
            return clearTimeout(this._timer), clearTimeout(this._responseTimeoutTimer), delete this._timer, 
            delete this._responseTimeoutTimer, this;
        }, n.prototype.parse = function(e) {
            return this._parser = e, this;
        }, n.prototype.responseType = function(e) {
            return this._responseType = e, this;
        }, n.prototype.serialize = function(e) {
            return this._serializer = e, this;
        }, n.prototype.timeout = function(e) {
            if (!e || "object" != typeof e) return this._timeout = e, this._responseTimeout = 0, 
            this;
            for (var t in e) switch (t) {
              case "deadline":
                this._timeout = e.deadline;
                break;

              case "response":
                this._responseTimeout = e.response;
                break;

              default:
                console.warn("Unknown timeout option", t);
            }
            return this;
        }, n.prototype.retry = function(e, t) {
            return this._maxRetries = e = (e = 0 === arguments.length || !0 === e ? 1 : e) <= 0 ? 0 : e, 
            this._retries = 0, this._retryCallback = t, this;
        };
        var o = [ "ECONNRESET", "ETIMEDOUT", "EADDRINFO", "ESOCKETTIMEDOUT" ];
        n.prototype._shouldRetry = function(e, t) {
            if (!this._maxRetries || this._retries++ >= this._maxRetries) return !1;
            if (this._retryCallback) try {
                var r = this._retryCallback(e, t);
                if (!0 === r) return !0;
                if (!1 === r) return !1;
            } catch (e) {
                console.error(e);
            }
            if (t && t.status && 500 <= t.status && 501 != t.status) return !0;
            if (e) {
                if (e.code && ~o.indexOf(e.code)) return !0;
                if (e.timeout && "ECONNABORTED" == e.code) return !0;
                if (e.crossDomain) return !0;
            }
            return !1;
        }, n.prototype._retry = function() {
            return this.clearTimeout(), this.req && (this.req = null, this.req = this.request()), 
            this._aborted = !1, this.timedout = !1, this._end();
        }, n.prototype.then = function(e, t) {
            var r;
            return this._fullfilledPromise || ((r = this)._endCalled && console.warn("Warning: superagent request was sent twice, because both .end() and .then() were called. Never call .end() if you use promises"), 
            this._fullfilledPromise = new Promise(function(e, t) {
                r.end(function(r, n) {
                    r ? t(r) : e(n);
                });
            })), this._fullfilledPromise.then(e, t);
        }, n.prototype.catch = function(e) {
            return this.then(void 0, e);
        }, n.prototype.use = function(e) {
            return e(this), this;
        }, n.prototype.ok = function(e) {
            if ("function" != typeof e) throw Error("Callback required");
            return this._okCallback = e, this;
        }, n.prototype._isResponseOK = function(e) {
            return !!e && (this._okCallback ? this._okCallback(e) : 200 <= e.status && e.status < 300);
        }, n.prototype.getHeader = n.prototype.get = function(e) {
            return this._header[e.toLowerCase()];
        }, n.prototype.set = function(e, t) {
            if (s(e)) {
                for (var r in e) this.set(r, e[r]);
                return this;
            }
            return this._header[e.toLowerCase()] = t, this.header[e] = t, this;
        }, n.prototype.unset = function(e) {
            return delete this._header[e.toLowerCase()], delete this.header[e], this;
        }, n.prototype.field = function(e, t) {
            if (null == e) throw new Error(".field(name, val) name can not be empty");
            if (this._data && console.error(".field() can't be used if .send() is used. Please use only .send() or only .field() & .attach()"), 
            s(e)) {
                for (var r in e) this.field(r, e[r]);
                return this;
            }
            if (Array.isArray(t)) {
                for (var n in t) this.field(e, t[n]);
                return this;
            }
            if (null == t) throw new Error(".field(name, val) val can not be empty");
            return "boolean" == typeof t && (t = "" + t), this._getFormData().append(e, t), 
            this;
        }, n.prototype.abort = function() {
            return this._aborted || (this._aborted = !0, this.xhr && this.xhr.abort(), this.req && this.req.abort(), 
            this.clearTimeout(), this.emit("abort")), this;
        }, n.prototype._auth = function(e, t, r, n) {
            switch (r.type) {
              case "basic":
                this.set("Authorization", "Basic " + n(e + ":" + t));
                break;

              case "auto":
                this.username = e, this.password = t;
                break;

              case "bearer":
                this.set("Authorization", "Bearer " + e);
            }
            return this;
        }, n.prototype.withCredentials = function(e) {
            return this._withCredentials = e = null == e ? !0 : e, this;
        }, n.prototype.redirects = function(e) {
            return this._maxRedirects = e, this;
        }, n.prototype.maxResponseSize = function(e) {
            if ("number" != typeof e) throw TypeError("Invalid argument");
            return this._maxResponseSize = e, this;
        }, n.prototype.toJSON = function() {
            return {
                method: this.method,
                url: this.url,
                data: this._data,
                headers: this._header
            };
        }, n.prototype.send = function(e) {
            var t = s(e), r = this._header["content-type"];
            if (this._formData && console.error(".send() can't be used if .attach() or .field() is used. Please use only .send() or only .field() & .attach()"), 
            t && !this._data) Array.isArray(e) ? this._data = [] : this._isHost(e) || (this._data = {}); else if (e && this._data && this._isHost(this._data)) throw Error("Can't merge these send calls");
            if (t && s(this._data)) for (var n in e) this._data[n] = e[n]; else "string" == typeof e ? (r || this.type("form"), 
            r = this._header["content-type"], this._data = "application/x-www-form-urlencoded" == r ? this._data ? this._data + "&" + e : e : (this._data || "") + e) : this._data = e;
            return !t || this._isHost(e) || r || this.type("json"), this;
        }, n.prototype.sortQuery = function(e) {
            return this._sort = void 0 === e || e, this;
        }, n.prototype._finalizeQueryString = function() {
            var t, r = this._query.join("&");
            r && (this.url += (0 <= this.url.indexOf("?") ? "&" : "?") + r), this._query.length = 0, 
            this._sort && 0 <= (t = this.url.indexOf("?")) && (r = this.url.substring(t + 1).split("&"), 
            "function" == typeof this._sort ? r.sort(this._sort) : r.sort(), this.url = this.url.substring(0, t) + "?" + r.join("&"));
        }, n.prototype._appendQueryString = function() {
            console.trace("Unsupported");
        }, n.prototype._timeoutError = function(n, t, r) {
            this._aborted || ((n = new Error(n + t + "ms exceeded")).timeout = t, n.code = "ECONNABORTED", 
            n.errno = r, this.timedout = !0, this.abort(), this.callback(n));
        }, n.prototype._setTimeouts = function() {
            var e = this;
            this._timeout && !this._timer && (this._timer = setTimeout(function() {
                e._timeoutError("Timeout of ", e._timeout, "ETIME");
            }, this._timeout)), this._responseTimeout && !this._responseTimeoutTimer && (this._responseTimeoutTimer = setTimeout(function() {
                e._timeoutError("Response timeout of ", e._responseTimeout, "ETIMEDOUT");
            }, this._responseTimeout));
        };
    }, function(e, t, r) {
        "use strict";
        function n(e) {
            if (e) return function(e) {
                for (var t in n.prototype) e[t] = n.prototype[t];
                return e;
            }(e);
        }
        var s = r(12);
        (e.exports = n).prototype.get = function(e) {
            return this.header[e.toLowerCase()];
        }, n.prototype._setHeaderProperties = function(e) {
            var t = e["content-type"] || "";
            this.type = s.type(t);
            var n, r = s.params(t);
            for (n in r) this[n] = r[n];
            this.links = {};
            try {
                e.link && (this.links = s.parseLinks(e.link));
            } catch (e) {}
        }, n.prototype._setStatusProperties = function(e) {
            var t = e / 100 | 0;
            this.status = this.statusCode = e, this.statusType = t, this.info = 1 == t, this.ok = 2 == t, 
            this.redirect = 3 == t, this.clientError = 4 == t, this.serverError = 5 == t, this.error = (4 == t || 5 == t) && this.toError(), 
            this.accepted = 202 == e, this.noContent = 204 == e, this.badRequest = 400 == e, 
            this.unauthorized = 401 == e, this.notAcceptable = 406 == e, this.forbidden = 403 == e, 
            this.notFound = 404 == e;
        };
    }, function(e, t) {
        "use strict";
        t.type = function(e) {
            return e.split(/ *; */).shift();
        }, t.params = function(e) {
            return e.split(/ *; */).reduce(function(e, n) {
                var i = n.split(/ *= */), n = i.shift(), i = i.shift();
                return n && i && (e[n] = i), e;
            }, {});
        }, t.parseLinks = function(e) {
            return e.split(/ *, */).reduce(function(e, n) {
                var r = n.split(/ *; */), n = r[0].slice(1, -1);
                return e[r[1].split(/ *= */)[1].slice(1, -1)] = n, e;
            }, {});
        }, t.cleanHeader = function(e, t) {
            return delete e["content-type"], delete e["content-length"], delete e["transfer-encoding"], 
            delete e.host, t && (delete e.authorization, delete e.cookie), e;
        };
    }, function(e, t, r) {
        var n, s, o = r(2), u = r(1).Promise, a = r(3), c = r(5);
        o.parse["application/octect-stream"] = function(e) {
            return e;
        }, n = function(e, t) {
            return {
                status: e.status,
                error: (t ? t.text : null) || e.toString(),
                response: t
            };
        }, s = function(e, t) {
            e.text = "", e.setEncoding("binary"), e.on("data", function(t) {
                e.text += t;
            }), e.on("end", function() {
                t();
            });
        }, e.exports = function(e, t, r, i, p, l) {
            if ("user" !== r) throw new Error("Unexpected auth type: " + r);
            return new u(function(r, u) {
                function h(e) {
                    r && r(e);
                }
                function d(r, t) {
                    r ? function(e) {
                        u && u(e);
                    }(n(r, t)) : (r = JSON.parse(t.headers["dropbox-api-result"]), t.xhr ? r.fileBlob = t.xhr.response : r.fileBinary = t.res.text, 
                    h(r));
                }
                var _ = o.post(a(i) + e).set("Authorization", "Bearer " + p).set("Dropbox-API-Arg", c(t)).on("request", function() {
                    this.xhr && (this.xhr.responseType = "blob");
                });
                l && (_ = _.set("Dropbox-API-Select-User", l)), ("undefined" == typeof window ? _.buffer(!0).parse(s) : _).end(d);
            });
        };
    }, function(e, t, n) {
        var i = n(6), s = n(17), n = function(e) {
            i.call(this, e);
        };
        (((n.prototype = Object.create(i.prototype)).constructor = n).prototype = Object.assign(n.prototype, s)).filesGetSharedLinkFile = function(e) {
            return this.request("sharing/get_shared_link_file", e, "api", "download");
        }, e.exports = n;
    }, function(e, t) {
        "function" != typeof Object.assign && (Object.assign = function(e) {
            "use strict";
            var t, r, n, i;
            if (null == e) throw new TypeError("Cannot convert undefined or null to object");
            for (t = Object(e), r = 1; r < arguments.length; r++) if (null != (n = arguments[r])) for (i in n) n.hasOwnProperty(i) && (t[i] = n[i]);
            return t;
        });
    }, function(e, t) {
        e.exports = {
            RPC: "rpc",
            DOWNLOAD: "download",
            UPLOAD: "upload"
        };
    }, function(e, t) {
        var r = {
            authTokenFromOauth1: function(e) {
                return this.request("auth/token/from_oauth1", e, "app", "api", "rpc");
            },
            authTokenRevoke: function(e) {
                return this.request("auth/token/revoke", e, "user", "api", "rpc");
            },
            filePropertiesPropertiesAdd: function(e) {
                return this.request("file_properties/properties/add", e, "user", "api", "rpc");
            },
            filePropertiesPropertiesOverwrite: function(e) {
                return this.request("file_properties/properties/overwrite", e, "user", "api", "rpc");
            },
            filePropertiesPropertiesRemove: function(e) {
                return this.request("file_properties/properties/remove", e, "user", "api", "rpc");
            },
            filePropertiesPropertiesSearch: function(e) {
                return this.request("file_properties/properties/search", e, "user", "api", "rpc");
            },
            filePropertiesPropertiesSearchContinue: function(e) {
                return this.request("file_properties/properties/search/continue", e, "user", "api", "rpc");
            },
            filePropertiesPropertiesUpdate: function(e) {
                return this.request("file_properties/properties/update", e, "user", "api", "rpc");
            },
            filePropertiesTemplatesAddForTeam: function(e) {
                return this.request("file_properties/templates/add_for_team", e, "team", "api", "rpc");
            },
            filePropertiesTemplatesAddForUser: function(e) {
                return this.request("file_properties/templates/add_for_user", e, "user", "api", "rpc");
            },
            filePropertiesTemplatesGetForTeam: function(e) {
                return this.request("file_properties/templates/get_for_team", e, "team", "api", "rpc");
            },
            filePropertiesTemplatesGetForUser: function(e) {
                return this.request("file_properties/templates/get_for_user", e, "user", "api", "rpc");
            },
            filePropertiesTemplatesListForTeam: function(e) {
                return this.request("file_properties/templates/list_for_team", e, "team", "api", "rpc");
            },
            filePropertiesTemplatesListForUser: function(e) {
                return this.request("file_properties/templates/list_for_user", e, "user", "api", "rpc");
            },
            filePropertiesTemplatesRemoveForTeam: function(e) {
                return this.request("file_properties/templates/remove_for_team", e, "team", "api", "rpc");
            },
            filePropertiesTemplatesRemoveForUser: function(e) {
                return this.request("file_properties/templates/remove_for_user", e, "user", "api", "rpc");
            },
            filePropertiesTemplatesUpdateForTeam: function(e) {
                return this.request("file_properties/templates/update_for_team", e, "team", "api", "rpc");
            },
            filePropertiesTemplatesUpdateForUser: function(e) {
                return this.request("file_properties/templates/update_for_user", e, "user", "api", "rpc");
            },
            fileRequestsCreate: function(e) {
                return this.request("file_requests/create", e, "user", "api", "rpc");
            },
            fileRequestsGet: function(e) {
                return this.request("file_requests/get", e, "user", "api", "rpc");
            },
            fileRequestsList: function(e) {
                return this.request("file_requests/list", e, "user", "api", "rpc");
            },
            fileRequestsUpdate: function(e) {
                return this.request("file_requests/update", e, "user", "api", "rpc");
            },
            filesAlphaGetMetadata: function(e) {
                return this.request("files/alpha/get_metadata", e, "user", "api", "rpc");
            },
            filesAlphaUpload: function(e) {
                return this.request("files/alpha/upload", e, "user", "content", "upload");
            },
            filesCopy: function(e) {
                return this.request("files/copy", e, "user", "api", "rpc");
            },
            filesCopyBatch: function(e) {
                return this.request("files/copy_batch", e, "user", "api", "rpc");
            },
            filesCopyBatchCheck: function(e) {
                return this.request("files/copy_batch/check", e, "user", "api", "rpc");
            },
            filesCopyReferenceGet: function(e) {
                return this.request("files/copy_reference/get", e, "user", "api", "rpc");
            },
            filesCopyReferenceSave: function(e) {
                return this.request("files/copy_reference/save", e, "user", "api", "rpc");
            },
            filesCopyV2: function(e) {
                return this.request("files/copy_v2", e, "user", "api", "rpc");
            },
            filesCreateFolder: function(e) {
                return this.request("files/create_folder", e, "user", "api", "rpc");
            },
            filesCreateFolderV2: function(e) {
                return this.request("files/create_folder_v2", e, "user", "api", "rpc");
            },
            filesDelete: function(e) {
                return this.request("files/delete", e, "user", "api", "rpc");
            },
            filesDeleteBatch: function(e) {
                return this.request("files/delete_batch", e, "user", "api", "rpc");
            },
            filesDeleteBatchCheck: function(e) {
                return this.request("files/delete_batch/check", e, "user", "api", "rpc");
            },
            filesDeleteV2: function(e) {
                return this.request("files/delete_v2", e, "user", "api", "rpc");
            },
            filesDownload: function(e) {
                return this.request("files/download", e, "user", "content", "download");
            },
            filesDownloadZip: function(e) {
                return this.request("files/download_zip", e, "user", "content", "download");
            },
            filesGetMetadata: function(e) {
                return this.request("files/get_metadata", e, "user", "api", "rpc");
            },
            filesGetPreview: function(e) {
                return this.request("files/get_preview", e, "user", "content", "download");
            },
            filesGetTemporaryLink: function(e) {
                return this.request("files/get_temporary_link", e, "user", "api", "rpc");
            },
            filesGetThumbnail: function(e) {
                return this.request("files/get_thumbnail", e, "user", "content", "download");
            },
            filesGetThumbnailBatch: function(e) {
                return this.request("files/get_thumbnail_batch", e, "user", "content", "rpc");
            },
            filesListFolder: function(e) {
                return this.request("files/list_folder", e, "user", "api", "rpc");
            },
            filesListFolderContinue: function(e) {
                return this.request("files/list_folder/continue", e, "user", "api", "rpc");
            },
            filesListFolderGetLatestCursor: function(e) {
                return this.request("files/list_folder/get_latest_cursor", e, "user", "api", "rpc");
            },
            filesListFolderLongpoll: function(e) {
                return this.request("files/list_folder/longpoll", e, "noauth", "notify", "rpc");
            },
            filesListRevisions: function(e) {
                return this.request("files/list_revisions", e, "user", "api", "rpc");
            },
            filesMove: function(e) {
                return this.request("files/move", e, "user", "api", "rpc");
            },
            filesMoveBatch: function(e) {
                return this.request("files/move_batch", e, "user", "api", "rpc");
            },
            filesMoveBatchCheck: function(e) {
                return this.request("files/move_batch/check", e, "user", "api", "rpc");
            },
            filesMoveV2: function(e) {
                return this.request("files/move_v2", e, "user", "api", "rpc");
            },
            filesPermanentlyDelete: function(e) {
                return this.request("files/permanently_delete", e, "user", "api", "rpc");
            },
            filesPropertiesAdd: function(e) {
                return this.request("files/properties/add", e, "user", "api", "rpc");
            },
            filesPropertiesOverwrite: function(e) {
                return this.request("files/properties/overwrite", e, "user", "api", "rpc");
            },
            filesPropertiesRemove: function(e) {
                return this.request("files/properties/remove", e, "user", "api", "rpc");
            },
            filesPropertiesTemplateGet: function(e) {
                return this.request("files/properties/template/get", e, "user", "api", "rpc");
            },
            filesPropertiesTemplateList: function(e) {
                return this.request("files/properties/template/list", e, "user", "api", "rpc");
            },
            filesPropertiesUpdate: function(e) {
                return this.request("files/properties/update", e, "user", "api", "rpc");
            },
            filesRestore: function(e) {
                return this.request("files/restore", e, "user", "api", "rpc");
            },
            filesSaveUrl: function(e) {
                return this.request("files/save_url", e, "user", "api", "rpc");
            },
            filesSaveUrlCheckJobStatus: function(e) {
                return this.request("files/save_url/check_job_status", e, "user", "api", "rpc");
            },
            filesSearch: function(e) {
                return this.request("files/search", e, "user", "api", "rpc");
            },
            filesUpload: function(e) {
                return this.request("files/upload", e, "user", "content", "upload");
            },
            filesUploadSessionAppend: function(e) {
                return this.request("files/upload_session/append", e, "user", "content", "upload");
            },
            filesUploadSessionAppendV2: function(e) {
                return this.request("files/upload_session/append_v2", e, "user", "content", "upload");
            },
            filesUploadSessionFinish: function(e) {
                return this.request("files/upload_session/finish", e, "user", "content", "upload");
            },
            filesUploadSessionFinishBatch: function(e) {
                return this.request("files/upload_session/finish_batch", e, "user", "api", "rpc");
            },
            filesUploadSessionFinishBatchCheck: function(e) {
                return this.request("files/upload_session/finish_batch/check", e, "user", "api", "rpc");
            },
            filesUploadSessionStart: function(e) {
                return this.request("files/upload_session/start", e, "user", "content", "upload");
            },
            paperDocsArchive: function(e) {
                return this.request("paper/docs/archive", e, "user", "api", "rpc");
            },
            paperDocsCreate: function(e) {
                return this.request("paper/docs/create", e, "user", "api", "upload");
            },
            paperDocsDownload: function(e) {
                return this.request("paper/docs/download", e, "user", "api", "download");
            },
            paperDocsFolderUsersList: function(e) {
                return this.request("paper/docs/folder_users/list", e, "user", "api", "rpc");
            },
            paperDocsFolderUsersListContinue: function(e) {
                return this.request("paper/docs/folder_users/list/continue", e, "user", "api", "rpc");
            },
            paperDocsGetFolderInfo: function(e) {
                return this.request("paper/docs/get_folder_info", e, "user", "api", "rpc");
            },
            paperDocsList: function(e) {
                return this.request("paper/docs/list", e, "user", "api", "rpc");
            },
            paperDocsListContinue: function(e) {
                return this.request("paper/docs/list/continue", e, "user", "api", "rpc");
            },
            paperDocsPermanentlyDelete: function(e) {
                return this.request("paper/docs/permanently_delete", e, "user", "api", "rpc");
            },
            paperDocsSharingPolicyGet: function(e) {
                return this.request("paper/docs/sharing_policy/get", e, "user", "api", "rpc");
            },
            paperDocsSharingPolicySet: function(e) {
                return this.request("paper/docs/sharing_policy/set", e, "user", "api", "rpc");
            },
            paperDocsUpdate: function(e) {
                return this.request("paper/docs/update", e, "user", "api", "upload");
            },
            paperDocsUsersAdd: function(e) {
                return this.request("paper/docs/users/add", e, "user", "api", "rpc");
            },
            paperDocsUsersList: function(e) {
                return this.request("paper/docs/users/list", e, "user", "api", "rpc");
            },
            paperDocsUsersListContinue: function(e) {
                return this.request("paper/docs/users/list/continue", e, "user", "api", "rpc");
            },
            paperDocsUsersRemove: function(e) {
                return this.request("paper/docs/users/remove", e, "user", "api", "rpc");
            },
            sharingAddFileMember: function(e) {
                return this.request("sharing/add_file_member", e, "user", "api", "rpc");
            },
            sharingAddFolderMember: function(e) {
                return this.request("sharing/add_folder_member", e, "user", "api", "rpc");
            },
            sharingChangeFileMemberAccess: function(e) {
                return this.request("sharing/change_file_member_access", e, "user", "api", "rpc");
            },
            sharingCheckJobStatus: function(e) {
                return this.request("sharing/check_job_status", e, "user", "api", "rpc");
            },
            sharingCheckRemoveMemberJobStatus: function(e) {
                return this.request("sharing/check_remove_member_job_status", e, "user", "api", "rpc");
            },
            sharingCheckShareJobStatus: function(e) {
                return this.request("sharing/check_share_job_status", e, "user", "api", "rpc");
            },
            sharingCreateSharedLink: function(e) {
                return this.request("sharing/create_shared_link", e, "user", "api", "rpc");
            },
            sharingCreateSharedLinkWithSettings: function(e) {
                return this.request("sharing/create_shared_link_with_settings", e, "user", "api", "rpc");
            },
            sharingGetFileMetadata: function(e) {
                return this.request("sharing/get_file_metadata", e, "user", "api", "rpc");
            },
            sharingGetFileMetadataBatch: function(e) {
                return this.request("sharing/get_file_metadata/batch", e, "user", "api", "rpc");
            },
            sharingGetFolderMetadata: function(e) {
                return this.request("sharing/get_folder_metadata", e, "user", "api", "rpc");
            },
            sharingGetSharedLinkFile: function(e) {
                return this.request("sharing/get_shared_link_file", e, "user", "content", "download");
            },
            sharingGetSharedLinkMetadata: function(e) {
                return this.request("sharing/get_shared_link_metadata", e, "user", "api", "rpc");
            },
            sharingGetSharedLinks: function(e) {
                return this.request("sharing/get_shared_links", e, "user", "api", "rpc");
            },
            sharingListFileMembers: function(e) {
                return this.request("sharing/list_file_members", e, "user", "api", "rpc");
            },
            sharingListFileMembersBatch: function(e) {
                return this.request("sharing/list_file_members/batch", e, "user", "api", "rpc");
            },
            sharingListFileMembersContinue: function(e) {
                return this.request("sharing/list_file_members/continue", e, "user", "api", "rpc");
            },
            sharingListFolderMembers: function(e) {
                return this.request("sharing/list_folder_members", e, "user", "api", "rpc");
            },
            sharingListFolderMembersContinue: function(e) {
                return this.request("sharing/list_folder_members/continue", e, "user", "api", "rpc");
            },
            sharingListFolders: function(e) {
                return this.request("sharing/list_folders", e, "user", "api", "rpc");
            },
            sharingListFoldersContinue: function(e) {
                return this.request("sharing/list_folders/continue", e, "user", "api", "rpc");
            },
            sharingListMountableFolders: function(e) {
                return this.request("sharing/list_mountable_folders", e, "user", "api", "rpc");
            },
            sharingListMountableFoldersContinue: function(e) {
                return this.request("sharing/list_mountable_folders/continue", e, "user", "api", "rpc");
            },
            sharingListReceivedFiles: function(e) {
                return this.request("sharing/list_received_files", e, "user", "api", "rpc");
            },
            sharingListReceivedFilesContinue: function(e) {
                return this.request("sharing/list_received_files/continue", e, "user", "api", "rpc");
            },
            sharingListSharedLinks: function(e) {
                return this.request("sharing/list_shared_links", e, "user", "api", "rpc");
            },
            sharingModifySharedLinkSettings: function(e) {
                return this.request("sharing/modify_shared_link_settings", e, "user", "api", "rpc");
            },
            sharingMountFolder: function(e) {
                return this.request("sharing/mount_folder", e, "user", "api", "rpc");
            },
            sharingRelinquishFileMembership: function(e) {
                return this.request("sharing/relinquish_file_membership", e, "user", "api", "rpc");
            },
            sharingRelinquishFolderMembership: function(e) {
                return this.request("sharing/relinquish_folder_membership", e, "user", "api", "rpc");
            },
            sharingRemoveFileMember: function(e) {
                return this.request("sharing/remove_file_member", e, "user", "api", "rpc");
            },
            sharingRemoveFileMember2: function(e) {
                return this.request("sharing/remove_file_member_2", e, "user", "api", "rpc");
            },
            sharingRemoveFolderMember: function(e) {
                return this.request("sharing/remove_folder_member", e, "user", "api", "rpc");
            },
            sharingRevokeSharedLink: function(e) {
                return this.request("sharing/revoke_shared_link", e, "user", "api", "rpc");
            },
            sharingShareFolder: function(e) {
                return this.request("sharing/share_folder", e, "user", "api", "rpc");
            },
            sharingTransferFolder: function(e) {
                return this.request("sharing/transfer_folder", e, "user", "api", "rpc");
            },
            sharingUnmountFolder: function(e) {
                return this.request("sharing/unmount_folder", e, "user", "api", "rpc");
            },
            sharingUnshareFile: function(e) {
                return this.request("sharing/unshare_file", e, "user", "api", "rpc");
            },
            sharingUnshareFolder: function(e) {
                return this.request("sharing/unshare_folder", e, "user", "api", "rpc");
            },
            sharingUpdateFileMember: function(e) {
                return this.request("sharing/update_file_member", e, "user", "api", "rpc");
            },
            sharingUpdateFolderMember: function(e) {
                return this.request("sharing/update_folder_member", e, "user", "api", "rpc");
            },
            sharingUpdateFolderPolicy: function(e) {
                return this.request("sharing/update_folder_policy", e, "user", "api", "rpc");
            },
            teamLogGetEvents: function(e) {
                return this.request("team_log/get_events", e, "team", "api", "rpc");
            },
            teamLogGetEventsContinue: function(e) {
                return this.request("team_log/get_events/continue", e, "team", "api", "rpc");
            },
            usersGetAccount: function(e) {
                return this.request("users/get_account", e, "user", "api", "rpc");
            },
            usersGetAccountBatch: function(e) {
                return this.request("users/get_account_batch", e, "user", "api", "rpc");
            },
            usersGetCurrentAccount: function(e) {
                return this.request("users/get_current_account", e, "user", "api", "rpc");
            },
            usersGetSpaceUsage: function(e) {
                return this.request("users/get_space_usage", e, "user", "api", "rpc");
            }
        };
        e.exports = r;
    }, function(e, t, r) {
        var n = r(2), i = r(1).Promise, s = r(3);
        e.exports = function(e, t, r, u, a, c) {
            return new i(function(i, p) {
                var d;
                switch (t = t || null, d = n.post(s(u) + e).type("application/json"), r) {
                  case "team":
                  case "user":
                    d.set("Authorization", "Bearer " + a);
                    break;

                  case "noauth":
                    break;

                  default:
                    throw new Error("Unhandled auth type: " + r);
                }
                (d = c ? d.set("Dropbox-API-Select-User", c) : d).send(t).end(function(e, t) {
                    e ? function(e) {
                        p && p(e);
                    }(function(e, t) {
                        var r;
                        if (t) try {
                            r = JSON.parse(t.text);
                        } catch (e) {
                            r = t.text;
                        }
                        return {
                            status: e.status,
                            error: r || e,
                            response: t
                        };
                    }(e, t)) : function(e) {
                        i && i(e);
                    }(t.body);
                });
            });
        };
    }, function(e, t, r) {
        var n = r(2), i = r(1).Promise, s = r(3), o = r(5);
        e.exports = function(e, t, r, a, c, p) {
            if ("user" !== r) throw new Error("Unexpected auth type: " + r);
            return new i(function(r, i) {
                var d, _ = t.contents;
                delete t.contents, d = n.post(s(a) + e).type("application/octet-stream").set("Authorization", "Bearer " + c).set("Dropbox-API-Arg", o(t)), 
                (d = p ? d.set("Dropbox-API-Select-User", p) : d).send(_).end(function(e, t) {
                    e ? function(e) {
                        i && i(e);
                    }(function(e, t) {
                        return {
                            status: e.status,
                            error: (t ? t.text : null) || e.toString(),
                            response: t
                        };
                    }(e, t)) : function(e) {
                        r && r(e);
                    }(t.body);
                });
            });
        };
    }, function(e, t) {} ], r = {}, t.m = e, t.c = r, t.p = "", t(0);
    function t(n) {
        if (r[n]) return r[n].exports;
        var i = r[n] = {
            exports: {},
            id: n,
            loaded: !1
        };
        return e[n].call(i.exports, i, i.exports, t), i.loaded = !0, i.exports;
    }
    var e, r;
}), function(q, u, c) {
    function v(a, b, g) {
        a.addEventListener ? a.addEventListener(b, g, !1) : a.attachEvent("on" + b, g);
    }
    function z(a) {
        if ("keypress" != a.type) return n[a.which] || r[a.which] || String.fromCharCode(a.which).toLowerCase();
        var b = String.fromCharCode(a.which);
        return b = !a.shiftKey ? b.toLowerCase() : b;
    }
    function w(a) {
        return "shift" == a || "ctrl" == a || "alt" == a || "meta" == a;
    }
    function A(a, b) {
        for (var d = [], e = "+" === (e = a) ? [ "+" ] : (e = e.replace(/\+{2}/g, "+plus")).split("+"), g = 0; g < e.length; ++g) {
            var m = e[g];
            B[m] && (m = B[m]), b && "keypress" != b && C[m] && (m = C[m], d.push("shift")), 
            w(m) && d.push(m);
        }
        if (e = m, !(g = b)) {
            if (!p) for (var c in p = {}, n) 95 < c && c < 112 || n.hasOwnProperty(c) && (p[n[c]] = c);
            g = p[e] ? "keydown" : "keypress";
        }
        return {
            key: m,
            modifiers: d,
            action: g = "keypress" == g && d.length ? "keydown" : g
        };
    }
    function d(a) {
        function b(a) {
            a = a || {};
            var l, b = !1;
            for (l in p) a[l] ? b = !0 : p[l] = 0;
            b || (x = !1);
        }
        function g(a, b, t, f, g, d) {
            var l, E = [], h = t.type;
            if (!k._callbacks[a]) return [];
            for ("keyup" == h && w(a) && (b = [ a ]), l = 0; l < k._callbacks[a].length; ++l) {
                var e, c = k._callbacks[a][l];
                !f && c.seq && p[c.seq] != c.level || h != c.action || ((e = "keypress" == h && !t.metaKey && !t.ctrlKey) || (e = c.modifiers, 
                e = b.sort().join(",") === e.sort().join(",")), e && (e = f && c.seq == f && c.level == d, 
                (!f && c.combo == g || e) && k._callbacks[a].splice(l, 1), E.push(c)));
            }
            return E;
        }
        function c(a, b, c, f) {
            k.stopCallback(b, b.target || b.srcElement, c, f) || !1 !== a(b, c) || (b.preventDefault ? b.preventDefault() : b.returnValue = !1, 
            b.stopPropagation ? b.stopPropagation() : b.cancelBubble = !0);
        }
        function e(a) {
            "number" != typeof a.which && (a.which = a.keyCode);
            var b = z(a);
            b && ("keyup" == a.type && y === b ? y = !1 : k.handleKey(b, function(a) {
                var b = [];
                return a.shiftKey && b.push("shift"), a.altKey && b.push("alt"), a.ctrlKey && b.push("ctrl"), 
                a.metaKey && b.push("meta"), b;
            }(a), a));
        }
        function m(a, g, t, f) {
            function l(g) {
                c(t, g, a), "keyup" !== f && (y = z(g)), setTimeout(b, 10);
            }
            for (var d = p[a] = 0; d < g.length; ++d) {
                var e = d + 1 === g.length ? l : function(c) {
                    return function() {
                        x = c, ++p[a], clearTimeout(q), q = setTimeout(b, 1e3);
                    };
                }(f || A(g[d + 1]).action);
                n(g[d], e, f, a, d);
            }
        }
        function n(a, b, c, f, d) {
            k._directMap[a + ":" + c] = b;
            var e = (a = a.replace(/\s+/g, " ")).split(" ");
            1 < e.length ? m(a, e, b, c) : (c = A(a, c), k._callbacks[c.key] = k._callbacks[c.key] || [], 
            g(c.key, c.modifiers, {
                type: c.action
            }, f, a, d), k._callbacks[c.key][f ? "unshift" : "push"]({
                callback: b,
                modifiers: c.modifiers,
                action: c.action,
                seq: f,
                level: d,
                combo: a
            }));
        }
        var k = this;
        if (a = a || u, !(k instanceof d)) return new d(a);
        k.target = a, k._callbacks = {}, k._directMap = {};
        var q, p = {}, y = !1, r = !1, x = !1;
        k._handleKey = function(a, d, e) {
            for (var f = g(a, d, e), k = 0, l = !(d = {}), h = 0; h < f.length; ++h) f[h].seq && (k = Math.max(k, f[h].level));
            for (h = 0; h < f.length; ++h) f[h].seq ? f[h].level == k && (l = !0, d[f[h].seq] = 1, 
            c(f[h].callback, e, f[h].combo, f[h].seq)) : l || c(f[h].callback, e, f[h].combo);
            f = "keypress" == e.type && r, e.type != x || w(a) || f || b(d), r = l && "keydown" == e.type;
        }, k._bindMultiple = function(a, b, c) {
            for (var d = 0; d < a.length; ++d) n(a[d], b, c);
        }, v(a, "keypress", e), v(a, "keydown", e), v(a, "keyup", e);
    }
    if (q) {
        var p, n = {
            8: "backspace",
            9: "tab",
            13: "enter",
            16: "shift",
            17: "ctrl",
            18: "alt",
            20: "capslock",
            27: "esc",
            32: "space",
            33: "pageup",
            34: "pagedown",
            35: "end",
            36: "home",
            37: "left",
            38: "up",
            39: "right",
            40: "down",
            45: "ins",
            46: "del",
            91: "meta",
            93: "meta",
            224: "meta"
        }, r = {
            106: "*",
            107: "+",
            109: "-",
            110: ".",
            111: "/",
            186: ";",
            187: "=",
            188: ",",
            189: "-",
            190: ".",
            191: "/",
            192: "`",
            219: "[",
            220: "\\",
            221: "]",
            222: "'"
        }, C = {
            "~": "`",
            "!": "1",
            "@": "2",
            "#": "3",
            $: "4",
            "%": "5",
            "^": "6",
            "&": "7",
            "*": "8",
            "(": "9",
            ")": "0",
            _: "-",
            "+": "=",
            ":": ";",
            '"': "'",
            "<": ",",
            ">": ".",
            "?": "/",
            "|": "\\"
        }, B = {
            option: "alt",
            command: "meta",
            return: "enter",
            escape: "esc",
            plus: "+",
            mod: /Mac|iPod|iPhone|iPad/.test(navigator.platform) ? "meta" : "ctrl"
        };
        for (c = 1; c < 20; ++c) n[111 + c] = "f" + c;
        for (c = 0; c <= 9; ++c) n[c + 96] = c.toString();
        d.prototype.bind = function(a, b, c) {
            return a = a instanceof Array ? a : [ a ], this._bindMultiple.call(this, a, b, c), 
            this;
        }, d.prototype.unbind = function(a, b) {
            return this.bind.call(this, a, function() {}, b);
        }, d.prototype.trigger = function(a, b) {
            return this._directMap[a + ":" + b] && this._directMap[a + ":" + b]({}, a), this;
        }, d.prototype.reset = function() {
            return this._callbacks = {}, this._directMap = {}, this;
        }, d.prototype.stopCallback = function(a, b) {
            return !(-1 < (" " + b.className + " ").indexOf(" mousetrap ") || function D(a, b) {
                return null !== a && a !== u && (a === b || D(a.parentNode, b));
            }(b, this.target)) && ("composedPath" in a && "function" == typeof a.composedPath && ((c = a.composedPath()[0]) !== a.target && (b = c)), 
            "INPUT" == b.tagName || "SELECT" == b.tagName || "TEXTAREA" == b.tagName || b.isContentEditable);
            var c;
        }, d.prototype.handleKey = function() {
            return this._handleKey.apply(this, arguments);
        }, d.addKeycodes = function(a) {
            for (var b in a) a.hasOwnProperty(b) && (n[b] = a[b]);
            p = null;
        }, (d.init = function() {
            var b, a = d(u);
            for (b in a) "_" !== b.charAt(0) && (d[b] = function(b) {
                return function() {
                    return a[b].apply(a, arguments);
                };
            }(b));
        })(), q.Mousetrap = d, "undefined" != typeof module && module.exports && (module.exports = d), 
        "function" == typeof define && define.amd && define(function() {
            return d;
        });
    }
}("undefined" != typeof window ? window : null, "undefined" != typeof window ? document : null);

var Typo = function(dictionary, affData, wordsData, path) {
    if (this.platform = (path = path || {}).platform || "chrome", this.dictionary = null, 
    this.rules = {}, this.dictionaryTable = {}, this.compoundRules = [], this.compoundRuleCodes = {}, 
    this.replacementTable = [], this.flags = path.flags || {}, dictionary) {
        this.dictionary = dictionary, wordsData = "chrome" == this.platform ? (affData = affData || this._readFile(chrome.extension.getURL("lib/typo/dictionaries/" + dictionary + "/" + dictionary + ".aff")), 
        wordsData || this._readFile(chrome.extension.getURL("lib/typo/dictionaries/" + dictionary + "/" + dictionary + ".dic"))) : (path = path.dictionaryPath || "", 
        affData = affData || this._readFile(path + "/" + dictionary + "/" + dictionary + ".aff"), 
        wordsData || this._readFile(path + "/" + dictionary + "/" + dictionary + ".dic")), 
        this.rules = this._parseAFF(affData), this.compoundRuleCodes = {};
        for (var i = 0, _len = this.compoundRules.length; i < _len; i++) for (var rule = this.compoundRules[i], j = 0, _jlen = rule.length; j < _jlen; j++) this.compoundRuleCodes[rule[j]] = [];
        for (i in "ONLYINCOMPOUND" in this.flags && (this.compoundRuleCodes[this.flags.ONLYINCOMPOUND] = []), 
        this.dictionaryTable = this._parseDIC(wordsData), this.compoundRuleCodes) 0 == this.compoundRuleCodes[i].length && delete this.compoundRuleCodes[i];
        for (i = 0, _len = this.compoundRules.length; i < _len; i++) {
            for (var ruleText = this.compoundRules[i], expressionText = "", j = 0, _jlen = ruleText.length; j < _jlen; j++) {
                var character = ruleText[j];
                character in this.compoundRuleCodes ? expressionText += "(" + this.compoundRuleCodes[character].join("|") + ")" : expressionText += character;
            }
            this.compoundRules[i] = new RegExp(expressionText, "i");
        }
    }
    return this;
};

Typo.prototype = {
    load: function(obj) {
        for (var i in obj) this[i] = obj[i];
        return this;
    },
    _readFile: function(path, charset) {
        charset = charset || "ISO8859-1";
        var req = new XMLHttpRequest();
        return req.open("GET", path, !1), req.overrideMimeType && req.overrideMimeType("text/plain; charset=" + charset), 
        req.send(null), req.responseText;
    },
    _parseAFF: function(data) {
        for (var rules = {}, lines = (data = this._removeAffixComments(data)).split("\n"), i = 0, _len = lines.length; i < _len; i++) {
            var definitionParts = (line = lines[i]).split(/\s+/), ruleType = definitionParts[0];
            if ("PFX" == ruleType || "SFX" == ruleType) {
                for (var ruleCode = definitionParts[1], combineable = definitionParts[2], entries = [], j = i + 1, _jlen = i + 1 + (numEntries = parseInt(definitionParts[3], 10)); j < _jlen; j++) {
                    var charactersToRemove = (lineParts = (line = lines[j]).split(/\s+/))[2], entry = lineParts[3].split("/"), charactersToAdd = entry[0];
                    "0" === charactersToAdd && (charactersToAdd = "");
                    var continuationClasses = this.parseRuleCodes(entry[1]), regexToMatch = lineParts[4], entry = {};
                    entry.add = charactersToAdd, 0 < continuationClasses.length && (entry.continuationClasses = continuationClasses), 
                    "." !== regexToMatch && (entry.match = "SFX" === ruleType ? new RegExp(regexToMatch + "$") : new RegExp("^" + regexToMatch)), 
                    "0" != charactersToRemove && (entry.remove = "SFX" === ruleType ? new RegExp(charactersToRemove + "$") : charactersToRemove), 
                    entries.push(entry);
                }
                rules[ruleCode] = {
                    type: ruleType,
                    combineable: "Y" == combineable,
                    entries: entries
                }, i += numEntries;
            } else if ("COMPOUNDRULE" === ruleType) {
                for (var numEntries, j = i + 1, _jlen = i + 1 + (numEntries = parseInt(definitionParts[1], 10)); j < _jlen; j++) {
                    var line, lineParts = (line = lines[j]).split(/\s+/);
                    this.compoundRules.push(lineParts[1]);
                }
                i += numEntries;
            } else "REP" === ruleType ? 3 === (lineParts = line.split(/\s+/)).length && this.replacementTable.push([ lineParts[1], lineParts[2] ]) : this.flags[ruleType] = definitionParts[1];
        }
        return rules;
    },
    _removeAffixComments: function(data) {
        return data = (data = (data = (data = data.replace(/#.*$/gm, "")).replace(/^\s\s*/m, "").replace(/\s\s*$/m, "")).replace(/\n{2,}/g, "\n")).replace(/^\s\s*/, "").replace(/\s\s*$/, "");
    },
    _parseDIC: function(data) {
        var lines = (data = this._removeDicComments(data)).split("\n"), dictionaryTable = {};
        function addWord(word, rules) {
            word in dictionaryTable && "object" == typeof dictionaryTable[word] || (dictionaryTable[word] = []), 
            dictionaryTable[word].push(rules);
        }
        for (var i = 1, _len = lines.length; i < _len; i++) {
            var parts = lines[i].split("/", 2), word = parts[0];
            if (1 < parts.length) {
                var ruleCodesArray = this.parseRuleCodes(parts[1]);
                "NEEDAFFIX" in this.flags && -1 != ruleCodesArray.indexOf(this.flags.NEEDAFFIX) || addWord(word, ruleCodesArray);
                for (var j = 0, _jlen = ruleCodesArray.length; j < _jlen; j++) {
                    var code = ruleCodesArray[j], rule = this.rules[code];
                    if (rule) for (var newWords = this._applyRule(word, rule), ii = 0, _iilen = newWords.length; ii < _iilen; ii++) {
                        var newWord = newWords[ii];
                        if (addWord(newWord, []), rule.combineable) for (var k = j + 1; k < _jlen; k++) {
                            var combineRule = ruleCodesArray[k], combineRule = this.rules[combineRule];
                            if (combineRule && combineRule.combineable && rule.type != combineRule.type) for (var otherNewWords = this._applyRule(newWord, combineRule), iii = 0, _iiilen = otherNewWords.length; iii < _iiilen; iii++) addWord(otherNewWords[iii], []);
                        }
                    }
                    code in this.compoundRuleCodes && this.compoundRuleCodes[code].push(word);
                }
            } else addWord(word, []);
        }
        return dictionaryTable;
    },
    _removeDicComments: function(data) {
        return data = data.replace(/^\t.*$/gm, "");
    },
    parseRuleCodes: function(textCodes) {
        if (textCodes) {
            if (!("FLAG" in this.flags)) return textCodes.split("");
            if ("long" !== this.flags.FLAG) return "num" === this.flags.FLAG ? textCode.split(",") : void 0;
            for (var flags = [], i = 0, _len = textCodes.length; i < _len; i += 2) flags.push(textCodes.substr(i, 2));
            return flags;
        }
        return [];
    },
    _applyRule: function(word, rule) {
        for (var entries = rule.entries, newWords = [], i = 0, _len = entries.length; i < _len; i++) {
            var entry = entries[i];
            if (!entry.match || word.match(entry.match)) {
                var newWord = word;
                if (entry.remove && (newWord = newWord.replace(entry.remove, "")), "SFX" === rule.type ? newWord += entry.add : newWord = entry.add + newWord, 
                newWords.push(newWord), "continuationClasses" in entry) for (var j = 0, _jlen = entry.continuationClasses.length; j < _jlen; j++) {
                    var continuationRule = this.rules[entry.continuationClasses[j]];
                    continuationRule && (newWords = newWords.concat(this._applyRule(newWord, continuationRule)));
                }
            }
        }
        return newWords;
    },
    check: function(trimmedWord) {
        trimmedWord = trimmedWord.replace(/^\s\s*/, "").replace(/\s\s*$/, "");
        if (this.checkExact(trimmedWord)) return !0;
        if (trimmedWord.toUpperCase() === trimmedWord) {
            var lowercaseWord = trimmedWord[0] + trimmedWord.substring(1).toLowerCase();
            if (this.hasFlag(lowercaseWord, "KEEPCASE")) return !1;
            if (this.checkExact(lowercaseWord)) return !0;
        }
        lowercaseWord = trimmedWord.toLowerCase();
        if (lowercaseWord !== trimmedWord) {
            if (this.hasFlag(lowercaseWord, "KEEPCASE")) return !1;
            if (this.checkExact(lowercaseWord)) return !0;
        }
        return !1;
    },
    checkExact: function(word) {
        var ruleCodes = this.dictionaryTable[word];
        if (void 0 === ruleCodes) {
            if ("COMPOUNDMIN" in this.flags && word.length >= this.flags.COMPOUNDMIN) for (var i = 0, _len = this.compoundRules.length; i < _len; i++) if (word.match(this.compoundRules[i])) return !0;
            return !1;
        }
        for (i = 0, _len = ruleCodes.length; i < _len; i++) if (!this.hasFlag(word, "ONLYINCOMPOUND", ruleCodes[i])) return !0;
        return !1;
    },
    hasFlag: function(word, flag, wordFlags) {
        if (flag in this.flags && ((wordFlags = void 0 === wordFlags ? Array.prototype.concat.apply([], this.dictionaryTable[word]) : wordFlags) && -1 !== wordFlags.indexOf(this.flags[flag]))) return !0;
        return !1;
    },
    alphabet: "",
    suggest: function(word, limit, callback) {
        if (limit = limit || 5, this.check(word)) callback([]); else {
            for (var i = 0, _len = this.replacementTable.length; i < _len; i++) {
                var correctedWord = this.replacementTable[i];
                if (-1 !== word.indexOf(correctedWord[0])) {
                    correctedWord = word.replace(correctedWord[0], correctedWord[1]);
                    if (this.check(correctedWord)) return void callback([ correctedWord ]);
                }
            }
            var self = this;
            self.alphabet = "abcdefghijklmnopqrstuvwxyz", function(word, callback) {
                edits1([ word ], function(ed1) {
                    edits1(ed1, function(ed2) {
                        for (var corrections = known(ed1).concat(known(ed2)), weighted_corrections = {}, i = 0, _len = corrections.length; i < _len; i++) corrections[i] in weighted_corrections ? weighted_corrections[corrections[i]] += 1 : weighted_corrections[corrections[i]] = 1;
                        var sorted_corrections = [];
                        for (i in weighted_corrections) sorted_corrections.push([ i, weighted_corrections[i] ]);
                        sorted_corrections.sort(function(a, b) {
                            return a[1] < b[1] ? -1 : 1;
                        }).reverse();
                        for (var rv = [], i = 0, _len = Math.min(limit, sorted_corrections.length); i < _len; i++) self.hasFlag(sorted_corrections[i][0], "NOSUGGEST") || rv.push(sorted_corrections[i][0]);
                        callback(rv);
                    });
                });
            }(word, function(rv) {
                callback(rv);
            });
        }
        function edits1(words, callback) {
            for (var rv = [], workers = [], workersCompleted = [], i = 0; i < 4; ++i) {
                var worker = new Worker("lib/typo/wordprocessor.js");
                worker.addEventListener("message", function(index) {
                    return function(e) {
                        rv = rv.concat(e.data), workersCompleted[index] = !0, this.terminate(), function() {
                            for (var i = 0; i < 4; ++i) if (!workersCompleted[i]) return;
                            callback(rv);
                        }();
                    };
                }(i)), workers.push(worker), workersCompleted.push(!1);
            }
            for (var sliceSize = words.length / 4, i = 0; i < 4; ++i) 3 != i ? workers[i].postMessage(words.slice(sliceSize * i, sliceSize * (i + 1))) : workers[i].postMessage(words.slice(sliceSize * i));
        }
        function known(words) {
            for (var rv = [], i = 0; i < words.length; i++) self.check(words[i]) && rv.push(words[i]);
            return rv;
        }
    }
}, function(n) {
    var v = this || (0, eval)("this"), y = v.document, L = v.navigator, r = v.jQuery, D = v.JSON;
    !function(n) {
        "function" == typeof require && "object" == typeof exports && "object" == typeof module ? n(module.exports || exports, require) : "function" == typeof define && define.amd ? define([ "exports", "require" ], n) : n(v.ko = {});
    }(function(B, N) {
        function H(a, d) {
            return (null === a || typeof a in Q) && a === d;
        }
        function R(a, d) {
            var c;
            return function() {
                c = c || setTimeout(function() {
                    c = n, a();
                }, d);
            };
        }
        function S(a, d) {
            var c;
            return function() {
                clearTimeout(c), c = setTimeout(a, d);
            };
        }
        function I(b, d, c, e) {
            a.d[b] = {
                init: function(b, h, k, g, m) {
                    var l, s;
                    return a.s(function() {
                        var g = a.a.c(h()), k = !c != !g, z = !s;
                        (z || d || k !== l) && (z && a.Y.la() && (s = a.a.ia(a.f.childNodes(b), !0)), k ? (z || a.f.T(b, a.a.ia(s)), 
                        a.Ca(e ? e(m, g) : m, b)) : a.f.ja(b), l = k);
                    }, null, {
                        o: b
                    }), {
                        controlsDescendantBindings: !0
                    };
                }
            }, a.h.ha[b] = !1, a.f.Q[b] = !0;
        }
        var d, a = void 0 !== B ? B : {};
        a.b = function(b, d) {
            for (var c = b.split("."), e = a, f = 0; f < c.length - 1; f++) e = e[c[f]];
            e[c[c.length - 1]] = d;
        }, a.A = function(a, d, c) {
            a[d] = c;
        }, a.version = "3.2.0", a.b("version", a.version), a.a = function() {
            function b(a, b) {
                for (var c in a) a.hasOwnProperty(c) && b(c, a[c]);
            }
            function d(a, b) {
                if (b) for (var c in b) b.hasOwnProperty(c) && (a[c] = b[c]);
                return a;
            }
            function c(a, b) {
                return a.__proto__ = b, a;
            }
            var e = {
                __proto__: []
            } instanceof Array, f = {}, h = {};
            f[L && /Firefox\/2/i.test(L.userAgent) ? "KeyboardEvent" : "UIEvents"] = [ "keyup", "keydown", "keypress" ], 
            f.MouseEvents = "click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave".split(" "), 
            b(f, function(a, b) {
                if (b.length) for (var c = 0, d = b.length; c < d; c++) h[b[c]] = a;
            });
            var k = {
                propertychange: !0
            }, g = y && function() {
                for (var a = 3, b = y.createElement("div"), c = b.getElementsByTagName("i"); b.innerHTML = "\x3c!--[if gt IE " + ++a + "]><i></i><![endif]--\x3e", 
                c[0]; ) ;
                return 4 < a ? a : n;
            }();
            return {
                vb: [ "authenticity_token", /^__RequestVerificationToken(_.*)?$/ ],
                u: function(a, b) {
                    for (var c = 0, d = a.length; c < d; c++) b(a[c], c);
                },
                m: function(a, b) {
                    if ("function" == typeof Array.prototype.indexOf) return Array.prototype.indexOf.call(a, b);
                    for (var c = 0, d = a.length; c < d; c++) if (a[c] === b) return c;
                    return -1;
                },
                qb: function(a, b, c) {
                    for (var d = 0, g = a.length; d < g; d++) if (b.call(c, a[d], d)) return a[d];
                    return null;
                },
                ua: function(m, c) {
                    c = a.a.m(m, c);
                    0 < c ? m.splice(c, 1) : 0 === c && m.shift();
                },
                rb: function(m) {
                    for (var b = [], c = 0, d = (m = m || []).length; c < d; c++) a.a.m(b, m[c]) < 0 && b.push(m[c]);
                    return b;
                },
                Da: function(a, b) {
                    for (var c = [], d = 0, g = (a = a || []).length; d < g; d++) c.push(b(a[d], d));
                    return c;
                },
                ta: function(a, b) {
                    for (var c = [], d = 0, g = (a = a || []).length; d < g; d++) b(a[d], d) && c.push(a[d]);
                    return c;
                },
                ga: function(a, b) {
                    if (b instanceof Array) a.push.apply(a, b); else for (var c = 0, d = b.length; c < d; c++) a.push(b[c]);
                    return a;
                },
                ea: function(b, c, d) {
                    var g = a.a.m(a.a.Xa(b), c);
                    g < 0 ? d && b.push(c) : d || b.splice(g, 1);
                },
                xa: e,
                extend: d,
                za: c,
                Aa: e ? c : d,
                G: b,
                na: function(a, b) {
                    if (!a) return a;
                    var d, c = {};
                    for (d in a) a.hasOwnProperty(d) && (c[d] = b(a[d], d, a));
                    return c;
                },
                Ka: function(b) {
                    for (;b.firstChild; ) a.removeNode(b.firstChild);
                },
                oc: function(b) {
                    b = a.a.S(b);
                    for (var c = y.createElement("div"), d = 0, g = b.length; d < g; d++) c.appendChild(a.R(b[d]));
                    return c;
                },
                ia: function(b, c) {
                    for (var d = 0, g = b.length, e = []; d < g; d++) {
                        var f = b[d].cloneNode(!0);
                        e.push(c ? a.R(f) : f);
                    }
                    return e;
                },
                T: function(b, c) {
                    if (a.a.Ka(b), c) for (var d = 0, g = c.length; d < g; d++) b.appendChild(c[d]);
                },
                Lb: function(b, c) {
                    var d = b.nodeType ? [ b ] : b;
                    if (0 < d.length) {
                        for (var g = d[0], e = g.parentNode, f = 0, h = c.length; f < h; f++) e.insertBefore(c[f], g);
                        for (f = 0, h = d.length; f < h; f++) a.removeNode(d[f]);
                    }
                },
                ka: function(a, b) {
                    if (a.length) {
                        for (b = 8 === b.nodeType && b.parentNode || b; a.length && a[0].parentNode !== b; ) a.shift();
                        if (1 < a.length) {
                            var c = a[0], d = a[a.length - 1];
                            for (a.length = 0; c !== d; ) if (a.push(c), !(c = c.nextSibling)) return;
                            a.push(d);
                        }
                    }
                    return a;
                },
                Nb: function(a, b) {
                    g < 7 ? a.setAttribute("selected", b) : a.selected = b;
                },
                cb: function(a) {
                    return null === a || a === n ? "" : a.trim ? a.trim() : a.toString().replace(/^[\s\xa0]+|[\s\xa0]+$/g, "");
                },
                uc: function(a, b) {
                    return !(b.length > (a = a || "").length) && a.substring(0, b.length) === b;
                },
                cc: function(a, b) {
                    if (a === b) return !0;
                    if (11 === a.nodeType) return !1;
                    if (b.contains) return b.contains(3 === a.nodeType ? a.parentNode : a);
                    if (b.compareDocumentPosition) return 16 == (16 & b.compareDocumentPosition(a));
                    for (;a && a != b; ) a = a.parentNode;
                    return !!a;
                },
                Ja: function(b) {
                    return a.a.cc(b, b.ownerDocument.documentElement);
                },
                ob: function(b) {
                    return !!a.a.qb(b, a.a.Ja);
                },
                t: function(a) {
                    return a && a.tagName && a.tagName.toLowerCase();
                },
                n: function(b, c, d) {
                    var e = g && k[c];
                    if (!e && r) r(b).bind(c, d); else if (e || "function" != typeof b.addEventListener) {
                        if (void 0 === b.attachEvent) throw Error("Browser doesn't support addEventListener or attachEvent");
                        function f(a) {
                            d.call(b, a);
                        }
                        var h = "on" + c;
                        b.attachEvent(h, f), a.a.w.da(b, function() {
                            b.detachEvent(h, f);
                        });
                    } else b.addEventListener(c, d, !1);
                },
                oa: function(b, c) {
                    if (!b || !b.nodeType) throw Error("element must be a DOM node when calling triggerEvent");
                    var d = !("input" !== a.a.t(b) || !b.type || "click" != c.toLowerCase()) && ("checkbox" == (d = b.type) || "radio" == d);
                    if (r && !d) r(b).trigger(c); else if ("function" == typeof y.createEvent) {
                        if ("function" != typeof b.dispatchEvent) throw Error("The supplied element doesn't support dispatchEvent");
                        (d = y.createEvent(h[c] || "HTMLEvents")).initEvent(c, !0, !0, v, 0, 0, 0, 0, 0, !1, !1, !1, !1, 0, b), 
                        b.dispatchEvent(d);
                    } else if (d && b.click) b.click(); else {
                        if (void 0 === b.fireEvent) throw Error("Browser doesn't support triggering events");
                        b.fireEvent("on" + c);
                    }
                },
                c: function(b) {
                    return a.C(b) ? b() : b;
                },
                Xa: function(b) {
                    return a.C(b) ? b.v() : b;
                },
                Ba: function(b, c, d) {
                    var g, e;
                    c && (e = b.className.match(g = /\S+/g) || [], a.a.u(c.match(g), function(b) {
                        a.a.ea(e, b, d);
                    }), b.className = e.join(" "));
                },
                bb: function(b, g) {
                    var d = a.a.c(g);
                    null !== d && d !== n || (d = "");
                    g = a.f.firstChild(b);
                    !g || 3 != g.nodeType || a.f.nextSibling(g) ? a.f.T(b, [ b.ownerDocument.createTextNode(d) ]) : g.data = d, 
                    a.a.fc(b);
                },
                Mb: function(a, b) {
                    if (a.name = b, g <= 7) try {
                        a.mergeAttributes(y.createElement("<input name='" + a.name + "'/>"), !1);
                    } catch (c) {}
                },
                fc: function(a) {
                    9 <= g && ((a = 1 == a.nodeType ? a : a.parentNode).style && (a.style.zoom = a.style.zoom));
                },
                dc: function(a) {
                    var b;
                    g && (b = a.style.width, a.style.width = 0, a.style.width = b);
                },
                sc: function(b, c) {
                    b = a.a.c(b), c = a.a.c(c);
                    for (var d = [], g = b; g <= c; g++) d.push(g);
                    return d;
                },
                S: function(a) {
                    for (var b = [], c = 0, d = a.length; c < d; c++) b.push(a[c]);
                    return b;
                },
                xc: 6 === g,
                yc: 7 === g,
                L: g,
                xb: function(b, c) {
                    for (var d = a.a.S(b.getElementsByTagName("input")).concat(a.a.S(b.getElementsByTagName("textarea"))), g = "string" == typeof c ? function(a) {
                        return a.name === c;
                    } : function(a) {
                        return c.test(a.name);
                    }, e = [], f = d.length - 1; 0 <= f; f--) g(d[f]) && e.push(d[f]);
                    return e;
                },
                pc: function(b) {
                    return "string" == typeof b && (b = a.a.cb(b)) ? D && D.parse ? D.parse(b) : new Function("return " + b)() : null;
                },
                eb: function(b, c, d) {
                    if (!D || !D.stringify) throw Error("Cannot find JSON.stringify(). Some browsers (e.g., IE < 8) don't support it natively, but you can overcome this by adding a script reference to json2.js, downloadable from http://www.json.org/json2.js");
                    return D.stringify(a.a.c(b), c, d);
                },
                qc: function(c, d, g) {
                    var e = (g = g || {}).params || {}, f = g.includeFields || this.vb, h = c;
                    if ("object" == typeof c && "form" === a.a.t(c)) for (var h = c.action, k = f.length - 1; 0 <= k; k--) for (var t = a.a.xb(c, f[k]), E = t.length - 1; 0 <= E; E--) e[t[E].name] = t[E].value;
                    d = a.a.c(d);
                    var n, x = y.createElement("form");
                    for (n in x.style.display = "none", x.action = h, x.method = "post", d) c = y.createElement("input"), 
                    c.type = "hidden", c.name = n, c.value = a.a.eb(a.a.c(d[n])), x.appendChild(c);
                    b(e, function(a, b) {
                        var c = y.createElement("input");
                        c.type = "hidden", c.name = a, c.value = b, x.appendChild(c);
                    }), y.body.appendChild(x), g.submitter ? g.submitter(x) : x.submit(), setTimeout(function() {
                        x.parentNode.removeChild(x);
                    }, 0);
                }
            };
        }(), a.b("utils", a.a), a.b("utils.arrayForEach", a.a.u), a.b("utils.arrayFirst", a.a.qb), 
        a.b("utils.arrayFilter", a.a.ta), a.b("utils.arrayGetDistinctValues", a.a.rb), a.b("utils.arrayIndexOf", a.a.m), 
        a.b("utils.arrayMap", a.a.Da), a.b("utils.arrayPushAll", a.a.ga), a.b("utils.arrayRemoveItem", a.a.ua), 
        a.b("utils.extend", a.a.extend), a.b("utils.fieldsIncludedWithJsonPost", a.a.vb), 
        a.b("utils.getFormFields", a.a.xb), a.b("utils.peekObservable", a.a.Xa), a.b("utils.postJson", a.a.qc), 
        a.b("utils.parseJson", a.a.pc), a.b("utils.registerEventHandler", a.a.n), a.b("utils.stringifyJson", a.a.eb), 
        a.b("utils.range", a.a.sc), a.b("utils.toggleDomNodeCssClass", a.a.Ba), a.b("utils.triggerEvent", a.a.oa), 
        a.b("utils.unwrapObservable", a.a.c), a.b("utils.objectForEach", a.a.G), a.b("utils.addOrRemoveItem", a.a.ea), 
        a.b("unwrap", a.a.c), Function.prototype.bind || (Function.prototype.bind = function(a) {
            var d = this, c = Array.prototype.slice.call(arguments);
            return a = c.shift(), function() {
                return d.apply(a, c.concat(Array.prototype.slice.call(arguments)));
            };
        }), a.a.e = new function() {
            function a(b, h) {
                var k = b[c];
                if (!k || "null" === k || !e[k]) {
                    if (!h) return n;
                    k = b[c] = "ko" + d++, e[k] = {};
                }
                return e[k];
            }
            var d = 0, c = "__ko__" + new Date().getTime(), e = {};
            return {
                get: function(e, d) {
                    e = a(e, !1);
                    return e === n ? n : e[d];
                },
                set: function(c, d, e) {
                    e === n && a(c, !1) === n || (a(c, !0)[d] = e);
                },
                clear: function(a) {
                    var b = a[c];
                    return !!b && (delete e[b], !(a[c] = null));
                },
                F: function() {
                    return d++ + c;
                }
            };
        }(), a.b("utils.domData", a.a.e), a.b("utils.domData.clear", a.a.e.clear), a.a.w = new function() {
            function b(b, d) {
                var g = a.a.e.get(b, c);
                return g === n && d && a.a.e.set(b, c, g = []), g;
            }
            function d(c) {
                if (e = b(c, !1)) for (var e = e.slice(0), g = 0; g < e.length; g++) e[g](c);
                if (a.a.e.clear(c), a.a.w.cleanExternalData(c), f[c.nodeType]) for (e = c.firstChild; c = e; ) e = c.nextSibling, 
                8 === c.nodeType && d(c);
            }
            var c = a.a.e.F(), e = {
                1: !0,
                8: !0,
                9: !0
            }, f = {
                1: !0,
                9: !0
            };
            return {
                da: function(a, c) {
                    if ("function" != typeof c) throw Error("Callback must be a function");
                    b(a, !0).push(c);
                },
                Kb: function(d, e) {
                    var g = b(d, !1);
                    g && (a.a.ua(g, e), 0 == g.length && a.a.e.set(d, c, n));
                },
                R: function(b) {
                    if (e[b.nodeType] && (d(b), f[b.nodeType])) {
                        var c = [];
                        a.a.ga(c, b.getElementsByTagName("*"));
                        for (var g = 0, m = c.length; g < m; g++) d(c[g]);
                    }
                    return b;
                },
                removeNode: function(b) {
                    a.R(b), b.parentNode && b.parentNode.removeChild(b);
                },
                cleanExternalData: function(a) {
                    r && "function" == typeof r.cleanData && r.cleanData([ a ]);
                }
            };
        }(), a.R = a.a.w.R, a.removeNode = a.a.w.removeNode, a.b("cleanNode", a.R), a.b("removeNode", a.removeNode), 
        a.b("utils.domNodeDisposal", a.a.w), a.b("utils.domNodeDisposal.addDisposeCallback", a.a.w.da), 
        a.b("utils.domNodeDisposal.removeDisposeCallback", a.a.w.Kb), a.a.ba = function(b) {
            if (r) {
                if (r.parseHTML) d = r.parseHTML(b) || []; else if ((d = r.clean([ b ])) && d[0]) {
                    for (b = d[0]; b.parentNode && 11 !== b.parentNode.nodeType; ) b = b.parentNode;
                    b.parentNode && b.parentNode.removeChild(b);
                }
            } else {
                var c = a.a.cb(b).toLowerCase(), d = y.createElement("div");
                for (b = "ignored<div>" + (c = (c.match(/^<(thead|tbody|tfoot)/) ? [ 1, "<table>", "</table>" ] : !c.indexOf("<tr") && [ 2, "<table><tbody>", "</tbody></table>" ]) || (!c.indexOf("<td") || !c.indexOf("<th")) && [ 3, "<table><tbody><tr>", "</tr></tbody></table>" ] || [ 0, "", "" ])[1] + b + c[2] + "</div>", 
                "function" == typeof v.innerShiv ? d.appendChild(v.innerShiv(b)) : d.innerHTML = b; c[0]--; ) d = d.lastChild;
                d = a.a.S(d.lastChild.childNodes);
            }
            return d;
        }, a.a.$a = function(b, d) {
            if (a.a.Ka(b), null !== (d = a.a.c(d)) && d !== n) if ("string" != typeof d && (d = d.toString()), 
            r) r(b).html(d); else for (var c = a.a.ba(d), e = 0; e < c.length; e++) b.appendChild(c[e]);
        }, a.b("utils.parseHtmlFragment", a.a.ba), a.b("utils.setHtml", a.a.$a), a.D = (d = {}, 
        {
            Ua: function(a) {
                if ("function" != typeof a) throw Error("You can only pass a function to ko.memoization.memoize()");
                var b = (4294967296 * (1 + Math.random()) | 0).toString(16).substring(1) + (4294967296 * (1 + Math.random()) | 0).toString(16).substring(1);
                return d[b] = a, "\x3c!--[ko_memo:" + b + "]--\x3e";
            },
            Rb: function(a, b) {
                var f = d[a];
                if (f === n) throw Error("Couldn't find any memo with ID " + a + ". Perhaps it's already been unmemoized.");
                try {
                    return f.apply(null, b || []), !0;
                } finally {
                    delete d[a];
                }
            },
            Sb: function(c, d) {
                var f = [];
                !function b(c, d) {
                    if (c) if (8 == c.nodeType) null != (f = a.D.Gb(c.nodeValue)) && d.push({
                        bc: c,
                        mc: f
                    }); else if (1 == c.nodeType) for (var f = 0, h = c.childNodes, k = h.length; f < k; f++) b(h[f], d);
                }(c, f);
                for (var h = 0, k = f.length; h < k; h++) {
                    var g = f[h].bc, m = [ g ];
                    d && a.a.ga(m, d), a.D.Rb(f[h].mc, m), g.nodeValue = "", g.parentNode && g.parentNode.removeChild(g);
                }
            },
            Gb: function(a) {
                return (a = a.match(/^\[ko_memo\:(.*?)\]$/)) ? a[1] : null;
            }
        }), a.b("memoization", a.D), a.b("memoization.memoize", a.D.Ua), a.b("memoization.unmemoize", a.D.Rb), 
        a.b("memoization.parseMemoText", a.D.Gb), a.b("memoization.unmemoizeDomNodeAndDescendants", a.D.Sb), 
        a.La = {
            throttle: function(b, d) {
                b.throttleEvaluation = d;
                var c = null;
                return a.j({
                    read: b,
                    write: function(a) {
                        clearTimeout(c), c = setTimeout(function() {
                            b(a);
                        }, d);
                    }
                });
            },
            rateLimit: function(a, d) {
                var c, e, f;
                "number" == typeof d ? c = d : (c = d.timeout, e = d.method), f = "notifyWhenChangesStop" == e ? S : R, 
                a.Ta(function(a) {
                    return f(a, c);
                });
            },
            notify: function(a, d) {
                a.equalityComparer = "always" == d ? null : H;
            }
        };
        var Q = {
            undefined: 1,
            boolean: 1,
            number: 1,
            string: 1
        };
        a.b("extenders", a.La), a.Pb = function(b, d, c) {
            this.target = b, this.wa = d, this.ac = c, this.Cb = !1, a.A(this, "dispose", this.K);
        }, a.Pb.prototype.K = function() {
            this.Cb = !0, this.ac();
        }, a.P = function() {
            a.a.Aa(this, a.P.fn), this.M = {};
        };
        B = {
            U: function(b, d, c) {
                var e = this;
                c = c || "change";
                var f = new a.Pb(e, d ? b.bind(d) : b, function() {
                    a.a.ua(e.M[c], f), e.nb && e.nb();
                });
                return e.va && e.va(c), e.M[c] || (e.M[c] = []), e.M[c].push(f), f;
            },
            notifySubscribers: function(b, d) {
                if (this.Ab(d = d || "change")) try {
                    a.k.Ea();
                    for (var f, c = this.M[d].slice(0), e = 0; f = c[e]; ++e) f.Cb || f.wa(b);
                } finally {
                    a.k.end();
                }
            },
            Ta: function(b) {
                var e, f, h, d = this, c = a.C(d);
                d.qa || (d.qa = d.notifySubscribers, d.notifySubscribers = function(a, b) {
                    b && "change" !== b ? "beforeChange" === b ? d.kb(a) : d.qa(a, b) : d.lb(a);
                });
                var k = b(function() {
                    c && h === d && (h = d()), e = !1, d.Pa(f, h) && d.qa(f = h);
                });
                d.lb = function(a) {
                    e = !0, h = a, k();
                }, d.kb = function(a) {
                    e || (f = a, d.qa(a, "beforeChange"));
                };
            },
            Ab: function(a) {
                return this.M[a] && this.M[a].length;
            },
            yb: function() {
                var b = 0;
                return a.a.G(this.M, function(a, c) {
                    b += c.length;
                }), b;
            },
            Pa: function(a, d) {
                return !this.equalityComparer || !this.equalityComparer(a, d);
            },
            extend: function(b) {
                var d = this;
                return b && a.a.G(b, function(f, e) {
                    f = a.La[f];
                    "function" == typeof f && (d = f(d, e) || d);
                }), d;
            }
        };
        a.A(B, "subscribe", B.U), a.A(B, "extend", B.extend), a.A(B, "getSubscriptionsCount", B.yb), 
        a.a.xa && a.a.za(B, Function.prototype), a.P.fn = B, a.Db = function(a) {
            return null != a && "function" == typeof a.U && "function" == typeof a.notifySubscribers;
        }, a.b("subscribable", a.P), a.b("isSubscribable", a.Db), a.Y = a.k = function() {
            function b(a) {
                c.push(e), e = a;
            }
            function d() {
                e = c.pop();
            }
            var e, c = [], f = 0;
            return {
                Ea: b,
                end: d,
                Jb: function(b) {
                    if (e) {
                        if (!a.Db(b)) throw Error("Only subscribable things can act as dependencies");
                        e.wa(b, b.Vb || (b.Vb = ++f));
                    }
                },
                B: function(a, c, g) {
                    try {
                        return b(), a.apply(c, g || []);
                    } finally {
                        d();
                    }
                },
                la: function() {
                    if (e) return e.s.la();
                },
                ma: function() {
                    if (e) return e.ma;
                }
            };
        }(), a.b("computedContext", a.Y), a.b("computedContext.getDependenciesCount", a.Y.la), 
        a.b("computedContext.isInitial", a.Y.ma), a.b("computedContext.isSleeping", a.Y.zc), 
        a.p = function(b) {
            function d() {
                return 0 < arguments.length ? (d.Pa(c, arguments[0]) && (d.X(), c = arguments[0], 
                d.W()), this) : (a.k.Jb(d), c);
            }
            var c = b;
            return a.P.call(d), a.a.Aa(d, a.p.fn), d.v = function() {
                return c;
            }, d.W = function() {
                d.notifySubscribers(c);
            }, d.X = function() {
                d.notifySubscribers(c, "beforeChange");
            }, a.A(d, "peek", d.v), a.A(d, "valueHasMutated", d.W), a.A(d, "valueWillMutate", d.X), 
            d;
        }, a.p.fn = {
            equalityComparer: H
        };
        var F = a.p.rc = "__ko_proto__";
        a.p.fn[F] = a.p, a.a.xa && a.a.za(a.p.fn, a.P.fn), a.Ma = function(b, d) {
            return null !== b && b !== n && b[F] !== n && (b[F] === d || a.Ma(b[F], d));
        }, a.C = function(b) {
            return a.Ma(b, a.p);
        }, a.Ra = function(b) {
            return !!("function" == typeof b && b[F] === a.p || "function" == typeof b && b[F] === a.j && b.hc);
        }, a.b("observable", a.p), a.b("isObservable", a.C), a.b("isWriteableObservable", a.Ra), 
        a.b("isWritableObservable", a.Ra), a.aa = function(b) {
            if ("object" != typeof (b = b || []) || !("length" in b)) throw Error("The argument passed when initializing an observable array must be an array, or null, or undefined.");
            return b = a.p(b), a.a.Aa(b, a.aa.fn), b.extend({
                trackArrayChanges: !0
            });
        }, a.aa.fn = {
            remove: function(b) {
                for (var d = this.v(), c = [], e = "function" != typeof b || a.C(b) ? function(a) {
                    return a === b;
                } : b, f = 0; f < d.length; f++) {
                    var h = d[f];
                    e(h) && (0 === c.length && this.X(), c.push(h), d.splice(f, 1), f--);
                }
                return c.length && this.W(), c;
            },
            removeAll: function(b) {
                if (b !== n) return b ? this.remove(function(c) {
                    return 0 <= a.a.m(b, c);
                }) : [];
                var d = this.v(), c = d.slice(0);
                return this.X(), d.splice(0, d.length), this.W(), c;
            },
            destroy: function(b) {
                var d = this.v(), c = "function" != typeof b || a.C(b) ? function(a) {
                    return a === b;
                } : b;
                this.X();
                for (var e = d.length - 1; 0 <= e; e--) c(d[e]) && (d[e]._destroy = !0);
                this.W();
            },
            destroyAll: function(b) {
                return b === n ? this.destroy(function() {
                    return !0;
                }) : b ? this.destroy(function(d) {
                    return 0 <= a.a.m(b, d);
                }) : [];
            },
            indexOf: function(b) {
                var d = this();
                return a.a.m(d, b);
            },
            replace: function(c, d) {
                c = this.indexOf(c);
                0 <= c && (this.X(), this.v()[c] = d, this.W());
            }
        }, a.a.u("pop push reverse shift sort splice unshift".split(" "), function(b) {
            a.aa.fn[b] = function() {
                var a = this.v();
                return this.X(), this.sb(a, b, arguments), a = a[b].apply(a, arguments), this.W(), 
                a;
            };
        }), a.a.u([ "slice" ], function(b) {
            a.aa.fn[b] = function() {
                var a = this();
                return a[b].apply(a, arguments);
            };
        }), a.a.xa && a.a.za(a.aa.fn, a.p.fn), a.b("observableArray", a.aa), a.La.trackArrayChanges = function(b) {
            function d() {
                var d, g;
                c || (c = !0, d = b.notifySubscribers, b.notifySubscribers = function(a, b) {
                    return b && "change" !== b || ++f, d.apply(this, arguments);
                }, g = [].concat(b.v() || []), e = null, b.U(function(c) {
                    c = [].concat(c || []), b.Ab("arrayChange") && (e = !e || 1 < f ? a.a.Fa(g, c, {
                        sparse: !0
                    }) : e).length && b.notifySubscribers(e, "arrayChange"), g = c, e = null, f = 0;
                }));
            }
            var c, e, f, h;
            b.sb || (c = !1, e = null, f = 0, h = b.U, b.U = b.subscribe = function(a, b, c) {
                return "arrayChange" === c && d(), h.apply(this, arguments);
            }, b.sb = function(b, d, m) {
                function l(a, b, c) {
                    return s[s.length] = {
                        status: a,
                        value: b,
                        index: c
                    };
                }
                if (c && !f) {
                    var s = [], h = b.length, p = m.length, z = 0;
                    switch (d) {
                      case "push":
                        z = h;

                      case "unshift":
                        for (d = 0; d < p; d++) l("added", m[d], z + d);
                        break;

                      case "pop":
                        z = h - 1;

                      case "shift":
                        h && l("deleted", b[z], z);
                        break;

                      case "splice":
                        d = Math.min(Math.max(0, m[0] < 0 ? h + m[0] : m[0]), h);
                        for (var h = 1 === p ? h : Math.min(d + (m[1] || 0), h), p = d + p - 2, z = Math.max(h, p), u = [], t = [], E = 2; d < z; ++d, 
                        ++E) d < h && t.push(l("deleted", b[d], d)), d < p && u.push(l("added", m[E], d));
                        a.a.wb(t, u);
                        break;

                      default:
                        return;
                    }
                    e = s;
                }
            });
        }, a.s = a.j = function(b, d, c) {
            function e() {
                a.a.G(v, function(a, b) {
                    b.K();
                }), v = {};
            }
            function f() {
                e(), q = !(u = !(A = 0));
            }
            function h() {
                var a = g.throttleEvaluation;
                a && 0 <= a ? (clearTimeout(O), O = setTimeout(k, a)) : g.ib ? g.ib() : k();
            }
            function k(b) {
                if (p) {
                    if (E) throw Error("A 'pure' computed must not be called recursively");
                } else if (!u) {
                    if (J && J()) {
                        if (!z) return void r();
                    } else z = !1;
                    if (p = !0, x) try {
                        var c = {};
                        a.k.Ea({
                            wa: function(a, b) {
                                c[b] || (c[b] = 1, ++A);
                            },
                            s: g,
                            ma: n
                        }), A = 0, s = t.call(d);
                    } finally {
                        a.k.end(), p = !1;
                    } else try {
                        var e = v, l = A;
                        a.k.Ea({
                            wa: function(a, b) {
                                u || (l && e[b] ? (v[b] = e[b], ++A, delete e[b], --l) : v[b] || (v[b] = a.U(h), 
                                ++A));
                            },
                            s: g,
                            ma: E ? n : !A
                        }), v = {}, A = 0;
                        try {
                            var m = d ? t.call(d) : t();
                        } finally {
                            a.k.end(), l && a.a.G(e, function(a, b) {
                                b.K();
                            }), q = !1;
                        }
                        g.Pa(s, m) && (g.notifySubscribers(s, "beforeChange"), s = m, !0 !== b && g.notifySubscribers(s));
                    } finally {
                        p = !1;
                    }
                    A || r();
                }
            }
            function g() {
                if (0 < arguments.length) {
                    if ("function" != typeof G) throw Error("Cannot write a value to a ko.computed unless you specify a 'write' option. If you wish to read the current value, don't pass any parameters.");
                    return G.apply(d, arguments), this;
                }
                return a.k.Jb(g), q && k(!0), s;
            }
            function m() {
                return q && !A && k(!0), s;
            }
            function l() {
                return q || 0 < A;
            }
            var s, q = !0, p = !1, z = !1, u = !1, t = b, E = !1, x = !1;
            if ("function" != typeof (t = t && "object" == typeof t ? (c = t).read : (c = c || {}, 
            t || c.read))) throw Error("Pass a function that returns the value of the ko.computed");
            var G = c.write, w = c.disposeWhenNodeIsRemoved || c.o || null, C = c.disposeWhen || c.Ia, J = C, r = f, v = {}, A = 0, O = null;
            d = d || c.owner, a.P.call(g), a.a.Aa(g, a.j.fn), g.v = m, g.la = function() {
                return A;
            }, g.hc = "function" == typeof c.write, g.K = function() {
                r();
            }, g.Z = l;
            var y = g.Ta;
            return g.Ta = function(a) {
                y.call(g, a), g.ib = function() {
                    g.kb(s), q = !0, g.lb(g);
                };
            }, c.pure ? (x = E = !0, g.va = function() {
                x && k(!(x = !1));
            }, g.nb = function() {
                g.yb() || (e(), x = q = !0);
            }) : c.deferEvaluation && (g.va = function() {
                m(), delete g.va;
            }), a.A(g, "peek", g.v), a.A(g, "dispose", g.K), a.A(g, "isActive", g.Z), a.A(g, "getDependenciesCount", g.la), 
            w && (z = !0, w.nodeType && (J = function() {
                return !a.a.Ja(w) || C && C();
            })), x || c.deferEvaluation || k(), w && l() && w.nodeType && (r = function() {
                a.a.w.Kb(w, r), f();
            }, a.a.w.da(w, r)), g;
        }, a.jc = function(b) {
            return a.Ma(b, a.j);
        }, B = a.p.rc, a.j[B] = a.p, a.j.fn = {
            equalityComparer: H
        }, a.j.fn[B] = a.j, a.a.xa && a.a.za(a.j.fn, a.P.fn), a.b("dependentObservable", a.j), 
        a.b("computed", a.j), a.b("isComputed", a.jc), a.Ib = function(b, d) {
            return "function" == typeof b ? a.s(b, d, {
                pure: !0
            }) : ((b = a.a.extend({}, b)).pure = !0, a.s(b, d));
        }, a.b("pureComputed", a.Ib), function() {
            function b(a, f, h) {
                if (h = h || new c(), "object" != typeof (a = f(a)) || null === a || a === n || a instanceof Date || a instanceof String || a instanceof Number || a instanceof Boolean) return a;
                var k = a instanceof Array ? [] : {};
                return h.save(a, k), function(a, b) {
                    if (a instanceof Array) {
                        for (var c = 0; c < a.length; c++) b(c);
                        "function" == typeof a.toJSON && b("toJSON");
                    } else for (c in a) b(c);
                }(a, function(c) {
                    var d = f(a[c]);
                    switch (typeof d) {
                      case "boolean":
                      case "number":
                      case "string":
                      case "function":
                        k[c] = d;
                        break;

                      case "object":
                      case "undefined":
                        var l = h.get(d);
                        k[c] = l !== n ? l : b(d, f, h);
                    }
                }), k;
            }
            function c() {
                this.keys = [], this.hb = [];
            }
            a.Qb = function(c) {
                if (0 == arguments.length) throw Error("When calling ko.toJS, pass the object you want to convert.");
                return b(c, function(b) {
                    for (var c = 0; a.C(b) && c < 10; c++) b = b();
                    return b;
                });
            }, a.toJSON = function(b, c, d) {
                return b = a.Qb(b), a.a.eb(b, c, d);
            }, c.prototype = {
                save: function(b, c) {
                    var d = a.a.m(this.keys, b);
                    0 <= d ? this.hb[d] = c : (this.keys.push(b), this.hb.push(c));
                },
                get: function(b) {
                    return 0 <= (b = a.a.m(this.keys, b)) ? this.hb[b] : n;
                }
            };
        }(), a.b("toJS", a.Qb), a.b("toJSON", a.toJSON), a.i = {
            q: function(b) {
                switch (a.a.t(b)) {
                  case "option":
                    return !0 === b.__ko__hasDomDataOptionValue__ ? a.a.e.get(b, a.d.options.Va) : !(a.a.L <= 7) || b.getAttributeNode("value") && b.getAttributeNode("value").specified ? b.value : b.text;

                  case "select":
                    return 0 <= b.selectedIndex ? a.i.q(b.options[b.selectedIndex]) : n;

                  default:
                    return b.value;
                }
            },
            ca: function(b, d, c) {
                switch (a.a.t(b)) {
                  case "option":
                    "string" == typeof d ? (a.a.e.set(b, a.d.options.Va, n), "__ko__hasDomDataOptionValue__" in b && delete b.__ko__hasDomDataOptionValue__, 
                    b.value = d) : (a.a.e.set(b, a.d.options.Va, d), b.__ko__hasDomDataOptionValue__ = !0, 
                    b.value = "number" == typeof d ? d : "");
                    break;

                  case "select":
                    "" !== d && null !== d || (d = n);
                    for (var k, e = -1, f = 0, h = b.options.length; f < h; ++f) if ((k = a.i.q(b.options[f])) == d || "" == k && d === n) {
                        e = f;
                        break;
                    }
                    (c || 0 <= e || d === n && 1 < b.size) && (b.selectedIndex = e);
                    break;

                  default:
                    b.value = d = null === d || d === n ? "" : d;
                }
            }
        }, a.b("selectExtensions", a.i), a.b("selectExtensions.readValue", a.i.q), a.b("selectExtensions.writeValue", a.i.ca), 
        a.h = function() {
            function b(b) {
                var s, k, c = [], d = (b = 123 === (b = a.a.cb(b)).charCodeAt(0) ? b.slice(1, -1) : b).match(e), p = 0;
                if (d) {
                    d.push(",");
                    for (var u, z = 0; u = d[z]; ++z) {
                        var t = u.charCodeAt(0);
                        if (44 === t) {
                            if (p <= 0) {
                                s && c.push(k ? {
                                    key: s,
                                    value: k.join("")
                                } : {
                                    unknown: s
                                }), s = k = p = 0;
                                continue;
                            }
                        } else if (58 === t) {
                            if (!k) continue;
                        } else if (47 === t && z && 1 < u.length) (t = d[z - 1].match(f)) && !h[t[0]] && ((d = (b = b.substr(b.indexOf(u) + 1)).match(e)).push(","), 
                        z = -1, u = "/"); else if (40 === t || 123 === t || 91 === t) ++p; else if (41 === t || 125 === t || 93 === t) --p; else if (!s && !k) {
                            s = 34 === t || 39 === t ? u.slice(1, -1) : u;
                            continue;
                        }
                        k ? k.push(u) : k = [ u ];
                    }
                }
                return c;
            }
            var d = [ "true", "false", "null", "undefined" ], c = /^(?:[$_a-z][$\w]*|(.+)(\.\s*[$_a-z][$\w]*|\[.+\]))$/i, e = RegExp("\"(?:[^\"\\\\]|\\\\.)*\"|'(?:[^'\\\\]|\\\\.)*'|/(?:[^/\\\\]|\\\\.)*/w*|[^\\s:,/][^,\"'{}()/:[\\]]*[^\\s,\"'{}()/:[\\]]|[^\\s]", "g"), f = /[\])"'A-Za-z0-9_$]+$/, h = {
                in: 1,
                return: 1,
                typeof: 1
            }, k = {};
            return {
                ha: [],
                V: k,
                Wa: b,
                ya: function(u, m) {
                    function l(b, g) {
                        var m;
                        if (!z) {
                            var u = a.getBindingHandler(b);
                            if (u && u.preprocess && !(g = u.preprocess(g, b, l))) return;
                            (u = (u = k[b]) ? m = !(0 <= a.a.m(d, m = g)) && (null !== (u = m.match(c)) && (u[1] ? "Object(" + u[1] + ")" + u[2] : m)) : u) && f.push("'" + b + "':function(_z){" + m + "=_z}");
                        }
                        e.push("'" + b + "':" + (g = h ? "function(){return " + g + " }" : g));
                    }
                    var e = [], f = [], h = (m = m || {}).valueAccessors, z = m.bindingParams, u = "string" == typeof u ? b(u) : u;
                    return a.a.u(u, function(a) {
                        l(a.key || a.unknown, a.value);
                    }), f.length && l("_ko_property_writers", "{" + f.join(",") + " }"), e.join(",");
                },
                lc: function(a, b) {
                    for (var c = 0; c < a.length; c++) if (a[c].key == b) return !0;
                    return !1;
                },
                pa: function(b, c, d, e, f) {
                    b && a.C(b) ? !a.Ra(b) || f && b.v() === e || b(e) : (b = c.get("_ko_property_writers")) && b[d] && b[d](e);
                }
            };
        }(), a.b("expressionRewriting", a.h), a.b("expressionRewriting.bindingRewriteValidators", a.h.ha), 
        a.b("expressionRewriting.parseObjectLiteral", a.h.Wa), a.b("expressionRewriting.preProcessBindings", a.h.ya), 
        a.b("expressionRewriting._twoWayBindings", a.h.V), a.b("jsonExpressionRewriting", a.h), 
        a.b("jsonExpressionRewriting.insertPropertyAccessorsIntoJson", a.h.ya), function() {
            function b(a) {
                return 8 == a.nodeType && h.test(f ? a.text : a.nodeValue);
            }
            function d(a) {
                return 8 == a.nodeType && k.test(f ? a.text : a.nodeValue);
            }
            function c(a, c) {
                for (var g = a, e = 1, f = []; g = g.nextSibling; ) {
                    if (d(g) && 0 === --e) return f;
                    f.push(g), b(g) && e++;
                }
                if (!c) throw Error("Cannot find closing comment tag to match: " + a.nodeValue);
                return null;
            }
            function e(a, d) {
                d = c(a, d);
                return d ? (0 < d.length ? d[d.length - 1] : a).nextSibling : null;
            }
            var f = y && "\x3c!--test--\x3e" === y.createComment("test").text, h = f ? /^\x3c!--\s*ko(?:\s+([\s\S]+))?\s*--\x3e$/ : /^\s*ko(?:\s+([\s\S]+))?\s*$/, k = f ? /^\x3c!--\s*\/ko\s*--\x3e$/ : /^\s*\/ko\s*$/, g = {
                ul: !0,
                ol: !0
            };
            a.f = {
                Q: {},
                childNodes: function(a) {
                    return b(a) ? c(a) : a.childNodes;
                },
                ja: function(c) {
                    if (b(c)) for (var d = 0, g = (c = a.f.childNodes(c)).length; d < g; d++) a.removeNode(c[d]); else a.a.Ka(c);
                },
                T: function(c, d) {
                    if (b(c)) {
                        a.f.ja(c);
                        for (var g = c.nextSibling, e = 0, f = d.length; e < f; e++) g.parentNode.insertBefore(d[e], g);
                    } else a.a.T(c, d);
                },
                Hb: function(a, c) {
                    b(a) ? a.parentNode.insertBefore(c, a.nextSibling) : a.firstChild ? a.insertBefore(c, a.firstChild) : a.appendChild(c);
                },
                Bb: function(c, d, g) {
                    g ? b(c) ? c.parentNode.insertBefore(d, g.nextSibling) : g.nextSibling ? c.insertBefore(d, g.nextSibling) : c.appendChild(d) : a.f.Hb(c, d);
                },
                firstChild: function(a) {
                    return b(a) ? !a.nextSibling || d(a.nextSibling) ? null : a.nextSibling : a.firstChild;
                },
                nextSibling: function(a) {
                    return (a = b(a) ? e(a) : a).nextSibling && d(a.nextSibling) ? null : a.nextSibling;
                },
                gc: b,
                wc: function(a) {
                    return (a = (f ? a.text : a.nodeValue).match(h)) ? a[1] : null;
                },
                Fb: function(c) {
                    if (g[a.a.t(c)]) {
                        var l = c.firstChild;
                        if (l) do {
                            if (1 === l.nodeType) {
                                var k, f = l.firstChild, h = null;
                                if (f) do {} while (h ? h.push(f) : b(f) ? (k = e(f, !0)) ? f = k : h = [ f ] : d(f) && (h = [ f ]), 
                                f = f.nextSibling);
                                if (f = h) for (h = l.nextSibling, k = 0; k < f.length; k++) h ? c.insertBefore(f[k], h) : c.appendChild(f[k]);
                            }
                        } while (l = l.nextSibling);
                    }
                }
            };
        }(), a.b("virtualElements", a.f), a.b("virtualElements.allowedBindings", a.f.Q), 
        a.b("virtualElements.emptyNode", a.f.ja), a.b("virtualElements.insertAfter", a.f.Bb), 
        a.b("virtualElements.prepend", a.f.Hb), a.b("virtualElements.setDomNodeChildren", a.f.T), 
        a.J = function() {
            this.Yb = {};
        }, a.a.extend(a.J.prototype, {
            nodeHasBindings: function(b) {
                switch (b.nodeType) {
                  case 1:
                    return null != b.getAttribute("data-bind") || a.g.getComponentNameForNode(b);

                  case 8:
                    return a.f.gc(b);

                  default:
                    return !1;
                }
            },
            getBindings: function(b, d) {
                var c = (c = this.getBindingsString(b, d)) ? this.parseBindingsString(c, d, b) : null;
                return a.g.mb(c, b, d, !1);
            },
            getBindingAccessors: function(b, d) {
                var c = (c = this.getBindingsString(b, d)) ? this.parseBindingsString(c, d, b, {
                    valueAccessors: !0
                }) : null;
                return a.g.mb(c, b, d, !0);
            },
            getBindingsString: function(b) {
                switch (b.nodeType) {
                  case 1:
                    return b.getAttribute("data-bind");

                  case 8:
                    return a.f.wc(b);

                  default:
                    return null;
                }
            },
            parseBindingsString: function(b, d, c, e) {
                try {
                    var m, g, k, f = this.Yb, h = b + (e && e.valueAccessors || "");
                    return (k = f[h]) || (m = "with($context){with($data||{}){return{" + a.h.ya(b, e) + "}}}", 
                    g = new Function("$context", "$element", m), k = f[h] = g), k(d, c);
                } catch (l) {
                    throw l.message = "Unable to parse bindings.\nBindings value: " + b + "\nMessage: " + l.message, 
                    l;
                }
            }
        }), a.J.instance = new a.J(), a.b("bindingProvider", a.J), function() {
            function b(a) {
                return function() {
                    return a;
                };
            }
            function d(a) {
                return a();
            }
            function c(b) {
                return a.a.na(a.k.B(b), function(a, c) {
                    return function() {
                        return b()[c];
                    };
                });
            }
            function e(d, g, e) {
                return "function" == typeof d ? c(d.bind(null, g, e)) : a.a.na(d, b);
            }
            function f(a, b) {
                return c(this.getBindings.bind(this, a, b));
            }
            function h(b, c, d) {
                var g, e = a.f.firstChild(c), l = a.J.instance, f = l.preprocessNode;
                if (f) {
                    for (;g = e; ) e = a.f.nextSibling(g), f.call(l, g);
                    e = a.f.firstChild(c);
                }
                for (;g = e; ) e = a.f.nextSibling(g), k(b, g, d);
            }
            function k(b, c, d) {
                var g = !0, e = 1 === c.nodeType;
                e && a.f.Fb(c), (g = e && d || a.J.instance.nodeHasBindings(c) ? m(c, null, b, d).shouldBindDescendants : g) && !s[a.a.t(c)] && h(b, c, !e);
            }
            function m(b, c, e, l) {
                var h, k, s, p, r, v, A, m = a.a.e.get(b, q);
                if (!c) {
                    if (m) throw Error("You cannot apply bindings multiple times to the same element.");
                    a.a.e.set(b, q, !0);
                }
                return !m && l && a.Ob(b, e), c && "function" != typeof c ? h = c : (k = a.J.instance, 
                s = k.getBindingAccessors || f, p = a.j(function() {
                    return (h = c ? c(e, b) : s.call(k, b, e)) && e.I && e.I(), h;
                }, null, {
                    o: b
                }), h && p.Z() || (p = null)), h && (v = p ? function(a) {
                    return function() {
                        return d(p()[a]);
                    };
                } : function(a) {
                    return h[a];
                }, (A = function() {
                    return a.a.na(p ? p() : h, d);
                }).get = function(a) {
                    return h[a] && v(a)();
                }, A.has = function(a) {
                    return a in h;
                }, l = function(b) {
                    var c = [], d = {}, g = [];
                    return a.a.G(b, function G(e) {
                        var l;
                        d[e] || ((l = a.getBindingHandler(e)) && (l.after && (g.push(e), a.a.u(l.after, function(c) {
                            if (b[c]) {
                                if (-1 !== a.a.m(g, c)) throw Error("Cannot combine the following bindings, because they have a cyclic dependency: " + g.join(", "));
                                G(c);
                            }
                        }), g.length--), c.push({
                            key: e,
                            zb: l
                        })), d[e] = !0);
                    }), c;
                }(h), a.a.u(l, function(c) {
                    var d = c.zb.init, g = c.zb.update, l = c.key;
                    if (8 === b.nodeType && !a.f.Q[l]) throw Error("The binding '" + l + "' cannot be used with virtual elements");
                    try {
                        "function" == typeof d && a.k.B(function() {
                            var a = d(b, v(l), A, e.$data, e);
                            if (a && a.controlsDescendantBindings) {
                                if (r !== n) throw Error("Multiple bindings (" + r + " and " + l + ") are trying to control descendant bindings of the same element. You cannot use these bindings together on the same element.");
                                r = l;
                            }
                        }), "function" == typeof g && a.j(function() {
                            g(b, v(l), A, e.$data, e);
                        }, null, {
                            o: b
                        });
                    } catch (f) {
                        throw f.message = 'Unable to process binding "' + l + ": " + h[l] + '"\nMessage: ' + f.message, 
                        f;
                    }
                })), {
                    shouldBindDescendants: r === n
                };
            }
            function l(b) {
                return b && b instanceof a.N ? b : new a.N(b);
            }
            a.d = {};
            var s = {
                script: !0
            };
            a.getBindingHandler = function(b) {
                return a.d[b];
            }, a.N = function(b, c, d, g) {
                var f, e = this, l = "function" == typeof b && !a.C(b), m = a.j(function() {
                    var f = l ? b() : b, h = a.a.c(f);
                    return c ? (c.I && c.I(), a.a.extend(e, c), m && (e.I = m)) : (e.$parents = [], 
                    e.$root = h, e.ko = a), e.$rawData = f, e.$data = h, d && (e[d] = h), g && g(e, c, h), 
                    e.$data;
                }, null, {
                    Ia: function() {
                        return f && !a.a.ob(f);
                    },
                    o: !0
                });
                m.Z() && ((e.I = m).equalityComparer = null, f = [], m.Tb = function(b) {
                    f.push(b), a.a.w.da(b, function(b) {
                        a.a.ua(f, b), f.length || (m.K(), e.I = m = n);
                    });
                });
            }, a.N.prototype.createChildContext = function(b, c, d) {
                return new a.N(b, this, c, function(a, b) {
                    a.$parentContext = b, a.$parent = b.$data, a.$parents = (b.$parents || []).slice(0), 
                    a.$parents.unshift(a.$parent), d && d(a);
                });
            }, a.N.prototype.extend = function(b) {
                return new a.N(this.I || this.$data, this, null, function(c, d) {
                    c.$rawData = d.$rawData, a.a.extend(c, "function" == typeof b ? b() : b);
                });
            };
            var q = a.a.e.F(), p = a.a.e.F();
            a.Ob = function(b, c) {
                if (2 != arguments.length) return a.a.e.get(b, p);
                a.a.e.set(b, p, c), c.I && c.I.Tb(b);
            }, a.ra = function(b, c, d) {
                return 1 === b.nodeType && a.f.Fb(b), m(b, c, l(d), !0);
            }, a.Wb = function(b, c, d) {
                return d = l(d), a.ra(b, e(c, d, b), d);
            }, a.Ca = function(a, b) {
                1 !== b.nodeType && 8 !== b.nodeType || h(l(a), b, !0);
            }, a.pb = function(a, b) {
                if (!r && v.jQuery && (r = v.jQuery), b && 1 !== b.nodeType && 8 !== b.nodeType) throw Error("ko.applyBindings: first parameter should be your view model; second parameter should be a DOM node");
                b = b || v.document.body, k(l(a), b, !0);
            }, a.Ha = function(b) {
                switch (b.nodeType) {
                  case 1:
                  case 8:
                    var c = a.Ob(b);
                    if (c) return c;
                    if (b.parentNode) return a.Ha(b.parentNode);
                }
                return n;
            }, a.$b = function(b) {
                return (b = a.Ha(b)) ? b.$data : n;
            }, a.b("bindingHandlers", a.d), a.b("applyBindings", a.pb), a.b("applyBindingsToDescendants", a.Ca), 
            a.b("applyBindingAccessorsToNode", a.ra), a.b("applyBindingsToNode", a.Wb), a.b("contextFor", a.Ha), 
            a.b("dataFor", a.$b);
        }(), function(b) {
            function d(d, g) {
                var l, e = f.hasOwnProperty(d) ? f[d] : b;
                e || (e = f[d] = new a.P(), c(d, function(a) {
                    h[d] = a, delete f[d], l ? e.notifySubscribers(a) : setTimeout(function() {
                        e.notifySubscribers(a);
                    }, 0);
                }), l = !0), e.U(g);
            }
            function c(a, b) {
                e("getConfig", [ a ], function(c) {
                    c ? e("loadComponent", [ a, c ], function(a) {
                        b(a);
                    }) : b(null);
                });
            }
            function e(c, d, f, l) {
                var h = (l = l || a.g.loaders.slice(0)).shift();
                if (h) {
                    var q = h[c];
                    if (q) {
                        var p = !1;
                        if (q.apply(h, d.concat(function(a) {
                            p ? f(null) : null !== a ? f(a) : e(c, d, f, l);
                        })) !== b && (p = !0, !h.suppressLoaderExceptions)) throw Error("Component loaders must supply values by invoking the callback, not by returning values synchronously.");
                    } else e(c, d, f, l);
                } else f(null);
            }
            var f = {}, h = {};
            a.g = {
                get: function(a, c) {
                    var e = h.hasOwnProperty(a) ? h[a] : b;
                    e ? setTimeout(function() {
                        c(e);
                    }, 0) : d(a, c);
                },
                tb: function(a) {
                    delete h[a];
                },
                jb: e
            }, a.g.loaders = [], a.b("components", a.g), a.b("components.get", a.g.get), a.b("components.clearCachedDefinition", a.g.tb);
        }(), function() {
            function b(b, c, d, e) {
                function h() {
                    0 == --u && e(k);
                }
                var k = {}, u = 2, t = d.template;
                d = d.viewModel, t ? f(c, t, function(c) {
                    a.g.jb("loadTemplate", [ b, c ], function(a) {
                        k.template = a, h();
                    });
                }) : h(), d ? f(c, d, function(c) {
                    a.g.jb("loadViewModel", [ b, c ], function(a) {
                        k[g] = a, h();
                    });
                }) : h();
            }
            function c(b) {
                switch (a.a.t(b)) {
                  case "script":
                    return a.a.ba(b.text);

                  case "textarea":
                    return a.a.ba(b.value);

                  case "template":
                    if (e(b.content)) return a.a.ia(b.content.childNodes);
                }
                return a.a.ia(b.childNodes);
            }
            function e(a) {
                return v.DocumentFragment ? a instanceof DocumentFragment : a && 11 === a.nodeType;
            }
            function f(a, b, c) {
                "string" == typeof b.require ? N || v.require ? (N || v.require)([ b.require ], c) : a("Uses require, but no AMD loader is present") : c(b);
            }
            function h(a) {
                return function(b) {
                    throw Error("Component '" + a + "': " + b);
                };
            }
            var k = {};
            a.g.register = function(b, c) {
                if (!c) throw Error("Invalid configuration for " + b);
                if (a.g.Qa(b)) throw Error("Component " + b + " is already registered");
                k[b] = c;
            }, a.g.Qa = function(a) {
                return a in k;
            }, a.g.vc = function(b) {
                delete k[b], a.g.tb(b);
            }, a.g.ub = {
                getConfig: function(a, b) {
                    b(k.hasOwnProperty(a) ? k[a] : null);
                },
                loadComponent: function(a, c, d) {
                    var e = h(a);
                    f(e, c, function(c) {
                        b(a, e, c, d);
                    });
                },
                loadTemplate: function(b, d, g) {
                    var f;
                    b = h(b), "string" == typeof d ? g(a.a.ba(d)) : d instanceof Array ? g(d) : e(d) ? g(a.a.S(d.childNodes)) : d.element ? (d = d.element, 
                    (v.HTMLElement ? d instanceof HTMLElement : d && d.tagName && 1 === d.nodeType) ? g(c(d)) : "string" == typeof d ? (f = y.getElementById(d)) ? g(c(f)) : b("Cannot find element with ID " + d) : b("Unknown element type: " + d)) : b("Unknown template value: " + d);
                },
                loadViewModel: function(a, b, c) {
                    !function d(a, b, c) {
                        var e;
                        "function" == typeof b ? c(function(a) {
                            return new b(a);
                        }) : "function" == typeof b[g] ? c(b[g]) : "instance" in b ? (e = b.instance, c(function() {
                            return e;
                        })) : "viewModel" in b ? d(a, b.viewModel, c) : a("Unknown viewModel value: " + b);
                    }(h(a), b, c);
                }
            };
            var g = "createViewModel";
            a.b("components.register", a.g.register), a.b("components.isRegistered", a.g.Qa), 
            a.b("components.unregister", a.g.vc), a.b("components.defaultLoader", a.g.ub), a.g.loaders.push(a.g.ub), 
            a.g.Ub = k;
        }(), function() {
            function b(b, h) {
                if (f = b.getAttribute("params")) {
                    var f = d.parseBindingsString(f, h, b, {
                        valueAccessors: !0,
                        bindingParams: !0
                    }), f = a.a.na(f, function(d) {
                        return a.s(d, null, {
                            o: b
                        });
                    }), h = a.a.na(f, function(d) {
                        return d.Z() ? a.s(function() {
                            return a.a.c(d());
                        }, null, {
                            o: b
                        }) : d.v();
                    });
                    return h.hasOwnProperty("$raw") || (h.$raw = f), h;
                }
                return {
                    $raw: {}
                };
            }
            a.g.getComponentNameForNode = function(b) {
                return b = a.a.t(b), a.g.Qa(b) && b;
            }, a.g.mb = function(c, d, f, h) {
                if (1 === d.nodeType) {
                    var k = a.g.getComponentNameForNode(d);
                    if (k) {
                        if ((c = c || {}).component) throw Error('Cannot use the "component" binding on a custom element matching a component');
                        var g = {
                            name: k,
                            params: b(d, f)
                        };
                        c.component = h ? function() {
                            return g;
                        } : g;
                    }
                }
                return c;
            };
            var d = new a.J();
            a.a.L < 9 && (a.g.register = function(a) {
                return function(b) {
                    return y.createElement(b), a.apply(this, arguments);
                };
            }(a.g.register), y.createDocumentFragment = function(b) {
                return function() {
                    var h, d = b(), f = a.g.Ub;
                    for (h in f) f.hasOwnProperty(h) && d.createElement(h);
                    return d;
                };
            }(y.createDocumentFragment));
        }(), function() {
            var b = 0;
            a.d.component = {
                init: function(d, c, e, f, h) {
                    function k() {
                        var a = g && g.dispose;
                        "function" == typeof a && a.call(g), m = null;
                    }
                    var g, m;
                    return a.a.w.da(d, k), a.s(function() {
                        var f, q, e = a.a.c(c());
                        if ("string" == typeof e ? f = e : (f = a.a.c(e.name), q = a.a.c(e.params)), !f) throw Error("No component name specified");
                        var p = m = ++b;
                        a.g.get(f, function(b) {
                            if (m === p) {
                                if (k(), !b) throw Error("Unknown component '" + f + "'");
                                if (!(c = b.template)) throw Error("Component '" + f + "' has no template");
                                c = a.a.ia(c), a.f.T(d, c);
                                var c = q, e = b.createViewModel;
                                b = e ? e.call(b, c, {
                                    element: d
                                }) : c, c = h.createChildContext(b), g = b, a.Ca(c, d);
                            }
                        });
                    }, null, {
                        o: d
                    }), {
                        controlsDescendantBindings: !0
                    };
                }
            }, a.f.Q.component = !0;
        }();
        var P = {
            class: "className",
            for: "htmlFor"
        };
        a.d.attr = {
            update: function(b, c) {
                c = a.a.c(c()) || {};
                a.a.G(c, function(c, d) {
                    var h = !1 === (d = a.a.c(d)) || null === d || d === n;
                    h && b.removeAttribute(c), a.a.L <= 8 && c in P ? (c = P[c], h ? b.removeAttribute(c) : b[c] = d) : h || b.setAttribute(c, d.toString()), 
                    "name" === c && a.a.Mb(b, h ? "" : d.toString());
                });
            }
        }, a.d.checked = {
            after: [ "value", "attr" ],
            init: function(b, d, c) {
                function e() {
                    var k, e = b.checked, f = s ? h() : e;
                    a.Y.ma() || g && !e || (k = a.k.B(d), m ? l !== f ? (e && (a.a.ea(k, f, !0), a.a.ea(k, l, !1)), 
                    l = f) : a.a.ea(k, f, e) : a.h.pa(k, c, "checked", f, !0));
                }
                var m, l, s, h = a.Ib(function() {
                    return c.has("checkedValue") ? a.a.c(c.get("checkedValue")) : c.has("value") ? a.a.c(c.get("value")) : b.value;
                }), k = "checkbox" == b.type, g = "radio" == b.type;
                (k || g) && (m = k && a.a.c(d()) instanceof Array, l = m ? h() : n, s = g || m, 
                g && !b.name && a.d.uniqueName.init(b, function() {
                    return !0;
                }), a.s(e, null, {
                    o: b
                }), a.a.n(b, "click", e), a.s(function() {
                    var c = a.a.c(d());
                    b.checked = m ? 0 <= a.a.m(c, h()) : k ? c : h() === c;
                }, null, {
                    o: b
                }));
            }
        }, a.h.V.checked = !0, a.d.checkedValue = {
            update: function(b, d) {
                b.value = a.a.c(d());
            }
        }, a.d.css = {
            update: function(b, c) {
                c = a.a.c(c());
                "object" == typeof c ? a.a.G(c, function(c, d) {
                    d = a.a.c(d), a.a.Ba(b, c, d);
                }) : (c = String(c || ""), a.a.Ba(b, b.__ko__cssValue, !1), b.__ko__cssValue = c, 
                a.a.Ba(b, c, !0));
            }
        }, a.d.enable = {
            update: function(b, c) {
                c = a.a.c(c());
                c && b.disabled ? b.removeAttribute("disabled") : c || b.disabled || (b.disabled = !0);
            }
        }, a.d.disable = {
            update: function(b, d) {
                a.d.enable.update(b, function() {
                    return !a.a.c(d());
                });
            }
        }, a.d.event = {
            init: function(b, d, c, e, f) {
                var h = d() || {};
                a.a.G(h, function(h) {
                    "string" == typeof h && a.a.n(b, h, function(b) {
                        var m, l = d()[h];
                        if (l) {
                            try {
                                var s = a.a.S(arguments);
                                e = f.$data, s.unshift(e), m = l.apply(e, s);
                            } finally {
                                !0 !== m && (b.preventDefault ? b.preventDefault() : b.returnValue = !1);
                            }
                            !1 === c.get(h + "Bubble") && (b.cancelBubble = !0, b.stopPropagation && b.stopPropagation());
                        }
                    });
                });
            }
        }, a.d.foreach = {
            Eb: function(b) {
                return function() {
                    var d = b(), c = a.a.Xa(d);
                    return c && "number" != typeof c.length ? (a.a.c(d), {
                        foreach: c.data,
                        as: c.as,
                        includeDestroyed: c.includeDestroyed,
                        afterAdd: c.afterAdd,
                        beforeRemove: c.beforeRemove,
                        afterRender: c.afterRender,
                        beforeMove: c.beforeMove,
                        afterMove: c.afterMove,
                        templateEngine: a.O.Oa
                    }) : {
                        foreach: d,
                        templateEngine: a.O.Oa
                    };
                };
            },
            init: function(b, d) {
                return a.d.template.init(b, a.d.foreach.Eb(d));
            },
            update: function(b, d, c, e, f) {
                return a.d.template.update(b, a.d.foreach.Eb(d), c, e, f);
            }
        }, a.h.ha.foreach = !1, a.f.Q.foreach = !0, a.d.hasfocus = {
            init: function(b, d, c) {
                function e(e) {
                    b.__ko_hasfocusUpdating = !0;
                    var f, g = b.ownerDocument;
                    if ("activeElement" in g) {
                        try {
                            f = g.activeElement;
                        } catch (h) {
                            f = g.body;
                        }
                        e = f === b;
                    }
                    g = d(), a.h.pa(g, c, "hasfocus", e, !0), b.__ko_hasfocusLastValue = e, b.__ko_hasfocusUpdating = !1;
                }
                var f = e.bind(null, !0), h = e.bind(null, !1);
                a.a.n(b, "focus", f), a.a.n(b, "focusin", f), a.a.n(b, "blur", h), a.a.n(b, "focusout", h);
            },
            update: function(b, c) {
                c = !!a.a.c(c());
                b.__ko_hasfocusUpdating || b.__ko_hasfocusLastValue === c || (c ? b.focus() : b.blur(), 
                a.k.B(a.a.oa, null, [ b, c ? "focusin" : "focusout" ]));
            }
        }, a.h.V.hasfocus = !0, a.d.hasFocus = a.d.hasfocus, a.h.V.hasFocus = !0, a.d.html = {
            init: function() {
                return {
                    controlsDescendantBindings: !0
                };
            },
            update: function(b, d) {
                a.a.$a(b, d());
            }
        }, I("if"), I("ifnot", !1, !0), I("with", !0, !1, function(a, d) {
            return a.createChildContext(d);
        });
        var K = {};
        a.d.options = {
            init: function(b) {
                if ("select" !== a.a.t(b)) throw Error("options binding applies only to SELECT elements");
                for (;0 < b.length; ) b.remove(0);
                return {
                    controlsDescendantBindings: !0
                };
            },
            update: function(b, d, c) {
                function e() {
                    return a.a.ta(b.options, function(a) {
                        return a.selected;
                    });
                }
                function f(a, b, c) {
                    var d = typeof b;
                    return "function" == d ? b(a) : "string" == d ? a[b] : c;
                }
                function h(c, d) {
                    var e;
                    s.length && (e = 0 <= a.a.m(s, a.i.q(d[0])), a.a.Nb(d[0], e), q && !e && a.k.B(a.a.oa, null, [ b, "change" ]));
                }
                var l, s, k = 0 != b.length && b.multiple ? b.scrollTop : null, g = a.a.c(d()), m = c.get("optionsIncludeDestroyed");
                d = {}, s = b.multiple ? a.a.Da(e(), a.i.q) : 0 <= b.selectedIndex ? [ a.i.q(b.options[b.selectedIndex]) ] : [], 
                g && (void 0 === g.length && (g = [ g ]), l = a.a.ta(g, function(b) {
                    return m || b === n || null === b || !a.a.c(b._destroy);
                }), !c.has("optionsCaption") || null !== (g = a.a.c(c.get("optionsCaption"))) && g !== n && l.unshift(K));
                var q = !1;
                d.beforeRemove = function(a) {
                    b.removeChild(a);
                }, g = h, c.has("optionsAfterRender") && (g = function(b, d) {
                    h(0, d), a.k.B(c.get("optionsAfterRender"), null, [ d[0], b !== K ? b : n ]);
                }), a.a.Za(b, l, function(d, e, g) {
                    return g.length && (s = g[0].selected ? [ a.i.q(g[0]) ] : [], q = !0), e = b.ownerDocument.createElement("option"), 
                    d === K ? (a.a.bb(e, c.get("optionsCaption")), a.i.ca(e, n)) : (g = f(d, c.get("optionsValue"), d), 
                    a.i.ca(e, a.a.c(g)), d = f(d, c.get("optionsText"), g), a.a.bb(e, d)), [ e ];
                }, d, g), a.k.B(function() {
                    c.get("valueAllowUnset") && c.has("value") ? a.i.ca(b, a.a.c(c.get("value")), !0) : (b.multiple ? s.length && e().length < s.length : s.length && 0 <= b.selectedIndex ? a.i.q(b.options[b.selectedIndex]) !== s[0] : s.length || 0 <= b.selectedIndex) && a.a.oa(b, "change");
                }), a.a.dc(b), k && 20 < Math.abs(k - b.scrollTop) && (b.scrollTop = k);
            }
        }, a.d.options.Va = a.a.e.F(), a.d.selectedOptions = {
            after: [ "options", "foreach" ],
            init: function(b, d, c) {
                a.a.n(b, "change", function() {
                    var e = d(), f = [];
                    a.a.u(b.getElementsByTagName("option"), function(b) {
                        b.selected && f.push(a.i.q(b));
                    }), a.h.pa(e, c, "selectedOptions", f);
                });
            },
            update: function(b, d) {
                if ("select" != a.a.t(b)) throw Error("values binding applies only to SELECT elements");
                var c = a.a.c(d());
                c && "number" == typeof c.length && a.a.u(b.getElementsByTagName("option"), function(b) {
                    var d = 0 <= a.a.m(c, a.i.q(b));
                    a.a.Nb(b, d);
                });
            }
        }, a.h.V.selectedOptions = !0, a.d.style = {
            update: function(b, c) {
                c = a.a.c(c() || {});
                a.a.G(c, function(c, d) {
                    d = a.a.c(d), b.style[c] = d = null === d || d === n || !1 === d ? "" : d;
                });
            }
        }, a.d.submit = {
            init: function(b, d, c, e, f) {
                if ("function" != typeof d()) throw Error("The value for a submit binding must be a function");
                a.a.n(b, "submit", function(a) {
                    var c, e = d();
                    try {
                        c = e.call(f.$data, b);
                    } finally {
                        !0 !== c && (a.preventDefault ? a.preventDefault() : a.returnValue = !1);
                    }
                });
            }
        }, a.d.text = {
            init: function() {
                return {
                    controlsDescendantBindings: !0
                };
            },
            update: function(b, d) {
                a.a.bb(b, d());
            }
        }, a.f.Q.text = !0, function() {
            var b, d, c, e, f, h, k, g, m;
            v && v.navigator && (b = function(a) {
                if (a) return parseFloat(a[1]);
            }, d = v.opera && v.opera.version && parseInt(v.opera.version()), c = v.navigator.userAgent, 
            e = b(c.match(/^(?:(?!chrome).)*version\/([^ ]*) safari/i)), f = b(c.match(/Firefox\/([^ ]*)/))), 
            a.a.L < 10 && (h = a.a.e.F(), k = a.a.e.F(), g = function(b) {
                var c = this.activeElement;
                (c = c && a.a.e.get(c, k)) && c(b);
            }, m = function(b, c) {
                var d = b.ownerDocument;
                a.a.e.get(d, h) || (a.a.e.set(d, h, !0), a.a.n(d, "selectionchange", g)), a.a.e.set(b, k, c);
            }), a.d.textInput = {
                init: function(b, c, g) {
                    function h(c, d) {
                        a.a.n(b, c, d);
                    }
                    function u() {
                        x || (v = b.value, x = setTimeout(t, 4));
                    }
                    function t() {
                        clearTimeout(x), v = x = n;
                        var d = b.value;
                        r !== d && (r = d, a.h.pa(c(), g, "textInput", d));
                    }
                    var x, v, r = b.value;
                    a.a.L < 10 ? (h("propertychange", function(a) {
                        "value" === a.propertyName && t();
                    }), 8 == a.a.L && (h("keyup", t), h("keydown", t)), 8 <= a.a.L && (m(b, t), h("dragend", u))) : (h("input", t), 
                    e < 5 && "textarea" === a.a.t(b) ? (h("keydown", u), h("paste", u), h("cut", u)) : d < 11 ? h("keydown", u) : f < 4 && (h("DOMAutoComplete", t), 
                    h("dragdrop", t), h("drop", t))), h("change", t), a.s(function k() {
                        var d = a.a.c(c());
                        null !== d && d !== n || (d = ""), v !== n && d === v ? setTimeout(k, 4) : b.value !== d && (r = d, 
                        b.value = d);
                    }, null, {
                        o: b
                    });
                }
            }, a.h.V.textInput = !0, a.d.textinput = {
                preprocess: function(a, b, c) {
                    c("textInput", a);
                }
            };
        }(), a.d.uniqueName = {
            init: function(b, c) {
                c() && (c = "ko_unique_" + ++a.d.uniqueName.Zb, a.a.Mb(b, c));
            }
        }, a.d.uniqueName.Zb = 0, a.d.value = {
            after: [ "options", "foreach" ],
            init: function(b, d, c) {
                var e, f, h, k, g, m;
                "input" != b.tagName.toLowerCase() || "checkbox" != b.type && "radio" != b.type ? (e = [ "change" ], 
                f = c.get("valueUpdate"), h = !1, k = null, f && (a.a.ga(e, f = "string" == typeof f ? [ f ] : f), 
                e = a.a.rb(e)), g = function() {
                    k = null, h = !1;
                    var e = d(), g = a.i.q(b);
                    a.h.pa(e, c, "value", g);
                }, !a.a.L || "input" != b.tagName.toLowerCase() || "text" != b.type || "off" == b.autocomplete || b.form && "off" == b.form.autocomplete || -1 != a.a.m(e, "propertychange") || (a.a.n(b, "propertychange", function() {
                    h = !0;
                }), a.a.n(b, "focus", function() {
                    h = !1;
                }), a.a.n(b, "blur", function() {
                    h && g();
                })), a.a.u(e, function(c) {
                    var d = g;
                    a.a.uc(c, "after") && (d = function() {
                        k = a.i.q(b), setTimeout(g, 0);
                    }, c = c.substring(5)), a.a.n(b, c, d);
                }), m = function() {
                    var f, e = a.a.c(d()), g = a.i.q(b);
                    null !== k && e === k ? setTimeout(m, 0) : e !== g && ("select" === a.a.t(b) ? (f = c.get("valueAllowUnset"), 
                    (g = function() {
                        a.i.ca(b, e, f);
                    })(), f || e === a.i.q(b) ? setTimeout(g, 0) : a.k.B(a.a.oa, null, [ b, "change" ])) : a.i.ca(b, e));
                }, a.s(m, null, {
                    o: b
                })) : a.ra(b, {
                    checkedValue: d
                });
            },
            update: function() {}
        }, a.h.V.value = !0, a.d.visible = {
            update: function(b, e) {
                var c = a.a.c(e()), e = "none" != b.style.display;
                c && !e ? b.style.display = "" : !c && e && (b.style.display = "none");
            }
        }, function(b) {
            a.d[b] = {
                init: function(d, c, e, f, h) {
                    return a.d.event.init.call(this, d, function() {
                        var a = {};
                        return a[b] = c(), a;
                    }, e, f, h);
                }
            };
        }("click"), a.H = function() {}, a.H.prototype.renderTemplateSource = function() {
            throw Error("Override renderTemplateSource");
        }, a.H.prototype.createJavaScriptEvaluatorBlock = function() {
            throw Error("Override createJavaScriptEvaluatorBlock");
        }, a.H.prototype.makeTemplateSource = function(b, c) {
            if ("string" == typeof b) {
                c = (c = c || y).getElementById(b);
                if (!c) throw Error("Cannot find template with ID " + b);
                return new a.r.l(c);
            }
            if (1 == b.nodeType || 8 == b.nodeType) return new a.r.fa(b);
            throw Error("Unknown template type: " + b);
        }, a.H.prototype.renderTemplate = function(a, d, c, e) {
            return a = this.makeTemplateSource(a, e), this.renderTemplateSource(a, d, c);
        }, a.H.prototype.isTemplateRewritten = function(a, d) {
            return !1 === this.allowTemplateRewriting || this.makeTemplateSource(a, d).data("isRewritten");
        }, a.H.prototype.rewriteTemplate = function(a, d, c) {
            d = d((a = this.makeTemplateSource(a, c)).text()), a.text(d), a.data("isRewritten", !0);
        }, a.b("templateEngine", a.H), a.fb = function() {
            function b(b, c, d, k) {
                b = a.h.Wa(b);
                for (var g = a.h.ha, m = 0; m < b.length; m++) {
                    var l = b[m].key;
                    if (g.hasOwnProperty(l)) {
                        var s = g[l];
                        if ("function" == typeof s) {
                            if (l = s(b[m].value)) throw Error(l);
                        } else if (!s) throw Error("This template engine does not support the '" + l + "' binding within its templates");
                    }
                }
                return d = "ko.__tr_ambtns(function($context,$element){return(function(){return{ " + a.h.ya(b, {
                    valueAccessors: !0
                }) + " } })()},'" + d.toLowerCase() + "')", k.createJavaScriptEvaluatorBlock(d) + c;
            }
            var d = /(<([a-z]+\d*)(?:\s+(?!data-bind\s*=\s*)[a-z0-9\-]+(?:=(?:\"[^\"]*\"|\'[^\']*\'))?)*\s+)data-bind\s*=\s*(["'])([\s\S]*?)\3/gi, c = /\x3c!--\s*ko\b\s*([\s\S]*?)\s*--\x3e/g;
            return {
                ec: function(b, c, d) {
                    c.isTemplateRewritten(b, d) || c.rewriteTemplate(b, function(b) {
                        return a.fb.nc(b, c);
                    }, d);
                },
                nc: function(a, f) {
                    return a.replace(d, function(a, c, d, e, l) {
                        return b(l, c, d, f);
                    }).replace(c, function(a, c) {
                        return b(c, "\x3c!-- ko --\x3e", "#comment", f);
                    });
                },
                Xb: function(b, c) {
                    return a.D.Ua(function(g, k) {
                        g = g.nextSibling;
                        g && g.nodeName.toLowerCase() === c && a.ra(g, b, k);
                    });
                }
            };
        }(), a.b("__tr_ambtns", a.fb.Xb), function() {
            a.r = {}, a.r.l = function(a) {
                this.l = a;
            }, a.r.l.prototype.text = function() {
                var b = "script" === (b = a.a.t(this.l)) ? "text" : "textarea" === b ? "value" : "innerHTML";
                if (0 == arguments.length) return this.l[b];
                var d = arguments[0];
                "innerHTML" === b ? a.a.$a(this.l, d) : this.l[b] = d;
            };
            var b = a.a.e.F() + "_";
            a.r.l.prototype.data = function(c) {
                if (1 === arguments.length) return a.a.e.get(this.l, b + c);
                a.a.e.set(this.l, b + c, arguments[1]);
            };
            var d = a.a.e.F();
            a.r.fa = function(a) {
                this.l = a;
            }, a.r.fa.prototype = new a.r.l(), a.r.fa.prototype.text = function() {
                if (0 == arguments.length) {
                    var b = a.a.e.get(this.l, d) || {};
                    return b.gb === n && b.Ga && (b.gb = b.Ga.innerHTML), b.gb;
                }
                a.a.e.set(this.l, d, {
                    gb: arguments[0]
                });
            }, a.r.l.prototype.nodes = function() {
                if (0 == arguments.length) return (a.a.e.get(this.l, d) || {}).Ga;
                a.a.e.set(this.l, d, {
                    Ga: arguments[0]
                });
            }, a.b("templateSources", a.r), a.b("templateSources.domElement", a.r.l), a.b("templateSources.anonymousTemplate", a.r.fa);
        }(), function() {
            function b(b, c, d) {
                var e;
                for (c = a.f.nextSibling(c); b && (e = b) !== c; ) d(e, b = a.f.nextSibling(e));
            }
            function d(c, d) {
                if (c.length) {
                    var e = c[0], f = c[c.length - 1], h = e.parentNode, k = a.J.instance, n = k.preprocessNode;
                    if (n) {
                        if (b(e, f, function(a, b) {
                            var c = a.previousSibling, d = n.call(k, a);
                            d && (a === e && (e = d[0] || b), a === f && (f = d[d.length - 1] || c));
                        }), c.length = 0, !e) return;
                        e === f ? c.push(e) : (c.push(e, f), a.a.ka(c, h));
                    }
                    b(e, f, function(b) {
                        1 !== b.nodeType && 8 !== b.nodeType || a.pb(d, b);
                    }), b(e, f, function(b) {
                        1 !== b.nodeType && 8 !== b.nodeType || a.D.Sb(b, [ d ]);
                    }), a.a.ka(c, h);
                }
            }
            function c(a) {
                return a.nodeType ? a : 0 < a.length ? a[0] : null;
            }
            function e(b, e, f, k, q) {
                var p = (p = b && c(b)) && p.ownerDocument, n = (q = q || {}).templateEngine || h;
                if (a.fb.ec(f, n, p), "number" != typeof (f = n.renderTemplate(f, k, q, p)).length || 0 < f.length && "number" != typeof f[0].nodeType) throw Error("Template engine must return an array of DOM nodes");
                switch (p = !1, e) {
                  case "replaceChildren":
                    a.f.T(b, f), p = !0;
                    break;

                  case "replaceNode":
                    a.a.Lb(b, f), p = !0;
                    break;

                  case "ignoreTargetNode":
                    break;

                  default:
                    throw Error("Unknown renderMode: " + e);
                }
                return p && (d(f, k), q.afterRender && a.k.B(q.afterRender, null, [ f, k.$data ])), 
                f;
            }
            function f(b, c, d) {
                return a.C(b) ? b() : "function" == typeof b ? b(c, d) : b;
            }
            var h;
            a.ab = function(b) {
                if (b != n && !(b instanceof a.H)) throw Error("templateEngine must inherit from ko.templateEngine");
                h = b;
            }, a.Ya = function(b, d, k, s, q) {
                if (((k = k || {}).templateEngine || h) == n) throw Error("Set a template engine before calling renderTemplate");
                if (q = q || "replaceChildren", s) {
                    var p = c(s);
                    return a.j(function() {
                        var h = d && d instanceof a.N ? d : new a.N(a.a.c(d)), n = f(b, h.$data, h), h = e(s, q, n, h, k);
                        "replaceNode" == q && (p = c(s = h));
                    }, null, {
                        Ia: function() {
                            return !p || !a.a.Ja(p);
                        },
                        o: p && "replaceNode" == q ? p.parentNode : p
                    });
                }
                return a.D.Ua(function(c) {
                    a.Ya(b, d, k, c, "replaceNode");
                });
            }, a.tc = function(b, c, h, k, q) {
                function p(a, b) {
                    d(b, u), h.afterRender && h.afterRender(b, a);
                }
                function r(a, c) {
                    return u = q.createChildContext(a, h.as, function(a) {
                        a.$index = c;
                    }), e(null, "ignoreTargetNode", f(b, a, u), u, h);
                }
                var u;
                return a.j(function() {
                    var b = a.a.c(c) || [];
                    void 0 === b.length && (b = [ b ]), b = a.a.ta(b, function(b) {
                        return h.includeDestroyed || b === n || null === b || !a.a.c(b._destroy);
                    }), a.k.B(a.a.Za, null, [ k, b, r, h, p ]);
                }, null, {
                    o: k
                });
            };
            var k = a.a.e.F();
            a.d.template = {
                init: function(b, d) {
                    d = a.a.c(d());
                    return "string" == typeof d || d.name ? a.f.ja(b) : (d = a.f.childNodes(b), d = a.a.oc(d), 
                    new a.r.fa(b).nodes(d)), {
                        controlsDescendantBindings: !0
                    };
                },
                update: function(b, c, d, e, f) {
                    var r, h = c();
                    d = !0, e = null, "string" == typeof (c = a.a.c(h)) ? c = {} : (h = c.name, (d = "if" in c ? a.a.c(c.if) : d) && "ifnot" in c && (d = !a.a.c(c.ifnot)), 
                    r = a.a.c(c.data)), "foreach" in c ? e = a.tc(h || b, d && c.foreach || [], c, b, f) : d ? (f = "data" in c ? f.createChildContext(r, c.as) : f, 
                    e = a.Ya(h || b, f, c, b)) : a.f.ja(b), f = e, (r = a.a.e.get(b, k)) && "function" == typeof r.K && r.K(), 
                    a.a.e.set(b, k, f && f.Z() ? f : n);
                }
            }, a.h.ha.template = function(b) {
                return 1 == (b = a.h.Wa(b)).length && b[0].unknown || a.h.lc(b, "name") ? null : "This template engine does not support anonymous templates nested within its templates";
            }, a.f.Q.template = !0;
        }(), a.b("setTemplateEngine", a.ab), a.b("renderTemplate", a.Ya), a.a.wb = function(a, d, c) {
            if (a.length && d.length) for (var f, h, k, g, e = f = 0; (!c || e < c) && (k = a[f]); ++f) {
                for (h = 0; g = d[h]; ++h) if (k.value === g.value) {
                    k.moved = g.index, g.moved = k.index, d.splice(h, 1), e = h = 0;
                    break;
                }
                e += h;
            }
        }, a.a.Fa = function() {
            function b(b, c, e, f, h) {
                for (var q, t, v, x, k = Math.min, g = Math.max, m = [], n = b.length, p = c.length, r = p - n || 1, u = n + p + 1, l = 0; l <= n; l++) for (v = t, 
                m.push(t = []), x = k(p, l + r), q = g(0, l - 1); q <= x; q++) t[q] = q ? l ? b[l - 1] === c[q - 1] ? v[q - 1] : k(v[q] || u, t[q - 1] || u) + 1 : q + 1 : l + 1;
                for (k = [], g = [], r = [], l = n, q = p; l || q; ) p = m[l][q] - 1, q && p === m[l][q - 1] ? g.push(k[k.length] = {
                    status: e,
                    value: c[--q],
                    index: q
                }) : l && p === m[l - 1][q] ? r.push(k[k.length] = {
                    status: f,
                    value: b[--l],
                    index: l
                }) : (--q, --l, h.sparse || k.push({
                    status: "retained",
                    value: c[q]
                }));
                return a.a.wb(g, r, 10 * n), k.reverse();
            }
            return function(a, c, e) {
                return e = "boolean" == typeof e ? {
                    dontLimitMoves: e
                } : e || {}, (a = a || []).length <= (c = c || []).length ? b(a, c, "added", "deleted", e) : b(c, a, "deleted", "added", e);
            };
        }(), a.b("utils.compareArrays", a.a.Fa), function() {
            var d = a.a.e.F();
            a.a.Za = function(c, e, f, h, k) {
                function g(b, d) {
                    w = s[d], t !== d && (y[b] = w), w.Na(t++), a.a.ka(w.$, c), r.push(w), x.push(w);
                }
                function m(b, c) {
                    if (b) for (var d = 0, e = c.length; d < e; d++) c[d] && a.a.u(c[d].$, function(a) {
                        b(a, d, c[d].sa);
                    });
                }
                e = e || [], h = h || {};
                var l = a.a.e.get(c, d) === n, s = a.a.e.get(c, d) || [], q = a.a.Da(s, function(a) {
                    return a.sa;
                }), p = a.a.Fa(q, e, h.dontLimitMoves), r = [], u = 0, t = 0, v = [], x = [];
                e = [];
                for (var w, B, D, y = [], q = [], C = 0; B = p[C]; C++) switch (D = B.moved, B.status) {
                  case "deleted":
                    D === n && ((w = s[u]).j && w.j.K(), v.push.apply(v, a.a.ka(w.$, c)), h.beforeRemove && (e[C] = w, 
                    x.push(w))), u++;
                    break;

                  case "retained":
                    g(C, u++);
                    break;

                  case "added":
                    D !== n ? g(C, D) : (w = {
                        sa: B.value,
                        Na: a.p(t++)
                    }, r.push(w), x.push(w), l || (q[C] = w));
                }
                m(h.beforeMove, y), a.a.u(v, h.beforeRemove ? a.R : a.removeNode);
                for (var F, C = 0, l = a.f.firstChild(c); w = x[C]; C++) {
                    for (w.$ || a.a.extend(w, function(b, d, f, h, k) {
                        var g = [], m = a.j(function() {
                            var l = d(f, k, a.a.ka(g, b)) || [];
                            0 < g.length && (a.a.Lb(g, l), h && a.k.B(h, null, [ f, l, k ])), g.length = 0, 
                            a.a.ga(g, l);
                        }, null, {
                            o: b,
                            Ia: function() {
                                return !a.a.ob(g);
                            }
                        });
                        return {
                            $: g,
                            j: m.Z() ? m : n
                        };
                    }(c, f, w.sa, k, w.Na)), u = 0; p = w.$[u]; l = p.nextSibling, F = p, u++) p !== l && a.f.Bb(c, p, F);
                    !w.ic && k && (k(w.sa, w.$, w.Na), w.ic = !0);
                }
                m(h.beforeRemove, e), m(h.afterMove, y), m(h.afterAdd, q), a.a.e.set(c, d, r);
            };
        }(), a.b("utils.setDomNodeChildrenFromArrayMapping", a.a.Za), a.O = function() {
            this.allowTemplateRewriting = !1;
        }, a.O.prototype = new a.H(), a.O.prototype.renderTemplateSource = function(b) {
            var d = a.a.L < 9 || !b.nodes ? null : b.nodes();
            return d ? a.a.S(d.cloneNode(!0).childNodes) : (b = b.text(), a.a.ba(b));
        }, a.O.Oa = new a.O(), a.ab(a.O.Oa), a.b("nativeTemplateEngine", a.O), function() {
            a.Sa = function() {
                var a = this.kc = function() {
                    if (!r || !r.tmpl) return 0;
                    try {
                        if (0 <= r.tmpl.tag.tmpl.open.toString().indexOf("__")) return 2;
                    } catch (a) {}
                    return 1;
                }();
                this.renderTemplateSource = function(b, e, f) {
                    if (f = f || {}, a < 2) throw Error("Your version of jQuery.tmpl is too old. Please upgrade to jQuery.tmpl 1.0.0pre or later.");
                    var h = b.data("precompiled");
                    return h || (h = b.text() || "", h = r.template(null, "{{ko_with $item.koBindingContext}}" + h + "{{/ko_with}}"), 
                    b.data("precompiled", h)), b = [ e.$data ], e = r.extend({
                        koBindingContext: e
                    }, f.templateOptions), (e = r.tmpl(h, b, e)).appendTo(y.createElement("div")), r.fragments = {}, 
                    e;
                }, this.createJavaScriptEvaluatorBlock = function(a) {
                    return "{{ko_code ((function() { return " + a + " })()) }}";
                }, this.addTemplate = function(a, b) {
                    y.write("<script type='text/html' id='" + a + "'>" + b + "<\/script>");
                }, 0 < a && (r.tmpl.tag.ko_code = {
                    open: "__.push($1 || '');"
                }, r.tmpl.tag.ko_with = {
                    open: "with($1) {",
                    close: "} "
                });
            }, a.Sa.prototype = new a.H();
            var b = new a.Sa();
            0 < b.kc && a.ab(b), a.b("jqueryTmplTemplateEngine", a.Sa);
        }();
    });
}(), function(a, b) {
    "use strict";
    "object" == typeof exports ? b(exports, require("jquery"), require("knockout"), require("jquery-ui")) : "function" == typeof define && define.amd ? define([ "exports", "jquery", "knockout", "jquery-ui" ], b) : b(a.kojqui = {}, a.jQuery, a.ko);
}(this, function(a, b, c) {
    "use strict";
    var e, g, f, h, d = function() {
        var a = function(b) {
            b = (b || "").match(/^(\d)\.(\d+)\..*$/);
            return b ? {
                major: parseInt(b[1], 10),
                minor: parseInt(b[2], 10)
            } : null;
        };
        return {
            jQuery: b && b.fn ? a(b.fn.jquery) : null,
            jQueryUI: b && b.ui ? a(b.ui.version) : null,
            knockout: c ? a(c.version) : null
        };
    }();
    (function() {
        if (!d.jQuery) throw new Error("jQuery must be loaded before knockout-jquery.");
        if (!d.jQueryUI) throw new Error("jQuery UI must be loaded before knockout-jquery.");
        if (!d.knockout) throw new Error("knockout must be loaded before knockout-jquery.");
        if (d.jQueryUI.major < 1 || 1 === d.jQueryUI.major && d.jQueryUI.minor < 8) throw new Error("This version of the jQuery UI library is not supported.");
        if (d.knockout.major < 2 || 2 === d.knockout.major && d.knockout.minor < 2) throw new Error("This version of the knockout library is not supported.");
    })(), e = function() {
        var a = "__kojqui_options", d = function(a, b) {
            var d = {};
            return c.utils.arrayForEach(b, function(b) {
                void 0 !== a[b] && (d[b] = c.utils.unwrapObservable(a[b]));
            }), d;
        }, e = function(a, d, e) {
            c.isObservable(e.refreshOn) && c.computed({
                read: function() {
                    e.refreshOn(), b(d)[a]("refresh");
                },
                disposeWhenNodeIsRemoved: d
            });
        };
        return {
            create: function(f) {
                var h, i, g = f.name;
                b.fn[g] && (h = function(h, o, j, k, l) {
                    var m = o(), o = d(m, f.options), p = d(m, f.events), n = arguments;
                    return c.utils.arrayForEach(c.bindingHandlers[g].preInitHandlers, function(a) {
                        a.apply(this, n);
                    }), c.applyBindingsToDescendants(l, h), c.utils.domData.set(h, a, o), b.each(p, function(a, b) {
                        p[a] = b.bind(k);
                    }), b(h)[g](c.utils.extend(o, p)), f.hasRefresh && e(g, h, m), c.isWriteableObservable(m.widget) && m.widget(b(h)), 
                    c.utils.domNodeDisposal.addDisposeCallback(h, function() {
                        b(h)[g]("destroy");
                    }), c.utils.arrayForEach(c.bindingHandlers[g].postInitHandlers, function(a) {
                        a.apply(this, n);
                    }), {
                        controlsDescendantBindings: !0
                    };
                }, i = function(e, i) {
                    var i = i(), j = c.utils.domData.get(e, a), k = d(i, f.options);
                    b.each(k, function(a, c) {
                        c !== j[a] && b(e)[g]("option", a, k[a]);
                    }), c.utils.domData.set(e, a, k);
                }, c.bindingHandlers[g] = {
                    init: h,
                    update: i,
                    config: f,
                    preInitHandlers: [],
                    postInitHandlers: []
                }, f.preInit && c.bindingHandlers[g].preInitHandlers.push(f.preInit), f.postInit && c.bindingHandlers[g].postInitHandlers.push(f.postInit));
            }
        };
    }(), function() {
        var g, h, i, f = function(d, e) {
            var f = e();
            c.isWriteableObservable(f.active) && b(d).on(a, function() {
                f.active(b(d).accordion("option", "active"));
            }), c.utils.domNodeDisposal.addDisposeCallback(d, function() {
                b(d).off(".accordion");
            });
        }, a = 1 === d.jQueryUI.major && 8 === d.jQueryUI.minor ? (g = [ "active", "animated", "autoHeight", "clearStyle", "collapsible", "disabled", "event", "fillSpace", "header", "icons", "navigation", "navigationFilter" ], 
        i = !(h = [ "change", "changestart", "create" ]), "accordionchange.accordion") : (g = [ "active", "animate", "collapsible", "disabled", "event", "header", "heightStyle", "icons" ], 
        h = [ "activate", "beforeActivate", "create" ], i = !0, "accordionactivate.accordion");
        e.create({
            name: "accordion",
            options: g,
            events: h,
            postInit: f,
            hasRefresh: i
        });
    }(), function() {
        var a = 1 === d.jQueryUI.major && 8 === d.jQueryUI.minor ? [ "change", "close", "create", "focus", "open", "search", "select" ] : [ "change", "close", "create", "focus", "open", "response", "search", "select" ];
        e.create({
            name: "autocomplete",
            options: [ "appendTo", "autoFocus", "delay", "disabled", "minLength", "position", "source" ],
            events: a
        });
    }(), e.create({
        name: "button",
        options: [ "disabled", "icons", "label", "text" ],
        events: [ "create" ],
        hasRefresh: !0
    }), e.create({
        name: "buttonset",
        options: [ "items", "disabled" ],
        events: [ "create" ],
        hasRefresh: !0
    }), function() {
        var a = function(a, f) {
            var g, h, e = f(), f = c.utils.unwrapObservable(e.value);
            f && b(a).datepicker("setDate", f), c.isObservable(e.value) && (g = e.value.subscribe(function(c) {
                b(a).datepicker("setDate", c);
            }), c.utils.domNodeDisposal.addDisposeCallback(a, function() {
                g.dispose();
            })), c.isWriteableObservable(e.value) && (h = b(a).datepicker("option", "onSelect"), 
            b(a).datepicker("option", "onSelect", function(f) {
                var d = b(a).datepicker("option", "dateFormat"), f = b.datepicker.parseDate(d, f);
                e.value(f), "function" == typeof h && h.apply(this, Array.prototype.slice.call(arguments));
            }));
        };
        e.create({
            name: "datepicker",
            options: [ "altField", "altFormat", "appendText", "autoSize", "buttonImage", "buttonImageOnly", "buttonText", "calculateWeek", "changeMonth", "changeYear", "closeText", "constrainInput", "currentText", "dateFormat", "dayNames", "dayNamesMin", "dayNamesShort", "defaultDate", "duration", "firstDay", "gotoCurrent", "hideIfNoPrevNext", "isRTL", "maxDate", "minDate", "monthNames", "monthNamesShort", "navigationAsDateFormat", "nextText", "numberOfMonths", "prevText", "selectOtherMonths", "shortYearCutoff", "showAnim", "showButtonPanel", "showCurrentAtPos", "showMonthAfterYear", "showOn", "showOptions", "showOtherMonths", "showWeek", "stepMonths", "weekHeader", "yearRange", "yearSuffix", "beforeShow", "beforeShowDay", "onChangeMonthYear", "onClose", "onSelect" ],
            events: [],
            postInit: a
        });
    }(), f = function(a, d) {
        var e = d();
        e.isOpen && c.computed({
            read: function() {
                c.utils.unwrapObservable(e.isOpen) ? b(a).dialog("open") : b(a).dialog("close");
            },
            disposeWhenNodeIsRemoved: a
        }), c.isWriteableObservable(e.isOpen) && (b(a).on("dialogopen.dialog", function() {
            e.isOpen(!0);
        }), b(a).on("dialogclose.dialog", function() {
            e.isOpen(!1);
        })), c.utils.domNodeDisposal.addDisposeCallback(a, function() {
            b(a).off(".dialog");
        });
    }, g = 1 === d.jQueryUI.major && 8 === d.jQueryUI.minor ? [ "autoOpen", "buttons", "closeOnEscape", "closeText", "dialogClass", "disabled", "draggable", "height", "maxHeight", "maxWidth", "minHeight", "minWidth", "modal", "position", "resizable", "show", "stack", "title", "width", "zIndex" ] : 1 === d.jQueryUI.major && 9 === d.jQueryUI.minor ? [ "autoOpen", "buttons", "closeOnEscape", "closeText", "dialogClass", "draggable", "height", "hide", "maxHeight", "maxWidth", "minHeight", "minWidth", "modal", "position", "resizable", "show", "stack", "title", "width", "zIndex" ] : [ "appendTo", "autoOpen", "buttons", "closeOnEscape", "closeText", "dialogClass", "draggable", "height", "hide", "maxHeight", "maxWidth", "minHeight", "minWidth", "modal", "position", "resizable", "show", "title", "width" ], 
    h = [ "beforeClose", "create", "open", "focus", "dragStart", "drag", "dragStop", "resizeStart", "resize", "resizeStop", "close" ], 
    e.create({
        name: "dialog",
        options: g,
        events: h,
        preInit: function(a) {
            var b = document.createElement("DIV");
            b.style.display = "none", a.parentNode.insertBefore(b, a), c.utils.domNodeDisposal.addDisposeCallback(b, function() {
                c.removeNode(a);
            });
        },
        postInit: f
    }), e.create({
        name: "menu",
        options: [ "disabled", "icons", "menus", "position", "role" ],
        events: [ "blur", "create", "focus", "select" ],
        hasRefresh: !0
    }), function() {
        var a = 1 === d.jQueryUI.major && 8 === d.jQueryUI.minor ? [ "disabled", "value" ] : [ "disabled", "max", "value" ];
        e.create({
            name: "progressbar",
            options: a,
            events: [ "change", "create", "complete" ]
        });
    }(), function() {
        var a = function(a, d) {
            var e = d();
            c.isWriteableObservable(e.value) && b(a).on("slidechange.slider", function(c, d) {
                b(a).find(".ui-slider-handle")[0] === d.handle && e.value(d.value);
            }), c.utils.domNodeDisposal.addDisposeCallback(a, function() {
                b(a).off(".slider");
            });
        };
        e.create({
            name: "slider",
            options: [ "animate", "disabled", "max", "min", "orientation", "range", "step", "value", "values" ],
            events: [ "create", "start", "slide", "change", "stop" ],
            postInit: a
        });
    }(), function() {
        var a = function(a, d, e) {
            var f = d();
            f.value && c.computed({
                read: function() {
                    b(a).spinner("value", c.utils.unwrapObservable(f.value));
                },
                disposeWhenNodeIsRemoved: a
            }), c.isWriteableObservable(f.value) && (e().valueUpdate ? b(a).on("spin.spinner", function(a, b) {
                f.value(b.value);
            }) : b(a).on("spinchange.spinner", function() {
                f.value(b(a).spinner("value"));
            })), c.utils.domNodeDisposal.addDisposeCallback(a, function() {
                b(a).off(".spinner");
            });
        };
        e.create({
            name: "spinner",
            options: [ "culture", "disabled", "icons", "incremental", "max", "min", "numberFormat", "page", "step" ],
            events: [ "create", "start", "spin", "stop", "change" ],
            postInit: a
        });
    }(), function() {
        var g, h, j, a = function(a, d) {
            var e = d();
            c.isWriteableObservable(e.selected) && b(a).on("tabsshow.tabs", function(c, d) {
                b(a)[0] === c.target && e.selected(d.index);
            }), c.utils.domNodeDisposal.addDisposeCallback(a, function() {
                b(a).off(".tabs");
            });
        }, i = function(a, d) {
            var e = d();
            c.isWriteableObservable(e.active) && b(a).on("tabsactivate.tabs", function(c, d) {
                b(a)[0] === c.target && e.active(d.newTab.index());
            }), c.utils.domNodeDisposal.addDisposeCallback(a, function() {
                b(a).off(".tabs");
            });
        }, i = 1 === d.jQueryUI.major && 8 === d.jQueryUI.minor ? (g = [ "ajaxOptions", "cache", "collapsible", "cookie", "disabled", "event", "fx", "idPrefix", "panelTemplate", "selected", "spinner", "tabTemplate" ], 
        j = a, !(h = [ "add", "create", "disable", "enable", "load", "remove", "select", "show" ])) : (g = [ "active", "collapsible", "disabled", "event", "heightStyle", "hide", "show" ], 
        h = [ "activate", "beforeActivate", "beforeLoad", "create", "load" ], j = i, !0);
        e.create({
            name: "tabs",
            options: g,
            events: h,
            postInit: j,
            hasRefresh: i
        });
    }(), function() {
        var a = function(a, d) {
            var e = d();
            e.isOpen && c.computed({
                read: function() {
                    c.utils.unwrapObservable(e.isOpen) ? b(a).tooltip("open") : b(a).tooltip("close");
                },
                disposeWhenNodeIsRemoved: a
            }), c.isWriteableObservable(e.isOpen) && (b(a).on("tooltipopen.tooltip", function() {
                e.isOpen(!0);
            }), b(a).on("tooltipclose.tooltip", function() {
                e.isOpen(!1);
            })), c.utils.domNodeDisposal.addDisposeCallback(a, function() {
                b(a).off(".tooltip");
            });
        };
        e.create({
            name: "tooltip",
            options: [ "content", "disabled", "hide", "items", "position", "show", "tooltipClass", "track" ],
            events: [ "create", "open", "close" ],
            postInit: a
        });
    }(), a.bindingFactory = e, a.version = "1.0.0";
}), function(a) {
    var b, c;
    "function" == typeof define && define.amd ? define([ "knockout", "jquery", "jquery-ui/ui/widgets/sortable", "jquery-ui/ui/widgets/draggable", "jquery-ui/ui/widgets/droppable" ], a) : "function" == typeof require && "object" == typeof exports && "object" == typeof module ? (b = require("knockout"), 
    c = require("jquery"), require("jquery-ui/ui/widgets/sortable"), require("jquery-ui/ui/widgets/draggable"), 
    require("jquery-ui/ui/widgets/droppable"), a(b, c)) : a(window.ko, window.jQuery);
}(function(a, b) {
    function m(b, d) {
        a.utils.arrayForEach(b, function(a) {
            1 === a.nodeType && (j(a, c, d), j(a, f, i(a.parentNode, e)));
        });
    }
    function n(b, c) {
        var d, e = {}, f = h(b()) || {};
        return f.data ? (e[c] = f.data, e.name = f.template) : e[c] = b(), a.utils.arrayForEach([ "afterAdd", "afterRender", "as", "beforeRemove", "includeDestroyed", "templateEngine", "templateOptions", "nodes" ], function(b) {
            f.hasOwnProperty(b) ? e[b] = f[b] : a.bindingHandlers.sortable.hasOwnProperty(b) && (e[b] = a.bindingHandlers.sortable[b]);
        }), "foreach" === c && (e.afterRender ? (d = e.afterRender, e.afterRender = function(a, b) {
            m.call(b, a, b), d.call(b, a, b);
        }) : e.afterRender = m), e;
    }
    function o(a, b) {
        var c = h(b);
        if (c) for (var d = 0; d < a; d++) c[d] && h(c[d]._destroy) && a++;
        return a;
    }
    var c = "ko_sortItem", d = "ko_sourceIndex", e = "ko_sortList", f = "ko_parentList", g = "ko_dragItem", h = a.utils.unwrapObservable, i = a.utils.domData.get, j = a.utils.domData.set, k = b.ui && b.ui.version, l = k && k.indexOf("1.6.") && k.indexOf("1.7.") && (k.indexOf("1.8.") || "1.8.24" === k);
    a.bindingHandlers.sortable = {
        init: function(k, m, q, r, s) {
            var t, u, v = b(k), w = h(m()) || {}, x = n(m, "foreach"), y = {};
            (function(c, e) {
                e ? (e = document.getElementById(e)) && (e = new a.templateSources.domElement(e)).text(b.trim(e.text())) : b(c).contents().each(function() {
                    this && 1 !== this.nodeType && c.removeChild(this);
                });
            })(k, x.name), b.extend(!0, y, a.bindingHandlers.sortable), w.options && y.options && (a.utils.extend(y.options, w.options), 
            delete w.options), a.utils.extend(y, w), y.connectClass && (a.isObservable(y.allowDrop) || "function" == typeof y.allowDrop) ? a.computed({
                read: function() {
                    var c = h(y.allowDrop), c = "function" == typeof c ? c.call(this, x.foreach) : c;
                    a.utils.toggleDomNodeCssClass(k, y.connectClass, c);
                },
                disposeWhenNodeIsRemoved: k
            }, this) : a.utils.toggleDomNodeCssClass(k, y.connectClass, y.allowDrop), a.bindingHandlers.template.init(k, function() {
                return x;
            }, q, r, s), t = y.options.start, u = y.options.update, y.options.helper || (y.options.helper = function(a, c) {
                return c.is("tr") && c.children().each(function() {
                    b(this).width(b(this).width());
                }), c;
            });
            var z = setTimeout(function() {
                var m, n = y.options.receive;
                v.sortable(a.utils.extend(y.options, {
                    start: function(b, c) {
                        var e = c.item[0];
                        j(e, d, a.utils.arrayIndexOf(c.item.parent().children(), e)), c.item.find("input:focus").change(), 
                        t && t.apply(this, arguments);
                    },
                    receive: function(a, b) {
                        "function" == typeof n && n.call(this, a, b), (m = i(b.item[0], g)) && (m.clone && (m = m.clone()), 
                        y.dragged && (m = y.dragged.call(this, m, a, b) || m));
                    },
                    update: function(g, k) {
                        var n, p, q, r, s, t = k.item[0], z = k.item.parent()[0], w = i(t, c) || m;
                        if (w || b(t).remove(), m = null, w && this === z || !l && b.contains(this, z)) {
                            if (n = i(t, f), q = i(t, d), p = i(t.parentNode, e), r = a.utils.arrayIndexOf(k.item.parent().children(), t), 
                            x.includeDestroyed || (q = o(q, n), r = o(r, p)), (y.beforeMove || y.afterMove) && (s = {
                                item: w,
                                sourceParent: n,
                                sourceParentNode: n && k.sender || t.parentNode,
                                sourceIndex: q,
                                targetParent: p,
                                targetIndex: r,
                                cancelDrop: !1
                            }, y.beforeMove && y.beforeMove.call(this, s, g, k)), n ? b(n !== p && k.sender || this).sortable("cancel") : b(t).remove(), 
                            s && s.cancelDrop) return;
                            y.hasOwnProperty("strategyMove") && !1 !== y.strategyMove ? 0 <= r && (n ? n !== p ? (n.splice(q, 1), 
                            p.splice(r, 0, w), j(t, c, null), k.item.remove()) : (z = h(n), n.valueWillMutate && n.valueWillMutate(), 
                            z.splice(q, 1), z.splice(r, 0, w), n.valueHasMutated && n.valueHasMutated()) : (p.splice(r, 0, w), 
                            j(t, c, null), k.item.remove())) : (0 <= r && (n && (n.splice(q, 1), a.processAllDeferredBindingUpdates && a.processAllDeferredBindingUpdates(), 
                            a.options && a.options.deferUpdates && a.tasks.runEarly()), p.splice(r, 0, w)), 
                            j(t, c, null)), a.processAllDeferredBindingUpdates && a.processAllDeferredBindingUpdates(), 
                            y.afterMove && y.afterMove.call(this, s, g, k);
                        }
                        u && u.apply(this, arguments);
                    },
                    connectWith: !!y.connectClass && "." + y.connectClass
                })), void 0 !== y.isEnabled && a.computed({
                    read: function() {
                        v.sortable(h(y.isEnabled) ? "enable" : "disable");
                    },
                    disposeWhenNodeIsRemoved: k
                });
            }, 0);
            return a.utils.domNodeDisposal.addDisposeCallback(k, function() {
                (v.data("ui-sortable") || v.data("sortable")) && v.sortable("destroy"), a.utils.toggleDomNodeCssClass(k, y.connectClass, !1), 
                clearTimeout(z);
            }), {
                controlsDescendantBindings: !0
            };
        },
        update: function(b, c, d, f, g) {
            var h = n(c, "foreach");
            j(b, e, h.foreach), a.bindingHandlers.template.update(b, function() {
                return h;
            }, d, f, g);
        },
        connectClass: "ko_container",
        allowDrop: !0,
        afterMove: null,
        beforeMove: null,
        options: {}
    }, a.bindingHandlers.draggable = {
        init: function(c, p, e, f, i) {
            var l = (k = h(p()) || {}).options || {}, m = a.utils.extend({}, a.bindingHandlers.draggable.options), o = n(p, "data"), p = k.connectClass || a.bindingHandlers.draggable.connectClass, q = (void 0 !== k.isEnabled ? k : a.bindingHandlers.draggable).isEnabled, k = "data" in k ? k.data : k;
            return j(c, g, k), a.utils.extend(m, l), m.connectToSortable = !!p && "." + p, b(c).draggable(m), 
            void 0 !== q && a.computed({
                read: function() {
                    b(c).draggable(h(q) ? "enable" : "disable");
                },
                disposeWhenNodeIsRemoved: c
            }), a.utils.domNodeDisposal.addDisposeCallback(c, function() {
                b(c).draggable("destroy");
            }), a.bindingHandlers.template.init(c, function() {
                return o;
            }, e, f, i);
        },
        update: function(b, c, d, e, f) {
            var g = n(c, "data");
            return a.bindingHandlers.template.update(b, function() {
                return g;
            }, d, e, f);
        },
        connectClass: a.bindingHandlers.sortable.connectClass,
        options: {
            helper: "clone"
        }
    }, a.bindingHandlers.droppable = {
        init: function(d, e, f, j, k) {
            var l = h(e()) || {}, m = l.options || {}, n = a.utils.extend({}, a.bindingHandlers.droppable.options), o = (void 0 !== l.isEnabled ? l : a.bindingHandlers.droppable).isEnabled;
            a.utils.extend(n, m), l = "data" in l ? l.data : e(), n.drop = function(a, d) {
                d = i(d.draggable[0], g) || i(d.draggable[0], c);
                l(d);
            }, b(d).droppable(n), void 0 !== o && a.computed({
                read: function() {
                    b(d).droppable(h(o) ? "enable" : "disable");
                },
                disposeWhenNodeIsRemoved: d
            }), a.utils.domNodeDisposal.addDisposeCallback(d, function() {
                b(d).droppable("destroy");
            });
        },
        options: {
            accept: "*"
        }
    };
});

var _amdLoaderGlobal = this, _commonjsGlobal = "object" == typeof global ? global : {}, AMDLoader, AMDLoader, AMDLoader, AMDLoader, AMDLoader, AMDLoader, define, AMDLoader;

!function(l) {
    l.global = _amdLoaderGlobal;
    var E = (Object.defineProperty(h.prototype, "isWindows", {
        get: function() {
            return this._detect(), this._isWindows;
        },
        enumerable: !1,
        configurable: !0
    }), Object.defineProperty(h.prototype, "isNode", {
        get: function() {
            return this._detect(), this._isNode;
        },
        enumerable: !1,
        configurable: !0
    }), Object.defineProperty(h.prototype, "isElectronRenderer", {
        get: function() {
            return this._detect(), this._isElectronRenderer;
        },
        enumerable: !1,
        configurable: !0
    }), Object.defineProperty(h.prototype, "isWebWorker", {
        get: function() {
            return this._detect(), this._isWebWorker;
        },
        enumerable: !1,
        configurable: !0
    }), h.prototype._detect = function() {
        this._detected || (this._detected = !0, this._isWindows = h._isWindows(), this._isNode = "undefined" != typeof module && !!module.exports, 
        this._isElectronRenderer = "undefined" != typeof process && void 0 !== process.versions && void 0 !== process.versions.electron && "renderer" === process.type, 
        this._isWebWorker = "function" == typeof l.global.importScripts);
    }, h._isWindows = function() {
        return !!("undefined" != typeof navigator && navigator.userAgent && 0 <= navigator.userAgent.indexOf("Windows")) || "undefined" != typeof process && "win32" === process.platform;
    }, h);
    function h() {
        this._detected = !1, this._isWindows = !1, this._isNode = !1, this._isElectronRenderer = !1, 
        this._isWebWorker = !1;
    }
    l.Environment = E;
}(AMDLoader = AMDLoader || {}), function(l) {
    var E = function(n, p, r) {
        this.type = n, this.detail = p, this.timestamp = r;
    };
    l.LoaderEvent = E;
    var _ = (a.prototype.record = function(n, p) {
        this._events.push(new E(n, p, l.Utilities.getHighPerformanceTimestamp()));
    }, a.prototype.getEvents = function() {
        return this._events;
    }, a);
    function a(n) {
        this._events = [ new E(1, "", n) ];
    }
    l.LoaderEventRecorder = _;
    _ = function() {
        function a() {}
        return a.prototype.record = function(n, p) {}, a.prototype.getEvents = function() {
            return [];
        }, a.INSTANCE = new a(), a;
    }();
    l.NullLoaderEventRecorder = _;
}(AMDLoader = AMDLoader || {}), function(l) {
    var E = (h.fileUriToFilePath = function(_, a) {
        if (a = decodeURI(a).replace(/%23/g, "#"), _) {
            if (/^file:\/\/\//.test(a)) return a.substr(8);
            if (/^file:\/\//.test(a)) return a.substr(5);
        } else if (/^file:\/\//.test(a)) return a.substr(7);
        return a;
    }, h.startsWith = function(_, a) {
        return _.length >= a.length && _.substr(0, a.length) === a;
    }, h.endsWith = function(_, a) {
        return _.length >= a.length && _.substr(_.length - a.length) === a;
    }, h.containsQueryString = function(_) {
        return /^[^\#]*\?/gi.test(_);
    }, h.isAbsolutePath = function(_) {
        return /^((http:\/\/)|(https:\/\/)|(file:\/\/)|(\/))/.test(_);
    }, h.forEachProperty = function(_, a) {
        if (_) {
            var n = void 0;
            for (n in _) _.hasOwnProperty(n) && a(n, _[n]);
        }
    }, h.isEmpty = function(_) {
        var a = !0;
        return h.forEachProperty(_, function() {
            a = !1;
        }), a;
    }, h.recursiveClone = function(_) {
        if (!_ || "object" != typeof _ || _ instanceof RegExp || !Array.isArray(_) && Object.getPrototypeOf(_) !== Object.prototype) return _;
        var a = Array.isArray(_) ? [] : {};
        return h.forEachProperty(_, function(n, p) {
            a[n] = p && "object" == typeof p ? h.recursiveClone(p) : p;
        }), a;
    }, h.generateAnonymousModule = function() {
        return "===anonymous" + h.NEXT_ANONYMOUS_ID++ + "===";
    }, h.isAnonymousModule = function(_) {
        return h.startsWith(_, "===anonymous");
    }, h.getHighPerformanceTimestamp = function() {
        return this.PERFORMANCE_NOW_PROBED || (this.PERFORMANCE_NOW_PROBED = !0, this.HAS_PERFORMANCE_NOW = l.global.performance && "function" == typeof l.global.performance.now), 
        (this.HAS_PERFORMANCE_NOW ? l.global.performance : Date).now();
    }, h.NEXT_ANONYMOUS_ID = 1, h.PERFORMANCE_NOW_PROBED = !1, h.HAS_PERFORMANCE_NOW = !1, 
    h);
    function h() {}
    l.Utilities = E;
}(AMDLoader = AMDLoader || {}), function(l) {
    function E(a) {
        if (a instanceof Error) return a;
        var n = new Error(a.message || String(a) || "Unknown Error");
        return a.stack && (n.stack = a.stack), n;
    }
    l.ensureError = E;
    var h = (a.validateConfigurationOptions = function(n) {
        var r;
        return "string" != typeof (n = n || {}).baseUrl && (n.baseUrl = ""), "boolean" != typeof n.isBuild && (n.isBuild = !1), 
        "object" != typeof n.paths && (n.paths = {}), "object" != typeof n.config && (n.config = {}), 
        void 0 === n.catchError && (n.catchError = !1), void 0 === n.recordStats && (n.recordStats = !1), 
        "string" != typeof n.urlArgs && (n.urlArgs = ""), "function" != typeof n.onError && (n.onError = function(e) {
            if ("loading" === e.phase) return console.error('Loading "' + e.moduleId + '" failed'), 
            console.error(e), console.error("Here are the modules that depend on it:"), void console.error(e.neededBy);
            "factory" === e.phase && (console.error('The factory method of "' + e.moduleId + '" has thrown an exception'), 
            console.error(e));
        }), Array.isArray(n.ignoreDuplicateModules) || (n.ignoreDuplicateModules = []), 
        0 < n.baseUrl.length && (l.Utilities.endsWith(n.baseUrl, "/") || (n.baseUrl += "/")), 
        "string" != typeof n.cspNonce && (n.cspNonce = ""), void 0 === n.preferScriptTags && (n.preferScriptTags = !1), 
        Array.isArray(n.nodeModules) || (n.nodeModules = []), n.nodeCachedData && "object" == typeof n.nodeCachedData && ("string" != typeof n.nodeCachedData.seed && (n.nodeCachedData.seed = "seed"), 
        ("number" != typeof n.nodeCachedData.writeDelay || n.nodeCachedData.writeDelay < 0) && (n.nodeCachedData.writeDelay = 7e3), 
        !n.nodeCachedData.path || "string" != typeof n.nodeCachedData.path) && ((r = E(new Error("INVALID cached data configuration, 'path' MUST be set"))).phase = "configuration", 
        n.onError(r), n.nodeCachedData = void 0), n;
    }, a.mergeConfigurationOptions = function(n, p) {
        void 0 === n && (n = null);
        var r = l.Utilities.recursiveClone((p = void 0 === p ? null : p) || {});
        return l.Utilities.forEachProperty(n, function(e, t) {
            "ignoreDuplicateModules" === e && void 0 !== r.ignoreDuplicateModules ? r.ignoreDuplicateModules = r.ignoreDuplicateModules.concat(t) : "paths" === e && void 0 !== r.paths ? l.Utilities.forEachProperty(t, function(i, o) {
                return r.paths[i] = o;
            }) : "config" === e && void 0 !== r.config ? l.Utilities.forEachProperty(t, function(i, o) {
                return r.config[i] = o;
            }) : r[e] = l.Utilities.recursiveClone(t);
        }), a.validateConfigurationOptions(r);
    }, a);
    function a() {}
    l.ConfigurationOptionsUtil = h;
    var _ = function() {
        function a(n, p) {
            var r, e;
            this._env = n, this.options = h.mergeConfigurationOptions(p), this._createIgnoreDuplicateModulesMap(), 
            this._createNodeModulesMap(), this._createSortedPathsRules(), "" === this.options.baseUrl && (this.options.nodeRequire && this.options.nodeRequire.main && this.options.nodeRequire.main.filename && this._env.isNode && (r = this.options.nodeRequire.main.filename, 
            e = Math.max(r.lastIndexOf("/"), r.lastIndexOf("\\")), this.options.baseUrl = r.substring(0, e + 1)), 
            this.options.nodeMain && this._env.isNode && (r = this.options.nodeMain, e = Math.max(r.lastIndexOf("/"), r.lastIndexOf("\\")), 
            this.options.baseUrl = r.substring(0, e + 1)));
        }
        return a.prototype._createIgnoreDuplicateModulesMap = function() {
            this.ignoreDuplicateModulesMap = {};
            for (var n = 0; n < this.options.ignoreDuplicateModules.length; n++) this.ignoreDuplicateModulesMap[this.options.ignoreDuplicateModules[n]] = !0;
        }, a.prototype._createNodeModulesMap = function() {
            this.nodeModulesMap = Object.create(null);
            for (var n = 0, p = this.options.nodeModules; n < p.length; n++) {
                var r = p[n];
                this.nodeModulesMap[r] = !0;
            }
        }, a.prototype._createSortedPathsRules = function() {
            var n = this;
            this.sortedPathsRules = [], l.Utilities.forEachProperty(this.options.paths, function(p, r) {
                Array.isArray(r) ? n.sortedPathsRules.push({
                    from: p,
                    to: r
                }) : n.sortedPathsRules.push({
                    from: p,
                    to: [ r ]
                });
            }), this.sortedPathsRules.sort(function(p, r) {
                return r.from.length - p.from.length;
            });
        }, a.prototype.cloneAndMerge = function(n) {
            return new a(this._env, h.mergeConfigurationOptions(n, this.options));
        }, a.prototype.getOptionsLiteral = function() {
            return this.options;
        }, a.prototype._applyPaths = function(n) {
            for (var p, r = 0, e = this.sortedPathsRules.length; r < e; r++) if (p = this.sortedPathsRules[r], 
            l.Utilities.startsWith(n, p.from)) {
                for (var t = [], i = 0, o = p.to.length; i < o; i++) t.push(p.to[i] + n.substr(p.from.length));
                return t;
            }
            return [ n ];
        }, a.prototype._addUrlArgsToUrl = function(n) {
            return l.Utilities.containsQueryString(n) ? n + "&" + this.options.urlArgs : n + "?" + this.options.urlArgs;
        }, a.prototype._addUrlArgsIfNecessaryToUrl = function(n) {
            return this.options.urlArgs ? this._addUrlArgsToUrl(n) : n;
        }, a.prototype._addUrlArgsIfNecessaryToUrls = function(n) {
            if (this.options.urlArgs) for (var p = 0, r = n.length; p < r; p++) n[p] = this._addUrlArgsToUrl(n[p]);
            return n;
        }, a.prototype.moduleIdToPaths = function(r) {
            if (!0 === this.nodeModulesMap[r] || this.options.amdModulesPattern instanceof RegExp && !this.options.amdModulesPattern.test(r)) return this.isBuild() ? [ "empty:" ] : [ "node|" + r ];
            if (l.Utilities.endsWith(r, ".js") || l.Utilities.isAbsolutePath(r)) l.Utilities.endsWith(r, ".js") || l.Utilities.containsQueryString(r) || (r += ".js"), 
            e = [ r ]; else for (var e, t = 0, i = (e = this._applyPaths(r)).length; t < i; t++) this.isBuild() && "empty:" === e[t] || (l.Utilities.isAbsolutePath(e[t]) || (e[t] = this.options.baseUrl + e[t]), 
            l.Utilities.endsWith(e[t], ".js") || l.Utilities.containsQueryString(e[t]) || (e[t] = e[t] + ".js"));
            return this._addUrlArgsIfNecessaryToUrls(e);
        }, a.prototype.requireToUrl = function(p) {
            return l.Utilities.isAbsolutePath(p) || (p = this._applyPaths(p)[0], l.Utilities.isAbsolutePath(p) || (p = this.options.baseUrl + p)), 
            this._addUrlArgsIfNecessaryToUrl(p);
        }, a.prototype.isBuild = function() {
            return this.options.isBuild;
        }, a.prototype.isDuplicateMessageIgnoredFor = function(n) {
            return this.ignoreDuplicateModulesMap.hasOwnProperty(n);
        }, a.prototype.getConfigForModule = function(n) {
            if (this.options.config) return this.options.config[n];
        }, a.prototype.shouldCatchError = function() {
            return this.options.catchError;
        }, a.prototype.shouldRecordStats = function() {
            return this.options.recordStats;
        }, a.prototype.onError = function(n) {
            this.options.onError(n);
        }, a;
    }();
    l.Configuration = _;
}(AMDLoader = AMDLoader || {}), function(l) {
    var E = (r.prototype.load = function(e, t, i, f) {
        var s, u = this;
        this._scriptLoader || (this._env.isWebWorker ? this._scriptLoader = new _() : this._env.isElectronRenderer ? (s = e.getConfig().getOptionsLiteral().preferScriptTags, 
        this._scriptLoader = s ? new h() : new a(this._env)) : this._env.isNode ? this._scriptLoader = new a(this._env) : this._scriptLoader = new h());
        f = {
            callback: i,
            errorback: f
        };
        this._callbackMap.hasOwnProperty(t) ? this._callbackMap[t].push(f) : (this._callbackMap[t] = [ f ], 
        this._scriptLoader.load(e, t, function() {
            return u.triggerCallback(t);
        }, function(c) {
            return u.triggerErrorback(t, c);
        }));
    }, r.prototype.triggerCallback = function(e) {
        var t = this._callbackMap[e];
        delete this._callbackMap[e];
        for (var i = 0; i < t.length; i++) t[i].callback();
    }, r.prototype.triggerErrorback = function(e, t) {
        var i = this._callbackMap[e];
        delete this._callbackMap[e];
        for (var o = 0; o < i.length; o++) i[o].errorback(t);
    }, r), h = function() {
        function r() {}
        return r.prototype.attachListeners = function(e, t, i) {
            function o() {
                e.removeEventListener("load", u), e.removeEventListener("error", s);
            }
            var u = function(f) {
                o(), t();
            }, s = function(f) {
                o(), i(f);
            };
            e.addEventListener("load", u), e.addEventListener("error", s);
        }, r.prototype.load = function(g, t, i, v) {
            if (/^node\|/.test(t)) {
                var d = g.getConfig().getOptionsLiteral(), s = n(g.getRecorder(), d.nodeRequire || l.global.nodeRequire), d = t.split("|"), c = null;
                try {
                    c = s(d[1]);
                } catch (y) {
                    return void v(y);
                }
                g.enqueueDefineAnonymousModule([], function() {
                    return c;
                }), i();
            } else {
                d = document.createElement("script");
                d.setAttribute("async", "async"), d.setAttribute("type", "text/javascript"), this.attachListeners(d, i, v);
                v = g.getConfig().getOptionsLiteral().trustedTypesPolicy;
                v && (t = v.createScriptURL(t)), d.setAttribute("src", t);
                g = g.getConfig().getOptionsLiteral().cspNonce;
                g && d.setAttribute("nonce", g), document.getElementsByTagName("head")[0].appendChild(d);
            }
        }, r;
    }(), _ = function() {
        function r() {}
        return r.prototype.load = function(u, t, i, o) {
            u = u.getConfig().getOptionsLiteral().trustedTypesPolicy;
            u && (t = u.createScriptURL(t));
            try {
                importScripts(t), i();
            } catch (s) {
                o(s);
            }
        }, r;
    }(), a = function() {
        function r(e) {
            this._env = e, this._didInitialize = !1, this._didPatchNodeRequire = !1;
        }
        return r.prototype._init = function(e) {
            this._didInitialize || (this._didInitialize = !0, this._fs = e("fs"), this._vm = e("vm"), 
            this._path = e("path"), this._crypto = e("crypto"));
        }, r.prototype._initNodeRequire = function(e, t) {
            var o, u, i = t.getConfig().getOptionsLiteral().nodeCachedData;
            function s(f) {
                function d(g) {
                    return f.require(g);
                }
                var c = f.constructor;
                return d.resolve = function(g, y) {
                    return c._resolveFilename(g, f, !1, y);
                }, d.main = process.mainModule, d.extensions = c._extensions, d.cache = c._cache, 
                d;
            }
            i && !this._didPatchNodeRequire && (this._didPatchNodeRequire = !0, o = this, (u = e("module")).prototype._compile = function(C, c) {
                var d = u.wrap(C.replace(/^#!.*/, "")), U = t.getRecorder(), g = o._getCachedDataPath(i, c), y = {
                    filename: c
                };
                try {
                    var R = o._fs.readFileSync(g), m = R.slice(0, 16);
                    y.cachedData = R.slice(16), U.record(60, g);
                } catch (O) {
                    U.record(61, g);
                }
                var b = new o._vm.Script(d, y), C = b.runInThisContext(y), R = o._path.dirname(c), U = s(this), R = [ this.exports, U, this, c, R, process, _commonjsGlobal, Buffer ], R = C.apply(this.exports, R);
                return o._handleCachedData(b, d, g, !y.cachedData, t), o._verifyCachedData(b, d, g, m, t), 
                R;
            });
        }, r.prototype.load = function(e, t, i, o) {
            var u = this, s = e.getConfig().getOptionsLiteral(), f = n(e.getRecorder(), s.nodeRequire || l.global.nodeRequire), c = s.nodeInstrumenter || function(C) {
                return C;
            };
            this._init(f), this._initNodeRequire(f, e);
            var d = e.getRecorder();
            if (/^node\|/.test(t)) {
                var v = t.split("|"), g = null;
                try {
                    g = f(v[1]);
                } catch (C) {
                    return void o(C);
                }
                e.enqueueDefineAnonymousModule([], function() {
                    return g;
                }), i();
            } else {
                t = l.Utilities.fileUriToFilePath(this._env.isWindows, t);
                var y = this._path.normalize(t), m = this._getElectronRendererScriptPathOrUri(y), I = Boolean(s.nodeCachedData), b = I ? this._getCachedDataPath(s.nodeCachedData, t) : void 0;
                this._readSourceAndCachedData(y, b, d, function(R, M, U, w) {
                    R ? o(R) : (R = M.charCodeAt(0) === r._BOM ? r._PREFIX + M.substring(1) + r._SUFFIX : r._PREFIX + M + r._SUFFIX, 
                    R = c(R, y), M = u._createAndEvalScript(e, R, {
                        filename: m,
                        cachedData: U
                    }, i, o), u._handleCachedData(M, R, b, I && !U, e), u._verifyCachedData(M, R, b, w, e));
                });
            }
        }, r.prototype._createAndEvalScript = function(e, g, i, o, u) {
            var s = e.getRecorder();
            s.record(31, i.filename);
            var f = new this._vm.Script(g, i), c = f.runInThisContext(i), d = e.getGlobalAMDDefineFunc(), v = !1, g = function() {
                return v = !0, d.apply(null, arguments);
            };
            return g.amd = d.amd, c.call(l.global, e.getGlobalAMDRequireFunc(), g, i.filename, this._path.dirname(i.filename)), 
            s.record(32, i.filename), v ? o() : u(new Error("Didn't receive define call in " + i.filename + "!")), 
            f;
        }, r.prototype._getElectronRendererScriptPathOrUri = function(e) {
            if (!this._env.isElectronRenderer) return e;
            var t = e.match(/^([a-z])\:(.*)/i);
            return t ? "file:///" + (t[1].toUpperCase() + ":" + t[2]).replace(/\\/g, "/") : "file://" + e;
        }, r.prototype._getCachedDataPath = function(e, o) {
            var i = this._crypto.createHash("md5").update(o, "utf8").update(e.seed, "utf8").update(process.arch, "").digest("hex"), o = this._path.basename(o).replace(/\.js$/, "");
            return this._path.join(e.path, o + "-" + i + ".code");
        }, r.prototype._handleCachedData = function(e, t, i, o, u) {
            var s = this;
            e.cachedDataRejected ? this._fs.unlink(i, function(f) {
                u.getRecorder().record(62, i), s._createAndWriteCachedData(e, t, i, u), f && u.getConfig().onError(f);
            }) : o && this._createAndWriteCachedData(e, t, i, u);
        }, r.prototype._createAndWriteCachedData = function(e, t, i, o) {
            var u = this, s = Math.ceil(o.getConfig().getOptionsLiteral().nodeCachedData.writeDelay * (1 + Math.random())), f = -1, c = 0, d = void 0, v = function() {
                setTimeout(function() {
                    d = d || u._crypto.createHash("md5").update(t, "utf8").digest();
                    var g = e.createCachedData();
                    0 === g.length || g.length === f || 5 <= c || (g.length < f ? v() : (f = g.length, 
                    u._fs.writeFile(i, Buffer.concat([ d, g ]), function(y) {
                        y && o.getConfig().onError(y), o.getRecorder().record(63, i), v();
                    })));
                }, s * Math.pow(4, c++));
            };
            v();
        }, r.prototype._readSourceAndCachedData = function(e, t, i, o) {
            var u, s, f, c, d;
            t ? (f = s = u = void 0, c = 2, d = function(v) {
                v ? o(v) : 0 == --c && o(void 0, u, s, f);
            }, this._fs.readFile(e, {
                encoding: "utf8"
            }, function(v, g) {
                u = g, d(v);
            }), this._fs.readFile(t, function(v, g) {
                !v && g && 0 < g.length ? (f = g.slice(0, 16), s = g.slice(16), i.record(60, t)) : i.record(61, t), 
                d();
            })) : this._fs.readFile(e, {
                encoding: "utf8"
            }, o);
        }, r.prototype._verifyCachedData = function(e, t, i, o, u) {
            var s = this;
            !o || e.cachedDataRejected || setTimeout(function() {
                var f = s._crypto.createHash("md5").update(t, "utf8").digest();
                o.equals(f) || (u.getConfig().onError(new Error("FAILED TO VERIFY CACHED DATA, deleting stale '" + i + "' now, but a RESTART IS REQUIRED")), 
                s._fs.unlink(i, function(c) {
                    c && u.getConfig().onError(c);
                }));
            }, Math.ceil(5e3 * (1 + Math.random())));
        }, r._BOM = 65279, r._PREFIX = "(function (require, define, __filename, __dirname) { ", 
        r._SUFFIX = `
});`, r;
    }();
    function r(e) {
        this._env = e, this._scriptLoader = null, this._callbackMap = {};
    }
    function n(r, e) {
        if (e.__$__isRecorded) return e;
        function t(o) {
            r.record(33, o);
            try {
                return e(o);
            } finally {
                r.record(34, o);
            }
        }
        return t.__$__isRecorded = !0, t;
    }
    l.ensureRecordedNodeRequire = n, l.createScriptLoader = function(r) {
        return new E(r);
    };
}(AMDLoader = AMDLoader || {}), function(l) {
    var E = (r._normalizeModuleId = function(e) {
        for (var t = e, i = /\/\.\//; i.test(t); ) t = t.replace(i, "/");
        for (t = t.replace(/^\.\//g, ""), i = /\/(([^\/])|([^\/][^\/\.])|([^\/\.][^\/])|([^\/][^\/][^\/]+))\/\.\.\//; i.test(t); ) t = t.replace(i, "/");
        return t = t.replace(/^(([^\/])|([^\/][^\/\.])|([^\/\.][^\/])|([^\/][^\/][^\/]+))\/\.\.\//, "");
    }, r.prototype.resolveModule = function(t) {
        return l.Utilities.isAbsolutePath(t) || (l.Utilities.startsWith(t, "./") || l.Utilities.startsWith(t, "../")) && (t = r._normalizeModuleId(this.fromModulePath + t)), 
        t;
    }, r.ROOT = new r(""), r);
    function r(e) {
        var t = e.lastIndexOf("/");
        this.fromModulePath = -1 !== t ? e.substr(0, t + 1) : "";
    }
    l.ModuleIdResolver = E;
    var h = function() {
        function r(e, t, i, o, u, s) {
            this.id = e, this.strId = t, this.dependencies = i, this._callback = o, this._errorback = u, 
            this.moduleIdResolver = s, this.exports = {}, this.error = null, this.exportsPassedIn = !1, 
            this.unresolvedDependenciesCount = this.dependencies.length, this._isComplete = !1;
        }
        return r._safeInvokeFunction = function(e, t) {
            try {
                return {
                    returnedValue: e.apply(l.global, t),
                    producedError: null
                };
            } catch (i) {
                return {
                    returnedValue: null,
                    producedError: i
                };
            }
        }, r._invokeFactory = function(e, t, i, o) {
            return e.isBuild() && !l.Utilities.isAnonymousModule(t) ? {
                returnedValue: null,
                producedError: null
            } : e.shouldCatchError() ? this._safeInvokeFunction(i, o) : {
                returnedValue: i.apply(l.global, o),
                producedError: null
            };
        }, r.prototype.complete = function(e, t, u) {
            this._isComplete = !0;
            var s = null;
            this._callback && ("function" == typeof this._callback ? (e.record(21, this.strId), 
            s = (u = r._invokeFactory(t, this.strId, this._callback, u)).producedError, e.record(22, this.strId), 
            s || void 0 === u.returnedValue || this.exportsPassedIn && !l.Utilities.isEmpty(this.exports) || (this.exports = u.returnedValue)) : this.exports = this._callback), 
            s && ((s = l.ensureError(s)).phase = "factory", s.moduleId = this.strId, this.error = s, 
            t.onError(s)), this.dependencies = null, this._callback = null, this._errorback = null, 
            this.moduleIdResolver = null;
        }, r.prototype.onDependencyError = function(e) {
            return this._isComplete = !0, this.error = e, !!this._errorback && (this._errorback(e), 
            !0);
        }, r.prototype.isComplete = function() {
            return this._isComplete;
        }, r;
    }();
    l.Module = h;
    var _ = function() {
        function r() {
            this._nextId = 0, this._strModuleIdToIntModuleId = new Map(), this._intModuleIdToStrModuleId = [], 
            this.getModuleId("exports"), this.getModuleId("module"), this.getModuleId("require");
        }
        return r.prototype.getMaxModuleId = function() {
            return this._nextId;
        }, r.prototype.getModuleId = function(e) {
            var t = this._strModuleIdToIntModuleId.get(e);
            return void 0 === t && (t = this._nextId++, this._strModuleIdToIntModuleId.set(e, t), 
            this._intModuleIdToStrModuleId[t] = e), t;
        }, r.prototype.getStrModuleId = function(e) {
            return this._intModuleIdToStrModuleId[e];
        }, r;
    }(), a = function() {
        function r(e) {
            this.id = e;
        }
        return r.EXPORTS = new r(0), r.MODULE = new r(1), r.REQUIRE = new r(2), r;
    }();
    l.RegularDependency = a;
    var n = function(e, t, i) {
        this.id = e, this.pluginId = t, this.pluginParam = i;
    };
    l.PluginDependency = n;
    var p = function() {
        function r(e, t, i, o, u) {
            void 0 === u && (u = 0), this._env = e, this._scriptLoader = t, this._loaderAvailableTimestamp = u, 
            this._defineFunc = i, this._requireFunc = o, this._moduleIdProvider = new _(), this._config = new l.Configuration(this._env), 
            this._hasDependencyCycle = !1, this._modules2 = [], this._knownModules2 = [], this._inverseDependencies2 = [], 
            this._inversePluginDependencies2 = new Map(), this._currentAnnonymousDefineCall = null, 
            this._recorder = null, this._buildInfoPath = [], this._buildInfoDefineStack = [], 
            this._buildInfoDependencies = [];
        }
        return r.prototype.reset = function() {
            return new r(this._env, this._scriptLoader, this._defineFunc, this._requireFunc, this._loaderAvailableTimestamp);
        }, r.prototype.getGlobalAMDDefineFunc = function() {
            return this._defineFunc;
        }, r.prototype.getGlobalAMDRequireFunc = function() {
            return this._requireFunc;
        }, r._findRelevantLocationInStack = function(e, t) {
            function i(m) {
                return m.replace(/\\/g, "/");
            }
            for (var o = i(e), u = t.split(/\n/), s = 0; s < u.length; s++) {
                var g = u[s].match(/(.*):(\d+):(\d+)\)?$/);
                if (g) {
                    var c = g[1], d = g[2], y = g[3], g = Math.max(c.lastIndexOf(" ") + 1, c.lastIndexOf("(") + 1);
                    if ((c = i(c = c.substr(g))) === o) {
                        y = {
                            line: parseInt(d, 10),
                            col: parseInt(y, 10)
                        };
                        return 1 === y.line && (y.col -= "(function (require, define, __filename, __dirname) { ".length), 
                        y;
                    }
                }
            }
            throw new Error("Could not correlate define call site for needle " + e);
        }, r.prototype.getBuildInfo = function() {
            if (!this._config.isBuild()) return null;
            for (var e = [], t = 0, i = 0, o = this._modules2.length; i < o; i++) {
                var s, f, c, u = this._modules2[i];
                u && (s = this._buildInfoPath[u.id] || null, f = this._buildInfoDefineStack[u.id] || null, 
                c = this._buildInfoDependencies[u.id], e[t++] = {
                    id: u.strId,
                    path: s,
                    defineLocation: s && f ? r._findRelevantLocationInStack(s, f) : null,
                    dependencies: c,
                    shim: null,
                    exports: u.exports
                });
            }
            return e;
        }, r.prototype.getRecorder = function() {
            return this._recorder || (this._config.shouldRecordStats() ? this._recorder = new l.LoaderEventRecorder(this._loaderAvailableTimestamp) : this._recorder = l.NullLoaderEventRecorder.INSTANCE), 
            this._recorder;
        }, r.prototype.getLoaderEvents = function() {
            return this.getRecorder().getEvents();
        }, r.prototype.enqueueDefineAnonymousModule = function(e, t) {
            if (null !== this._currentAnnonymousDefineCall) throw new Error("Can only have one anonymous define call per script file");
            var i = null;
            this._config.isBuild() && (i = new Error("StackLocation").stack || null), this._currentAnnonymousDefineCall = {
                stack: i,
                dependencies: e,
                callback: t
            };
        }, r.prototype.defineModule = function(e, t, i, o, u, d) {
            var f = this;
            void 0 === d && (d = new E(e));
            var c = this._moduleIdProvider.getModuleId(e);
            this._modules2[c] ? this._config.isDuplicateMessageIgnoredFor(e) || console.warn("Duplicate definition of module '" + e + "'") : (d = new h(c, e, this._normalizeDependencies(t, d), i, o, d), 
            this._modules2[c] = d, this._config.isBuild() && (this._buildInfoDefineStack[c] = u, 
            this._buildInfoDependencies[c] = (d.dependencies || []).map(function(v) {
                return f._moduleIdProvider.getStrModuleId(v.id);
            })), this._resolve(d));
        }, r.prototype._normalizeDependency = function(e, t) {
            if ("exports" === e) return a.EXPORTS;
            if ("module" === e) return a.MODULE;
            if ("require" === e) return a.REQUIRE;
            var s = e.indexOf("!");
            if (0 <= s) {
                var f = t.resolveModule(e.substr(0, s)), u = t.resolveModule(e.substr(s + 1)), s = this._moduleIdProvider.getModuleId(f + "!" + u), f = this._moduleIdProvider.getModuleId(f);
                return new n(s, f, u);
            }
            return new a(this._moduleIdProvider.getModuleId(t.resolveModule(e)));
        }, r.prototype._normalizeDependencies = function(e, t) {
            for (var i = [], o = 0, u = 0, s = e.length; u < s; u++) i[o++] = this._normalizeDependency(e[u], t);
            return i;
        }, r.prototype._relativeRequire = function(e, t, i, o) {
            if ("string" == typeof t) return this.synchronousRequire(t, e);
            this.defineModule(l.Utilities.generateAnonymousModule(), t, i, o, null, e);
        }, r.prototype.synchronousRequire = function(e, o) {
            void 0 === o && (o = new E(e));
            o = this._normalizeDependency(e, o), o = this._modules2[o.id];
            if (!o) throw new Error("Check dependency list! Synchronous require cannot resolve module '" + e + "'. This is the first mention of this module!");
            if (!o.isComplete()) throw new Error("Check dependency list! Synchronous require cannot resolve module '" + e + "'. This module has not been resolved completely yet.");
            if (o.error) throw o.error;
            return o.exports;
        }, r.prototype.configure = function(e, t) {
            var i = this._config.shouldRecordStats();
            this._config = t ? new l.Configuration(this._env, e) : this._config.cloneAndMerge(e), 
            this._config.shouldRecordStats() && !i && (this._recorder = null);
        }, r.prototype.getConfig = function() {
            return this._config;
        }, r.prototype._onLoad = function(e) {
            var t;
            null !== this._currentAnnonymousDefineCall && (t = this._currentAnnonymousDefineCall, 
            this._currentAnnonymousDefineCall = null, this.defineModule(this._moduleIdProvider.getStrModuleId(e), t.dependencies, t.callback, null, t.stack));
        }, r.prototype._createLoadError = function(u, s) {
            var i = this, o = this._moduleIdProvider.getStrModuleId(u), u = (this._inverseDependencies2[u] || []).map(function(f) {
                return i._moduleIdProvider.getStrModuleId(f);
            }), s = l.ensureError(s);
            return s.phase = "loading", s.moduleId = o, s.neededBy = u, s;
        }, r.prototype._onLoadError = function(e, t) {
            var i = this._createLoadError(e, t);
            this._modules2[e] || (this._modules2[e] = new h(e, this._moduleIdProvider.getStrModuleId(e), [], function() {}, function() {}, null));
            for (var o = [], u = 0, s = this._moduleIdProvider.getMaxModuleId(); u < s; u++) o[u] = !1;
            var f = !1, c = [];
            for (c.push(e), o[e] = !0; 0 < c.length; ) {
                var d = c.shift(), v = this._modules2[d];
                v && (f = v.onDependencyError(i) || f);
                var g = this._inverseDependencies2[d];
                if (g) for (u = 0, s = g.length; u < s; u++) {
                    var y = g[u];
                    o[y] || (c.push(y), o[y] = !0);
                }
            }
            f || this._config.onError(i);
        }, r.prototype._hasDependencyPath = function(e, t) {
            var i = this._modules2[e];
            if (!i) return !1;
            for (var o = [], u = 0, s = this._moduleIdProvider.getMaxModuleId(); u < s; u++) o[u] = !1;
            var f = [];
            for (f.push(i), o[e] = !0; 0 < f.length; ) {
                var d = f.shift().dependencies;
                if (d) for (u = 0, s = d.length; u < s; u++) {
                    var v = d[u];
                    if (v.id === t) return !0;
                    var g = this._modules2[v.id];
                    g && !o[v.id] && (o[v.id] = !0, f.push(g));
                }
            }
            return !1;
        }, r.prototype._findCyclePath = function(e, t, i) {
            if (e === t || 50 === i) return [ e ];
            var o = this._modules2[e];
            if (!o) return null;
            var u = o.dependencies;
            if (u) for (var s = 0, f = u.length; s < f; s++) {
                var c = this._findCyclePath(u[s].id, t, i + 1);
                if (null !== c) return c.push(e), c;
            }
            return null;
        }, r.prototype._createRequire = function(e) {
            function i(o, u, s) {
                return t._relativeRequire(e, o, u, s);
            }
            var t = this;
            return i.toUrl = function(o) {
                return t._config.requireToUrl(e.resolveModule(o));
            }, i.getStats = function() {
                return t.getLoaderEvents();
            }, i.hasDependencyCycle = function() {
                return t._hasDependencyCycle;
            }, i.config = function(o, u) {
                t.configure(o, u = void 0 === u ? !1 : u);
            }, i.__$__nodeRequire = l.global.nodeRequire, i;
        }, r.prototype._loadModule = function(e) {
            var i, o, s, f, t = this;
            this._modules2[e] || this._knownModules2[e] || (this._knownModules2[e] = !0, i = this._moduleIdProvider.getStrModuleId(e), 
            o = this._config.moduleIdToPaths(i), this._env.isNode && (-1 === i.indexOf("/") || /^@[^\/]+\/[^\/]+$/.test(i)) && o.push("node|" + i), 
            s = -1, (f = function(c) {
                if (++s >= o.length) t._onLoadError(e, c); else {
                    var d = o[s], v = t.getRecorder();
                    if (t._config.isBuild() && "empty:" === d) return t._buildInfoPath[e] = d, t.defineModule(t._moduleIdProvider.getStrModuleId(e), [], null, null, null), 
                    void t._onLoad(e);
                    v.record(10, d), t._scriptLoader.load(t, d, function() {
                        t._config.isBuild() && (t._buildInfoPath[e] = d), v.record(11, d), t._onLoad(e);
                    }, function(g) {
                        v.record(12, d), f(g);
                    });
                }
            })(null));
        }, r.prototype._loadPluginDependency = function(e, t) {
            var o, i = this;
            this._modules2[t.id] || this._knownModules2[t.id] || (this._knownModules2[t.id] = !0, 
            (o = function(u) {
                i.defineModule(i._moduleIdProvider.getStrModuleId(t.id), [], u, null, null);
            }).error = function(u) {
                i._config.onError(i._createLoadError(t.id, u));
            }, e.load(t.pluginParam, this._createRequire(E.ROOT), o, this._config.getOptionsLiteral()));
        }, r.prototype._resolve = function(e) {
            var t = this, i = e.dependencies;
            if (i) for (var o = 0, u = i.length; o < u; o++) {
                var s = i[o];
                if (s !== a.EXPORTS) if (s !== a.MODULE) if (s !== a.REQUIRE) {
                    var v, f = this._modules2[s.id];
                    if (f && f.isComplete()) {
                        if (f.error) return void e.onDependencyError(f.error);
                        e.unresolvedDependenciesCount--;
                    } else this._hasDependencyPath(s.id, e.id) ? (this._hasDependencyCycle = !0, console.warn("There is a dependency cycle between '" + this._moduleIdProvider.getStrModuleId(s.id) + "' and '" + this._moduleIdProvider.getStrModuleId(e.id) + "'. The cyclic path follows:"), 
                    (v = this._findCyclePath(s.id, e.id, 0) || []).reverse(), v.push(s.id), console.warn(v.map(function(g) {
                        return t._moduleIdProvider.getStrModuleId(g);
                    }).join(` => 
`)), e.unresolvedDependenciesCount--) : (this._inverseDependencies2[s.id] = this._inverseDependencies2[s.id] || [], 
                    this._inverseDependencies2[s.id].push(e.id), s instanceof n ? (v = this._modules2[s.pluginId]) && v.isComplete() ? this._loadPluginDependency(v.exports, s) : ((v = this._inversePluginDependencies2.get(s.pluginId)) || this._inversePluginDependencies2.set(s.pluginId, v = []), 
                    v.push(s), this._loadModule(s.pluginId)) : this._loadModule(s.id));
                } else e.unresolvedDependenciesCount--; else e.unresolvedDependenciesCount--; else e.exportsPassedIn = !0, 
                e.unresolvedDependenciesCount--;
            }
            0 === e.unresolvedDependenciesCount && this._onModuleComplete(e);
        }, r.prototype._onModuleComplete = function(e) {
            var t = this, i = this.getRecorder();
            if (!e.isComplete()) {
                var o = e.dependencies, u = [];
                if (o) for (var s = 0, f = o.length; s < f; s++) {
                    var d = o[s];
                    d !== a.EXPORTS ? d !== a.MODULE ? d !== a.REQUIRE ? (d = this._modules2[d.id], 
                    u[s] = d ? d.exports : null) : u[s] = this._createRequire(e.moduleIdResolver) : u[s] = {
                        id: e.strId,
                        config: function() {
                            return t._config.getConfigForModule(e.strId);
                        }
                    } : u[s] = e.exports;
                }
                e.complete(i, this._config, u);
                var v = this._inverseDependencies2[e.id];
                if (this._inverseDependencies2[e.id] = null, v) for (s = 0, f = v.length; s < f; s++) {
                    var y = v[s], y = this._modules2[y];
                    y.unresolvedDependenciesCount--, 0 === y.unresolvedDependenciesCount && this._onModuleComplete(y);
                }
                var m = this._inversePluginDependencies2.get(e.id);
                if (m) {
                    this._inversePluginDependencies2.delete(e.id);
                    for (s = 0, f = m.length; s < f; s++) this._loadPluginDependency(e.exports, m[s]);
                }
            }
        }, r;
    }();
    l.ModuleManager = p;
}(AMDLoader = AMDLoader || {}), function(l) {
    function _(r, e, t) {
        "string" != typeof r && (t = e, e = r, r = null), "object" == typeof e && Array.isArray(e) || (t = e, 
        e = null), e = e || [ "require", "exports", "module" ], r ? h.defineModule(r, e, t, null, null) : h.enqueueDefineAnonymousModule(e, t);
    }
    var E = new l.Environment(), h = null;
    _.amd = {
        jQuery: !0
    };
    function a(r, e) {
        h.configure(r, e = void 0 === e ? !1 : e);
    }
    function n() {
        if (1 === arguments.length) {
            if (arguments[0] instanceof Object && !Array.isArray(arguments[0])) return void a(arguments[0]);
            if ("string" == typeof arguments[0]) return h.synchronousRequire(arguments[0]);
        }
        if (2 !== arguments.length && 3 !== arguments.length || !Array.isArray(arguments[0])) throw new Error("Unrecognized require call");
        h.defineModule(l.Utilities.generateAnonymousModule(), arguments[0], arguments[1], arguments[2], null);
    }
    function p() {
        var e;
        void 0 === l.global.require && "undefined" == typeof require || "function" == typeof (e = l.global.require || require) && "function" == typeof e.resolve && (e = l.ensureRecordedNodeRequire(h.getRecorder(), e), 
        l.global.nodeRequire = e, n.nodeRequire = e, n.__$__nodeRequire = e), E.isNode && !E.isElectronRenderer ? (module.exports = n, 
        require = n) : (E.isElectronRenderer || (l.global.define = _), l.global.require = n);
    }
    n.config = a, n.getConfig = function() {
        return h.getConfig().getOptionsLiteral();
    }, n.reset = function() {
        h = h.reset();
    }, n.getBuildInfo = function() {
        return h.getBuildInfo();
    }, n.getStats = function() {
        return h.getLoaderEvents();
    }, n.define = function() {
        return _.apply(null, arguments);
    }, l.init = p, "function" == typeof l.global.define && l.global.define.amd || (h = new l.ModuleManager(E, l.createScriptLoader(E), _, n, l.Utilities.getHighPerformanceTimestamp()), 
    void 0 !== l.global.require && "function" != typeof l.global.require && n.config(l.global.require), 
    (define = function() {
        return _.apply(null, arguments);
    }).amd = _.amd, "undefined" == typeof doNotInitLoader && p());
}(AMDLoader = AMDLoader || {});

var amdRequire = require, fs, mkdirp, trash, getDirName, gui, resolvePath, updater, mediaServer, win, getDirName;

function IDEViewModel() {
    function __normalizePath(path) {
        return path = path.replace(/\\/g, "/");
    }
    function CSIDEProject(projectData) {
        var self = this, name = ko.observable(projectData.name || (getLastDirName(projectData.path) ? getLastDirName(projectData.path) : "Untitled")), path = ko.observable().extend({
            normalizePaths: ""
        });
        path(projectData.path);
        var scenes = ko.observableArray([]), issues = ko.observableArray([]), console_logs = ko.observableArray([]).extend({
            rateLimit: {
                timeout: 100
            },
            callFunc: {
                func: function() {
                    setTimeout(function() {
                        var ul = $("#cs-console > ul")[0];
                        ul && (ul.scrollTop = ul.scrollHeight);
                    }, 100);
                }
            }
        }), unreadLogs = ko.observable(0), consoleOpen = ko.observable(!1), source = projectData.source, expanded = ko.observable(!1 !== projectData.expanded), locked = ko.observable(!1), readOnly = ko.observable(projectData.readOnly || !1), editing = ko.observable(!1), invalidName = ko.observable(!1);
        self.getName = ko.computed(function() {
            return name();
        }, this), self.getPath = ko.computed(function() {
            return path();
        }, this), self.getScenes = scenes, self.getIssues = ko.computed(function() {
            return issues();
        }, this), self.consoleOpen = ko.computed(function() {
            return consoleOpen();
        }, this), self.getLogs = ko.computed(function() {
            return console_logs();
        }, this), self.getUnreadLogCount = ko.computed(function() {
            return unreadLogs();
        }, this), self.issueCount = ko.computed(function() {
            return issues().length;
        }, this), self.getSource = function() {
            return source;
        }, self.isExpanded = ko.computed(function() {
            return expanded();
        }, this), self.isLocked = ko.computed(function() {
            return locked();
        }, this), self.isReadOnly = ko.computed(function() {
            return readOnly();
        }, this), self.beingEdited = ko.computed(function() {
            return editing();
        }, this), self.nameInvalid = ko.computed(function() {
            return invalidName();
        }, this), self.getSearchResults = ko.computed(function() {
            return ko.utils.arrayMap(scenes(), function(scene) {
                return scene.getSearchResults();
            }).filter(function(sceneResults) {
                return 0 < sceneResults.getResults().length;
            });
        }, this), self.replaceAllScenesSearchResults = function() {
            for (var _scenes = scenes(), s = 0; s < _scenes.length; s++) _scenes[s].replaceAllSearchResults();
        }, self.isDirty = ko.computed(function() {
            for (var i = 0; i < scenes().length; i++) {
                if (scenes()[i].isDirty()) return !0;
                if (i === scenes().length - 1) return !1;
            }
        }), self.getWordCount = function(exclCommandLines, selected) {
            exclCommandLines = exclCommandLines || !1;
            for (var wordCount = 0, i = 0; i < scenes().length; i++) wordCount += scenes()[i].getWordCount(exclCommandLines, selected);
            return wordCount;
        }, self.getCharCount = function(selected) {
            for (var charCount = 0, i = 0; i < scenes().length; i++) charCount += scenes()[i].getCharCount(selected);
            return charCount;
        }, self.logToConsole = function(log, type, meta) {
            "boolean" != typeof log && "number" != typeof log && "string" != typeof log || monaco.editor.colorize(log, "choicescript").then(function(formatString) {
                "string" != typeof type && (type = ""), 999 < console_logs().length && console_logs.shift(), 
                meta ? "string" == typeof meta.scene && "number" == typeof meta.line ? console_logs.push({
                    value: formatString,
                    type: type || "null",
                    scene: meta.scene || "",
                    line: meta.line || ""
                }) : (console.log(typeof meta.scene, typeof meta.line), console_logs.push({
                    value: "Error: attempt to log bad meta data logged to project console!",
                    type: "cm-error"
                })) : console_logs.push({
                    value: formatString,
                    type: type || "null"
                }), consoleOpen() || "system" == type || unreadLogs(unreadLogs() < 8 ? unreadLogs() + 1 : "9+");
            });
        }, self.toggleConsole = function(force) {
            return consoleOpen("boolean" == typeof force ? force : !consoleOpen()), consoleOpen() && unreadLogs(0), 
            consoleOpen();
        }, self.clearConsole = function() {
            console_logs.removeAll();
        }, self.dismissAllIssues = function() {
            for (var issueBuffer = [], issueList = issues(), o = 0; o < issueList.length; o++) issueBuffer.push(issueList[o]);
            for (var i = 0; i < issueBuffer.length; i++) issueBuffer[i].dismiss();
            __selectTab("game");
        }, self.setExpand = function(boole, event) {
            "boolean" == typeof boole ? expanded(boole) : expanded() ? expanded(!1) : expanded(!0);
        }, self.nameInterface = ko.pureComputed({
            read: function() {
                return name();
            },
            write: function(newValue) {
                validName(newValue, !0, function(valid, errMsg) {
                    invalidName(!valid), valid ? name(newValue) : console.log(errMsg);
                });
            },
            owner: this
        }), self.searchByEnterKey = function(data, event, domObj) {
            if ("keyup" == event.type && SEARCH.CONF.searchOnType()) return self.search("", "", SEARCH.MODES.SEARCH) || !0;
            if ("keydown" != event.type) return !0;
            if (13 == event.keyCode) {
                if (!event.ctrlKey) return self.search("", "", SEARCH.MODES.SEARCH) && !1;
                event.target.value += "\n", event.target.scrollTop = event.target.scrollHeight;
            }
            return !0;
        }, self.search = function(searchStr, replaceStr, newSearchMode) {
            var curSearchMode = "number" == typeof newSearchMode ? newSearchMode : searchMode();
            return "string" == typeof searchStr && "" !== searchStr || (searchStr = document.getElementById("searchBox").value), 
            curSearchMode === SEARCH.MODES.REPLACE ? (replaceStr = replaceStr || document.getElementById("replaceBox").value, 
            bootbox.confirm(self.getSearchResultDesc() + "<br>Replace them with '" + replaceStr + "'?", function(result) {
                result && scenes().forEach(function(scene) {
                    scene.search(searchStr, replaceStr, !1, curSearchMode);
                });
            })) : scenes().forEach(function(scene) {
                var forceExpand = scene.getSearchResults() && scene.getSearchResults().keepOpen() && 0 < scene.getSearchResults().getLength();
                scene.search(searchStr, replaceStr, forceExpand, curSearchMode);
            }), !1;
        }, self.getSearchResultCount = function() {
            for (var count = 0, i = 0; i < self.getSearchResults().length; i++) count += self.getSearchResults()[i].getLength();
            return count;
        }, self.getSearchResultDesc = function() {
            return "Found " + self.getSearchResultCount() + " results in " + self.getSearchResults().length + " scene(s).";
        }, self.rename = function(data, event) {
            if (!readOnly() && ("keyup" != event.type || 13 == event.keyCode || 27 == event.keyCode)) {
                if ("dblclick" != event.type) return invalidName() && editing() ? void 0 : (editing(!1), 
                void __updatePersistenceList());
                editing(!0), setTimeout(function() {
                    $(event.target).focus().select();
                }, 10);
            }
        }, self.run = function() {
            locked() || (locked(!0), self.isDirty() ? bootbox.confirm("This project has unsaved changes, these will not appear in the test run, do you wish to continue?", function(result) {
                result && __runProject(self);
            }) : __runProject(self), setTimeout(function() {
                locked(!1);
            }, 5e3));
        }, self.openFolder = function() {
            __openFolder(path());
        }, self.close = function() {
            function __commitCloseProject() {
                project === selectedProject() && (selectedProject() == activeProject() && activeProject(null), 
                selectedScene(""), __getTab("game").href("")), project.dispose(), projects.remove(project), 
                __updatePersistenceList();
            }
            var project;
            (project = self).isDirty() ? bootbox.confirm("This project has unsaved scenes, are you sure you wish to close it?", function(result) {
                result && __commitCloseProject();
            }) : __commitCloseProject();
        }, self.dispose = function() {
            scenes().forEach(function(scene) {
                scene.dispose();
            });
        }, self.select = function() {
            for (var i = 0; i < scenes().length; i++) if (scenes()[i].select()) return !0;
            return !1;
        }, self.save = function(cb) {
            "function" != typeof cb && (cb = function() {});
            var failed = !1, count = scenes().length;
            scenes().forEach(function(scene, index) {
                failed || scene.save(null, null, function(err) {
                    return err ? (failed = !0, cb(err)) : void (0 == --count && cb(null));
                });
            });
        }, self.addNewScene = function(project, event) {
            readOnly() || (event && event.stopPropagation(), function(project, name) {
                "object" == typeof project && !function generateName(newName) {
                    sceneExists(newName, project, function(exists) {
                        var scenePath, newScene;
                        exists ? (scenePath = newName.substring(newName.lastIndexOf("_") + 1, newName.length), 
                        scenePath = isNaN(scenePath) ? 0 : parseInt(scenePath) + 1, generateName("untitled_" + scenePath)) : (scenePath = project.getPath() + newName + ".txt", 
                        newScene = new CSIDEScene({
                            path: scenePath,
                            source: platform,
                            readOnly: project.isReadOnly()
                        }), project.addScene(newScene), newScene.save(null, null, function(err) {
                            err ? bootbox.alert(err.message) : newScene.load(function(err, scene) {
                                err || scene.select();
                            });
                        }));
                    });
                }(name || "untitled");
            }(self));
        }, self.addScene = function(scene) {
            scene.getProject() !== self && !1 !== scene.getProject() || scenes.push(scene);
        }, self.removeScene = function(scene) {
            -1 !== scenes().lastIndexOf(scene) && (scenes.remove(scene), scenes().length < 1 && projects.remove(self));
        }, self.closeScene = function(scene, callback) {
            function closeScene() {
                selectedScene() == scene && selectedScene(null), self.removeScene(scene), __updatePersistenceList(), 
                scene.dispose(), "function" == typeof callback && callback(!0);
            }
            scene.isDirty() ? bootbox.confirm("This scene has unsaved changes, are you sure you wish to close it?", function(result) {
                result ? closeScene() : "function" == typeof callback && callback(!1);
            }) : closeScene();
        }, self.exportScenes = function() {
            fh.selectFolder(function(newPath) {
                newPath && bootbox.confirm("<h3>Warning</h3><p>This will <b>overwrite</b> any files with the same name in '<i>" + newPath + "</i>'.<br>Are you sure you wish to continue?</p>", function(result) {
                    result && __copyProjectTo(path(), newPath, function(err) {
                        err ? notification("Error", err.message, {
                            type: "error"
                        }) : notification("Game Exported Successfully", "All scenes exported successfully to " + newPath, {
                            type: "success",
                            buttons: [ {
                                addClass: "btn",
                                text: "Show Folder",
                                onClick: function(note) {
                                    __openFolder(newPath), note.close();
                                }
                            } ]
                        }).setTimeout(1e4);
                    });
                });
            });
        }, self.compile = function() {
            fh.selectFolder(function(newPath) {
                newPath && bootbox.confirm("<h3>Warning</h3><p>This will <b>overwrite</b> any file with the same name in '<i>" + newPath + "</i>'.<br>Are you sure you wish to continue?</p>", function(result) {
                    var project, path;
                    result && (path = newPath, __shortCompile(project = self, function(err, allScenes) {
                        fh.readFile("compile_head.txt", function(err, headContents) {
                            fh.readFile("compile_tail.txt", function(err, tailContents) {
                                fh.writeFile(path + project.getName() + ".html", headContents + "<script>allScenes = " + JSON.stringify(allScenes) + "<\/script>" + tailContents, function(buttons) {
                                    if (buttons) throw new Error("Export failed!");
                                    buttons = [ {
                                        addClass: "btn",
                                        text: "Show Folder",
                                        onClick: function(note) {
                                            __openFolder(path), note.close();
                                        }
                                    } ];
                                    notification("Game Exported Successfully", project.getName(), {
                                        type: "success",
                                        buttons: buttons
                                    }).setTimeout(1e4);
                                });
                            });
                        });
                    }));
                });
            });
        }, self.test = function(test) {
            !function __testProject(project, test) {
                if ("random" != test && "quick" != test) return void alert("Error: no such test as " + test + "test!");
                if (void 0 === project || "" === project) return void alert("Error: no project given to " + test + "test!");
                var path = "node_modules/cside-choicescript/" + test + "test.html";
                activeProject(project);
                "web-dropbox" === platform ? (project.test_win = window.open(path, "Quicktest", "toolbar=0,location=0,status=0,menubar=0,scrollbars,resizable,width=500,height=400"), 
                project.test_win.addEventListener("beforeunload", function(event) {
                    project.test_win = null;
                }), setTimeout(function() {
                    project.test_win.title = test.toUpperCase() + "TEST - " + project.getName();
                }, 200)) : project.test_win ? (project.test_win.close(), project.test_win = null, 
                __testProject(project, test)) : nw.Window.open(path, {
                    focus: !0,
                    width: 500,
                    height: 500,
                    title: ""
                }, function(test_win) {
                    (project.test_win = test_win).on("closed", function() {
                        project.test_win.hide(), project.test_win.close(!0), project.test_win = null;
                    });
                });
            }(self, test);
        }, self.openAllScenes = function() {
            var projectPath;
            projectPath = self.getPath(), fh.readDir(projectPath, function(err, filepaths) {
                !function(err, filepaths) {
                    err ? console.log(err) : __openScenes(filepaths.filter(function(filepath) {
                        return ".txt" === getFileExtension(filepath) && !filepath.match(CONST_IMG_PREFIX);
                    }, !1).map(function(filepath) {
                        return projectPath + filepath;
                    }));
                }(err, filepaths);
            });
        }, self.reloadAllScenes = function() {
            for (var i = 0; i < scenes().length; i++) scenes()[i].load();
        }, self.logIssue = function(issue) {
            issues.push(issue);
            var buttons = [ {
                addClass: "btn btn-danger",
                text: "Show",
                onClick: function(note) {
                    note.close(), issue.getLineNum() && issue.show(), selectedProject() == self || self.select(), 
                    __selectTab("issues");
                }
            } ];
            notification("New Issue", "New issue with project " + name(), {
                type: "error",
                buttons: buttons
            }).setTimeout(5e3);
        }, self.removeIssue = function(issue) {
            issues.remove(issue);
        };
    }
    function CSIDESearchResults(data) {
        var self = this, searchTerm = data.searchTerm || "", searchResults = ko.observableArray(data.results || []).extend({
            rateLimit: 500
        }), keepOpen = data.keepOpen || !1, expanded = ko.observable(data.expanded || !1).extend({
            callFunc: {
                func: function(expand) {
                    expand && self.createResultDescriptions();
                }
            }
        }), versionId = data.versionId || null, scene = data.scene || null;
        self.getResults = ko.computed(function() {
            return searchResults();
        }, this), self.isExpanded = ko.computed(function() {
            return expanded();
        }, this), self.getLength = function() {
            return searchResults().length;
        }, self.getLengthString = function() {
            var len = self.getLength();
            return 999 <= len ? "999+" : len.toString();
        }, self.getScene = function() {
            return scene;
        }, self.getVersionId = function() {
            return versionId;
        }, self.getSearchTerm = function() {
            return searchTerm;
        }, self.keepOpen = function() {
            return keepOpen;
        }, self.expand = function(expand, stayOpen) {
            expanded("boolean" == typeof expand ? expand : !expanded()), keepOpen = expanded() && stayOpen || !1;
        }, self.createResultDescriptions = function() {
            for (var descriptiveResults = searchResults(), i = 0, result = descriptiveResults[i]; i < descriptiveResults.length; result = descriptiveResults[++i]) {
                result.preText = 0 < result.range.startColumn ? scene.getLineContent(result.range.startLineNumber).slice(0, result.range.startColumn - 1) : "", 
                30 < result.preText.length && (result.preText = "…" + result.preText.slice(result.range.startColumn - 31, result.range.startColumn - 1));
                var endLineLen = scene.getLineLength(result.range.endLineNumber);
                result.postText = result.range.endColumn < endLineLen ? scene.getLineContent(result.range.endLineNumber).slice(result.range.endColumn - 1, endLineLen) : "", 
                30 < result.postText.length && (result.postText = result.postText.slice(0, 30) + "…"), 
                result.replaceText = document.getElementById("replaceBox").value || "", SEARCH.CONF.useRegex() && (result.replaceText = monaco.cside.parseReplaceString(result.replaceText).buildReplaceString(descriptiveResults[i].matches, SEARCH.CONF.preserveCase()));
            }
            searchResults(descriptiveResults);
        }, scene && expanded && self.createResultDescriptions();
    }
    function CSIDEScene(sceneData) {
        var self = this;
        self.dispose = function() {
            edModel.dispose();
        };
        var path = ko.observable(__normalizePath(sceneData.path)).extend({
            normalizePaths: "",
            callFunc: {
                func: function(newPath) {
                    var oldModel = edModel;
                    try {
                        (edModel = monaco.editor.createModel(edModel ? edModel.getValue() : "", "choicescript", monaco.Uri.file(newPath))).csideScene = self, 
                        oldModel && oldModel.dispose(), selectedScene() == self && vseditor.setModel(edModel), 
                        edModel.onDidChangeContent(updateOnModelEdit);
                    } catch (err) {
                        bootbox.alert("Unrecoverable Error: Couldn't update URI for scene.<br><br>" + err.message + ".<br><br> Please restart the application and report this.");
                    }
                }
            }
        }), name = ko.observable("").extend({
            lowerCase: ""
        });
        name(getFileName(path()));
        var edModel, isImportant = name().toUpperCase().match(reservedSceneNames), source = sceneData.source || platform, loaded = ko.observable(!1), locked = ko.observable(!1), readOnly = ko.observable(sceneData.readOnly || !1), editing = ko.observable(!1), colouring = ko.observable(!1), saving = ko.observable(!1), inErrState = ko.observable(!1), errStateMsg = ko.observable(""), searchVersionId = null, searchResults = ko.observable(new CSIDESearchResults({
            results: []
        })).extend({
            rateLimit: {
                rateLimit: 1e3,
                method: "notifyWhenChangesStop"
            }
        }), indentSize = ko.observable(settings.byId("editor", "tabsize").getValue()).extend({
            callFunc: {
                func: function(newVal) {
                    edModel.updateOptions({
                        tabSize: newVal
                    });
                }
            }
        }), useSpaces = ko.observable(settings.byId("editor", "usespaces").getValue()).extend({
            callFunc: {
                func: function(newVal) {
                    edModel.updateOptions({
                        insertSpaces: newVal
                    });
                }
            }
        });
        (edModel = monaco.editor.createModel(sceneData.contents || "", "choicescript", monaco.Uri.file(path()))).onDidChangeContent(updateOnModelEdit), 
        edModel.csideScene = self;
        var lastVersionId = edModel.getAlternativeVersionId(), dirty = ko.observable(!1), editorViewState = null, charCount = ko.observable(sceneData.contents ? sceneData.contents.length : 0), wordCount = ko.observable(0), fileStats = sceneData.stats || {
            mtime: new Date()
        }, markColour = ko.observable(sceneData.color || (isImportant ? "#7797ec" : "#777777"));
        markColour.extend({
            callFunc: {
                func: function(newCol) {
                    var colIndex = recentSceneColours().indexOf(newCol);
                    recentSceneColours.unshift(newCol), -1 < colIndex ? recentSceneColours.splice(++colIndex, 1) : recentSceneColours.splice(recentSceneColours().length - 1, 1), 
                    __updatePersistenceList();
                }
            }
        });
        var issues = ko.observableArray([]);
        issues.subscribe(function(val) {
            self == selectedScene() && __updateEditorDecorations(self);
        });
        var invalidName = ko.observable(!1), nameErrMsg = ko.observable();
        self.isLocked = ko.computed(function() {
            if (locked()) return !0;
            var curScene = cside.getSelectedScene();
            return !(!curScene || !curScene.beingEdited() || curScene == self);
        }, this), self.decorations = [], self.getName = ko.computed(function() {
            return name();
        }, this), self.getPath = ko.computed(function() {
            return path();
        }, this), self.hasLoaded = ko.computed(function() {
            return loaded();
        }, this), self.isSaving = ko.computed(function() {
            return saving();
        }, this), self.isDirty = ko.computed(function() {
            return dirty();
        }, this), self.isReadOnly = ko.computed(function() {
            return readOnly();
        }, this), self.beingEdited = ko.computed(function() {
            return editing();
        }, this), self.isSelected = ko.computed(function() {
            return this === selectedScene();
        }, this), self.beingColoured = ko.computed(function() {
            return colouring();
        }, this), self.getSource = function() {
            return source;
        }, self.getProject = function() {
            return getProject(getProjectPath(path()));
        }, self.getText = function() {
            return edModel.getValue();
        }, self.getMarkColour = ko.computed(function() {
            return markColour();
        }, this), self.nameInvalid = ko.computed(function() {
            return invalidName();
        }, this), self.getNameErrorMsg = ko.computed(function() {
            return nameErrMsg();
        }, this), self.getIssues = ko.computed(function() {
            return issues();
        }, this), self.getContents = function() {
            return edModel.getValue();
        }, self.getLineContent = function(range) {
            return edModel.getLineContent(range);
        }, self.getLineLength = function(lineNum) {
            return edModel.getLineLength(lineNum);
        }, self.getSearchResults = ko.computed(function() {
            return searchResults();
        }, this), self.getErrStateMsg = ko.computed(function() {
            return errStateMsg() + " - click here to close";
        }, this), self.getErrState = ko.computed(function() {
            return inErrState();
        }, this), self.getCharCountString = function() {
            return 0 < selectedChars() ? charCount() + " (" + selectedChars() + ")" : charCount();
        }, self.getCharCount = function(selected) {
            return (selected ? selectedChars : charCount)();
        }, self.getWordCountString = function() {
            var suffix = 1 < wordCountOn() ? " [excl. cmds]" : " [inc. cmds]";
            if (0 < selectedChars()) {
                var selectedWords = __wordCount(vseditor.getModel().getValueInRange(vseditor.getSelection()), 1 < wordCountOn());
                return wordCount() + " (" + selectedWords + ") " + suffix;
            }
            return wordCount() + suffix;
        }, self.getWordCount = function(exclCommandLines, selected) {
            return __wordCount(selected ? vseditor.getModel().getValueInRange(vseditor.getSelection()) : edModel.getValue(), exclCommandLines);
        }, self.getIndentDesc = ko.computed(function() {
            return (useSpaces() ? "Spaces: " : "Tabs: ") + indentSize();
        }, this), self.getState = ko.computed(function() {
            return saving() ? "fa fa-spinner fa-spin" : loaded() ? inErrState() ? "fa fa-exclamation-triangle scene-unsaved" : readOnly() ? "fa fa-lock" : dirty() ? "fa fa-save scene-unsaved" : "fa fa-save scene-saved" : "fa fa-ban";
        }), self.updateIndentSize = function(val) {
            void 0 === val && (val = useSpaces() ? settings.asObject("editor").indentspaces.getValue() : settings.asObject("editor").tabsize), 
            indentSize(val);
        }, self.updateUseSpaces = function(val) {
            void 0 === val && (val = settings.asObject("editor").usespaces), useSpaces(val);
        }, self.setText = function(value) {
            readOnly() || "string" == typeof value && edModel.setValue(value);
        };
        function renameSceneFile(newName) {
            var newPath;
            invalidName() || (saving(!0), newPath = self.getProject().getPath() + newName + ".txt", 
            fh.renameFile(path(), newPath, function(err) {
                !function(err) {
                    saving(!1), err ? bootbox.alert(err) : (fileStats.mtime ? fileStats.mtime = new Date() : fileStats.modifiedAt = new Date(), 
                    path(newPath), name(newName), __updatePersistenceList());
                }(err);
            }));
        }
        function saveScene(callback) {
            var data = edModel.getValue();
            fh.writeFile(path(), data, function(err) {
                !function(err) {
                    err ? console.log(err) : (dirty(!1), lastVersionId = edModel.getAlternativeVersionId(), 
                    fileStats.mtime ? fileStats.mtime = new Date() : fileStats.modifiedAt = new Date());
                    saving(!1), "function" == typeof callback && callback(err);
                }(err);
            });
        }
        function updateOnModelEdit() {
            saving() || (lastVersionId !== edModel.getAlternativeVersionId() ? dirty(!0) : dirty(!1)), 
            "" != searchResults().getSearchTerm() && searchResults().getVersionId !== edModel.getAlternativeVersionId() && self.search(searchResults().getSearchTerm(), null, searchResults() && searchResults().isExpanded(), SEARCH.MODES.SEARCH), 
            charCount(edModel.getValueLength()), 0 < wordCountOn() && wordCount(__wordCount(edModel.getValue(), 1 < wordCountOn()));
        }
        self.nameInterface = ko.pureComputed({
            read: function() {
                return name();
            },
            write: function(newValue) {
                validName(newValue, !1, function(valid, errMsg) {
                    invalidName(!valid), valid || nameErrMsg(errMsg);
                });
            },
            owner: this
        }), self.rename = function(data, event) {
            var newName;
            inErrState() || !loaded() || saving() || readOnly() || "keyup" == event.type && 13 != event.keyCode && 27 != event.keyCode || ("dblclick" != event.type && "click" != event.type ? invalidName() && editing() ? $(event.target).fadeOut("fast").fadeIn("fast").focus() : ((newName = event.target.value.trim()) != name() && sceneExists(newName, self.getProject(), function(exists) {
                exists ? (notification("Failed to Rename Scene", "Scene '" + event.target.value.toLowerCase() + "' already exists in this Project", {
                    type: "error"
                }), event.target.value = name()) : renameSceneFile(newName);
            }), editing(!1)) : isImportant ? isImportant && notification("", "Reserved scene cannot be renamed", {
                type: "error",
                layout: "bottomLeft"
            }) : self.isLocked() || (editing(!0), setTimeout(function() {
                $(event.target).focus().select();
            }, 10)));
        }, self.showColours = function(scene, event) {
            "mouseleave" === event.type && !colouring() || colouring(!colouring());
        }, self.recolour = function(colour, event) {
            markColour(colour), colouring(!1);
        }, self.newColour = function(scene, bcr) {
            var bcr = bcr.target.getBoundingClientRect(), colSelector = $("#selectColor");
            colSelector.off(), colSelector.val(markColour()), colSelector.css({
                position: "fixed",
                left: bcr.x,
                top: bcr.y,
                "z-index": -999
            }).change(function(evt) {
                markColour(colSelector.val()), colSelector.hide();
            }), setTimeout(function() {
                colSelector.show().trigger("click");
            }, 500);
        }, self.showSearchResult = function(index, data) {
            searchVersionId == edModel.getAlternativeVersionId() ? (self.focusLine(data, !0), 
            vseditor.setSelection(data.range)) : notification("Stale Search Results", "This scene has been modified since the last search was performed. Please search again.", {
                type: "error"
            });
        }, self.replaceSearchResult = function(index, data, newSelections) {
            var oldText, newText, oldRange, newRange;
            newSelections && newSelections.stopPropagation(), searchVersionId == edModel.getAlternativeVersionId() ? (self.focusLine(data, !0), 
            vseditor.setSelection(data.range), oldText = data.matches[0], newText = document.getElementById("replaceBox").value || "", 
            SEARCH.CONF.useRegex() && (newText = monaco.cside.parseReplaceString(newText).buildReplaceString(data.matches, SEARCH.CONF.preserveCase())), 
            oldRange = new monaco.Range(data.range.startLineNumber, data.range.startColumn, data.range.endLineNumber, data.range.endColumn), 
            newRange = oldRange, newSelections = edModel.pushEditOperations([ new monaco.Selection(oldRange.startLineNumber, oldRange.startColumn, oldRange.endLineNumber, oldRange.endColumn) ], [ {
                text: newText,
                range: oldRange
            } ], function() {
                if (monaco.Range.spansMultipleLines(data.range)) return [ data.range.collapseToStart() ];
                var columnDiff = -1 * (oldText.length - newText.length);
                return 0 != columnDiff && (newRange = oldRange.setEndPosition(oldRange.endLineNumber, oldRange.endColumn + columnDiff)), 
                [ new monaco.Selection(oldRange.startLineNumber, oldRange.startColumn, newRange.endLineNumber, newRange.endColumn) ];
            }), edModel.pushStackElement(), self.isSelected() && vseditor.setSelections(newSelections), 
            self.search(self.getSearchResults().getSearchTerm(), newText, !0, SEARCH.MODES.SEARCH)) : notification("Stale Search Results", "This scene has been modified since the last search was performed. Please search again.", {
                type: "error"
            });
        }, self.replaceAllSearchResults = function(uiConfirmation) {
            var searchStr = document.getElementById("searchBox").value, replaceStr = document.getElementById("replaceBox").value;
            uiConfirmation ? bootbox.confirm("Replace all matches in this scene?", function(result) {
                result && self.search(searchStr, replaceStr, !1, SEARCH.MODES.REPLACE);
            }) : self.search(searchStr, replaceStr, !1, SEARCH.MODES.REPLACE);
        }, self.focusLine = function(lineNum, noArrow) {
            if ("number" != typeof lineNum) {
                if (!lineNum.range || "number" != typeof lineNum.range.startLineNumber) return;
                lineNum = lineNum.range.startLineNumber;
            } else lineNum += 1;
            self.select(function(selected) {
                selected && (noArrow || __updateEditorDecorations(self, [ {
                    range: new monaco.Range(lineNum, 1, lineNum, 1),
                    options: {
                        isWholeLine: !1,
                        className: "",
                        glyphMarginClassName: "arrow-gutter"
                    }
                } ]), vseditor.revealLineInCenter(lineNum, monaco.editor.ScrollType.Immediate));
            });
        }, self.addIssue = function(issue) {
            issues.push(issue);
        }, self.removeIssue = function(issue) {
            issues.remove(issue);
        }, self.updateViewState = function() {
            return self === selectedScene() ? editorViewState = vseditor.saveViewState() : null;
        }, self.load = function(callback) {
            function finishLoading(err, data) {
                err ? (inErrState(!0), errStateMsg(err.message), console.log(errStateMsg()), callback(err)) : (inErrState(!1), 
                edModel.setValue(data), edModel.detectIndentation(settings.byId("editor", "usespaces").getValue(), (useSpaces() ? settings.byId("editor", "indentspaces") : settings.byId("editor", "tabsize")).getValue()), 
                useSpaces(edModel.getOptions().insertSpaces), indentSize(useSpaces() ? edModel.getOptions().indentSize : settings.byId("editor", "tabsize").getValue()), 
                dirty(!1), __updatePersistenceList()), loaded(!0), saving(!1), void 0 !== callback && callback(err, self);
            }
            saving() || (loaded(!1), saving(!0), "function" != typeof callback && (callback = function(err) {
                err && console.log(err.message);
            }), fh.stat(path(), function(err, newfileStats) {
                err ? finishLoading(err) : (fileStats = newfileStats, fh.readFile(path(), function(err, data) {
                    err ? finishLoading(err) : finishLoading(err, data);
                }));
            }));
        }, self.save = function(scene, event, callback) {
            var lastModifiedAt;
            event && event.stopPropagation(), !dirty() && loaded() || inErrState() || saving() || locked() || readOnly() ? "function" == typeof callback && callback(null) : (saving(!0), 
            lastModifiedAt = fileStats.mtime || fileStats.modifiedAt, fh.stat(path(), function(err, newfileStats) {
                !err || 404 != err.code && "ENOENT" != err.code ? err ? (console.log(err), saving(!1), 
                bootbox.alert("<h3>Warning</h3><p>Unable to save <b>" + name() + "</b> of <b>" + self.getProject().getName() + "</b>: " + err.message + ".</p> \t\t\t\t\t\t<p>Check your internet connection.</p>")) : function(newfileStats) {
                    (newfileStats.mtime || newfileStats.modifiedAt).getTime() > lastModifiedAt.getTime() + 1e3 ? bootbox.dialog({
                        message: "'" + name() + ".txt' of <b>" + self.getProject().getName() + "</b> appears to have been modified by another program or process \t\t\t\t\t\tsince it was last saved. Are you sure you wish to save it?",
                        title: "Conflict Warning",
                        buttons: {
                            cancel: {
                                label: "Cancel",
                                callback: function() {
                                    saving(!1);
                                }
                            },
                            reload: {
                                label: "Reload",
                                callback: function() {
                                    saving(!1), self.load(function(err, scene) {
                                        err || scene.select();
                                    });
                                }
                            },
                            yes: {
                                label: "Save",
                                className: "btn-primary",
                                callback: function() {
                                    saveScene(callback);
                                }
                            }
                        },
                        onEscape: function() {
                            saving(!1);
                        }
                    }) : saveScene(callback);
                }(newfileStats) : saveScene(callback);
            }));
        }, self.select = function(callback) {
            "function" != typeof callback && (callback = function() {}), selectedScene() !== self ? inErrState() || !loaded() || saving() || self.isLocked() ? callback(!1) : (selectedScene() && selectedScene().updateViewState(), 
            selectedScene(self), vseditor.setModel(edModel), cursorPos(vseditor.getPosition()), 
            __updateEditorDecorations(self), editorViewState && vseditor.restoreViewState(editorViewState), 
            self.getProject().isExpanded() || self.getProject().setExpand(!0), vseditor.focus(), 
            callback(!0)) : callback(!0);
        }, self.search = function(searchStr, replaceStr, forceExpand, expandSceneResults) {
            if (locked()) return null;
            locked(!0), expandSceneResults = "number" == typeof expandSceneResults ? expandSceneResults : searchMode();
            var replacePattern = monaco.cside.parseReplaceString(replaceStr), matches = (matches = edModel.findMatches(searchStr, !1, SEARCH.CONF.useRegex(), SEARCH.CONF.preserveCase(), getWordSeperationValue(), !0)).map(function(match) {
                return match.text = SEARCH.CONF.useRegex() ? replacePattern.buildReplaceString(match.matches, SEARCH.CONF.preserveCase()) : replaceStr, 
                match;
            });
            expandSceneResults === SEARCH.MODES.REPLACE && 0 < matches.length && edModel.pushEditOperations([ new monaco.Selection(matches[0].range.startLineNumber, matches[0].range.startColumn, matches[0].range.endLineNumber, matches[0].range.endColumn) ], matches, function() {
                return [ new monaco.Selection(1, 1, 1, 1) ];
            }), expandSceneResults === SEARCH.MODES.REPLACE && (matches = edModel.findMatches(searchStr, !1, SEARCH.CONF.useRegex(), SEARCH.CONF.preserveCase(), getWordSeperationValue(), !0)), 
            locked(!1), searchVersionId = edModel.getAlternativeVersionId();
            expandSceneResults = forceExpand || matches.length < SEARCH.CONF.collapseThreshold();
            return searchResults(new CSIDESearchResults({
                searchTerm: searchStr,
                scene: self,
                versionId: searchVersionId,
                results: matches,
                expanded: expandSceneResults,
                keepOpen: forceExpand
            })), searchResults();
        }, self.close = function() {
            self.getProject().closeScene(self);
        }, self.copyTo = function(targetProject) {
            var newPath;
            "object" == typeof targetProject && (inErrState() || !loaded() || saving() || (targetProject.isReadOnly() ? notification("", "Cannot Move Scene to Read-Only Project", {
                type: "error",
                closeWith: [ "click" ]
            }) : (newPath = targetProject.getPath() + name() + ".txt", fh.copyFile(path(), newPath, function(newScene, fileStat) {
                (newScene = newScene) ? (bootbox.alert(newScene.message), console.log(newScene)) : (newScene = new CSIDEScene({
                    path: newPath,
                    source: source,
                    contents: edModel.getValue()
                }), targetProject.addScene(newScene), newScene.load());
            }))));
        }, self.moveTo = function(targetProject) {
            var currentProject, newPath;
            "object" == typeof targetProject && (inErrState() || !loaded() || saving() || readOnly() || (isImportant ? notification("", "Cannot Move Reserved Scene", {
                type: "error",
                closeWith: [ "click" ]
            }) : targetProject.isReadOnly() ? notification("", "Cannot Move Scene to Read-Only Project", {
                type: "error",
                closeWith: [ "click" ]
            }) : (currentProject = self.getProject(), targetProject !== currentProject && (newPath = targetProject.getPath() + name() + ".txt", 
            fh.renameFile(path(), newPath, function(err) {
                !function(err) {
                    err ? (bootbox.alert(err.message), console.log(err)) : (currentProject.removeScene(self), 
                    path(newPath), targetProject.addScene(self), __updatePersistenceList());
                }(err);
            })))));
        }, self.del = function() {
            inErrState() || !loaded() || saving() || (isImportant ? notification("", "Cannot Delete Reserved Scene", {
                type: "error",
                closeWith: [ "click" ]
            }) : readOnly() ? notification("", "Cannot Delete Read-Only Scene", {
                type: "error",
                closeWith: [ "click" ]
            }) : bootbox.confirm("<h3>Confirm</h3><p>Are you sure you want to permanently delete '" + name() + ".txt'?</p><p style='font-size:12px;'>" + path() + "<p>", function(result) {
                result && fh.deleteFile(path(), function(err) {
                    err ? bootbox.alert(err.message) : self.close();
                });
            }));
        };
    }
    function CSIDEIssue(d) {
        var self = this, scene = d.scene || null, project = d.project || null;
        if (null === project) return null;
        var desc = d.desc || "No description available", lineNum = "number" == typeof d.lineNum && -1 < d.lineNum ? d.lineNum : null, d = new Date(), date = d.getDate() + "/" + (d.getMonth() + 1) + "/" + d.getFullYear(), time = d.getHours() + ":" + d.getMinutes();
        self.getScene = function() {
            return scene;
        }, self.getDesc = function() {
            return desc;
        }, self.getDate = function() {
            return date;
        }, self.getTime = function() {
            return time;
        }, self.getLineNum = function() {
            return lineNum;
        }, self.dismiss = function() {
            project.removeIssue(self), scene && scene.removeIssue(self);
        }, self.show = function() {
            scene && (scene.select(), "number" == typeof self.getLineNum() && scene.focusLine(self.getLineNum(), !0));
        }, scene && scene.addIssue(self);
    }
    function CSIDESetting(settingData) {
        var setting = this, value = ko.observable(settingData.value);
        value.extend({
            notify: "always"
        });
        var options, id = settingData.id, name = settingData.name, selectedOption = 0, type = settingData.type || "binary", cat = settingData.cat || "app", desc = ko.observable(settingData.desc || ""), visible = ko.observable(!0);
        options = "binary" === type ? ko.observableArray([ {
            desc: "on",
            value: !0
        }, {
            desc: "off",
            value: !1
        } ]) : ko.observableArray(settingData.options), setting.getValue = ko.computed(function() {
            return value();
        }, this), setting.getId = function() {
            return id;
        }, setting.getName = function() {
            return name;
        }, setting.getType = function() {
            return type;
        }, setting.getCat = function() {
            return cat;
        }, setting.getOptions = ko.computed(function() {
            return options();
        }, this), setting.getSelectedOptionId = function() {
            for (var i = 0; i < options().length; i++) if (value() == options()[i].value) return i;
            return null;
        }, setting.getDesc = ko.computed(function() {
            return desc();
        }, this), setting.isVisible = ko.computed(function() {
            return visible();
        }, this), setting.setDesc = function(val) {
            desc(val);
        }, setting.apply = settingData.apply, setting.toggle = function(option, evt) {
            "binary" != type ? value(option.value) : (selectedOption + 1 == options().length ? selectedOption = 0 : selectedOption += 1, 
            value(options()[selectedOption].value));
        }, setting.setOptions = function(optionList) {
            options(optionList);
        }, setting.setValue = function(newVal) {
            value(newVal);
        }, setting.setVisibility = function(newVal) {
            "boolean" == typeof newVal && visible(newVal);
        }, value.subscribe(function(option) {
            config.settings[cat][id] = value(), setting.apply(value()), __updateConfig();
        }), setting.extAPI = {
            getName: setting.getName,
            getType: setting.getType,
            getDesc: setting.getDesc,
            getValue: setting.getValue,
            value: value,
            toggle: setting.toggle,
            getOptions: setting.getOptions,
            isVisible: setting.isVisible
        };
    }
    ko.extenders.normalizePaths = function(target, option) {
        return target.subscribe(function(path) {
            target(__normalizePath(path));
        }), target;
    }, ko.extenders.lowerCase = function(target, option) {
        return target.subscribe(function(val) {
            target(val.toLowerCase());
        }), target;
    }, ko.extenders.callFunc = function(target, option) {
        return target.subscribe(function(val) {
            option.func(val);
        }), target;
    };
    var nw_version, updating, autoSaveFn, autoUpdateCheckFn, CSIDE_version, platform, self = this;
    usingNode ? (CSIDE_version = gui.App.manifest.version, nw_version = process.versions["node-webkit"], 
    "mac_os" === (platform = "darwin" === process.platform ? "mac_os" : process.platform) ? process.execPath.substring(0, process.execPath.lastIndexOf("/") + 1) : process.execPath.substring(0, process.execPath.lastIndexOf("\\") + 1), 
    updating = !1, autoUpdateCheckFn = autoSaveFn = null, self.isUpdating = function() {
        return updating;
    }) : (CSIDE_version = "Dropbox Alpha", platform = "web-dropbox");
    var CONST_IMG_PREFIX = "csideimg_", user = {
        name: usingNode ? require("username").sync() : "Dropbox User",
        path: "/"
    };
    user.name = user.name.charAt(0).toUpperCase() + user.name.slice(1);
    var projectMenuOptions = ko.observableArray([ new menuOption("Add new scene", function(menu) {
        menu.getTarget().addNewScene();
    }), new menuOption("Open all scenes", function(menu) {
        menu.getTarget().openAllScenes();
    }), new menuOption("Reload all scenes", function(menu) {
        menu.getTarget().reloadAllScenes();
    }), new menuOption("Review", function(menu) {}, [ new menuOption("Word count", function(menu) {
        cside.showWordCount(menu.getTarget());
    }) ]), new menuOption("Export", function(menu) {}, [ new menuOption("All scenes to folder", function(menu) {
        menu.getTarget().exportScenes();
    }) ]), new menuOption("Open folder in " + ("mac_os" === platform ? "Finder" : "Explorer"), function(menu) {
        menu.getTarget().openFolder();
    }), new menuOption("Show/hide project", function(menu) {
        menu.getTarget().setExpand();
    }), new menuOption("Close project", function(menu) {
        menu.getTarget().close();
    }) ]), sceneMenuOptions = ko.observableArray([ new menuOption("Edit", function(menu) {}, [ new menuOption("Convert all spaces to tabs", function(menu) {
        vseditor.getAction("editor.action.indentationToTabs").run();
    }), new menuOption("Convert all tabs to spaces", function(menu) {
        vseditor.getAction("editor.action.indentationToSpaces").run();
    }) ]), new menuOption("Review", function(menu) {}, [ new menuOption("Word count", function(menu) {
        cside.showWordCount(menu.getTarget());
    }) ]), new menuOption("Reload", function(menu) {
        function callback(err, scene) {
            err || selectedScene() !== menu.getTarget() || scene.select();
        }
        var scene = menu.getTarget();
        scene.isDirty() ? bootbox.confirm("<h3>Warning</h3><p>The scene '" + scene.getName() + "' has unsaved changes. Are you sure you wish to reload it?</p>", function(result) {
            result && scene.load(callback);
        }) : scene.load(callback);
    }), new menuOption("Close", function(menu) {
        menu.getTarget().close();
    }), new menuOption("Delete file", function(menu) {
        menu.getTarget().del();
    }) ]);
    usingNode && (sceneMenuOptions.push(new menuOption("Export", function(menu) {}, [ new menuOption("Copy file to folder", function(menu) {
        var scene = menu.getTarget();
        fh.selectFolder(function(newPath) {
            newPath && bootbox.confirm("<h3>Warning</h3><p>This will <b>overwrite</b> any file with the same name in '<i>" + newPath + "</i>'.<br>Are you sure you wish to continue?</p>", function(result) {
                result && fh.copyFile(scene.getPath(), newPath + scene.getName() + ".txt", function(buttons, data) {
                    buttons ? notification("Export Failed", buttons.message, {
                        type: "error"
                    }) : (buttons = [ {
                        addClass: "btn",
                        text: "Show Folder",
                        onClick: function(note) {
                            __openFolder(newPath), note.close();
                        }
                    } ], notification("Export Succesful", "Copied " + scene.getName() + " to " + newPath, {
                        type: "success",
                        buttons: buttons
                    }).setTimeout(3e3));
                });
            });
        });
    }), new menuOption("Print file", function(menu) {
        nw.Window.open("file://" + menu.getTarget().getPath(), {
            focus: !0,
            width: 800,
            height: 600
        }, function(win) {
            win.window.print();
        });
    }) ])), projectMenuOptions.splice(4, 0, new menuOption("Import", function(menu) {}, [ new menuOption("Image (as scene)", function(menu) {
        menu.getTarget().isReadOnly() || fh.selectImage(function(path) {
            path && function(project, path) {
                var image = new Image();
                image.onload = function() {
                    var canvas = document.createElement("canvas"), fileExt = getFileExtension(path), imgSceneName = (CONST_IMG_PREFIX + getLastDirName(path).replace(fileExt, "")).replace(/\s/g, "_").toLowerCase(), scenePath = project.getPath() + imgSceneName + ".txt";
                    canvas.width = this.naturalWidth, canvas.height = this.naturalHeight, canvas.width <= 0 && canvas.height <= 0 ? notification("Image Import Failed", path, {
                        type: "error"
                    }) : (canvas.getContext("2d").drawImage(image, 0, 0), sceneExists(imgSceneName, project, function(dataUrl) {
                        var newScene;
                        dataUrl ? bootbox.prompt({
                            title: "That Image Already Exists - Copy & Paste Code Below",
                            value: "*gosub_scene " + imgSceneName,
                            callback: function(result) {}
                        }) : (newScene = new CSIDEScene({
                            path: scenePath,
                            source: platform
                        }), dataUrl = canvas.toDataURL(), newScene.setText("*comment ENCODED IMAGE FILE - DO NOT EDIT\n*comment source: " + path + "\n*comment usage: *gosub_scene " + newScene.getName() + "\n*image " + dataUrl + "\n*return"), 
                        newScene.save(null, null, function(err) {
                            err ? bootbox.alert(err.message) : (notification("Image Import Successful", "", {
                                type: "success"
                            }), bootbox.prompt({
                                title: "Copy & Paste Code Below",
                                value: "*gosub_scene " + newScene.getName(),
                                callback: function(result) {}
                            }));
                        }));
                    }));
                }, image.onabort = image.onerror = function() {
                    notification("Image Import Failed", path, {
                        type: "error"
                    });
                }, image.src = "file://" + path;
            }(menu.getTarget(), path);
        });
    }) ])), projectMenuOptions.splice(6, 0, new menuOption("Test Project", function(menu) {}, [ new menuOption("Quicktest", function(menu) {
        menu.getTarget().test("quick");
    }), new menuOption("Randomtest", function(menu) {
        "web-dropbox" != platform ? menu.getTarget().test("random") : bootbox.alert("<h3>Apologies...</h3><p>But due to technical limitations randomtest can only be run in the Desktop version of the Choicescript IDE.</p></h3>");
    }) ])), projectMenuOptions()[5].getSubMenuOptions().push(new menuOption("Compiled game", function(menu) {
        menu.getTarget().compile();
    })));
    var vseditor = null, projects = ko.observableArray([]), cursorPos = ko.observable({
        lineNumber: 0,
        column: 0
    }), selectedChars = ko.observable(0), selectedScene = ko.observable(null), selectedProject = ko.computed(function() {
        return selectedScene() ? selectedScene().getProject() : null;
    }), SEARCH = {
        MODES: {
            SEARCH: 0,
            REPLACE: 1
        },
        CONF: {
            wordSeperators: "`~!@#$%^&*()-=+[{]}|;:'\",.<>/?",
            collapseThreshold: ko.observable(6),
            useRegex: ko.observable(!1).extend({
                callFunc: {
                    func: function() {
                        selectedProject().search("", "", SEARCH.MODES.SEARCH);
                    }
                }
            }),
            preserveCase: ko.observable(!0).extend({
                callFunc: {
                    func: function() {
                        selectedProject().search("", "", SEARCH.MODES.SEARCH);
                    }
                }
            }),
            matchWholeWord: ko.observable(!1).extend({
                callFunc: {
                    func: function() {
                        selectedProject().search("", "", SEARCH.MODES.SEARCH);
                    }
                }
            }),
            searchOnType: ko.observable(!0)
        }
    };
    function getWordSeperationValue() {
        return SEARCH.CONF.matchWholeWord() ? SEARCH.CONF.wordSeperators : null;
    }
    self.SEARCH_MODES = SEARCH.MODES;
    var nativeMenuBar, searchMode = ko.observable(SEARCH.MODES.SEARCH);
    searchMode.extend({
        callFunc: {
            func: function(newVal) {
                setTimeout(function() {
                    document.getElementById(newVal == SEARCH.MODES.REPLACE ? "replaceBox" : "searchBox").focus();
                }, 200), selectedProject().search("", "", SEARCH.MODES.SEARCH);
            }
        }
    }), self.toggleSearchMode = function(newSearchMode) {
        if ("number" == typeof newSearchMode) searchMode(newSearchMode); else {
            switch (searchMode()) {
              case SEARCH.MODES.REPLACE:
                newSearchMode = SEARCH.MODES.SEARCH;
                break;

              case SEARCH.MODES.SEARCH:
                newSearchMode = SEARCH.MODES.REPLACE;
                break;

              default:
                throw new Error("Unrecognized search mode: " + searchMode() + ". Please report this.");
            }
            searchMode(newSearchMode);
        }
    }, self.inReplaceMode = ko.computed(function() {
        return searchMode() === SEARCH.MODES.REPLACE;
    }, this), self.searchToggles = ko.observableArray([ {
        title: "Match Whole Word",
        cssClass: "codicon-whole-word",
        value: SEARCH.CONF.matchWholeWord
    }, {
        title: "Use Regular Expression",
        cssClass: "codicon-regex",
        value: SEARCH.CONF.useRegex
    }, {
        title: "Match Case",
        cssClass: "codicon-case-sensitive",
        value: SEARCH.CONF.preserveCase
    }, {
        title: "Search on Type",
        cssClass: "codicon-record-keys",
        value: SEARCH.CONF.searchOnType
    } ]), self.getSelectedProject = ko.computed(function() {
        return selectedProject();
    }, this), "mac_os" === platform && (nativeMenuBar = new nw.Menu({
        type: "menubar"
    }), "darwin" === process.platform && nativeMenuBar.createMacBuiltin("CSIDE"), win.menu = nativeMenuBar, 
    function() {
        var projectMenu = new nw.Menu();
        projectMenu.getTarget = selectedProject;
        for (var options = projectMenuOptions(), i = 0; i < options.length; i++) if (options[i].getSubMenuOptions()) {
            for (var subMenu = new nw.Menu(), o = 0; o < options[i].getSubMenuOptions().length; o++) subMenu.append(new nw.MenuItem({
                label: options[i].getSubMenuOptions()[o].getLabel(),
                click: options[i].getSubMenuOptions()[o].doAction.bind(null, projectMenu)
            }));
            projectMenu.append(new nw.MenuItem({
                label: options[i].getLabel(),
                click: options[i].doAction.bind(null, projectMenu),
                submenu: subMenu
            }));
        } else projectMenu.append(new nw.MenuItem({
            label: options[i].getLabel(),
            click: options[i].doAction.bind(null, projectMenu)
        }));
        var index = "mac_os" === platform ? 3 : 1;
        win.menu.insert(new nw.MenuItem({
            label: "Project",
            submenu: projectMenu
        }), index);
    }(), function() {
        var sceneMenu = new nw.Menu();
        sceneMenu.getTarget = selectedScene;
        for (var options = sceneMenuOptions(), i = 0; i < options.length; i++) if (options[i].getSubMenuOptions()) {
            for (var subMenu = new nw.Menu(), o = 0; o < options[i].getSubMenuOptions().length; o++) subMenu.append(new nw.MenuItem({
                label: options[i].getSubMenuOptions()[o].getLabel(),
                click: options[i].getSubMenuOptions()[o].doAction.bind(null, sceneMenu)
            }));
            sceneMenu.append(new nw.MenuItem({
                label: options[i].getLabel(),
                click: options[i].doAction.bind(null, sceneMenu),
                submenu: subMenu
            }));
        } else sceneMenu.append(new nw.MenuItem({
            label: options[i].getLabel(),
            click: options[i].doAction.bind(null, sceneMenu)
        }));
        var index = "mac_os" === platform ? 4 : 2;
        win.menu.insert(new nw.MenuItem({
            label: "Scene",
            submenu: sceneMenu
        }), index);
    }(), "mac_os" != platform ? nw.Window.get().menu = win.menu : (ko.extenders.updateMenuBarStates = function(target, option) {
        return target.subscribe(function(projectIndex) {
            var b = !!projectIndex, projectIndex = "mac_os" === platform ? 3 : 1, sceneIndex = "mac_os" === platform ? 4 : 2;
            win.menu = nw.Window.get().menu;
            for (var index = projectIndex; index <= sceneIndex; index++) for (var item = 0; item < win.menu.items[index].submenu.items.length; item++) win.menu.items[index].submenu.items[item].enabled = b;
            nw.Window.get().menu = win.menu;
        }), target;
    }, selectedScene.extend({
        updateMenuBarStates: ""
    }), selectedScene.valueHasMutated()));
    var reservedSceneNames = "(STARTUP|CHOICESCRIPT_STATS)", recentSceneColours = ko.observableArray([ "#72c374", "#7797ec", "#d9534f", "#a5937a", "#ff8d2b", "#e079f5", "#00a8c3", "#777777" ]), uiColour = ko.observable().extend({
        notify: "always"
    });
    uiColour("90,90,90");
    ko.observable(!1);
    var config, activeProject = ko.observable(""), projects = ko.observableArray([]), wordCountOn = ko.observable(!0), defaultConfig = {
        settings: {
            editor: {
                usespaces: !0,
                smartindent: !0,
                tabsize: 4,
                indentspaces: 4,
                linewrap: !0,
                fontsize: "12px",
                fontfamily: "'Courier New', Courier, monospace",
                spell_dic: "en_US",
                theme: "cs-dark",
                "night-mode": !1,
                spellcheck: !0,
                autosuggest: !0,
                autoformat: !0,
                "word-count": 2,
                "visible-tabs": !1,
                "selection-match": !1
            },
            app: {
                persist: !0,
                autosave: !0,
                cmdhelp: !0,
                "update-channel": "stable",
                "ui-colour": "90,90,90",
                "project-path": "default"
            }
        },
        justUpdated: !1,
        openProjects: [],
        recentColours: [],
        userDictionary: {},
        tabs: [ "game", "issues", "settings", "search", "help", "dictionary" ]
    };
    usingNode && defaultConfig.tabs.push("examples"), config = defaultConfig;
    try {
        for (var item in storedConfig = JSON.parse(localStorage.getItem("CSIDE_appConfig")), 
        storedConfig) config[item] = storedConfig[item];
    } catch (err) {
        bootbox.alert("Sorry, there was a problem parsing your configuration settings.<br> \t\tThey have been repaired and reset to the defaults.<br><br> \t\t<b>Error:</b> " + err.message), 
        localStorage.setItem("CSIDE_appConfig", JSON.stringify(defaultConfig)), config = defaultConfig;
    }
    var db, userDictionary = {}, fh = {
        writeFile: function(path, data, callback) {
            "web-dropbox" === platform ? db.filesUpload({
                path: path,
                contents: data,
                mode: {
                    ".tag": "overwrite"
                },
                autorename: !1
            }).then(function(response) {
                callback(null);
            }).catch(function(err) {
                callback(normalizeError(err));
            }) : mkdirp(getDirName(path), function(err) {
                err ? callback(normalizeError(err)) : fs.writeFile(path, data, {
                    encoding: "utf8"
                }, function(err) {
                    callback(normalizeError(err));
                });
            });
        },
        readFile: function(path, callback) {
            "web-dropbox" === platform ? db.filesDownload({
                path: path
            }).then(function(fileData) {
                var reader = new FileReader();
                reader.addEventListener("loadend", function() {
                    reader.result ? callback(null, new TextDecoder("utf-8").decode(reader.result)) : callback({});
                }), reader.readAsArrayBuffer(fileData.fileBlob);
            }).catch(function(err) {
                callback(normalizeError(err));
            }) : fs.readFile(path, {
                encoding: "utf8"
            }, function(err, data) {
                callback(normalizeError(err), data);
            });
        },
        copyFile: function(oldPath, newPath, callback) {
            "web-dropbox" === platform ? db.filesCopy({
                from_path: oldPath,
                to_path: newPath
            }).then(function(response) {
                callback(null);
            }).catch(function(err) {
                callback(normalizeError(err));
            }) : fs.readFile(oldPath, {
                encoding: "utf8"
            }, function(err, data) {
                err ? callback(normalizeError(err)) : fs.writeFile(newPath, data, function(err) {
                    callback(normalizeError(err));
                });
            });
        },
        renameFile: function(oldPath, newPath, callback) {
            "web-dropbox" === platform ? db.filesMove({
                from_path: oldPath,
                to_path: newPath
            }).then(function(response) {
                callback(null);
            }).catch(function(err) {
                callback(normalizeError(err));
            }) : fs.rename(oldPath, newPath, function(err) {
                callback(normalizeError(err));
            });
        },
        deleteFile: function(path, callback) {
            "web-dropbox" === platform ? db.filesDelete({
                path: path
            }).then(function(response) {
                callback(null);
            }).catch(function(err) {
                callback(normalizeError(err));
            }) : trash([ path ], function(err) {
                callback(normalizeError(err));
            });
        },
        readDir: function(path, callback, dbMetaData) {
            "web-dropbox" === platform ? db.filesListFolder({
                path: path = "/" == path ? "" : path
            }).then(function(response) {
                callback(null, void 0 !== dbMetaData && 1 == dbMetaData ? response.entries.map(function(item) {
                    return item.path = item.path_lower, item.isFolder = "folder" == item[".tag"], item;
                }) : response.entries.map(function(item) {
                    return getLastDirName(item.path_lower);
                }));
            }).catch(function(err) {
                callback(normalizeError(err));
            }) : fs.readdir(path, function(err, filePathArray) {
                callback(normalizeError(err), filePathArray);
            });
        },
        makeDir: function(path, callback) {
            "web-dropbox" === platform ? ("/" == path.slice(-1, path.length) && (path = path.slice(0, -1)), 
            db.filesCreateFolder({
                path: path
            }).then(function(response) {
                callback(null);
            }).catch(function(error) {
                err && 403 == err.status && (delete err.status, err.code = "EEXIST"), callback(normalizeError(err));
            })) : mkdirp(path, function(err) {
                callback(normalizeError(err));
            });
        },
        stat: function(path, callback) {
            "web-dropbox" === platform ? db.filesGetMetadata({
                path: path
            }).then(function(response) {
                callback(null, {
                    mtime: new Date(response.client_modified)
                });
            }).catch(function(err) {
                callback(normalizeError(err));
            }) : fs.stat(path, function(err, fileStats) {
                callback(normalizeError(err), fileStats);
            });
        },
        selectFolder: function(callback) {
            var chooser;
            "web-dropbox" === platform ? fileBrowser.selectFolders(function(selection) {
                0 < selection.length ? callback(selection[0].path + "/") : callback(null);
            }) : ((chooser = $("#selectFolder")).off().change(function(evt) {
                callback($(this).val() + "/"), $(this).val("");
            }), setTimeout(function() {
                chooser.trigger("click");
            }, 200));
        },
        selectImage: function(callback) {
            var chooser;
            "web-dropbox" === platform ? bootbox.alert("TODO: Image scene import not yet implemented on the web-version.") : ((chooser = $("#getImagePaths")).off().change(function(evt) {
                callback($(this).val()), $(this).val("");
            }), setTimeout(function() {
                chooser.trigger("click");
            }, 200));
        },
        selectFiles: function(callback, options) {
            var extensions, chooser;
            options = options || {}, usingNode ? (extensions = options.extensions || [ ".txt", ".log" ], 
            (chooser = $("#getFilePaths")).attr("accept", extensions.join(",")), chooser.off().change(function(evt) {
                var selection = $(this).val().split(";");
                1 === selection.length && "" === selection[0] && callback(null), $(this).val(""), 
                callback(selection);
            }), chooser.trigger("click")) : fileBrowser.open(function(selection) {
                selection.length < 1 && callback(null), selection = selection.filter(function(file) {
                    return !file.isFolder();
                }).map(function(file) {
                    return file.path;
                }), callback(selection);
            }, options);
        }
    }, normalizeError = function(err) {
        if (!err) return null;
        if (void 0 === err.message) try {
            err.message = JSON.parse(err.responseText).error;
        } catch (e) {
            err.message = "Unable to get an error description";
        }
        switch (void 0 === err.code && (err.code = err.status || "Unknown Error Code"), 
        void 0 !== err.code && 409 == err.code && ("not_found" == err.error.error[err.error.error[".tag"]][".tag"] && (err.code = 404), 
        err.message = "Dropbox: " + err.error.error_summary), err.code) {
          case "not_found":
          case "ENOENT":
          case 404:
            err.code = 404;
        }
        return err;
    }, notification = function(title, message, options) {
        (options = options || {}).theme = "bootstrap-v3", options.layout = options.layout || "bottomRight", 
        options.type = options.type || "alert", options.timeout = !1 !== options.timeout && (options.timeout || 5e3), 
        options.closeWith = !1 !== options.closeWith && (options.closeWith || [ "click" ]), 
        options.buttons = options.buttons || null, options.buttons && (options.buttons = options.buttons.map(function(btn) {
            return Noty.button(btn.text, btn.addClass, function(note) {
                btn.onClick(note);
            });
        })), options.text = "<h5>" + title + "</h5>\t\t\t\t\t <p>" + message + "</p>", options.progress && (options.text += "<progress value='0' max='100'></progress>");
        var n = new Noty(options);
        return options.progress && (n.setProgress = function(val) {
            $(n.barDom).find(".noty_body").find("progress").val(val);
        }), n.show(), n;
    };
    function _bootboxSelect(msg, opts, callback, currentValue) {
        for (var val, btn, div = function(msg) {
            var template = document.createElement("template");
            return template.innerHTML = '<div class="bootbox-select"><p></p></div>', template.content.firstChild.querySelector("p").innerText = msg, 
            template.content.firstChild;
        }(msg), i = 0; i < opts.length; i++) {
            var btnElement = (val = opts[i], btn = void 0, (btn = document.createElement("button")).className = "btn " + (currentValue == val ? "btn-primary" : "btn-default"), 
            btn.innerText = val, btn);
            !function(x) {
                btnElement.addEventListener("click", function() {
                    bootbox.hideAll(), callback(opts[x]);
                });
            }(i), div.appendChild(btnElement);
        }
        bootbox.dialog({
            message: div,
            closeButton: !1,
            onEscape: !0
        });
    }
    self.notification = function(title, message, options) {
        return notification(title, message, options);
    }, self.promptForSceneIndentation = function() {
        var types = [ "Tabs", "Spaces" ];
        _bootboxSelect("Select Indentation Unit", types, function(unitOpt) {
            self.getSelectedScene().updateUseSpaces("Spaces" === unitOpt), _bootboxSelect("Select Indentation Size", settings.byId("editor", "tabsize").getOptions().map(function(o) {
                return o.value;
            }), function(sizeOpt) {
                self.getSelectedScene().updateIndentSize(sizeOpt), bootbox.hideAll();
            }, meditor.getModel().getOptions().tabSize);
        }, types[Number(meditor.getModel().getOptions().insertSpaces)]);
    }, self.footerBtnHover = function(IDEmodel, evt) {
        var ele = evt.currentTarget;
        switch (evt.type) {
          case "mousedown":
            ele.style.backgroundColor = this.getUIColour(-20);
            break;

          case "mouseover":
            ele.style.backgroundColor = this.getUIColour(-10);
            break;

          case "mouseup":
          case "mouseout":
            ele.style.backgroundColor = "transparent";
            break;

          default:
            return;
        }
    }, "web-dropbox" == platform && (utils.parseQueryString(window.location.hash).access_token ? (db = new Dropbox({
        accessToken: utils.parseQueryString(window.location.hash).access_token
    })).setClientId("hnzfrguwoejpwbj") : (myContextMenuViewModel = (db = new Dropbox({
        clientId: "hnzfrguwoejpwbj"
    })).getAuthenticationUrl(window.location), window.location = myContextMenuViewModel), 
    db.usersGetCurrentAccount().then(function(acc) {
        user.name = acc.name.display_name;
    }).catch(function(err) {})), window.db = db;
    var dropboxAuthorised = ko.observable(!1), typo = new Typo("", "", "", {
        platform: "any"
    });
    self.dbAuth = ko.computed(function() {
        return dropboxAuthorised();
    }, this), self.getProjects = projects, self.getSelectedScene = ko.computed(function() {
        return selectedScene();
    }, this), self.getActiveProject = ko.computed(function() {
        return activeProject();
    }, this), self.getRecentSceneColours = ko.computed(function() {
        return recentSceneColours();
    }, this), self.getPlatform = function() {
        return platform;
    }, self.wordCountOn = ko.computed(function() {
        return wordCountOn();
    }), self.getUIColour = function(delta) {
        delta = delta || 0, config.settings.app["night-mode"] && (delta -= 30);
        for (var val, rgb = uiColour().split(","), i = 0; i < rgb.length; i++) (val = parseInt(rgb[i]) + delta) < 0 ? val = 0 : 255 < val && (val = 255), 
        rgb[i] = val;
        return "rgb(" + rgb.join(",") + ")";
    }, self.selectTab = function(tab) {
        for (var tabs = self.tabs(), i = 0; i < tabs.length; i++) if (tab === tabs[i].id) {
            __selectTab(tab);
            break;
        }
    }, self.readFile = function(url, callback) {
        fh.readFile(url, callback);
    }, self.selectScene = function(scene) {
        scene.select();
    }, self.session = {
        save: function(cb) {
            var failed = !1, count = projects().length;
            count < 1 ? cb(null) : projects().forEach(function(project, index) {
                project.save(function(err) {
                    return err ? failed ? void 0 : (failed = !0, cb(err)) : void (0 == --count && cb(null));
                });
            });
        },
        isDirty: ko.computed(function() {
            for (var i = 0; i < projects().length; i++) if (projects()[i].isDirty()) return !0;
            return !1;
        })
    }, self.session.win = function() {
        var fullScreen = ko.observable(!0);
        return {
            isFullscreen: ko.computed(function() {
                return fullScreen();
            }, this),
            toggleMaximize: function() {
                fullScreen() ? win.restore() : "mac_os" === platform ? win.enterFullscreen() : win.maximize(), 
                fullScreen(!fullScreen());
            }
        };
    }();
    var insertTextTags = function(tagStart, tagEnd, allowSpecialLines) {
        var line, whitespace;
        if (text = vseditor.getModel().getValueInRange(vseditor.getSelection())) {
            text = text.split("\n");
            for (var i = 0; i < text.length; i++) "" !== (line = text[i].replace(/\r?\n|\r/, "")) && (!allowSpecialLines && (line.match(/^\s*\*[A-Za-z_]+\b/) || line.match(/^\s*#/)) || (line = (line = (whitespace = line.match(/^\s+/g)) ? line.replace(/^\s+/g, "") : line).substring(0, tagStart.length) === tagStart && line.substring(line.length - tagEnd.length, line.length) === tagEnd ? line.substring(tagStart.length, line.length - tagEnd.length) : tagStart + line + tagEnd, 
            text[i] = (whitespace || "") + line));
            text = text.join("\n"), vseditor.executeEdits("insertTextTags", [ {
                range: vseditor.getSelection(),
                text: text
            } ]);
        } else {
            var text = tagStart + tagEnd, currentSel = vseditor.getSelection(), originalSel = Object.assign({}, currentSel);
            (currentSel = vseditor.getModel().pushEditOperations([ originalSel ], [ {
                range: new monaco.Range(originalSel.startLineNumber, originalSel.startColumn, originalSel.startLineNumber, originalSel.startColumn),
                text: text
            } ], function(inverseEditOperations) {
                return currentSel.startColumn = currentSel.selectionStartColumn = currentSel.positionColumn = currentSel.startColumn + tagStart.length, 
                [ currentSel ];
            })) && vseditor.setSelection(currentSel[0]);
        }
    }, __csideTabs = {
        game: {
            id: "game",
            title: "Game",
            showTitle: !0,
            iconClass: "fa fa-cube",
            href: ko.observable(""),
            content: "",
            visible: ko.observable(!0),
            getHeaderTitle: ko.computed(function() {
                return activeProject() ? activeProject().getName() : "Run a Project";
            }, this)
        },
        issues: {
            id: "issues",
            title: "Issues",
            showTitle: !0,
            iconClass: "fa fa-exclamation-triangle",
            href: "",
            content: "",
            visible: ko.observable(!0),
            getHeaderTitle: ko.computed(function() {
                return selectedProject() ? "Issues with " + selectedProject().getName() : "Select a Project";
            }, this)
        },
        settings: {
            id: "settings",
            title: "Settings",
            showTitle: !1,
            iconClass: "fa fa-cog",
            href: "",
            content: "",
            visible: ko.observable(!0),
            getHeaderTitle: ""
        },
        help: {
            id: "help",
            title: "Help & Information",
            showTitle: !0,
            iconClass: "fa fa-question-circle",
            href: "help/index.html",
            content: "",
            visible: ko.observable(!0),
            getHeaderTitle: "Help & Information"
        },
        search: {
            id: "search",
            title: "Search and Replace",
            showTitle: !0,
            iconClass: "fa fa-search",
            href: "",
            content: "",
            visible: ko.observable(!0),
            getHeaderTitle: ko.computed(function() {
                return selectedProject() ? (self.inReplaceMode() ? "Replace" : "Search") + " in " + selectedProject().getName() : "Select a Project";
            }, this)
        },
        dictionary: {
            id: "dictionary",
            title: "User Dictionary",
            showTitle: !0,
            iconClass: "fa fa-book",
            href: "",
            content: "",
            visible: ko.observable(!0),
            getHeaderTitle: "User Dictionary"
        },
        examples: {
            id: "examples",
            title: "Example Projects & Templates",
            showTitle: !0,
            iconClass: "fa fa-lightbulb-o",
            href: "",
            content: "",
            visible: ko.observable(!0),
            getHeaderTitle: "Example Projects & Templates"
        }
    };
    function __cycleSceneSelection(direction) {
        var index, currentScene, sceneList;
        cside.getSelectedProject() && (currentScene = cside.getSelectedScene(), sceneList = cside.getSelectedProject().getScenes(), 
        currentScene && -1 < (index = sceneList.indexOf(cside.getSelectedScene())) && (direction ? 0 < index ? sceneList[--index] : sceneList[sceneList.length - 1] : index < sceneList.length - 1 ? sceneList[++index] : sceneList[0]).select());
    }
    function __getTab(id) {
        for (var tabs = self.tabs(), i = 0; i < tabs.length; i++) if (id === tabs[i].id) return tabs[i];
        return null;
    }
    function __getCSIDEHelp() {
        for (var i = 0; i < frames.length; i++) if (frames[i].csideHelp) return frames[i].csideHelp;
        return null;
    }
    self.tabs = ko.observableArray([]), self.tabs.subscribe(function(tabList) {
        for (var i = 0; i < tabList.length; i++) tabList[i] || tabList.splice(i, 1);
    }), usingNode && (self.cs_examples = [ {
        title: "Interactive CSIDE Tutorial",
        desc: "A great starting point tutorial - developed by Vendetta. Useful for those new to both Choicescript and the Choicescript IDE.",
        path: "cs_examples/CSIDE Tutorial/"
    }, {
        title: "ChoiceScript Basics Tutorial",
        desc: "A simple tutorial template by FairyGodfeather. This example project is designed to get you started with handling name, gender and relationship stats in your ChoiceScript games. A great starting point for any new project!",
        path: "cs_examples/Basics Tutorial/"
    }, {
        title: "Pronouns with Gender-Neutral Options Template",
        desc: 'A template for including gender neutral pronouns in your game (they/them), created by Lynnea Glasser. This includes a variable system to make sure your verbs and pronouns will match ("They go on ahead"/"She goes on ahead").',
        path: "cs_examples/GNO Pronoun Template/"
    } ], self.runExample = function(data) {
        __runProject(new CSIDEProject({
            path: data.path
        }));
    }, self.cloneExample = function(data) {
        self.createProject("", function(err, project) {
            err ? notification("Error", err.message, {
                type: "error"
            }) : __copyProjectTo(data.path, project.getPath(), function(err) {
                err ? notification("Error", err.message, {
                    type: "error"
                }) : (project.openAllScenes(), notification("Import Successful", data.title + " imported to " + project.getPath(), {
                    type: "success"
                }));
            });
        }, !0);
    });
    var settings = {
        editor: ko.observableArray([ new CSIDESetting({
            id: "smartindent",
            name: "Smart Indentation",
            value: !0,
            type: "binary",
            cat: "editor",
            desc: "Automatically indent (or dedent) the cursor after flow-control commands",
            apply: function(val) {
                val ? this.handle && this.handle.dispose() : this.handle = monaco.languages.setLanguageConfiguration("choicescript", {
                    onEnterRules: []
                });
            }
        }), new CSIDESetting({
            id: "linewrap",
            name: "Line Wrapping",
            value: !0,
            type: "binary",
            cat: "editor",
            desc: "Wrap lines that exceed the editor's width (no horizontal scrolling)",
            apply: function(val) {
                vseditor.updateOptions({
                    wordWrap: val ? "on" : "off"
                });
            }
        }), new CSIDESetting({
            id: "autosuggest",
            name: "Auto Suggest",
            value: !0,
            type: "binary",
            cat: "editor",
            desc: "Prompt quick-complete word suggestions as you type",
            apply: function(val) {
                vseditor.updateOptions({
                    quickSuggestions: val
                });
            }
        }), new CSIDESetting({
            id: "autoformat",
            name: "Auto Format",
            value: !0,
            type: "binary",
            cat: "editor",
            desc: "Automatically replace certain character combinations with their formatted equivalents",
            apply: function(val) {
                vseditor.updateOptions({
                    formatOnType: val
                });
            }
        }), new CSIDESetting({
            id: "selection-match",
            name: "Selection Match",
            value: !0,
            type: "binary",
            cat: "editor",
            desc: "Highlight matching instances of selected text",
            apply: function(val) {
                vseditor.updateOptions({
                    selectionHighlight: val
                });
            }
        }), new CSIDESetting({
            id: "visible-tabs",
            name: "Visible Indentation",
            value: !1,
            type: "binary",
            cat: "editor",
            desc: "Provides a visible representation of the indentation level in the editor window",
            apply: function(val) {
                vseditor.updateOptions({
                    renderIndentGuides: val
                });
            }
        }), new CSIDESetting({
            id: "spellcheck",
            name: "Spell Check",
            value: !0,
            type: "binary",
            cat: "editor",
            desc: "Underline any misspelt words in the active scene text",
            apply: function(val) {
                var monacoOptions = __getMonacoDiagnosticOptions();
                monacoOptions.spellcheck.enabled = Boolean(val), __updateMonacoDiagnosticOptions(monacoOptions), 
                val ? this.handle = monaco.languages.choicescript.onDictionaryChange(dictEvent => {
                    userDictionary.add(dictEvent.word, dictEvent.dictionary);
                }) : this.handle && this.handle.dispose();
            }
        }), new CSIDESetting({
            id: "spell_dic",
            name: "Spell Check Dictionary",
            value: "en_US",
            type: "variable",
            cat: "editor",
            options: [ {
                desc: "US",
                value: "en_US"
            }, {
                desc: "GB",
                value: "en_GB"
            } ],
            desc: "The dictionary to spellcheck against",
            apply: function(val) {
                typo = new Typo(val, typo._readFile("lib/typo/dictionaries/" + val + "/" + val + ".aff"), typo._readFile("lib/typo/dictionaries/" + val + "/" + val + ".dic"), {
                    platform: "any"
                });
                var monacoOptions = __getMonacoDiagnosticOptions();
                monacoOptions.spellcheck.dictionary = val, __updateMonacoDiagnosticOptions(monacoOptions);
            }
        }), new CSIDESetting({
            id: "word-count",
            name: "Word Count",
            value: 2,
            type: "variable",
            cat: "editor",
            desc: "Display the current scene's word and character counts at the bottom of the editor window",
            options: [ {
                desc: "Exclude cmd lines",
                value: 2
            }, {
                desc: "Include cmd lines",
                value: 1
            }, {
                desc: "Off",
                value: 0
            } ],
            apply: function(val) {
                wordCountOn(val);
            }
        }), new CSIDESetting({
            id: "usespaces",
            name: "Use Spaces for Indentation",
            value: !0,
            type: "binary",
            cat: "editor",
            desc: "Sets the preferred indentation unit to spaces (on) or tabs (off). Note that this will only be applied to newly created scenes. This setting can be overridden per scene.",
            apply: function(val) {}
        }), new CSIDESetting({
            id: "tabsize",
            name: "Tab/Indent Block Size",
            value: "4",
            type: "dropdown",
            cat: "editor",
            options: [ {
                desc: "2",
                value: "2"
            }, {
                desc: "3",
                value: "3"
            }, {
                desc: "4",
                value: "4"
            }, {
                desc: "5",
                value: "5"
            }, {
                desc: "6",
                value: "6"
            }, {
                desc: "7",
                value: "7"
            }, {
                desc: "8",
                value: "8"
            } ],
            desc: "Sets the default visual size of tabs. This setting can be overridden per scene.",
            apply: function(val) {}
        }), new CSIDESetting({
            id: "indentspaces",
            name: "Space Indentation Size",
            value: "4",
            type: "dropdown",
            cat: "editor",
            options: [ {
                desc: "2",
                value: "2"
            }, {
                desc: "3",
                value: "3"
            }, {
                desc: "4",
                value: "4"
            }, {
                desc: "5",
                value: "5"
            }, {
                desc: "6",
                value: "6"
            }, {
                desc: "7",
                value: "7"
            }, {
                desc: "8",
                value: "8"
            } ],
            desc: "Sets the preferred number of spaces used for indentation. Note that this will only be applied to newly created scenes. This setting can be overridden per scene.",
            apply: function(val) {}
        }), new CSIDESetting({
            id: "fontsize",
            name: "Font Size (px)",
            value: "12px",
            type: "variable",
            cat: "editor",
            options: [ {
                desc: "10",
                value: "10px"
            }, {
                desc: "12",
                value: "12px"
            }, {
                desc: "14",
                value: "14px"
            }, {
                desc: "16",
                value: "16px"
            } ],
            desc: "The size of the font in the editor window",
            apply: function(val) {
                vseditor.updateOptions({
                    fontSize: val
                });
            }
        }), new CSIDESetting({
            id: "fontfamily",
            name: "Font Family",
            value: "'Century Gothic', AppleGothic, Arial, Helvetica, sans-serif",
            type: "dropdown",
            cat: "editor",
            options: [ {
                desc: "Mono",
                value: "'Courier New', Courier, monospace"
            }, {
                desc: "Sans-Serif",
                value: "Arial, Helvetica, sans-serif"
            }, {
                desc: "Serif",
                value: "'Times New Roman', Times, serif"
            }, {
                desc: "Gothic",
                value: "'Century Gothic', AppleGothic, Arial, Helvetica, sans-serif"
            } ],
            desc: "The font family used in the editor window",
            apply: function(val) {
                vseditor.updateOptions({
                    fontFamily: val
                });
            }
        }), new CSIDESetting({
            id: "theme",
            name: "Editor Theme",
            value: "cs-light",
            type: "dropdown",
            cat: "editor",
            options: [ {
                desc: "Light",
                value: "cs-light"
            }, {
                desc: "Dark",
                value: "cs-dark"
            } ],
            desc: "Sets the colour and style of the editor window and its text",
            apply: function(val) {
                var options, BASE_THEMES = [ "vs", "vs-dark", "hc-black" ], CS_THEMES = [ "cs-light", "cs-dark" ];
                vseditor._themeService._knownThemes.size > this.getOptions().length + BASE_THEMES.length && (options = [], 
                vseditor._themeService._knownThemes.forEach(function(theme) {
                    BASE_THEMES.indexOf(theme.themeName) < 0 && options.push({
                        desc: -1 < CS_THEMES.indexOf(theme.themeName) ? theme.themeName : theme.themeName + " (custom)",
                        value: theme.themeName
                    });
                }), this.setOptions(options), options.some(function(opt) {
                    return opt.value === val;
                }) && this.apply(val)), this.getOptions().some(function(opt) {
                    return opt.value === val;
                }) || (val = "cs-light"), monaco.editor.setTheme(val), $("#code-footer, #cs-console").removeClass(function(i, className) {
                    return (className.match(/cs-\w+/g) || []).join(" ");
                }).addClass(val);
            }
        }) ]),
        app: ko.observableArray([ new CSIDESetting({
            id: "version",
            name: "Version: " + CSIDE_version,
            value: "",
            type: "variable",
            options: [],
            desc: "",
            apply: function(val) {}
        }), new CSIDESetting({
            id: "autosave",
            name: "Autosave Scenes & Projects",
            value: !1,
            type: "binary",
            desc: "Save all unsaved changes automatically (every 5 minutes)",
            apply: function(val) {
                void 0 !== autoSaveFn && autoSaveFn && clearInterval(autoSaveFn), val && (autoSaveFn = setInterval(function() {
                    self.session.save(function(err) {
                        err && bootbox.alert("<h3>Save Error</h3>" + err.message);
                    });
                }, 3e5));
            }
        }), new CSIDESetting({
            id: "persist",
            name: "Persistent Session",
            value: !1,
            type: "binary",
            desc: "Retain open scenes & project data between sessions",
            apply: function(val) {}
        }), new CSIDESetting({
            id: "cmdhelp",
            name: "Command Help (prompts & links)",
            value: !1,
            type: "binary",
            desc: "Hovering the cursor over a command in the editor window will display additional information",
            apply: function(val) {
                vseditor.updateOptions({
                    hover: {
                        enabled: val
                    }
                });
            }
        }), new CSIDESetting({
            id: "night-mode",
            name: "Night Mode",
            value: !1,
            type: "binary",
            desc: "Toggle between a light and dark application interface",
            apply: function(val) {
                var help = __getCSIDEHelp();
                val ? ($("body").addClass("night"), help && $(help.document.body).addClass("night")) : ($("body").removeClass("night"), 
                help && $(help.document.body).removeClass("night")), uiColour(uiColour());
            }
        }), new CSIDESetting({
            id: "project-path",
            name: "Project Folder",
            value: "default",
            type: "custom",
            options: [ {
                desc: "Select",
                value: "select"
            }, {
                desc: "Default",
                value: "default"
            } ],
            desc: "",
            apply: function(val) {
                var path, self = this;
                "default" == val ? (usingNode && (path = process.env["win32" == process.platform ? "USERPROFILE" : "HOME"]), 
                path = usingNode ? path + "/Documents/Choicescript Projects/" : "/Choicescript Projects/", 
                self.setDesc(path), user.path = path) : "select" == val ? (fh.selectFolder(function(path) {
                    path && (path = __normalizePath(path), self.setValue(path), self.setDesc(path), 
                    user.path = path, config.settings[self.getCat()][self.getId()] = path, __updateConfig());
                }), self.setValue(user.path), config.settings[self.getCat()][self.getId()] = user.path, 
                __updateConfig()) : (self.setDesc(val), user.path = val);
            }
        }), new CSIDESetting({
            id: "allowscript",
            name: "Allow Script",
            value: !1,
            type: "binary",
            desc: "Enables usage of the *script command in your ChoiceScript games.",
            apply: function(val) {
                "web-dropbox" === platform && this.setVisibility(!1);
            }
        }), new CSIDESetting({
            id: "update-channel",
            name: "Update Channel",
            value: "stable",
            type: "variable",
            options: [ {
                desc: "Stable",
                value: "stable"
            }, {
                desc: "Latest",
                value: "latest"
            }, {
                desc: "Development",
                value: "development"
            }, {
                desc: "None",
                value: "none"
            } ],
            desc: "Speed and stability of the updates CSIDE will receive",
            apply: function(channel) {
                var autoUpdate, self = this;
                "web-dropbox" != platform ? (void 0 !== autoUpdateCheckFn && autoUpdateCheckFn && clearInterval(autoUpdateCheckFn), 
                "none" != channel && usingNode && (autoUpdate = function() {
                    var n;
                    self.prompt && !self.prompt.closed || (n = notification("", "<i aria-hidden=true class='fa fa-refresh fa-spin'></i> Checking for updates...", {
                        closeWith: !1,
                        timeout: !1
                    }), updater.checkForUpdates({
                        cside: CSIDE_version,
                        nw: nw_version
                    }, channel, function(err, update) {
                        n.close(), err ? notification("Connection Error", "Failed to obtain update data from server. " + err.message, {
                            type: "error"
                        }) : update && (self.prompt = function(channel, update) {
                            var buttons = [ {
                                addClass: "btn",
                                text: "Download",
                                onClick: function(note) {
                                    note.close(), function(channel) {
                                        var status, eventHandlers;
                                        updating || (status = notification("Downloading Update", "Do not close the program", {
                                            progress: !0,
                                            closeWith: !1,
                                            timeout: !1
                                        }), eventHandlers = {
                                            progress: function(val) {
                                                isNaN(val) || status.setProgress(val);
                                            },
                                            error: function(title, msg) {
                                                notification(title, msg, {
                                                    type: "error"
                                                });
                                            }
                                        }, updating = !0, updater.update(channel, eventHandlers, function(err) {
                                            status.close(), updating = !1, err ? (notification("Update Failed", err.message, {
                                                type: "error",
                                                timeout: 1e4
                                            }), updater.restore(function(err) {
                                                err ? notification("Warning - Rollback failed: Package Corrupt", err.message, {
                                                    type: "error",
                                                    timeout: 1e4
                                                }) : notification("Rollback Succesful", "The previous app package has been restored");
                                            })) : (config.justUpdated = !0, __updateConfig(), notification("Update Complete", "Please restart the application.", {
                                                closeWith: !1,
                                                timeout: !1,
                                                type: "success"
                                            }));
                                        }));
                                    }(channel);
                                }
                            }, {
                                addClass: "btn",
                                text: "Cancel",
                                onClick: function(note) {
                                    note.close();
                                }
                            } ];
                            return notification("Update Available on " + (channel.charAt(0).toUpperCase() + channel.slice(1)), update.desc, {
                                closeWith: !1,
                                timeout: !1,
                                buttons: buttons,
                                type: "development" === channel ? "warning" : "alert"
                            });
                        }(channel, update));
                    }));
                }, autoUpdateCheckFn = setInterval(autoUpdate, 36e5), autoUpdate())) : self.setVisibility(!1);
            }
        }), new CSIDESetting({
            id: "ui-colour",
            name: "Colour Scheme",
            value: "rgb(90, 90, 90)",
            type: "variable",
            desc: "",
            options: [ {
                desc: "<div class='setting-colour-swatch' style='background-color: rgb(90, 90, 90)'></div>",
                value: "granite"
            }, {
                desc: "<div class='setting-colour-swatch' style='background-color: rgb(175, 93, 111)'></div>",
                value: "garnet"
            }, {
                desc: "<div class='setting-colour-swatch' style='background-color: rgb(147, 122, 175)'></div>",
                value: "amethyst"
            }, {
                desc: "<div class='setting-colour-swatch' style='background-color: rgb(107, 166, 125)'></div>",
                value: "emerald"
            }, {
                desc: "<div class='setting-colour-swatch' style='background-color: rgb(94,104,121)'></div>",
                value: "slate"
            }, {
                desc: "<div class='setting-colour-swatch' style='background-color: rgb(129,127,122)'></div>",
                value: "sandstone"
            }, {
                desc: "<div class='setting-colour-swatch' style='background-color: rgb(51, 164, 164)'></div>",
                value: "jade"
            }, {
                desc: "<div class='setting-colour-swatch' style='background-color: rgb(76,91,152)'></div>",
                value: "sapphire"
            } ],
            apply: function(val) {
                var colour;
                switch (val) {
                  case "granite":
                    colour = "90,90,90";
                    break;

                  case "amethyst":
                    colour = "147,122,175";
                    break;

                  case "garnet":
                    colour = "175,93,111";
                    break;

                  case "emerald":
                    colour = "60,100,80";
                    break;

                  case "slate":
                    colour = "94,104,121";
                    break;

                  case "sandstone":
                    colour = "129,127,122";
                    break;

                  case "jade":
                    colour = "51,164,164";
                    break;

                  case "sapphire":
                    colour = "76,91,152";
                    break;

                  default:
                    colour = "90,90,90";
                }
                uiColour(colour);
            }
        }) ]),
        byId: function(settingType, id) {
            if (void 0 !== settings[settingType]) for (var i = 0; i < settings[settingType]().length; i++) if (settings[settingType]()[i].getId() == id) return settings[settingType]()[i];
            return null;
        },
        asObject: function(settingType) {
            if (void 0 !== settings[settingType]) {
                for (var arr = settings[settingType](), obj = {}, i = 0; i < arr.length; i++) obj[arr[i].getId()] = arr[i].getValue();
                return obj;
            }
            console.log("Invalid settings type passed to settings.asObject function.");
        }
    };
    self.getEditorSettings = ko.computed(function() {
        return settings.editor().map(function(setting) {
            return setting.extAPI;
        });
    }), self.getAppSettings = ko.computed(function() {
        return settings.app().map(function(setting) {
            return setting.extAPI;
        });
    }), self.getCursorPositionString = function() {
        return "Ln " + cursorPos().lineNumber + ", Col " + cursorPos().column;
    }, self.scenePanel = function(action) {
        $("#sidebar").is(":visible") && "open" !== action ? $("#sidebar").css({
            display: "none"
        }) : $("#sidebar").css({
            display: ""
        }), vseditor && vseditor.layout();
    };
    var consoleCmdBuf = [], consoleCmdBufPtr = 0;
    ko.observable(0);
    function __openScenes(paths, selectLast) {
        for (var lastIndex = selectLast ? paths.length - 1 : paths.length, i = 0; i < lastIndex; i++) {
            var ext = getFileExtension(paths[i]);
            switch (ext) {
              case ".txt":
                __openScene(paths[i], function() {});
                break;

              case ".log":
                __openLogFile(paths[i], function() {});
                break;

              default:
                return void bootbox.alert("<h3>Error</h3>Attempting to open an unsupported file type: " + ext + ". Please report this.");
            }
        }
        if (selectLast) switch (getFileExtension(paths[lastIndex])) {
          case ".txt":
            __openScene(paths[lastIndex], function(err, scene) {
                err || scene.select();
            });
            break;

          case ".log":
            __openLogFile(paths[lastIndex], function() {});
            break;

          default:
            return void bootbox.alert("<h3>Error</h3>Attempting to open an unsupported file type: " + ext + ". Please report this.");
        }
    }
    function __updateMonacoDiagnosticOptions(diagOptions) {
        monaco.languages.choicescript.setDiagnosticsOptions(diagOptions);
    }
    function __getMonacoDiagnosticOptions() {
        return monaco.languages.choicescript.diagnosticsOptions;
    }
    function __promptForString(callback, title, placeholder) {
        bootbox.prompt({
            title: title || "Please enter text",
            value: placeholder || "",
            callback: function(str) {
                callback("string" != typeof str ? "" : function(str) {
                    return str = (str = str.trim()).replace(/\s{2,}/g, " ");
                }(str));
            }
        });
    }
    function __loadEditorCustomThemes(themeDir) {
        var result = {
            err: null,
            themes: []
        };
        try {
            fs.readdirSync(themeDir).filter(function(file) {
                return ".json" === getFileExtension(file);
            }).forEach(function(theme) {
                var themePath = themeDir + "/" + theme, themeName = getFileName(themePath), theme = {
                    name: themeName,
                    err: null
                };
                try {
                    var themeData = JSON.parse(fs.readFileSync(themePath).toString()), valErr = function(themeData) {
                        for (var compulsoryAttrs = [ {
                            key: "base",
                            isValid: function(val) {
                                return [ "vs", "vs-dark", "hc-black" ].some(function(theme) {
                                    return val === theme;
                                });
                            }
                        }, {
                            key: "colors",
                            isValid: function(val) {
                                for (key in val) if (val.hasOwnProperty(key) && !val[key].match(/^#[0-9A-Fa-f]{6,8}$/)) return !1;
                                return !0;
                            }
                        }, {
                            key: "rules",
                            isValid: function(val) {
                                return Array.isArray(val) && val.every(function(entry) {
                                    return !0;
                                });
                            }
                        }, {
                            key: "inherit",
                            isValid: function(val) {
                                return "boolean" == typeof val;
                            }
                        } ], i = 0; i < compulsoryAttrs.length; i++) {
                            var attr = compulsoryAttrs[i].key, val = themeData[attr];
                            if (null == val) return new Error("Incomplete editor theme is missing an attribute: " + attr);
                            if (!compulsoryAttrs[i].isValid(val)) return new Error("Invalid editor theme: " + attr + " is invalid");
                        }
                        return null;
                    }(themeData);
                    valErr ? theme.err = valErr : monaco.editor.defineTheme(themeName, themeData);
                } catch (err) {
                    theme.err = err;
                }
                result.themes.push(theme);
            });
        } catch (err) {
            result.err = err;
        }
        return result;
    }
    function __addProject(project) {
        project instanceof CSIDEProject ? projects.unshift(project) : bootbox.alert("Error: Unable to add non-CSIDE Project.");
    }
    function __openLogFile(path, callback) {
        nw.Window.open("file://" + path, {
            focus: !0,
            width: 800,
            height: 600
        }, callback);
    }
    function __openScene(newScene, callback) {
        if ("string" != typeof newScene) throw new Error("Error: Bad scenePath - expect a string.");
        var scene, sceneProjectPath = getProjectPath(newScene = __normalizePath(newScene)), sceneProject = function(projectPath) {
            for (var i = 0; i < projects().length; i++) {
                if (projects()[i].getPath() === projectPath) return projects()[i];
                if (i === projects().length - 1) return !1;
            }
        }(sceneProjectPath);
        if (sceneProject) {
            if (scene = function(sceneName, project) {
                sceneName = sceneName.toLowerCase();
                for (var scenes = project.getScenes(), i = 0; i < scenes.length; i++) {
                    if (scenes[i].getName() === sceneName) return scenes[i];
                    if (i === scenes.length - 1) return !1;
                }
            }(getFileName(newScene), sceneProject)) return void (callback && callback(null, scene));
        } else __addProject(sceneProject = new CSIDEProject({
            path: sceneProjectPath,
            source: platform
        }));
        newScene = new CSIDEScene({
            path: newScene,
            source: platform
        });
        sceneProject.addScene(newScene), newScene.load(callback);
    }
    function getFileName(scenePath) {
        var sceneName = getLastDirName(scenePath);
        return sceneName.substring(0, sceneName.length - getFileExtension(scenePath).length);
    }
    function getLastDirName(path) {
        var divider;
        return divider = -1 != (path = ("/" == path.charAt(path.length - 1) || "\\" == path.charAt(path.length - 1)) && 2 < path.length ? path.substring(0, path.length - 1) : path).lastIndexOf("/") ? "/" : "\\", 
        path.substring(path.lastIndexOf(divider) + 1, path.length);
    }
    function getFileExtension(scenePath) {
        return scenePath.substring(scenePath.lastIndexOf("."), scenePath.length);
    }
    function getProject(projectPath) {
        for (var n = 0; n < projects().length; n++) if (projects()[n].getPath() === projectPath) return projects()[n];
        return null;
    }
    function getProjectPath(scenePath) {
        return scenePath.substring(0, scenePath.lastIndexOf("/") + 1);
    }
    function validName(name, allowSpaces, callback) {
        var err, valid = !1;
        !name || "" === name || /^\s*$/.test(name) ? err = "Name required" : (name.match(/^[\w-\s]+$/) || !allowSpaces) && (name.match(/^[\w-]+$/) || allowSpaces) ? name.toUpperCase().match(reservedSceneNames) ? err = "That name is reserved" : valid = !0 : err = "Name contains invalid characters.", 
        callback(valid, err);
    }
    function __updateEditorDecorations(scene, additional) {
        var issues = scene.getIssues();
        additional = additional || [], scene.decorations = vseditor.deltaDecorations(scene.decorations, issues.filter(function(issue) {
            return "number" == typeof issue.getLineNum();
        }).map(function(issue) {
            var col = meditor.getModel().getLineFirstNonWhitespaceColumn(issue.getLineNum());
            return {
                range: new monaco.Range(issue.getLineNum(), col, issue.getLineNum(), col),
                options: {
                    isWholeLine: !0,
                    className: "line-delete",
                    stickiness: monaco.editor.TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges
                }
            };
        }).concat(additional));
    }
    function __wordCount(string, nonCommandLines) {
        var wordCount = 0;
        return wordCount = 1 === (wordCount = (nonCommandLines = nonCommandLines || !1) ? ((nonCommandLines = string.replace(/\*.+$/gm, "")).replace(/^\s+|\s+$/g, "").split(/\s+/).length, 
        nonCommandLines.replace(/^\s+|\s+$/g, "").split(/\s+/).length) : string.replace(/^\s+|\s+$/g, "").split(/\s+/).length) && "" === string ? 0 : wordCount;
    }
    function __copyProjectTo(oldPath, newPath, callback) {
        fh.readDir(oldPath, function(err, filenames) {
            if (err) callback(err); else for (var count = (filenames = filenames.filter(function(file) {
                return ".txt" === getFileExtension(file);
            })).length, i = 0; i < filenames.length; i++) fh.copyFile(oldPath + filenames[i], newPath + filenames[i], function(err, data) {
                err ? callback(err) : 0 == --count && callback(null);
            });
        });
    }
    function __openFolder(path) {
        usingNode ? gui.Shell.openItem(path) : fileBrowser.open(path, function(selection) {
            selection.length < 1 || __openScenes(selection = selection.filter(function(file) {
                return !file.isFolder();
            }).map(function(file) {
                return file.path;
            }), !0);
        });
    }
    function sceneExists(scenePath, project, callback) {
        scenePath = project.getPath() + scenePath + ".txt";
        fh.stat(scenePath, function(err, stat) {
            err && 404 == err.code || "undefined" !== stat.isRemoved && 1 == stat.isRemoved ? callback(!1) : callback(!0);
        });
    }
    function __selectTab(id) {
        $("#tabs").tabs("option", "active", $("#" + id).index() - 1);
    }
    function __runProject(project) {
        "web-dropbox" != platform && (mediaServer.setDir(project.getPath()), document.getElementById("game-tab-frame").terminate()), 
        __shortCompile(project, function(href, allScenes) {
            var tab;
            href ? (bootbox.alert("<h3>Compilation Error</h3>" + href.message), console.log(href)) : (notification("Running", project.getName(), {
                timeout: 2e3
            }), activeProject(project), tab = __getTab("game"), href = (href = "run_index.html?restart=true") || tab.href(), 
            tab.href(""), tab.href(href), cside.tabPanel("open"), __selectTab("game"), setTimeout(function() {
                var webview = document.getElementById("game-tab-frame");
                webview.addEventListener("unresponsive", function(pid) {
                    var buttons = [ {
                        addClass: "btn",
                        text: "Close",
                        onClick: function(note) {
                            webview.terminate(), note.close();
                        }
                    }, {
                        addClass: "btn",
                        text: "Wait",
                        onClick: function(note) {
                            note.close();
                        }
                    } ];
                    return notification(project.getName() + " Seems to be Unresponsive", "Should we force it to close?", {
                        closeWith: !0,
                        timeout: !1,
                        buttons: buttons,
                        type: "warning"
                    });
                }), webview.contentWindow.postMessage({
                    type: "startGame",
                    allScenes: allScenes,
                    project: {
                        path: project.getPath(),
                        name: project.getName()
                    },
                    platform: platform,
                    server: mediaServer ? mediaServer.getAddr() : null,
                    allowScript: "web-dropbox" !== platform && settings.byId("app", "allowscript").getValue()
                });
            }, 1e3));
        });
    }
    self.consoleInput = function(data, gameFrame) {
        if (gameFrame) {
            var element = gameFrame.originalEvent.target, input = element.value;
            if (38 === gameFrame.keyCode) {
                if (consoleCmdBuf.length <= 0) return;
                --consoleCmdBufPtr < 0 && (consoleCmdBufPtr = consoleCmdBuf.length - 1), element.value = consoleCmdBuf[consoleCmdBufPtr];
            } else if (40 === gameFrame.keyCode) {
                if (consoleCmdBuf.length <= 0) return;
                ++consoleCmdBufPtr > consoleCmdBuf.length - 1 && (consoleCmdBufPtr = 0), element.value = consoleCmdBuf[consoleCmdBufPtr];
            }
            if (input && 13 === gameFrame.keyCode) {
                9 < consoleCmdBuf.length && consoleCmdBuf.shift(), consoleCmdBuf.push(input), consoleCmdBufPtr = consoleCmdBuf.length, 
                selectedProject().logToConsole(input, "*" == input.substring(0, 1) ? "cm-builtin" : "cm-variable");
                var toks, gameFrame = document.getElementById("game-tab-frame").contentWindow || document.getElementById("#game-tab-frame");
                if (void 0 === gameFrame || void 0 === gameFrame) return selectedProject().logToConsole("Error: no choicescript game running", "cm-error"), 
                void (element.value = "");
                if (selectedProject() != activeProject()) return selectedProject().logToConsole("Error: this project is not the one running", "cm-error"), 
                void (element.value = "");
                try {
                    input.match(/^\*/) ? (toks = input.match(/^\*(?:set|temp|rand|achieve|restart|goto|goto_scene)/)) || (toks = input.match(/^\*(console_)?(clear|track|untrack|track_all_off|track_all_on|track_list|help)/)) ? (input = 1 < toks.length && "console_" !== toks[1] ? "*console_" + input.substring(1, input.length) : input).match(/^\*goto/) ? input.match(/^\*goto\s+/) ? (input = input.replace(/^\*goto\s+/, ""), 
                    gameFrame.postMessage({
                        type: "runCommand",
                        cmd: "CSIDEConsole_goto",
                        input: input
                    })) : (input = input.replace(/^\*goto_scene\s+/, ""), gameFrame.postMessage({
                        type: "runCommand",
                        cmd: "CSIDEConsole_goto_scene",
                        input: input
                    })) : gameFrame.postMessage({
                        type: "runCommand",
                        cmd: null,
                        input: input
                    }) : selectedProject().logToConsole("Error: invalid console command", "cm-error") : gameFrame.postMessage({
                        type: "runCommand",
                        cmd: "CSIDEConsole_eval_expr",
                        input: input
                    });
                } catch (e) {
                    e.message = e.message.replace(/line [0-9]+ of\s\w+: /, ""), selectedProject().logToConsole("Error: " + e.message, "cm-error");
                }
                element.value = "";
            }
        }
    }, self.tabPanel = function(action) {
        if (!$("#left-wrap").is(":animated") && !$("#right-wrap").is(":animated")) {
            var ele, isOpen = !0;
            if (100 <= 100 * (ele = $("#left-wrap")).width() / ele.offsetParent().width() && (isOpen = !1), 
            "close" == action && isOpen || !action && isOpen) $("#right-wrap").css({
                width: "0%"
            }), $("#left-wrap").css({
                width: "100%"
            }), $("#expand-collapse-bar").addClass("collapsed"), vseditor && vseditor.layout(); else {
                if (("open" != action || isOpen) && (action || isOpen)) return isOpen;
                $("#right-wrap").css({
                    width: "50%"
                }), $("#left-wrap").css({
                    width: "50%"
                }), $("#expand-collapse-bar").removeClass("collapsed"), vseditor && vseditor.layout();
            }
        }
    }, self.openScene = function(path, callback) {
        __openScene(path, callback);
    }, self.openLogFile = function(path, callback) {
        getFileExtension(path) && __openLogFile(path, callback);
    }, self.openFileBrowser = function() {
        fh.selectFiles(function(selection) {
            selection && 1 <= selection.length && __openScenes(selection, !0);
        });
    }, self.spellCheck = function(word) {
        return !__getMonacoDiagnosticOptions().spellcheck.enabled || (typo.check(word) || userDictionary.check(word.toLowerCase()) || Boolean(word.match(/^\d+$/)));
    }, userDictionary = {
        monacoCmds: {},
        persistentList: {},
        persistentListArray: ko.observableArray([]),
        sessionList: {},
        validateWord: function(word) {
            return word.match(/^([A-Za-z\u00C0-\u00FF\u0100-\u017F]+'[A-Za-z\u00C0-\u00FF\u0100-\u017F]+|[A-Za-z\u00C0-\u00FF\u0100-\u017F]{2,}|[AaI]'?)$/);
        },
        add: function(word, list) {
            return !!userDictionary.validateWord(word) && (word = word.toLowerCase(), userDictionary[list + "List"][word] || (userDictionary[list + "List"][word] = !0, 
            userDictionary.update(list), "persistent" == list && userDictionary.persistentListArray.push(word)), 
            !0);
        },
        remove: function(word, list) {
            userDictionary[list + "List"] && delete userDictionary[list + "List"][word], userDictionary.update(list), 
            userDictionary.persistentListArray.remove(word);
        },
        removeAll: function() {
            userDictionary.persistentList = {}, userDictionary.persistentListArray.removeAll();
        },
        check: function(word) {
            var pList = this.persistentList;
            return !(!this.sessionList[word] && !pList[word]);
        },
        load: function() {
            try {
                for (var i in userDictionary.persistentList = JSON.parse(localStorage.getItem("userDictionary")) || {}, 
                userDictionary.persistentList) userDictionary.persistentList.hasOwnProperty(i.toLowerCase()) && userDictionary.persistentListArray.push(i.toLowerCase());
                userDictionary.sync("persistent");
            } catch (err) {
                err ? userDictionary.update() : bootbox.alert("Sorry, there was a problem loading or parsing your user dictionary data.<br>If you're seeing this message frequently please file a bug report.");
            }
        },
        update: function(list) {
            var newDictionary;
            void 0 !== list && "persistent" != list || (newDictionary = JSON.stringify(userDictionary.persistentList, null, "\t"), 
            localStorage.setItem("userDictionary", newDictionary)), userDictionary.sync(list);
        },
        sync: function(list) {
            var monacoOptions = __getMonacoDiagnosticOptions();
            monacoOptions.spellcheck.userDictionary || (monacoOptions.spellcheck.userDictionary = Object.create({})), 
            monacoOptions.spellcheck.userDictionary[list] = userDictionary[list + "List"], __updateMonacoDiagnosticOptions(monacoOptions);
        },
        sanitize: function() {
            for (var arr = Object.keys(userDictionary.persistentList), i = 0; i < arr.length; i++) {
                if (arr[i] !== arr[i].toLowerCase()) throw new Error("Error: Entry should be lowercase: " + arr[i]);
                if (!userDictionary.validateWord(arr[i])) throw new Error("Error: Invalid entry (not a word): " + arr[i]);
                if (!0 !== userDictionary.persistentList[arr[i]]) throw new Error("Error: Entry value should be 'true' for: " + arr[i]);
            }
        },
        import: function() {
            var path;
            fh.selectFiles(function(selection) {
                !selection || selection.length < 1 || (path = selection[0], 1 < selection.length || ".json" != getFileExtension(path) ? bootbox.alert("<h3>Error</h3>Please select a single valid JSON file.") : bootbox.confirm("Are you sure you wish to import this dictionary?<br>All words from the current dictionary will be lost.", function(result) {
                    result && fh.readFile(path, function(err, data) {
                        if (err) notification("Failed to Read Dictionary", path, {
                            type: "error"
                        }); else try {
                            userDictionary.persistentList = JSON.parse(data), userDictionary.sanitize(), userDictionary.update(), 
                            userDictionary.removeAll(), userDictionary.load(), notification("Dictionary Import Succesful", path, {
                                type: "success"
                            });
                        } catch (e) {
                            throw notification("Dictionary Import Failed", path, {
                                type: "error"
                            }), e;
                        }
                    });
                }));
            }, {
                extensions: [ ".json" ]
            });
        },
        export: function() {
            var path;
            fh.selectFolder(function(url) {
                url && __promptForString(function(filename) {
                    filename && validName(filename, !1, function(valid, err) {
                        valid ? (path = url + filename + ".json", fh.stat(path, function(err, stats) {
                            err && 404 === err.code ? fh.writeFile(path, localStorage.userDictionary, function(err) {
                                err || notification("Dictionary Export Successful", path, {
                                    type: "success",
                                    buttons: [ {
                                        addClass: "btn",
                                        text: "Show Folder",
                                        onClick: function(note) {
                                            __openFolder(getDirName(path)), note.close();
                                        }
                                    } ]
                                });
                            }) : notification("Export Failed: File already exists", path, {
                                type: "error"
                            });
                        })) : notification("Export Failed: Naming error", err, {
                            type: "error"
                        });
                    });
                }, "Filename for Exported Dictionary", "CSIDE_Dictionary");
            });
        }
    }, self.importDictionary = userDictionary.import, self.exportDictionary = userDictionary.export, 
    self.checkUserDictionary = function(word) {
        return "string" == typeof word && userDictionary.check(word);
    }, self.clearDictionary = function() {
        bootbox.confirm("Are you sure you wish to remove all words from the user dictionary?", function(result) {
            result && (userDictionary.removeAll(), userDictionary.update());
        });
    }, self.dictWord = ko.observable(""), self.addToDictionary = function(obj, e) {
        ("click" == e.type || "keyup" == e.type && 13 == e.keyCode) && (userDictionary.add(self.dictWord(), "persistent") || bootbox.alert("<h3>Error</h3>Unable to add to user dictionary: not a word!"));
    }, self.removeFromDictionary = function(word) {
        userDictionary.persistentList.hasOwnProperty(word) && userDictionary.remove(word, "persistent");
    }, self.getDictionaryArray = ko.computed(function() {
        var query = self.dictWord().toLowerCase();
        return ("" == query ? userDictionary.persistentListArray() : userDictionary.persistentListArray().filter(function(word) {
            return word.startsWith(query);
        })).sort();
    }, this), self.init = function(loc) {
        if (vseditor = loc, monaco.cside = {}, amdRequire([ "vs/editor/contrib/find/replacePattern" ], function(replacePattern) {
            monaco.cside.parseReplaceString = replacePattern.parseReplaceString, monaco.cside.getReplaceString = function(replaceStr, matches, preserveCase) {
                return replacePattern.parseReplaceString(replaceStr).buildReplaceString(matches, preserveCase);
            };
        }), function(editor) {
            editor.addAction({
                id: "replace-project-scenes",
                label: "Replace in Project Scenes",
                keybindings: [ monaco.KeyMod.Shift | monaco.KeyMod.CtrlCmd | monaco.KeyCode.KEY_R ],
                precondition: null,
                keybindingContext: null,
                run: function(ed) {
                    cside.getSelectedProject() && (cside.toggleSearchMode(SEARCH.MODES.REPLACE), __selectTab("search"), 
                    cside.tabPanel("open"), document.getElementById("replaceBox").focus());
                }
            }), editor.addAction({
                id: "search-project-scenes",
                label: "Search Project Scenes",
                keybindings: [ monaco.KeyMod.Shift | monaco.KeyMod.CtrlCmd | monaco.KeyCode.KEY_F ],
                precondition: null,
                keybindingContext: null,
                run: function(ed) {
                    cside.getSelectedProject() && (cside.toggleSearchMode(SEARCH.MODES.SEARCH), __selectTab("search"), 
                    cside.tabPanel("open"), document.getElementById("searchBox").focus());
                }
            }), editor.addAction({
                id: "save-selected-scene",
                label: "Save Selected Scene",
                keybindings: [ monaco.KeyMod.CtrlCmd | monaco.KeyCode.KEY_S ],
                precondition: null,
                keybindingContext: null,
                run: function(ed) {
                    return cside.getSelectedScene().save(), null;
                }
            }), editor.addAction({
                id: "select-previous-scene",
                label: "Select Previous Scene",
                keybindings: [ monaco.KeyMod.CtrlCmd | monaco.KeyCode.PageUp ],
                precondition: null,
                keybindingContext: null,
                run: function(ed) {
                    __cycleSceneSelection(!0);
                }
            }), editor.addAction({
                id: "select-next-scene",
                label: "Select Next Scene",
                keybindings: [ monaco.KeyMod.CtrlCmd | monaco.KeyCode.PageDown ],
                precondition: null,
                keybindingContext: null,
                run: function(ed) {
                    __cycleSceneSelection(!1);
                }
            }), editor.addAction({
                id: "close-selected-scene",
                label: "Close Selected Scene",
                keybindings: [ monaco.KeyMod.CtrlCmd | monaco.KeyCode.KEY_W ],
                precondition: null,
                keybindingContext: null,
                run: function(ed) {
                    return cside.getSelectedScene().close(), null;
                }
            }), editor.addAction({
                id: "add-new-scene",
                label: "Add New Scene",
                keybindings: [ monaco.KeyMod.CtrlCmd | monaco.KeyCode.KEY_N ],
                precondition: null,
                keybindingContext: null,
                run: function(ed) {
                    return cside.getSelectedProject().addNewScene(), null;
                }
            }), editor.addAction({
                id: "save-selected-project",
                label: "Save Selected Project",
                keybindings: [ monaco.KeyMod.Shift | monaco.KeyMod.CtrlCmd | monaco.KeyCode.KEY_S ],
                precondition: null,
                keybindingContext: null,
                run: function(ed) {
                    return cside.getSelectedProject().save(), null;
                }
            }), editor.addAction({
                id: "close-selected-project",
                label: "Close Selected Project",
                keybindings: [ monaco.KeyMod.Shift | monaco.KeyMod.CtrlCmd | monaco.KeyCode.KEY_W ],
                precondition: null,
                keybindingContext: null,
                run: function(ed) {
                    return cside.getSelectedProject().close(), null;
                }
            }), editor.addAction({
                id: "create-project",
                label: "Create Project",
                keybindings: [ monaco.KeyMod.Shift | monaco.KeyMod.CtrlCmd | monaco.KeyCode.KEY_N ],
                precondition: null,
                keybindingContext: null,
                run: function(ed) {
                    return cside.createProject(), null;
                }
            }), editor.addAction({
                id: "toggle-scene-panel-project",
                label: "Toggle Scene Panel",
                keybindings: [ monaco.KeyMod.Shift | monaco.KeyMod.CtrlCmd | monaco.KeyCode.US_COMMA ],
                precondition: null,
                keybindingContext: null,
                run: function(ed) {
                    return cside.scenePanel(), null;
                }
            }), editor.addAction({
                id: "toggle-tab-panel",
                label: "Toggle Tab Panel",
                keybindings: [ monaco.KeyMod.Shift | monaco.KeyMod.CtrlCmd | monaco.KeyCode.US_DOT ],
                precondition: null,
                keybindingContext: null,
                run: function(ed) {
                    return cside.tabPanel(), null;
                }
            }), editor.addAction({
                id: "increase-font-size",
                label: "Increase Editor Font Size",
                keybindings: [ monaco.KeyMod.Shift | monaco.KeyMod.CtrlCmd | monaco.KeyCode.US_EQUAL ],
                precondition: null,
                keybindingContext: null,
                run: function(ed) {
                    var fontSizeSetting = settings.byId("editor", "fontsize"), optionId = fontSizeSetting.getSelectedOptionId();
                    return "number" == typeof optionId && optionId < fontSizeSetting.getOptions().length - 1 && fontSizeSetting.toggle(fontSizeSetting.getOptions()[optionId + 1]), 
                    null;
                }
            }), editor.addAction({
                id: "decrease-font-size",
                label: "Decrease Editor Font Size",
                keybindings: [ monaco.KeyMod.Shift | monaco.KeyMod.CtrlCmd | monaco.KeyCode.US_MINUS ],
                precondition: null,
                keybindingContext: null,
                run: function(ed) {
                    var fontSizeSetting = settings.byId("editor", "fontsize"), optionId = fontSizeSetting.getSelectedOptionId();
                    return "number" == typeof optionId && 0 < optionId && fontSizeSetting.toggle(fontSizeSetting.getOptions()[optionId - 1]), 
                    null;
                }
            }), editor.addAction({
                id: "open-all-scenes",
                label: "Open All Scenes",
                keybindings: [ monaco.KeyMod.Shift | monaco.KeyMod.CtrlCmd | monaco.KeyCode.KEY_O ],
                precondition: null,
                keybindingContext: null,
                run: function(ed) {
                    return cside.getSelectedProject().openAllScenes(), null;
                }
            }), editor.addAction({
                id: "open-file-browser",
                label: "Open File Browser",
                keybindings: [ monaco.KeyMod.CtrlCmd | monaco.KeyCode.KEY_O ],
                precondition: null,
                keybindingContext: null,
                run: function(ed) {
                    return cside.openFileBrowser(), null;
                }
            }), editor.addAction({
                id: "toggle-bold",
                label: "Toggle Bold",
                keybindings: [ monaco.KeyMod.CtrlCmd | monaco.KeyCode.KEY_B ],
                precondition: null,
                keybindingContext: null,
                run: function(ed) {
                    insertTextTags("[b]", "[/b]");
                }
            }), editor.addAction({
                id: "wrap-variable",
                label: "Wrap Variable",
                keybindings: [ monaco.KeyMod.CtrlCmd | monaco.KeyCode.KEY_D ],
                precondition: null,
                keybindingContext: null,
                run: function(ed) {
                    insertTextTags("${", "}");
                }
            }), editor.addAction({
                id: "toggle-italics",
                label: "Toggle Italics",
                keybindings: [ monaco.KeyMod.CtrlCmd | monaco.KeyCode.KEY_I ],
                precondition: null,
                keybindingContext: null,
                run: function(ed) {
                    insertTextTags("[i]", "[/i]");
                }
            }), editor.addAction({
                id: "toggle-comment",
                label: "Toggle Comment",
                keybindings: [ monaco.KeyMod.CtrlCmd | monaco.KeyCode.US_SLASH ],
                precondition: null,
                keybindingContext: null,
                run: function(ed) {
                    insertTextTags("*comment ", "", !0);
                }
            }), editor.addAction({
                id: "quicktest",
                label: "Quicktest Project",
                keybindings: [ monaco.KeyMod.CtrlCmd | monaco.KeyCode.KEY_T ],
                precondition: null,
                keybindingContext: null,
                run: function(ed) {
                    return cside.getSelectedProject().test("quick"), null;
                }
            }), editor.addAction({
                id: "randomtest-project",
                label: "Randomtest Project",
                keybindings: [ monaco.KeyMod.Shift | monaco.KeyMod.CtrlCmd | monaco.KeyCode.KEY_T ],
                precondition: null,
                keybindingContext: null,
                run: function(ed) {
                    return cside.getSelectedProject().test("random"), null;
                }
            }), editor.addAction({
                id: "run-project",
                label: "Run Project",
                keybindings: [ monaco.KeyMod.Shift | monaco.KeyMod.CtrlCmd | monaco.KeyCode.Enter ],
                precondition: null,
                keybindingContext: null,
                run: function(ed) {
                    return cside.getSelectedProject().run(), null;
                }
            }), editor.addAction({
                id: "toggle-console",
                label: "Toggle ChoiceScript Console",
                keybindings: [ monaco.KeyMod.Shift | monaco.KeyMod.CtrlCmd | monaco.KeyCode.KEY_C ],
                precondition: null,
                keybindingContext: null,
                run: function(ed) {
                    cside.getSelectedProject().toggleConsole() && $("#cs-console > input").focus();
                }
            });
        }(vseditor), usingNode) {
            var diagnosticsOptions = gui.App.dataPath + "/userThemes", dictPath = __loadEditorCustomThemes(diagnosticsOptions);
            if (dictPath.err && "ENOENT" === dictPath.err.code) try {
                fs.mkdirSync(diagnosticsOptions), dictPath = __loadEditorCustomThemes(diagnosticsOptions);
            } catch (err) {
                notification("Unable to Detect Custom Themes", "CSIDE couldn't find or create a themes folder", {
                    type: "error",
                    layout: "bottomRight"
                });
            }
            !dictPath.err && 0 < dictPath.themes.length && dictPath.themes.filter(function(theme) {
                return theme.err;
            }).forEach(function(theme) {
                notification("Failed to Load Custom Theme: " + theme.name, theme.err.message || "", {
                    type: "error",
                    layout: "bottomRight"
                });
            });
        }
        if (loc.getContribution("editor.linkDetector").openerService._externalOpener = {
            openExternal: function(href) {
                return usingNode ? gui.Shell.openExternal(href) : matchesScheme(href, Schemas.http) || matchesScheme(href, Schemas.https) ? dom.windowOpenNoOpener(href) : window.location.href = href, 
                Promise.resolve(!0);
            }
        }, loc._codeEditorService.findModel = function(editor, resource) {
            const model = editor.getModel();
            return resource && model && model.uri.toString() !== resource.toString() ? monaco.editor.getModel(resource.toString()) : model;
        }, loc._codeEditorService.doOpenEditor = function(editor, input) {
            var model = this.findModel(editor, input.resource);
            if (!model) {
                if (input.resource) {
                    var schema = input.resource.scheme;
                    if (schema === network_1.Schemas.http || schema === network_1.Schemas.https) return editor;
                }
                return null;
            }
            model.csideScene.select(function(pos) {
                if (pos) {
                    pos = input.options ? input.options.selection : null;
                    return pos && ("number" == typeof pos.endLineNumber && "number" == typeof pos.endColumn ? (editor.setSelection(pos), 
                    editor.revealRangeInCenter(pos, 1)) : (pos = {
                        lineNumber: pos.startLineNumber,
                        column: pos.startColumn
                    }, editor.setPosition(pos), editor.revealPositionInCenter(pos, 1))), editor;
                }
                return null;
            });
        }, vseditor.onDidChangeCursorPosition(function(evt) {
            selectedChars(vseditor.getModel().getValueInRange(vseditor.getSelection()).length), 
            cursorPos(evt.position);
        }), usingNode || (user.name = "dropbox-user"), config.settings.app.persist) {
            Array.isArray(config.recentColours) && 0 < config.recentColours.length && recentSceneColours(config.recentColours);
            for (var thisProjectData = [], i = 0; i < config.openProjects.length; i++) {
                var project = new CSIDEProject(thisProjectData = config.openProjects[i]);
                __addProject(project);
                for (var n = 0; n < thisProjectData.openScenes.length; n++) {
                    var scene = new CSIDEScene(thisProjectData.openScenes[n]);
                    project.addScene(scene), scene.load();
                }
            }
            if (config.tabs.length === __csideTabs.length) for (var e = 0; e < config.tabs.length; e++) self.tabs.push(__csideTabs[config.tabs[e]]); else for (var tab in __csideTabs) self.tabs.push(__csideTabs[tab]);
        } else for (var tab in __csideTabs) self.tabs.push(__csideTabs[tab]);
        diagnosticsOptions = __getMonacoDiagnosticOptions(), dictPath = "lib/typo/dictionaries";
        dictPath = "web-dropbox" === platform ? (diagnosticsOptions.spellcheck.workerPath = "/lib/typo/wordprocessor.js", 
        (loc = window.location.pathname).substring(0, loc.length - "index.html".length) + dictPath) : (diagnosticsOptions.spellcheck.workerPath = "file://" + resolvePath("lib/typo/wordprocessor.js"), 
        "file://" + process.cwd() + "/" + dictPath), diagnosticsOptions.spellcheck.dictionaryPath = dictPath, 
        diagnosticsOptions.validate = !1, diagnosticsOptions.lint.enabled = !1, diagnosticsOptions.cslib = !0, 
        __updateMonacoDiagnosticOptions(diagnosticsOptions);
        for (var scope = settings.editor(), i = 0; i < scope.length; i++) {
            var val = (void 0 !== config.settings.editor[scope[i].getId()] ? config : defaultConfig).settings.editor[scope[i].getId()];
            scope[i].setValue(val);
        }
        for (scope = settings.app(), i = 0; i < scope.length; i++) {
            val = (void 0 !== config.settings.app[scope[i].getId()] ? config : defaultConfig).settings.app[scope[i].getId()];
            scope[i].setValue(val);
        }
        try {
            userDictionary.sanitize(), userDictionary.load();
        } catch (err) {
            bootbox.alert("Sorry, there was a problem loading or parsing your user dictionary data.<br>If you're seeing this message frequently please file a bug report.");
        }
        __selectTab("help"), self.scenePanel("open"), !config.justUpdated && void 0 !== config.justUpdated || (config.justUpdated = !1, 
        __updateConfig(), setTimeout(function() {
            notification("Updated to v" + CSIDE_version, "A full list of changes can be found under 'Changelog' in the help and information tab.", {
                buttons: [ {
                    addClass: "btn",
                    text: "Show Changelog",
                    onClick: function(note) {
                        var csideHelp = __getCSIDEHelp();
                        csideHelp && (csideHelp.breadcrumbs = [ {
                            url: "home.html",
                            title: "Home"
                        }, {
                            url: "changelog.md",
                            title: "Changelog"
                        } ], csideHelp.history = [ "home.html", "changelog.md" ], csideHelp.drawPage("changelog.md")), 
                        note.close();
                    }
                } ]
            }).setTimeout(5e3);
        }, 1e4));
    }, self.slideUpAndOut = function(elem) {
        $(elem).parent().find("ul").remove(), $(elem).animate({
            minHeight: 0,
            height: 0,
            padding: 0
        }, 400, function() {
            $(elem).remove();
        });
    }, self.slideDownAndIn = function(elem) {
        $(elem).hide().slideDown(400);
    }, self.fadeIn = function(elem) {
        $(elem).hide().fadeIn("fast");
    }, self.fadeOutAndUp = function(elem) {
        $(elem).animate({
            opacity: 0,
            height: 0,
            padding: 0
        }, 400, function() {
            $(elem).remove();
        });
    }, self.showWordCount = function(sceneOrProject) {
        sceneOrProject.getWordCount(), sceneOrProject.getWordCount(!0), sceneOrProject.getCharCount();
        var msg = sceneOrProject.constructor.name.substring("CSIDE".length, sceneOrProject.constructor.name.length), selectedTitle = "Scene" == msg ? "Currently Selected Text (this scene)" : "Currently Selected Text (in all scenes)", title = msg + " - " + sceneOrProject.getName(), msg = "<h5>Word Count</h5> \t\t    Including command lines: " + sceneOrProject.getWordCount() + "<br>Excluding command lines: " + sceneOrProject.getWordCount(!0);
        msg += "<br>Characters: " + sceneOrProject.getCharCount(), msg += "<br><br><h5>" + selectedTitle + "</h5> \t\t\t\tWords including command lines: " + sceneOrProject.getWordCount(!1, !0) + "<br>Words excluding command lines: " + sceneOrProject.getWordCount(!0, !0) + "<br>Characters: " + sceneOrProject.getCharCount(!0), 
        msg += "<br><br>Please note that these figures are only approximations.<br>Project word counts only include those of open scenes.", 
        bootbox.alert({
            message: msg,
            title: title
        });
    }, self.createProject = function(projectName, cb, blank) {
        function __create(projectName) {
            validName(projectName, !0, function(projectPath, err) {
                var callback;
                projectPath ? (projectPath = user.path + projectName, callback = function(exists) {
                    exists ? notification("Project Naming Error", "A Project with that name already exists in the project directory", {
                        type: "error"
                    }) : function(projectName, cb, blank) {
                        blank = blank || !1, function(cpf_cb) {
                            var projectPath = user.path + (projectName + "/");
                            fh.makeDir(projectPath, function(err) {
                                err && "EEXIST" == err.code ? (bootbox.alert("Error: That Project folder could not be created because it already exists."), 
                                cpf_cb(!0)) : err ? (bootbox.alert("Error: Unable to create the project folder, check your permissions."), 
                                cpf_cb(!0)) : cpf_cb(!1, projectPath);
                            });
                        }(function(startupContents, projectPath) {
                            startupContents && cb(startupContents);
                            var project = new CSIDEProject({
                                name: projectName,
                                path: projectPath,
                                source: platform
                            });
                            __addProject(project);
                            startupContents = "*title " + projectName + "\n*author " + user.name + '\n*create implicit_control_flow true\n*create cslib_ret ""\n*gosub_scene cslib_string concat " " "Hello" "World!"\n${cslib_ret}\n*finish';
                            (blank ? [] : [ new CSIDEScene({
                                path: projectPath + "choicescript_stats.txt",
                                contents: "",
                                source: platform
                            }), new CSIDEScene({
                                path: projectPath + "startup.txt",
                                contents: startupContents,
                                source: platform
                            }) ]).forEach(function(scene, index) {
                                scene.save(null, null, function(err) {
                                    err ? bootbox.alert(err.message) : (project.addScene(scene), scene.load(function(err, scene) {
                                        err || scene.select();
                                    }));
                                });
                            }), cb(null, project);
                        });
                    }(projectName, cb, blank);
                }, fh.stat(projectPath, function(err, stat) {
                    err && 404 == err.code || "undefined" !== stat.isRemoved && 1 == stat.isRemoved ? callback(!1) : callback(!0);
                })) : notification("Project Naming Error", err, {
                    type: "error"
                });
            });
        }
        blank = blank || !1, "function" != typeof cb && (cb = function(err, project) {
            err || notification("Project created", project.getPath(), {
                type: "success",
                layout: "bottomRight"
            });
        }), "string" != typeof projectName || "" == projectName ? __promptForString(function(str) {
            str && __create(str);
        }, "Name of Project?") : __create(projectName);
    };
    self.__getCSLIBScenes = function() {
        var libFiles = [ "cslib_util", "cslib_string", "cslib_number", "cslib_array", "cslib_menu", "cslib_math" ], resps = libFiles.map(function(lf) {
            return fetch("https://raw.githubusercontent.com/ChoicescriptIDE/cslib/main/scenes/" + lf + ".txt", {
                credentials: "omit",
                mode: "cors"
            });
        });
        return Promise.all(resps).then(function(responses) {
            return Promise.all(responses.map(function(r) {
                return r.text();
            })).then(function(final) {
                return final.map(function(f, i) {
                    return {
                        name: libFiles[i],
                        content: f
                    };
                });
            });
        });
    };
    function __shortCompile(project, cb, transpile) {
        var statusBox = notification("Compiling... ", project.getName(), {
            closeWith: !1,
            timeout: !1
        }), allScenes = {}, failed = !1, projectPath = project.getPath();
        fh.readDir(projectPath, function(err, fileNames) {
            if (err) return statusBox.close(), cb(err);
            var count = (fileNames = fileNames.filter(function(fileName) {
                return ".txt" === getFileExtension(fileName);
            })).length;
            return fileNames.forEach(function(fileName, index) {
                fh.readFile(projectPath + fileName, function(err, data) {
                    if (!failed) return err ? (failed = !0, statusBox.close(), 404 == err.code && (err = new Error("File not found: " + fileName)), 
                    cb(err)) : (err = function(sceneName, data) {
                        var scene = new Scene(), sceneName = getFileName(sceneName);
                        try {
                            scene.loadLines(data);
                        } catch (err) {
                            return statusBox.close(), new Error(err.message + " - " + sceneName + ".txt");
                        }
                        if (transpile) {
                            for (var changes = [], lineNum = 0; lineNum < scene.lines.length; lineNum++) {
                                var command = /^\s*\*(\w+)(.*)/.exec(scene.lines[lineNum]);
                                if (command && cse[command[1]]) {
                                    for (var block_size = 1; scene.getIndent(scene.lines[lineNum + block_size]) > scene.getIndent(scene.lines[lineNum]); ) block_size++;
                                    changes.push({
                                        targetLine: lineNum,
                                        targetLength: block_size,
                                        change: cse[command[1]].transpile(scene, command[2], lineNum, block_size)
                                    });
                                }
                            }
                            for (var c = 0; c < changes.length; c++) Array.prototype.splice.apply(scene.lines, [ changes[c].targetLine, changes[c].targetLength ].concat(changes[c].change));
                        }
                        return allScenes[sceneName] = {}, allScenes[sceneName].crc = scene.temps.choice_crc, 
                        allScenes[sceneName].labels = scene.labels, allScenes[sceneName].lines = scene.lines, 
                        !1;
                    }(fileName, data)) ? (statusBox.close(), cb(err)) : void (0 == --count && (statusBox.close(), 
                    self.__getCSLIBScenes().then(function(cslibFiles) {
                        for (var csi = 0; csi < cslibFiles.length; csi++) {
                            var cslibScene = new Scene();
                            try {
                                cslibScene.loadLines(cslibFiles[csi].content);
                            } catch (err) {
                                return void cb(new Error(err.message + " - " + cslibFiles[csi].name + ".txt"));
                            }
                            allScenes[cslibFiles[csi].name] = {}, allScenes[cslibFiles[csi].name].crc = cslibScene.temps.choice_crc, 
                            allScenes[cslibFiles[csi].name].labels = cslibScene.labels, allScenes[cslibFiles[csi].name].lines = cslibScene.lines;
                        }
                        cb(null, allScenes);
                    })));
                });
            }), failed ? (statusBox.close(), cb(err)) : void 0;
        });
    }
    var fileBrowser, cse = {
        getFreeLabelName: function(scene, prefix) {
            for (var i = 0; i < prefix && void 0 !== scene.labels[prefix + "_" + i]; i++) ;
            return prefix + "_" + i;
        },
        while: {
            transpile: function(scene, expr, line, block_size) {
                var lines = [], label = cse.getFreeLabelName(scene, "while_loop");
                return lines.push("*label " + label), lines.push("*if" + expr), (lines = lines.concat(scene.lines.slice(line + 1, line + block_size))).push("\t*goto " + label), 
                lines;
            }
        }
    };
    function __updateConfig() {
        var newConfig = JSON.stringify(config, null, "\t");
        localStorage.setItem("CSIDE_appConfig", newConfig);
    }
    function __updatePersistenceList() {
        config.openProjects = [], config.tabs = [], config.recentColours = [];
        for (var i = 0; i < projects().length; i++) {
            for (var thisScene, thisProject = {
                path: projects()[i].getPath(),
                source: projects()[i].getSource(),
                name: projects()[i].getName(),
                expanded: projects()[i].isExpanded(),
                openScenes: []
            }, n = 0; n < projects()[i].getScenes().length; n++) thisScene = {
                path: projects()[i].getScenes()[n].getPath(),
                source: projects()[i].getScenes()[n].getSource(),
                color: projects()[i].getScenes()[n].getMarkColour()
            }, thisProject.openScenes.push(thisScene);
            config.openProjects.unshift(thisProject);
        }
        for (var e = 0; e < self.tabs().length; e++) config.tabs[e] = self.tabs()[e].id;
        for (var c = 0; c < recentSceneColours().length; c++) config.recentColours.push(recentSceneColours()[c]);
        __updateConfig();
    }
    self.updatePersistenceList = function() {
        __updatePersistenceList();
    }, self.makeSortable = function(data) {
        __makeSortable(data);
    }, window.addEventListener("message", event => {
        var eventProject = null;
        switch (event.data.project && (eventProject = getProject(event.data.project.path)), 
        event.data.type) {
          case "handleLink":
            nw.Shell.openExternal(event.data.url);
            break;

          case "console":
            switch (event.data.action) {
              case "clear":
                eventProject.clearConsole();
                break;

              case "log":
                eventProject.logToConsole(event.data.msg, event.data.style, event.data.metadata);
            }
            break;

          case "focusLine":
            __openScene(event.data.project.path + event.data.scene.name + ".txt", function(err, scene) {
                if (!err) try {
                    var lineNum = parseInt(event.data.scene.lineNum);
                    scene.focusLine(lineNum);
                } catch (e) {
                    scene.select();
                }
            });
            break;

          case "logIssue":
            var issueData = {
                project: eventProject,
                scene: null,
                desc: event.data.error.message,
                lineNum: event.data.error.lineNumber
            };
            event.data.scene ? __openScene(event.data.project.path + event.data.scene.name + ".txt", function(err, scene) {
                err || (issueData.scene = scene), issueData.project.logIssue(new CSIDEIssue(issueData));
            }) : issueData.project.logIssue(new CSIDEIssue(issueData));
            break;

          case "popOut":
            nw.Window.open("run_index.html?persistence=CSIDE", {
                focus: !0,
                width: 500,
                height: 500,
                title: ""
            }, function(new_win) {
                (cside.popout.window = new_win).on("loaded", function() {
                    new_win.window.storeName = null;
                }), new_win.on("closed", function() {
                    cside.popout.window.leaveFullscreen(), cside.popout.window.hide(), cside.popout.window.close(!0), 
                    cside.popout.window = null;
                });
            });
            break;

          default:
            return;
        }
    }, !1), self.dragSceneEvent = function(arg, event, ui) {
        var targetProject, movingScene;
        function execute(action) {
            sceneExists(arg.item.getName(), targetProject, function(exists) {
                exists ? ($(ui.sender).sortable("cancel"), arg.cancelDrop = !0, bootbox.alert("This project already has a scene by that name.")) : action();
            });
        }
        arg.sourceParent != arg.targetParent && (targetProject = ko.dataFor(event.target), 
        movingScene = arg.item, arg.cancelDrop = !0, bootbox.dialog({
            message: "Would you like to <b>move</b> or <b>copy</b> this scene to this project?",
            title: "What would you like to do?",
            buttons: {
                copy: {
                    label: "Copy",
                    className: "btn-primary",
                    callback: function() {
                        execute(function() {
                            movingScene.copyTo(targetProject);
                        });
                    }
                },
                move: {
                    label: "Move",
                    callback: function() {
                        execute(function() {
                            movingScene.moveTo(targetProject);
                        });
                    }
                },
                cancel: {
                    label: "Cancel",
                    callback: function() {}
                }
            }
        }));
    }, ko.bindingHandlers.bindIframe = {
        init: function(element, valueAccessor) {
            function bindIframe() {
                try {
                    var iframeInit = element.contentWindow.initChildFrame, iframedoc = element.contentDocument.body;
                } catch (e) {}
                iframeInit ? iframeInit(ko, valueAccessor()) : iframedoc && ko.applyBindings(valueAccessor(), iframedoc);
            }
            bindIframe(), ko.utils.registerEventHandler(element, "load", bindIframe);
        }
    }, ko.bindingHandlers.enableTextInput = {
        init: function(element, valueAccessor) {
            $(element).prop("readOnly", !0);
        },
        update: function(element, valueAccessor) {
            $(element).prop("readOnly", !ko.utils.unwrapObservable(valueAccessor()));
        }
    }, ko.bindingHandlers.fadeVisible = {
        init: function(element, value) {
            value = value();
            $(element).toggle(ko.utils.unwrapObservable(value));
        },
        update: function(element, value) {
            value = value();
            ko.utils.unwrapObservable(value) ? $(element).show().animate({
                opacity: 1
            }, 250) : $(element).animate({
                opacity: 0
            }, 250, function() {
                $(this).hide();
            });
        }
    }, ko.bindingHandlers.fadeAndSlideVisible = {
        init: function(element, value) {
            value = value();
            $(element).toggle(ko.unwrap(value));
        },
        update: function(element, value) {
            value = value();
            ko.unwrap(value) ? $(element).slideDown(500).animate({
                opacity: 1
            }, {
                queue: !1,
                duration: 350
            }) : $(element).slideUp(500).animate({
                opacity: 0
            }, {
                queue: !1,
                duration: 350
            });
        }
    }, ko.bindingHandlers.initFiles = {
        init: function(element, valueAccessor) {
            $(element).draggable({
                cursor: "move",
                cursorAt: {
                    left: 5,
                    top: 5
                },
                scroll: !0,
                start: function(event, ui) {
                    ui.helper.appendTo($("body"));
                },
                helper: function() {
                    var newElement = $("<div></div>");
                    return newElement.addClass("helper"), newElement.text($("folder.selected").length), 
                    $(newElement);
                }
            });
        },
        update: function(element, valueAccessor, allBindings) {}
    }, ko.bindingHandlers.initFolders = {
        init: function(element, valueAccessor) {
            $(element).droppable({
                accept: ".file, .folder-ul",
                over: function(event, ui) {
                    $(this).css("background-color", "#F7F7E1");
                },
                out: function(event, ui) {
                    $(this).css("background-color", "");
                },
                drop: function(event, ui) {
                    $(this).delay(100).fadeOut().fadeIn("slow");
                    var targetFolder = $(this);
                    $(".folder-selected").each(function() {
                        moveDropboxItem($(this), targetFolder);
                    });
                }
            }).draggable({
                cursor: "move",
                cursorAt: {
                    left: 5,
                    top: 5
                },
                scroll: !0,
                start: function(event, ui) {
                    ui.helper.appendTo($("body"));
                },
                helper: function() {
                    var newElement = $("<div></div>");
                    return newElement.addClass("helper"), $(newElement);
                }
            });
        },
        update: function(element, valueAccessor, allBindings) {}
    };
    {
        function fileBrowser() {
            var shiftPressed = !1, ctrlPressed = !1;
            $(document).keydown(function(e) {
                17 == e.keyCode && (e.preventDefault(), ctrlPressed = !0), 16 == e.keyCode && (e.preventDefault(), 
                shiftPressed = !0);
            }), $(document).keyup(function(e) {
                17 == e.keyCode && (e.preventDefault(), ctrlPressed = !1), 16 == e.keyCode && (e.preventDefault(), 
                shiftPressed = !1);
            });
            var self = this, visible = ko.observable(!1), loading = ko.observable(!1), curPath = ko.observable(""), buttonText = ko.observable("Open"), browserTitle = ko.observable("Open scenes"), stateDesc = ko.observable(""), error = ko.observable(!1);
            function fileFolderItem(data) {
                var parsedDate, thisFileFolder = this;
                thisFileFolder.is_folder = "folder" == data[".tag"] || data.isFolder || data.is_folder, 
                thisFileFolder.name = data.name, thisFileFolder.path = data.path, thisFileFolder.icon = data.icon || (data.isFolder ? "fa fa-folder-o fa-lg" : "fa fa-file-o fa-lg"), 
                thisFileFolder.selected = ko.observable(!1), thisFileFolder.index = data.listIndex, 
                thisFileFolder.select = function(data, event, forcedValue, skipKeyCheck) {
                    if (!skipKeyCheck) {
                        var selectedList = self.selection(), fullList = self.filesAndFolders();
                        if (!ctrlPressed && !shiftPressed && 0 < selectedList.length) {
                            for (var s in selectedList) fullList[selectedList[s].index].selected(!1);
                            self.selection([]);
                        } else if (shiftPressed) {
                            selectedList.sort(function(a, b) {
                                return a.index - b.index;
                            });
                            var topToBottom = !1;
                            if (self.selection() < 1) for (var i = 0; i < thisFileFolder.index; i++) fullList[i].select({}, {}, !0, !0); else {
                                for (i = 0; i < thisFileFolder.index; i++) if (fullList[i].selected()) {
                                    topToBottom = !0;
                                    break;
                                }
                                if (topToBottom) for (i = selectedList[0].index; i < thisFileFolder.index; i++) fullList[i].selected() || fullList[i].select({}, {}, !0, !0); else for (i = selectedList[selectedList.length - 1].index; i > thisFileFolder.index; i--) fullList[i].selected() || fullList[i].select({}, {}, !0, !0);
                            }
                        }
                    }
                    forcedValue ? thisFileFolder.selected(forcedValue) : thisFileFolder.selected() ? thisFileFolder.selected(!1) : thisFileFolder.selected(!0), 
                    self.selection.push(thisFileFolder);
                }, data.isFolder ? thisFileFolder.open = function() {
                    self.redraw(thisFileFolder.path);
                } : thisFileFolder.open = function() {
                    "function" == typeof self.callback ? (self.selection = ko.observableArray([ thisFileFolder ]), 
                    self.executeTask()) : self.close();
                }, thisFileFolder.dateModified = data.modifiedAt || "", "" != thisFileFolder.dateModified && ((parsedDate = {}).day = data.modifiedAt.getDate(), 
                parsedDate.month = data.modifiedAt.getMonth(), parsedDate.year = data.modifiedAt.getFullYear(), 
                parsedDate.hours = data.modifiedAt.getHours(), parsedDate.mins = data.modifiedAt.getMinutes(), 
                parsedDate.mins.toString().length < 2 && (parsedDate.mins = "0" + parsedDate.mins.toString()), 
                thisFileFolder.dateModified = " - last modified at " + parsedDate.day + "/" + parsedDate.month + "/" + parsedDate.year + " at " + parsedDate.hours + ":" + parsedDate.mins), 
                thisFileFolder.isFolder = function() {
                    return thisFileFolder.is_folder;
                };
            }
            self.getButtonText = ko.computed(function() {
                return buttonText();
            }, this), self.getBrowserTitle = ko.computed(function() {
                return browserTitle() + ": " + curPath();
            }, this), self.isVisible = ko.computed(function() {
                return visible();
            }, this), self.isLoading = ko.computed(function() {
                return loading();
            }, this), self.getStateDesc = ko.computed(function() {
                return stateDesc();
            }, this), self.hasErrored = ko.computed(function() {
                return error();
            }, this), self.path = ko.computed(function() {
                return curPath();
            }, this), self.selectingFolder = !1, self.filesAndFolders = ko.observableArray([]), 
            self.selection = ko.observableArray([]), this.cancel = function() {
                "function" == typeof self.callback && self.callback([]), self.close();
            }, this.close = function() {
                var s, selectedList = self.selection(), fullList = self.filesAndFolders();
                for (s in selectedList) fullList[selectedList[s].index].selected(!1);
                self.selection([]), self.callback = null, self.selectingFolder = !1, self.extensions = [ ".txt", ".log" ], 
                visible(!1);
            }, this.open = function(path, callback, options) {
                "function" == typeof path && (options = callback, callback = path, path = ""), self.selectingFolder ? (buttonText("Select"), 
                browserTitle("Select a Folder")) : options && options.extensions ? (self.extensions = options.extensions, 
                buttonText("Open"), browserTitle("Select " + self.extensions.join(", "))) : (self.extensions = [ ".txt", ".log" ], 
                buttonText("Open"), browserTitle("Open scenes")), self.callback = callback, path = path || curPath(), 
                self.redraw(path), visible(!0);
            }, this.redraw = function(path) {
                stateDesc("Connecting..."), loading(!0), error(!1), curPath(path), self.filesAndFolders([]), 
                self.selection([]);
                var position = 0;
                fh.readDir(path, function(parentPath, listStats) {
                    if (parentPath) error(!0), stateDesc("Failed to connect. Please check your internet connection."); else {
                        "/" != curPath() && "" != curPath() && ((parentPath = curPath().split("/")).pop(), 
                        parentPath = parentPath.join("/"), self.filesAndFolders.push(new fileFolderItem({
                            name: "Up a level",
                            path: parentPath,
                            isFolder: !0,
                            icon: "fa fa-level-up fa-lg",
                            listIndex: position
                        })), position++);
                        for (var i = 0; i < listStats.length; i++) !listStats[i].isFolder && self.extensions.indexOf(getFileExtension(listStats[i].path)) < 0 || (listStats[i].listIndex = position, 
                        self.selectingFolder && !listStats[i].isFolder || (position++, self.filesAndFolders.push(new fileFolderItem(listStats[i]))));
                    }
                    loading(!1);
                }, !0);
            }, this.selectFolders = function(callback) {
                self.selectingFolder = !0, self.open("", callback);
            }, this.executeTask = function() {
                !self.selectingFolder && 1 == self.selection().length && self.selection()[0].isFolder() ? self.selection()[0].open() : (self.callback(self.selection()), 
                self.close());
            };
        }
        usingNode;
    }
    function contextMenu(newTarget, newOptions) {
        var target = newTarget, options = newOptions;
        this.getTitle = function() {
            return title;
        }, this.getOptions = ko.computed(function() {
            return options();
        }, this), this.getTarget = function() {
            return target;
        };
    }
    function menuOption(newLabel, action, newSubMenu) {
        var label = newLabel, action = action, subMenu = newSubMenu;
        this.getLabel = function() {
            return label;
        }, this.getSubMenuOptions = function() {
            return subMenu;
        }, this.doAction = action;
    }
    usingNode || (fileBrowser = new fileBrowser(), ko.applyBindings(fileBrowser, $("#file-browser-canvas")[0]), 
    self.webFileBrowserClosed = ko.computed(function() {
        return !fileBrowser.isVisible();
    }));
    var toolbarMenus, fileMenuOptions = ko.observableArray([ new menuOption("Open Scene", function(menu) {
        menu.getTarget().open();
    }) ]), folderMenuOptions = ko.observableArray([ new menuOption("Open Folder", function(menu) {
        menu.getTarget().open();
    }) ]);
    function toolbarMenu(data) {
        var menu = this, title = ko.observable(data.title || ""), expanded = ko.observable(!1);
        menu.isActive = data.active || !0, menu.getTarget = data.target, menu.doAction = function(option) {
            expanded(!1), option.doAction(menu);
        }, menu.isExpanded = ko.computed(function() {
            return expanded();
        }, this), menu.toggle = function(force) {
            "boolean" == typeof force ? expanded(force) : expanded() ? expanded(!1) : expanded(!0);
        }, menu.getTitle = title(), menu.getOptions = ko.computed(function() {
            return data.options();
        }, this);
    }
    "mac_os" !== platform && (toolbarMenus = ko.observableArray([ new toolbarMenu({
        title: "<span title='Project' class='fa fa-folder-open-o '>",
        active: self.getSelectedProject,
        options: ko.computed(function() {
            return new contextMenu(selectedProject(), projectMenuOptions).getOptions();
        }, this),
        target: ko.computed(function() {
            return selectedProject();
        }, this)
    }), new toolbarMenu({
        title: "<span title='Scene' class='fa fa-file-text-o'>",
        active: self.getSelectedScene,
        options: ko.computed(function() {
            return new contextMenu(selectedScene(), sceneMenuOptions).getOptions();
        }, this),
        target: ko.computed(function() {
            return selectedScene();
        }, this)
    }) ]), self.getToolbarMenus = ko.computed(function() {
        return toolbarMenus();
    }, this));
    var menu = ko.observable();
    var myContextMenuViewModel = new function() {
        this.isReady = function() {
            return !0;
        }, this.getContextMenu = ko.computed(function() {
            return menu();
        }, this), $(function() {
            $("#sidebar").contextmenu({
                target: "#context-menu",
                scopes: ".project-header",
                before: function(event, project) {
                    project = ko.dataFor(project.parent().get(0));
                    return menu(new contextMenu(project, projectMenuOptions)), !0;
                }
            }), $("#main-project-wrap").contextmenu({
                target: "#context-menu",
                scopes: ".scene",
                before: function(event, scene) {
                    scene = ko.dataFor(scene.get(0));
                    return !(scene.getErrState() || !scene.hasLoaded() || scene.isSaving() || scene.isLocked()) && (menu(new contextMenu(scene, sceneMenuOptions)), 
                    !0);
                }
            }), $("#file-browser-ul").contextmenu({
                target: "#context-menu",
                scopes: ".file",
                before: function(event, fileFolder) {
                    fileFolder = ko.dataFor(fileFolder.get(0));
                    return fileFolder.isFolder() ? menu(new contextMenu(fileFolder, folderMenuOptions)) : menu(new contextMenu(fileFolder, fileMenuOptions)), 
                    !0;
                }
            });
        });
    }();
    ko.applyBindings(myContextMenuViewModel, $("#context-menu")[0]);
}

function Scene(name, stats, nav, options) {
    name = name || "", void 0 === (stats = stats || {
        implicit_control_flow: !1
    }).implicit_control_flow && (stats.implicit_control_flow = !1), this.name = name, 
    this.stats = stats, this.temps = {
        choice_reuse: "allow",
        choice_user_restored: !1,
        _choiceEnds: {}
    }, this.nav = nav, this.debugMode = (options = options || {}).debugMode || !1, this.secondaryMode = options.secondaryMode, 
    this.saveSlot = options.saveSlot || "", this.lines = [], this.lineNum = 0, this.rollbackLineCoverage(), 
    this.finished = !1, this.labels = {}, this.indent = 0, this.prevLine = "empty", 
    this.screenEmpty = !0, this.initialCommands = !0, this.stats.sceneName = name, (this.stats.scene = this).target = null, 
    this.accumulatedParagraph = [];
}

function SceneNavigator(sceneList) {
    this.setSceneList(sceneList), this.startingStats = {
        implicit_control_flow: !1
    };
}

function callIos(scheme, path) {
    if (_global.isIosApp) {
        if ("undefined" != typeof webkit && webkit.messageHandlers) return webkit.messageHandlers.choicescript.postMessage([ scheme, path ]);
        path = path ? encodeURIComponent(path).replace(/[!~*')(]/g, function(match) {
            return "%" + match.charCodeAt(0).toString(16);
        }) : "", setTimeout(function() {
            var iframe = document.createElement("IFRAME");
            iframe.setAttribute("src", scheme + "://" + path), iframe.setAttribute("style", "display:none"), 
            document.documentElement.appendChild(iframe), iframe.parentNode.removeChild(iframe), 
            iframe = null;
        }, 0);
    }
}

function safeCall(obj, fn) {
    if (fn) {
        var isHeadless = "undefined" == typeof window, debug = !isHeadless && window.debug;
        if (isIE || isHeadless) "undefined" != typeof MSApp ? obj ? MSApp.execUnsafeLocalFunction(function() {
            fn.call(obj);
        }) : MSApp.execUnsafeLocalFunction(fn) : obj ? fn.call(obj) : fn.call(); else try {
            obj ? fn.call(obj) : fn.call();
        } catch (e) {
            if (e.message ? window.onerror(e.message, e.fileName, e.lineNumber, e.stack) : e.stack ? window.onerror(e.stack, e.fileName, e.lineNumber, e.stack) : window.onerror(toJson(e, "\n")), 
            window.console && (window.console.error(e), e.message && window.console.error("Message: " + e.message), 
            e.stack && window.console.error("Stack: " + e.stack)), debug) throw e;
        }
    }
}

function safeCallback(callback) {
    return function() {
        safeCall(null, callback);
    };
}

function safeTimeout(fn, time) {
    setTimeout(function() {
        safeCall(null, fn);
    }, time);
}

function isDefined(x) {
    return void 0 !== x;
}

function jsonStringifyAscii(obj) {
    return JSON.stringify(obj, function(key, value) {
        if ("scene" != key) return value;
    }).replace(/(.)/g, function(x) {
        var code = x.charCodeAt(0);
        if (127 < code || code < 32) {
            var outCode = code.toString(16);
            switch (outCode.length) {
              case 4:
                return "\\u" + outCode;

              case 3:
                return "\\u0" + outCode;

              case 2:
                return "\\u00" + outCode;

              case 1:
                return "\\u000" + outCode;

              default:
                return x;
            }
        }
        return x;
    });
}

function toJson(obj, standardized) {
    if ("undefined" != typeof JSON && JSON.stringify) return jsonStringifyAscii(obj);
    switch (typeof obj) {
      case "object":
        if (obj) {
            var prop, list = [];
            if (obj instanceof Array) {
                for (var i = 0; i < obj.length; i++) list.push(toJson(obj[i], standardized));
                return "[" + list.join(",") + "]";
            }
            for (prop in obj) "scene" != prop && (standardized || !/^[a-zA-Z][a-zA-Z_0-9]\w+$/.test(prop) || /\b(abstract|boolean|break|byte|case|catch|char|class|comment|const|continue|debugger|default|delete|do|double|else|enum|export|extends|false|final|finally|float|for|function|goto|if|implements|import|in|instanceof|int|interface|label|long|native|new|null|package|private|protected|public|return|short|static|super|switch|synchronized|this|throws|transient|true|try|typeof|var|void|volatile|while|with)\b/.test(prop) ? list.push('"' + prop + '":' + toJson(obj[prop], standardized)) : list.push(prop + ":" + toJson(obj[prop], standardized)));
            return "{" + list.join(",") + "}";
        }
        return "null";

      case "string":
        return '"' + obj.replace(/(.)/g, function(x) {
            if ("'" == x || '"' == x || "\\" == x) return "\\" + x;
            var code = x.charCodeAt(0);
            if (127 < code || code < 32) {
                var outCode = code.toString(16);
                switch (outCode.length) {
                  case 4:
                    return "\\u" + outCode;

                  case 3:
                    return "\\u0" + outCode;

                  case 2:
                    return "\\u00" + outCode;

                  case 1:
                    return "\\u000" + outCode;

                  default:
                    return x;
                }
            }
            return x;
        }) + '"';

      case "number":
      case "boolean":
        return String(obj);

      case "function":
        return "badfunction";

      case "undefined":
        return "undefined";

      default:
        throw new Error("invalid type: " + typeof obj);
    }
}

amdRequire.config({
    baseUrl: "node_modules/monaco-editor/release/min"
}), "object" == typeof nw ? (require = nodeRequire, require.nodeRequire = require, 
window.usingNode = !0, fs = require("fs"), mkdirp = require("mkdirp"), trash = require("trash"), 
getDirName = require("path").dirname, gui = require("nw.gui"), resolvePath = require("path").resolve, 
updater = require("cside-updater"), mediaServer = require("cside-server"), win = gui.Window.get(), 
win.show(), process.on("uncaughtException", function(err) {
    bootbox.alert('<h3>Uncaught Exception <span aria-hidden="true">=(</span></h3><p>' + err.message + "        </p><p>Something went (unexpectedly!) wrong.<br/>Please close         and restart the application (then report this!).");
    try {
        fs.appendFileSync(gui.App.dataPath + "/cside-errors.txt", new Date(Date.now()) + ": " + err.message + "\n" + err.stack + "\n");
    } catch (err) {}
})) : (window.usingNode = !1, getDirName = function(path) {
    return path.substring(0, path.lastIndexOf("/") + 1);
}, window.onbeforeunload = function(evt) {
    if (cside.session.isDirty() && 0 !== cside.getProjects().length) {
        var msg = "Warning: You have unsaved changes.";
        return (evt = evt || window.event) && (evt.returnValue = msg), msg;
    }
    return null;
}), window.cside = new IDEViewModel(), ko.applyBindings(cside, $(".main-wrap")[0]), 
amdRequire([ "vs/editor/editor.main" ], function() {
    window.monaco = monaco, window.meditor = monaco.editor.create(document.getElementById("editor-wrap"), {
        theme: "cs-light",
        value: "",
        language: "choicescript",
        autoIndent: !0,
        formatOnType: !0,
        dragAndDrop: !1,
        renderLineHighlight: "all",
        minimap: {
            enabled: !1
        },
        wordWrap: "bounded",
        wrappingIndent: "same",
        roundedSelection: !0,
        folding: !0,
        automaticLayout: !0,
        detectIndentation: !0,
        lightbulb: {
            enabled: !0
        },
        glyphMargin: !0,
        model: null
    }), cside.init(meditor);
}), "undefined" != typeof module && module.exports && (this["encoding-indexes"] = require("./encoding-indexes.js")["encoding-indexes"]), 
function(global) {
    "use strict";
    function inRange(a, min, max) {
        return min <= a && a <= max;
    }
    var floor = Math.floor;
    function ToDictionary(o) {
        if (void 0 === o) return {};
        if (o === Object(o)) return o;
        throw TypeError("Could not convert argument to dictionary");
    }
    function isASCIIByte(a) {
        return 0 <= a && a <= 127;
    }
    var isASCIICodePoint = isASCIIByte;
    function Stream(tokens) {
        this.tokens = [].slice.call(tokens), this.tokens.reverse();
    }
    Stream.prototype = {
        endOfStream: function() {
            return !this.tokens.length;
        },
        read: function() {
            return this.tokens.length ? this.tokens.pop() : -1;
        },
        prepend: function(token) {
            if (Array.isArray(token)) for (var tokens = token; tokens.length; ) this.tokens.push(tokens.pop()); else this.tokens.push(token);
        },
        push: function(token) {
            if (Array.isArray(token)) for (var tokens = token; tokens.length; ) this.tokens.unshift(tokens.shift()); else this.tokens.unshift(token);
        }
    };
    function decoderError(fatal, opt_code_point) {
        if (fatal) throw TypeError("Decoder error");
        return opt_code_point || 65533;
    }
    function encoderError(code_point) {
        throw TypeError("The code point " + code_point + " could not be encoded.");
    }
    function getEncoding(label) {
        return label = String(label).trim().toLowerCase(), Object.prototype.hasOwnProperty.call(label_to_encoding, label) ? label_to_encoding[label] : null;
    }
    var encodings = [ {
        encodings: [ {
            labels: [ "unicode-1-1-utf-8", "utf-8", "utf8" ],
            name: "UTF-8"
        } ],
        heading: "The Encoding"
    }, {
        encodings: [ {
            labels: [ "866", "cp866", "csibm866", "ibm866" ],
            name: "IBM866"
        }, {
            labels: [ "csisolatin2", "iso-8859-2", "iso-ir-101", "iso8859-2", "iso88592", "iso_8859-2", "iso_8859-2:1987", "l2", "latin2" ],
            name: "ISO-8859-2"
        }, {
            labels: [ "csisolatin3", "iso-8859-3", "iso-ir-109", "iso8859-3", "iso88593", "iso_8859-3", "iso_8859-3:1988", "l3", "latin3" ],
            name: "ISO-8859-3"
        }, {
            labels: [ "csisolatin4", "iso-8859-4", "iso-ir-110", "iso8859-4", "iso88594", "iso_8859-4", "iso_8859-4:1988", "l4", "latin4" ],
            name: "ISO-8859-4"
        }, {
            labels: [ "csisolatincyrillic", "cyrillic", "iso-8859-5", "iso-ir-144", "iso8859-5", "iso88595", "iso_8859-5", "iso_8859-5:1988" ],
            name: "ISO-8859-5"
        }, {
            labels: [ "arabic", "asmo-708", "csiso88596e", "csiso88596i", "csisolatinarabic", "ecma-114", "iso-8859-6", "iso-8859-6-e", "iso-8859-6-i", "iso-ir-127", "iso8859-6", "iso88596", "iso_8859-6", "iso_8859-6:1987" ],
            name: "ISO-8859-6"
        }, {
            labels: [ "csisolatingreek", "ecma-118", "elot_928", "greek", "greek8", "iso-8859-7", "iso-ir-126", "iso8859-7", "iso88597", "iso_8859-7", "iso_8859-7:1987", "sun_eu_greek" ],
            name: "ISO-8859-7"
        }, {
            labels: [ "csiso88598e", "csisolatinhebrew", "hebrew", "iso-8859-8", "iso-8859-8-e", "iso-ir-138", "iso8859-8", "iso88598", "iso_8859-8", "iso_8859-8:1988", "visual" ],
            name: "ISO-8859-8"
        }, {
            labels: [ "csiso88598i", "iso-8859-8-i", "logical" ],
            name: "ISO-8859-8-I"
        }, {
            labels: [ "csisolatin6", "iso-8859-10", "iso-ir-157", "iso8859-10", "iso885910", "l6", "latin6" ],
            name: "ISO-8859-10"
        }, {
            labels: [ "iso-8859-13", "iso8859-13", "iso885913" ],
            name: "ISO-8859-13"
        }, {
            labels: [ "iso-8859-14", "iso8859-14", "iso885914" ],
            name: "ISO-8859-14"
        }, {
            labels: [ "csisolatin9", "iso-8859-15", "iso8859-15", "iso885915", "iso_8859-15", "l9" ],
            name: "ISO-8859-15"
        }, {
            labels: [ "iso-8859-16" ],
            name: "ISO-8859-16"
        }, {
            labels: [ "cskoi8r", "koi", "koi8", "koi8-r", "koi8_r" ],
            name: "KOI8-R"
        }, {
            labels: [ "koi8-ru", "koi8-u" ],
            name: "KOI8-U"
        }, {
            labels: [ "csmacintosh", "mac", "macintosh", "x-mac-roman" ],
            name: "macintosh"
        }, {
            labels: [ "dos-874", "iso-8859-11", "iso8859-11", "iso885911", "tis-620", "windows-874" ],
            name: "windows-874"
        }, {
            labels: [ "cp1250", "windows-1250", "x-cp1250" ],
            name: "windows-1250"
        }, {
            labels: [ "cp1251", "windows-1251", "x-cp1251" ],
            name: "windows-1251"
        }, {
            labels: [ "ansi_x3.4-1968", "ascii", "cp1252", "cp819", "csisolatin1", "ibm819", "iso-8859-1", "iso-ir-100", "iso8859-1", "iso88591", "iso_8859-1", "iso_8859-1:1987", "l1", "latin1", "us-ascii", "windows-1252", "x-cp1252" ],
            name: "windows-1252"
        }, {
            labels: [ "cp1253", "windows-1253", "x-cp1253" ],
            name: "windows-1253"
        }, {
            labels: [ "cp1254", "csisolatin5", "iso-8859-9", "iso-ir-148", "iso8859-9", "iso88599", "iso_8859-9", "iso_8859-9:1989", "l5", "latin5", "windows-1254", "x-cp1254" ],
            name: "windows-1254"
        }, {
            labels: [ "cp1255", "windows-1255", "x-cp1255" ],
            name: "windows-1255"
        }, {
            labels: [ "cp1256", "windows-1256", "x-cp1256" ],
            name: "windows-1256"
        }, {
            labels: [ "cp1257", "windows-1257", "x-cp1257" ],
            name: "windows-1257"
        }, {
            labels: [ "cp1258", "windows-1258", "x-cp1258" ],
            name: "windows-1258"
        }, {
            labels: [ "x-mac-cyrillic", "x-mac-ukrainian" ],
            name: "x-mac-cyrillic"
        } ],
        heading: "Legacy single-byte encodings"
    }, {
        encodings: [ {
            labels: [ "chinese", "csgb2312", "csiso58gb231280", "gb2312", "gb_2312", "gb_2312-80", "gbk", "iso-ir-58", "x-gbk" ],
            name: "GBK"
        }, {
            labels: [ "gb18030" ],
            name: "gb18030"
        } ],
        heading: "Legacy multi-byte Chinese (simplified) encodings"
    }, {
        encodings: [ {
            labels: [ "big5", "big5-hkscs", "cn-big5", "csbig5", "x-x-big5" ],
            name: "Big5"
        } ],
        heading: "Legacy multi-byte Chinese (traditional) encodings"
    }, {
        encodings: [ {
            labels: [ "cseucpkdfmtjapanese", "euc-jp", "x-euc-jp" ],
            name: "EUC-JP"
        }, {
            labels: [ "csiso2022jp", "iso-2022-jp" ],
            name: "ISO-2022-JP"
        }, {
            labels: [ "csshiftjis", "ms932", "ms_kanji", "shift-jis", "shift_jis", "sjis", "windows-31j", "x-sjis" ],
            name: "Shift_JIS"
        } ],
        heading: "Legacy multi-byte Japanese encodings"
    }, {
        encodings: [ {
            labels: [ "cseuckr", "csksc56011987", "euc-kr", "iso-ir-149", "korean", "ks_c_5601-1987", "ks_c_5601-1989", "ksc5601", "ksc_5601", "windows-949" ],
            name: "EUC-KR"
        } ],
        heading: "Legacy multi-byte Korean encodings"
    }, {
        encodings: [ {
            labels: [ "csiso2022kr", "hz-gb-2312", "iso-2022-cn", "iso-2022-cn-ext", "iso-2022-kr" ],
            name: "replacement"
        }, {
            labels: [ "utf-16be" ],
            name: "UTF-16BE"
        }, {
            labels: [ "utf-16", "utf-16le" ],
            name: "UTF-16LE"
        }, {
            labels: [ "x-user-defined" ],
            name: "x-user-defined"
        } ],
        heading: "Legacy miscellaneous encodings"
    } ], label_to_encoding = {};
    encodings.forEach(function(category) {
        category.encodings.forEach(function(encoding) {
            encoding.labels.forEach(function(label) {
                label_to_encoding[label] = encoding;
            });
        });
    });
    var shift_jis_index, big5_index_no_hkscs, encoders = {}, decoders = {};
    function indexCodePointFor(pointer, index) {
        return index && index[pointer] || null;
    }
    function indexPointerFor(pointer, index) {
        pointer = index.indexOf(pointer);
        return -1 === pointer ? null : pointer;
    }
    function index(name) {
        if (!("encoding-indexes" in global)) throw Error("Indexes missing. Did you forget to include encoding-indexes.js?");
        return global["encoding-indexes"][name];
    }
    var DEFAULT_ENCODING = "utf-8";
    function TextDecoder(label, options) {
        if (!(this instanceof TextDecoder)) throw TypeError("Called as a function. Did you forget 'new'?");
        label = void 0 !== label ? String(label) : DEFAULT_ENCODING, options = ToDictionary(options), 
        this._encoding = null, this._decoder = null, this._ignoreBOM = !1, this._BOMseen = !1, 
        this._error_mode = "replacement", this._do_not_flush = !1;
        var encoding = getEncoding(label);
        if (null === encoding || "replacement" === encoding.name) throw RangeError("Unknown encoding: " + label);
        if (!decoders[encoding.name]) throw Error("Decoder not present. Did you forget to include encoding-indexes.js?");
        return this._encoding = encoding, Boolean(options.fatal) && (this._error_mode = "fatal"), 
        Boolean(options.ignoreBOM) && (this._ignoreBOM = !0), Object.defineProperty || (this.encoding = this._encoding.name.toLowerCase(), 
        this.fatal = "fatal" === this._error_mode, this.ignoreBOM = this._ignoreBOM), this;
    }
    function TextEncoder(label, encoding) {
        if (!(this instanceof TextEncoder)) throw TypeError("Called as a function. Did you forget 'new'?");
        encoding = ToDictionary(encoding), this._encoding = null, this._encoder = null, 
        this._do_not_flush = !1, this._fatal = Boolean(encoding.fatal) ? "fatal" : "replacement";
        if (Boolean(encoding.NONSTANDARD_allowLegacyEncoding)) {
            encoding = getEncoding(label = void 0 !== label ? String(label) : DEFAULT_ENCODING);
            if (null === encoding || "replacement" === encoding.name) throw RangeError("Unknown encoding: " + label);
            if (!encoders[encoding.name]) throw Error("Encoder not present. Did you forget to include encoding-indexes.js?");
            this._encoding = encoding;
        } else this._encoding = getEncoding("utf-8"), void 0 !== label && "console" in global && console.warn("TextEncoder constructor called with encoding label, which is ignored.");
        return Object.defineProperty || (this.encoding = this._encoding.name.toLowerCase()), 
        this;
    }
    function UTF8Decoder(options) {
        var fatal = options.fatal, utf8_code_point = 0, utf8_bytes_seen = 0, utf8_bytes_needed = 0, utf8_lower_boundary = 128, utf8_upper_boundary = 191;
        this.handler = function(stream, code_point) {
            if (-1 === code_point && 0 !== utf8_bytes_needed) return utf8_bytes_needed = 0, 
            decoderError(fatal);
            if (-1 === code_point) return -1;
            if (0 === utf8_bytes_needed) {
                if (inRange(code_point, 0, 127)) return code_point;
                if (inRange(code_point, 194, 223)) utf8_bytes_needed = 1, utf8_code_point = 31 & code_point; else if (inRange(code_point, 224, 239)) 224 === code_point && (utf8_lower_boundary = 160), 
                237 === code_point && (utf8_upper_boundary = 159), utf8_bytes_needed = 2, utf8_code_point = 15 & code_point; else {
                    if (!inRange(code_point, 240, 244)) return decoderError(fatal);
                    240 === code_point && (utf8_lower_boundary = 144), 244 === code_point && (utf8_upper_boundary = 143), 
                    utf8_bytes_needed = 3, utf8_code_point = 7 & code_point;
                }
                return null;
            }
            if (!inRange(code_point, utf8_lower_boundary, utf8_upper_boundary)) return utf8_code_point = utf8_bytes_needed = utf8_bytes_seen = 0, 
            utf8_lower_boundary = 128, utf8_upper_boundary = 191, stream.prepend(code_point), 
            decoderError(fatal);
            if (utf8_lower_boundary = 128, utf8_upper_boundary = 191, utf8_code_point = utf8_code_point << 6 | 63 & code_point, 
            (utf8_bytes_seen += 1) !== utf8_bytes_needed) return null;
            code_point = utf8_code_point;
            return utf8_code_point = utf8_bytes_needed = utf8_bytes_seen = 0, code_point;
        };
    }
    function UTF8Encoder(options) {
        options.fatal;
        this.handler = function(stream, code_point) {
            if (-1 === code_point) return -1;
            if (isASCIICodePoint(code_point)) return code_point;
            var count, offset;
            inRange(code_point, 128, 2047) ? (count = 1, offset = 192) : inRange(code_point, 2048, 65535) ? (count = 2, 
            offset = 224) : inRange(code_point, 65536, 1114111) && (count = 3, offset = 240);
            for (var bytes = [ (code_point >> 6 * count) + offset ]; 0 < count; ) bytes.push(128 | 63 & code_point >> 6 * (count - 1)), 
            --count;
            return bytes;
        };
    }
    function SingleByteDecoder(index, options) {
        var fatal = options.fatal;
        this.handler = function(stream, code_point) {
            if (-1 === code_point) return -1;
            if (isASCIIByte(code_point)) return code_point;
            code_point = index[code_point - 128];
            return null === code_point ? decoderError(fatal) : code_point;
        };
    }
    function SingleByteEncoder(index, options) {
        options.fatal;
        this.handler = function(stream, code_point) {
            if (-1 === code_point) return -1;
            if (isASCIICodePoint(code_point)) return code_point;
            var pointer = indexPointerFor(code_point, index);
            return null === pointer && encoderError(code_point), pointer + 128;
        };
    }
    function GB18030Decoder(options) {
        var fatal = options.fatal, gb18030_first = 0, gb18030_second = 0, gb18030_third = 0;
        this.handler = function(stream, bite) {
            if (-1 === bite && 0 === gb18030_first && 0 === gb18030_second && 0 === gb18030_third) return -1;
            var code_point;
            if (-1 !== bite || 0 === gb18030_first && 0 === gb18030_second && 0 === gb18030_third || (gb18030_third = gb18030_second = gb18030_first = 0, 
            decoderError(fatal)), 0 !== gb18030_third) {
                code_point = null, inRange(bite, 48, 57) && (code_point = function(pointer) {
                    if (39419 < pointer && pointer < 189e3 || 1237575 < pointer) return null;
                    if (7457 === pointer) return 59335;
                    for (var offset = 0, code_point_offset = 0, idx = index("gb18030-ranges"), i = 0; i < idx.length; ++i) {
                        var entry = idx[i];
                        if (!(entry[0] <= pointer)) break;
                        offset = entry[0], code_point_offset = entry[1];
                    }
                    return code_point_offset + pointer - offset;
                }(10 * (126 * (10 * (gb18030_first - 129) + gb18030_second - 48) + gb18030_third - 129) + bite - 48));
                var pointer = [ gb18030_second, gb18030_third, bite ];
                return gb18030_third = gb18030_second = gb18030_first = 0, null === code_point ? (stream.prepend(pointer), 
                decoderError(fatal)) : code_point;
            }
            if (0 !== gb18030_second) return inRange(bite, 129, 254) ? (gb18030_third = bite, 
            null) : (stream.prepend([ gb18030_second, bite ]), gb18030_second = gb18030_first = 0, 
            decoderError(fatal));
            if (0 === gb18030_first) return isASCIIByte(bite) ? bite : 128 === bite ? 8364 : inRange(bite, 129, 254) ? (gb18030_first = bite, 
            null) : decoderError(fatal);
            if (inRange(bite, 48, 57)) return gb18030_second = bite, null;
            var lead = gb18030_first, pointer = null;
            return gb18030_first = 0, null === (code_point = null === (pointer = inRange(bite, 64, 126) || inRange(bite, 128, 254) ? 190 * (lead - 129) + (bite - (bite < 127 ? 64 : 65)) : pointer) ? null : indexCodePointFor(pointer, index("gb18030"))) && isASCIIByte(bite) && stream.prepend(bite), 
            null === code_point ? decoderError(fatal) : code_point;
        };
    }
    function GB18030Encoder(options, gbk_flag) {
        options.fatal;
        this.handler = function(stream, byte3) {
            if (-1 === byte3) return -1;
            if (isASCIICodePoint(byte3)) return byte3;
            if (58853 === byte3) return encoderError(byte3);
            if (gbk_flag && 8364 === byte3) return 128;
            if (null !== (pointer = indexPointerFor(byte3, index("gb18030")))) {
                var byte2 = pointer % 190;
                return [ floor(pointer / 190) + 129, byte2 + (byte2 < 63 ? 64 : 65) ];
            }
            if (gbk_flag) return encoderError(byte3);
            var pointer = function(code_point) {
                if (59335 === code_point) return 7457;
                for (var offset = 0, pointer_offset = 0, idx = index("gb18030-ranges"), i = 0; i < idx.length; ++i) {
                    var entry = idx[i];
                    if (!(entry[1] <= code_point)) break;
                    offset = entry[1], pointer_offset = entry[0];
                }
                return pointer_offset + code_point - offset;
            }(byte3), byte1 = floor(pointer / 10 / 126 / 10), byte2 = floor((pointer -= 10 * byte1 * 126 * 10) / 10 / 126), byte3 = floor((pointer -= 10 * byte2 * 126) / 10);
            return [ byte1 + 129, byte2 + 48, byte3 + 129, 48 + (pointer - 10 * byte3) ];
        };
    }
    function Big5Decoder(options) {
        var fatal = options.fatal, Big5_lead = 0;
        this.handler = function(stream, bite) {
            if (-1 === bite && 0 !== Big5_lead) return Big5_lead = 0, decoderError(fatal);
            if (-1 === bite && 0 === Big5_lead) return -1;
            if (0 === Big5_lead) return isASCIIByte(bite) ? bite : inRange(bite, 129, 254) ? (Big5_lead = bite, 
            null) : decoderError(fatal);
            var lead = Big5_lead, code_point = null;
            switch (Big5_lead = 0, code_point = inRange(bite, 64, 126) || inRange(bite, 161, 254) ? 157 * (lead - 129) + (bite - (bite < 127 ? 64 : 98)) : code_point) {
              case 1133:
                return [ 202, 772 ];

              case 1135:
                return [ 202, 780 ];

              case 1164:
                return [ 234, 772 ];

              case 1166:
                return [ 234, 780 ];
            }
            code_point = null === code_point ? null : indexCodePointFor(code_point, index("big5"));
            return null === code_point && isASCIIByte(bite) && stream.prepend(bite), null === code_point ? decoderError(fatal) : code_point;
        };
    }
    function Big5Encoder(options) {
        options.fatal;
        this.handler = function(stream, code_point) {
            if (-1 === code_point) return -1;
            if (isASCIICodePoint(code_point)) return code_point;
            var trail = function(code_point) {
                var index_ = big5_index_no_hkscs = big5_index_no_hkscs || index("big5").map(function(code_point, pointer) {
                    return pointer < 5024 ? null : code_point;
                });
                return 9552 === code_point || 9566 === code_point || 9569 === code_point || 9578 === code_point || 21313 === code_point || 21317 === code_point ? index_.lastIndexOf(code_point) : indexPointerFor(code_point, index_);
            }(code_point);
            if (null === trail) return encoderError(code_point);
            var lead = floor(trail / 157) + 129;
            if (lead < 161) return encoderError(code_point);
            trail %= 157;
            return [ lead, trail + (trail < 63 ? 64 : 98) ];
        };
    }
    function EUCJPDecoder(options) {
        var fatal = options.fatal, eucjp_jis0212_flag = !1, eucjp_lead = 0;
        this.handler = function(stream, bite) {
            if (-1 === bite && 0 !== eucjp_lead) return eucjp_lead = 0, decoderError(fatal);
            if (-1 === bite && 0 === eucjp_lead) return -1;
            if (142 === eucjp_lead && inRange(bite, 161, 223)) return eucjp_lead = 0, 65216 + bite;
            if (143 === eucjp_lead && inRange(bite, 161, 254)) return eucjp_jis0212_flag = !0, 
            eucjp_lead = bite, null;
            if (0 === eucjp_lead) return isASCIIByte(bite) ? bite : 142 === bite || 143 === bite || inRange(bite, 161, 254) ? (eucjp_lead = bite, 
            null) : decoderError(fatal);
            var lead = eucjp_lead;
            eucjp_lead = 0;
            var code_point = null;
            return inRange(lead, 161, 254) && inRange(bite, 161, 254) && (code_point = indexCodePointFor(94 * (lead - 161) + (bite - 161), index(eucjp_jis0212_flag ? "jis0212" : "jis0208"))), 
            eucjp_jis0212_flag = !1, inRange(bite, 161, 254) || stream.prepend(bite), null === code_point ? decoderError(fatal) : code_point;
        };
    }
    function EUCJPEncoder(options) {
        options.fatal;
        this.handler = function(stream, code_point) {
            if (-1 === code_point) return -1;
            if (isASCIICodePoint(code_point)) return code_point;
            if (165 === code_point) return 92;
            if (8254 === code_point) return 126;
            if (inRange(code_point, 65377, 65439)) return [ 142, code_point - 65377 + 161 ];
            var pointer = indexPointerFor(code_point = 8722 === code_point ? 65293 : code_point, index("jis0208"));
            return null === pointer ? encoderError(code_point) : [ floor(pointer / 94) + 161, pointer % 94 + 161 ];
        };
    }
    function ISO2022JPDecoder(options) {
        var fatal = options.fatal, states_ASCII = 0, states_Roman = 1, states_Katakana = 2, states_LeadByte = 3, states_TrailByte = 4, states_EscapeStart = 5, states_Escape = 6, iso2022jp_decoder_state = states_ASCII, iso2022jp_decoder_output_state = states_ASCII, iso2022jp_lead = 0, iso2022jp_output_flag = !1;
        this.handler = function(stream, bite) {
            switch (iso2022jp_decoder_state) {
              default:
              case states_ASCII:
                return 27 === bite ? (iso2022jp_decoder_state = states_EscapeStart, null) : inRange(bite, 0, 127) && 14 !== bite && 15 !== bite && 27 !== bite ? (iso2022jp_output_flag = !1, 
                bite) : -1 === bite ? -1 : (iso2022jp_output_flag = !1, decoderError(fatal));

              case states_Roman:
                return 27 === bite ? (iso2022jp_decoder_state = states_EscapeStart, null) : 92 === bite ? (iso2022jp_output_flag = !1, 
                165) : 126 === bite ? (iso2022jp_output_flag = !1, 8254) : inRange(bite, 0, 127) && 14 !== bite && 15 !== bite && 27 !== bite && 92 !== bite && 126 !== bite ? (iso2022jp_output_flag = !1, 
                bite) : -1 === bite ? -1 : (iso2022jp_output_flag = !1, decoderError(fatal));

              case states_Katakana:
                return 27 === bite ? (iso2022jp_decoder_state = states_EscapeStart, null) : inRange(bite, 33, 95) ? (iso2022jp_output_flag = !1, 
                65344 + bite) : -1 === bite ? -1 : (iso2022jp_output_flag = !1, decoderError(fatal));

              case states_LeadByte:
                return 27 === bite ? (iso2022jp_decoder_state = states_EscapeStart, null) : inRange(bite, 33, 126) ? (iso2022jp_output_flag = !1, 
                iso2022jp_lead = bite, iso2022jp_decoder_state = states_TrailByte, null) : -1 === bite ? -1 : (iso2022jp_output_flag = !1, 
                decoderError(fatal));

              case states_TrailByte:
                if (27 === bite) return iso2022jp_decoder_state = states_EscapeStart, decoderError(fatal);
                if (inRange(bite, 33, 126)) {
                    iso2022jp_decoder_state = states_LeadByte;
                    var output_flag = indexCodePointFor(94 * (iso2022jp_lead - 33) + bite - 33, index("jis0208"));
                    return null === output_flag ? decoderError(fatal) : output_flag;
                }
                return -1 === bite ? (iso2022jp_decoder_state = states_LeadByte, stream.prepend(bite), 
                decoderError(fatal)) : (iso2022jp_decoder_state = states_LeadByte, decoderError(fatal));

              case states_EscapeStart:
                return 36 === bite || 40 === bite ? (iso2022jp_lead = bite, iso2022jp_decoder_state = states_Escape, 
                null) : (stream.prepend(bite), iso2022jp_output_flag = !1, iso2022jp_decoder_state = iso2022jp_decoder_output_state, 
                decoderError(fatal));

              case states_Escape:
                var lead = iso2022jp_lead;
                iso2022jp_lead = 0;
                output_flag = 36 !== lead || 64 !== bite && 66 !== bite ? 40 === lead && 73 === bite ? states_Katakana : 40 === lead && 74 === bite ? states_Roman : 40 === lead && 66 === bite ? states_ASCII : null : states_LeadByte;
                if (null === output_flag) return stream.prepend([ lead, bite ]), iso2022jp_output_flag = !1, 
                iso2022jp_decoder_state = iso2022jp_decoder_output_state, decoderError(fatal);
                iso2022jp_decoder_state = output_flag;
                output_flag = iso2022jp_output_flag;
                return iso2022jp_output_flag = !0, output_flag ? decoderError(fatal) : null;
            }
        };
    }
    function ISO2022JPEncoder(options) {
        options.fatal;
        var states_ASCII$0 = 0, states_Roman$0 = 1, states_jis0208 = 2, iso2022jp_state = states_ASCII$0;
        this.handler = function(stream, code_point) {
            if (-1 === code_point && iso2022jp_state !== states_ASCII$0) return stream.prepend(code_point), 
            iso2022jp_state = states_ASCII$0, [ 27, 40, 66 ];
            if (-1 === code_point && iso2022jp_state === states_ASCII$0) return -1;
            if (!(iso2022jp_state !== states_ASCII$0 && iso2022jp_state !== states_Roman$0 || 14 !== code_point && 15 !== code_point && 27 !== code_point)) return encoderError(65533);
            if (iso2022jp_state === states_ASCII$0 && isASCIICodePoint(code_point)) return code_point;
            if (iso2022jp_state === states_Roman$0 && (isASCIICodePoint(code_point) && 92 !== code_point && 126 !== code_point || 165 == code_point || 8254 == code_point)) {
                if (isASCIICodePoint(code_point)) return code_point;
                if (165 === code_point) return 92;
                if (8254 === code_point) return 126;
            }
            if (isASCIICodePoint(code_point) && iso2022jp_state !== states_ASCII$0) return stream.prepend(code_point), 
            iso2022jp_state = states_ASCII$0, [ 27, 40, 66 ];
            if ((165 === code_point || 8254 === code_point) && iso2022jp_state !== states_Roman$0) return stream.prepend(code_point), 
            iso2022jp_state = states_Roman$0, [ 27, 40, 74 ];
            var pointer = indexPointerFor(code_point = 8722 === code_point ? 65293 : code_point, index("jis0208"));
            return null === pointer ? encoderError(code_point) : iso2022jp_state !== states_jis0208 ? (stream.prepend(code_point), 
            iso2022jp_state = states_jis0208, [ 27, 36, 66 ]) : [ floor(pointer / 94) + 33, pointer % 94 + 33 ];
        };
    }
    function ShiftJISDecoder(options) {
        var fatal = options.fatal, Shift_JIS_lead = 0;
        this.handler = function(stream, bite) {
            if (-1 === bite && 0 !== Shift_JIS_lead) return Shift_JIS_lead = 0, decoderError(fatal);
            if (-1 === bite && 0 === Shift_JIS_lead) return -1;
            if (0 === Shift_JIS_lead) return isASCIIByte(bite) || 128 === bite ? bite : inRange(bite, 161, 223) ? 65216 + bite : inRange(bite, 129, 159) || inRange(bite, 224, 252) ? (Shift_JIS_lead = bite, 
            null) : decoderError(fatal);
            var lead = Shift_JIS_lead, code_point = null;
            if (Shift_JIS_lead = 0, (inRange(bite, 64, 126) || inRange(bite, 128, 252)) && (code_point = 188 * (lead - (lead < 160 ? 129 : 193)) + bite - (bite < 127 ? 64 : 65)), 
            inRange(code_point, 8836, 10715)) return 48508 + code_point;
            code_point = null === code_point ? null : indexCodePointFor(code_point, index("jis0208"));
            return null === code_point && isASCIIByte(bite) && stream.prepend(bite), null === code_point ? decoderError(fatal) : code_point;
        };
    }
    function ShiftJISEncoder(options) {
        options.fatal;
        this.handler = function(stream, lead) {
            if (-1 === lead) return -1;
            if (isASCIICodePoint(lead) || 128 === lead) return lead;
            if (165 === lead) return 92;
            if (8254 === lead) return 126;
            if (inRange(lead, 65377, 65439)) return lead - 65377 + 161;
            var trail = function(code_point) {
                return (shift_jis_index = shift_jis_index || index("jis0208").map(function(code_point, pointer) {
                    return inRange(pointer, 8272, 8835) ? null : code_point;
                })).indexOf(code_point);
            }(lead = 8722 === lead ? 65293 : lead);
            if (null === trail) return encoderError(lead);
            lead = floor(trail / 188), trail %= 188;
            return [ lead + (lead < 31 ? 129 : 193), trail + (trail < 63 ? 64 : 65) ];
        };
    }
    function EUCKRDecoder(options) {
        var fatal = options.fatal, euckr_lead = 0;
        this.handler = function(stream, bite) {
            if (-1 === bite && 0 !== euckr_lead) return euckr_lead = 0, decoderError(fatal);
            if (-1 === bite && 0 === euckr_lead) return -1;
            if (0 === euckr_lead) return isASCIIByte(bite) ? bite : inRange(bite, 129, 254) ? (euckr_lead = bite, 
            null) : decoderError(fatal);
            var code_point = euckr_lead, pointer = null;
            euckr_lead = 0;
            code_point = null === (pointer = inRange(bite, 65, 254) ? 190 * (code_point - 129) + (bite - 65) : pointer) ? null : indexCodePointFor(pointer, index("euc-kr"));
            return null === pointer && isASCIIByte(bite) && stream.prepend(bite), null === code_point ? decoderError(fatal) : code_point;
        };
    }
    function EUCKREncoder(options) {
        options.fatal;
        this.handler = function(stream, code_point) {
            if (-1 === code_point) return -1;
            if (isASCIICodePoint(code_point)) return code_point;
            var pointer = indexPointerFor(code_point, index("euc-kr"));
            return null === pointer ? encoderError(code_point) : [ floor(pointer / 190) + 129, pointer % 190 + 65 ];
        };
    }
    function convertCodeUnitToBytes(byte2, utf16be) {
        var byte1 = byte2 >> 8, byte2 = 255 & byte2;
        return utf16be ? [ byte1, byte2 ] : [ byte2, byte1 ];
    }
    function UTF16Decoder(utf16_be, options) {
        var fatal = options.fatal, utf16_lead_byte = null, utf16_lead_surrogate = null;
        this.handler = function(stream, lead_surrogate) {
            if (-1 === lead_surrogate && (null !== utf16_lead_byte || null !== utf16_lead_surrogate)) return decoderError(fatal);
            if (-1 === lead_surrogate && null === utf16_lead_byte && null === utf16_lead_surrogate) return -1;
            if (null === utf16_lead_byte) return utf16_lead_byte = lead_surrogate, null;
            var code_unit = utf16_be ? (utf16_lead_byte << 8) + lead_surrogate : (lead_surrogate << 8) + utf16_lead_byte;
            if ((utf16_lead_byte = null) === utf16_lead_surrogate) return inRange(code_unit, 55296, 56319) ? (utf16_lead_surrogate = code_unit, 
            null) : inRange(code_unit, 56320, 57343) ? decoderError(fatal) : code_unit;
            lead_surrogate = utf16_lead_surrogate;
            return utf16_lead_surrogate = null, inRange(code_unit, 56320, 57343) ? 65536 + 1024 * (lead_surrogate - 55296) + (code_unit - 56320) : (stream.prepend(convertCodeUnitToBytes(code_unit, utf16_be)), 
            decoderError(fatal));
        };
    }
    function UTF16Encoder(utf16_be, options) {
        options.fatal;
        this.handler = function(stream, trail) {
            if (-1 === trail) return -1;
            if (inRange(trail, 0, 65535)) return convertCodeUnitToBytes(trail, utf16_be);
            var lead = convertCodeUnitToBytes(55296 + (trail - 65536 >> 10), utf16_be), trail = convertCodeUnitToBytes(56320 + (trail - 65536 & 1023), utf16_be);
            return lead.concat(trail);
        };
    }
    function XUserDefinedDecoder(options) {
        options.fatal;
        this.handler = function(stream, bite) {
            return -1 === bite ? -1 : isASCIIByte(bite) ? bite : 63360 + bite - 128;
        };
    }
    function XUserDefinedEncoder(options) {
        options.fatal;
        this.handler = function(stream, code_point) {
            return -1 === code_point ? -1 : isASCIICodePoint(code_point) ? code_point : inRange(code_point, 63360, 63487) ? code_point - 63360 + 128 : encoderError(code_point);
        };
    }
    Object.defineProperty && (Object.defineProperty(TextDecoder.prototype, "encoding", {
        get: function() {
            return this._encoding.name.toLowerCase();
        }
    }), Object.defineProperty(TextDecoder.prototype, "fatal", {
        get: function() {
            return "fatal" === this._error_mode;
        }
    }), Object.defineProperty(TextDecoder.prototype, "ignoreBOM", {
        get: function() {
            return this._ignoreBOM;
        }
    })), TextDecoder.prototype.decode = function(bytes, options) {
        bytes = "object" == typeof bytes && bytes instanceof ArrayBuffer ? new Uint8Array(bytes) : "object" == typeof bytes && "buffer" in bytes && bytes.buffer instanceof ArrayBuffer ? new Uint8Array(bytes.buffer, bytes.byteOffset, bytes.byteLength) : new Uint8Array(0);
        options = ToDictionary(options), this._do_not_flush || (this._decoder = decoders[this._encoding.name]({
            fatal: "fatal" === this._error_mode
        }), this._BOMseen = !1), this._do_not_flush = Boolean(options.stream);
        for (var result, input_stream = new Stream(bytes), output = []; ;) {
            var token = input_stream.read();
            if (-1 === token) break;
            if (-1 === (result = this._decoder.handler(input_stream, token))) break;
            null !== result && (Array.isArray(result) ? output.push.apply(output, result) : output.push(result));
        }
        if (!this._do_not_flush) {
            for (;-1 !== (result = this._decoder.handler(input_stream, input_stream.read())) && (null !== result && (Array.isArray(result) ? output.push.apply(output, result) : output.push(result)), 
            !input_stream.endOfStream()); ) ;
            this._decoder = null;
        }
        return function(stream) {
            var array, item;
            return array = [ "UTF-8", "UTF-16LE", "UTF-16BE" ], item = this._encoding.name, 
            -1 === array.indexOf(item) || this._ignoreBOM || this._BOMseen || (0 < stream.length && 65279 === stream[0] ? (this._BOMseen = !0, 
            stream.shift()) : 0 < stream.length && (this._BOMseen = !0)), function(code_points) {
                for (var s = "", i = 0; i < code_points.length; ++i) {
                    var cp = code_points[i];
                    cp <= 65535 ? s += String.fromCharCode(cp) : (cp -= 65536, s += String.fromCharCode(55296 + (cp >> 10), 56320 + (1023 & cp)));
                }
                return s;
            }(stream);
        }.call(this, output);
    }, Object.defineProperty && Object.defineProperty(TextEncoder.prototype, "encoding", {
        get: function() {
            return this._encoding.name.toLowerCase();
        }
    }), TextEncoder.prototype.encode = function(opt_string, options) {
        opt_string = opt_string ? String(opt_string) : "", options = ToDictionary(options), 
        this._do_not_flush || (this._encoder = encoders[this._encoding.name]({
            fatal: "fatal" === this._fatal
        })), this._do_not_flush = Boolean(options.stream);
        for (var result, input = new Stream(function(string) {
            for (var s = String(string), n = s.length, i = 0, u = []; i < n; ) {
                var d, c = s.charCodeAt(i);
                c < 55296 || 57343 < c ? u.push(c) : 56320 <= c && c <= 57343 ? u.push(65533) : 55296 <= c && c <= 56319 && (i !== n - 1 && 56320 <= (d = s.charCodeAt(i + 1)) && d <= 57343 ? (u.push(65536 + ((1023 & c) << 10) + (1023 & d)), 
                i += 1) : u.push(65533)), i += 1;
            }
            return u;
        }(opt_string)), output = []; ;) {
            var token = input.read();
            if (-1 === token) break;
            if (-1 === (result = this._encoder.handler(input, token))) break;
            Array.isArray(result) ? output.push.apply(output, result) : output.push(result);
        }
        if (!this._do_not_flush) {
            for (;-1 !== (result = this._encoder.handler(input, input.read())); ) Array.isArray(result) ? output.push.apply(output, result) : output.push(result);
            this._encoder = null;
        }
        return new Uint8Array(output);
    }, encoders["UTF-8"] = function(options) {
        return new UTF8Encoder(options);
    }, decoders["UTF-8"] = function(options) {
        return new UTF8Decoder(options);
    }, "encoding-indexes" in global && encodings.forEach(function(category) {
        "Legacy single-byte encodings" === category.heading && category.encodings.forEach(function(name) {
            var name = name.name, idx = index(name.toLowerCase());
            decoders[name] = function(options) {
                return new SingleByteDecoder(idx, options);
            }, encoders[name] = function(options) {
                return new SingleByteEncoder(idx, options);
            };
        });
    }), decoders.GBK = function(options) {
        return new GB18030Decoder(options);
    }, encoders.GBK = function(options) {
        return new GB18030Encoder(options, !0);
    }, encoders.gb18030 = function(options) {
        return new GB18030Encoder(options);
    }, decoders.gb18030 = function(options) {
        return new GB18030Decoder(options);
    }, encoders.Big5 = function(options) {
        return new Big5Encoder(options);
    }, decoders.Big5 = function(options) {
        return new Big5Decoder(options);
    }, encoders["EUC-JP"] = function(options) {
        return new EUCJPEncoder(options);
    }, decoders["EUC-JP"] = function(options) {
        return new EUCJPDecoder(options);
    }, encoders["ISO-2022-JP"] = function(options) {
        return new ISO2022JPEncoder(options);
    }, decoders["ISO-2022-JP"] = function(options) {
        return new ISO2022JPDecoder(options);
    }, encoders.Shift_JIS = function(options) {
        return new ShiftJISEncoder(options);
    }, decoders.Shift_JIS = function(options) {
        return new ShiftJISDecoder(options);
    }, encoders["EUC-KR"] = function(options) {
        return new EUCKREncoder(options);
    }, decoders["EUC-KR"] = function(options) {
        return new EUCKRDecoder(options);
    }, encoders["UTF-16BE"] = function(options) {
        return new UTF16Encoder(!0, options);
    }, decoders["UTF-16BE"] = function(options) {
        return new UTF16Decoder(!0, options);
    }, encoders["UTF-16LE"] = function(options) {
        return new UTF16Encoder(!1, options);
    }, decoders["UTF-16LE"] = function(options) {
        return new UTF16Decoder(!1, options);
    }, encoders["x-user-defined"] = function(options) {
        return new XUserDefinedEncoder(options);
    }, decoders["x-user-defined"] = function(options) {
        return new XUserDefinedDecoder(options);
    }, global.TextEncoder || (global.TextEncoder = TextEncoder), global.TextDecoder || (global.TextDecoder = TextDecoder), 
    "undefined" != typeof module && module.exports && (module.exports = {
        TextEncoder: global.TextEncoder,
        TextDecoder: global.TextDecoder,
        EncodingIndexes: global["encoding-indexes"]
    });
}(this), Scene.prototype.reexecute = function() {
    this.lineNum = this.stats.testEntryPoint || 0, this.finished = 0, this.indent = this.getIndent(this.lines[this.lineNum]), 
    this.prevLine = "empty", this.screenEmpty = !0, this.execute();
}, Scene.prototype.printLoop = function() {
    for (var line; !this.finished && this.lineNum < this.lines.length; this.lineNum++) if (trim(line = this.lines[this.lineNum])) {
        var indent = this.getIndent(line);
        if (indent > this.indent) {
            if (/\s*\*comment\b/.test(line)) continue;
            throw new Error(this.lineMsg() + "increasing indent not allowed, expected " + this.indent + " was " + indent);
        }
        if (indent < this.indent && this.dedent(indent), this.temps._choiceEnds[this.lineNum] && (this.stats.implicit_control_flow || 0 < this.temps._fakeChoiceDepth)) this.rollbackLineCoverage(), 
        this.lineNum = this.temps._choiceEnds[this.lineNum], this.rollbackLineCoverage(), 
        0 < this.temps._fakeChoiceDepth && this.temps._fakeChoiceDepth--; else {
            if (this.indent = indent, /^\s*#/.test(line)) throw new Error(this.lineMsg() + "It is illegal to fall out of a *choice statement; you must *goto or *finish before the end of the indented block.");
            this.runCommand(line) || (this.prevLine = "text", this.screenEmpty = !1, this.printLine(line));
        }
    } else this.paragraph();
    this.rollbackLineCoverage(), this.finished || this.autofinish(), this.save("temp"), 
    this.skipFooter ? this.skipFooter = !1 : printFooter();
}, Scene.prototype.dedent = function(newDent) {}, Scene.prototype.printLine = function(line) {
    if (!line) return null;
    line = this.replaceVariables(line.replace(/^\s*/, "")), this.accumulatedParagraph.push(line), 
    /([-\u2011-\u2014]|\[c\/\])$/.test(line) || this.accumulatedParagraph.push(" ");
}, Scene.prototype.replaceVariables = function(line) {
    line = String(line);
    for (var replacer = /([$@](\!?\!?)\{)/, index = 0, output = [], result = replacer.exec(line); result; result = replacer.exec(line.substring(index))) {
        output.push(line.substring(index, index + result.index));
        for (var curlies = 0, closingCurly = -1, exprStart = index + result.index + result[1].length, i = exprStart; i < line.length; i++) if ("{" === (c = line.charAt(i))) curlies++; else if ("}" === c) {
            if (!curlies) {
                closingCurly = i;
                break;
            }
            curlies--;
        }
        if (-1 == closingCurly) throw new Error(this.lineMsg() + "invalid " + result[0] + "} variable substitution at letter " + (index + result.index + 1));
        var stack, value, body = line.substring(exprStart, closingCurly);
        if ("$" === result[0].charAt(0)) stack = this.tokenizeExpr(body), value = this.evaluateExpr(stack); else {
            if (/^\s*\(/.test(body)) {
                for (var c, parens = 0, closingParen = -1, i = 1; i < body.length; i++) if ("(" === (c = body.charAt(i))) parens++; else if (")" === c) {
                    if (!parens) {
                        closingParen = i;
                        break;
                    }
                    parens--;
                }
                if (-1 == closingParen) throw new Error(this.lineMsg() + "invalid " + result[0] + "} at letter " + (index + result.index + 1) + "; missing closing parenthesis )");
                if (" " != body.charAt(closingParen + 1)) throw new Error(this.lineMsg() + "invalid " + result[0] + "} at letter " + (index + result.index + 1) + "; there should be a space after the closing parenthesis )");
                expr = body.substring(1, closingParen), options = body.substring(closingParen + 2).split("|");
            } else {
                if (!/^\S+ /.test(body)) throw new Error(this.lineMsg() + "invalid " + result[0] + "} at letter " + (index + result.index + 1) + "; there should be a space after the first word");
                var capitalize = body.indexOf(" "), expr = body.substring(0, capitalize), options = body.substring(capitalize + 1).split("|");
            }
            if (options.length < 2) throw new Error(this.lineMsg() + "invalid " + result[0] + "} at letter " + (index + result.index + 1) + "; there should be at least one pipe | to separate options");
            if (stack = this.tokenizeExpr(expr), (0 | (value = num(value = "boolean" == typeof (value = this.evaluateExpr(stack)) || /^(true|false)$/i.test(value) ? bool(value) ? 1 : 2 : value, this.lineNum + 1))) !== value) throw new Error(this.lineMsg() + "invalid " + result[0] + "} at letter " + (index + result.index + 1) + "; '" + expr + "' is equal to " + value + " which is not a whole integer number");
            if (value < 1) throw new Error(this.lineMsg() + "invalid " + result[0] + "} at letter " + (index + result.index + 1) + "; '" + expr + "' is equal to " + value + " which is not a positive number");
            if (value > options.length) throw new Error(this.lineMsg() + "invalid " + result[0] + "} at letter " + (index + result.index + 1) + "; '" + expr + "' is equal to " + value + " but there are only " + options.length + " options");
            value = options[value - 1], value = this.replaceVariables(value);
        }
        capitalize = result[2];
        capitalize && (value = String(value)), "!" == capitalize ? value = value.charAt(0).toUpperCase() + value.slice(1) : "!!" == capitalize && (value = value.toUpperCase()), 
        "undefined" != typeof highlightGenderPronouns && highlightGenderPronouns && /\b(he|him|his|she|her|hers)\b/gi.test(value) && output.push("​"), 
        output.push(value), index = closingCurly + 1;
    }
    return 0 === index ? line : (output.push(line.substring(index)), output.join(""));
}, Scene.prototype.paragraph = function() {
    printParagraph(this.accumulatedParagraph.join("")), this.accumulatedParagraph = [], 
    this.prevLine = "empty";
}, Scene.prototype.loadSceneFast = function(url) {
    if (!this.loading) {
        var result;
        this.loading = !0;
        var fileName, self = this;
        if ("undefined" != typeof cachedResults && cachedResults && cachedResults[this.name]) return result = window.cachedResults[this.name], 
        safeTimeout(function() {
            self.loadLinesFast(result.crc, result.lines, result.labels);
        }, 0);
        if ("undefined" != typeof allScenes) {
            if (!(result = allScenes[this.name])) throw new Error("Couldn't load scene '" + this.name + "'\nThe file doesn't exist.");
            return safeTimeout(function() {
                self.loadLinesFast(result.crc, result.lines, result.labels);
            }, 0);
        }
        if ("undefined" != typeof window && window.isIosApp && window.isFile && !window.isOmnibusApp) {
            startLoading();
            var startedWaiting = new Date().getTime();
            function retryScenes(command) {
                command = command || "retryscenes", clearScreen(function() {
                    startLoading(), "retryscenes" == command && curl(), window.downloadState = null, 
                    callIos(command), startedWaiting = new Date().getTime(), awaitAllScenes();
                });
            }
            function awaitAllScenes() {
                if ("undefined" != typeof allScenes) {
                    if (!(result = allScenes[self.name])) throw new Error("Couldn't load scene '" + self.name + "'\nThe file doesn't exist.");
                    self.loadLinesFast(result.crc, result.lines, result.labels);
                } else {
                    var retry;
                    "failed" == window.downloadState || 5e3 < new Date().getTime() - startedWaiting ? (doneLoading(), 
                    window.downloadRequired ? (self.printLine("We weren't able to download the latest version of the game."), 
                    self.paragraph(), printButton("Try Again", main, !1, retryScenes)) : (self.printLine("We weren't able to download the latest version of the game. Please try downloading again. The latest version may contain important fixes."), 
                    self.paragraph(), retry = {
                        name: "Try downloading again."
                    }, printOptions([ "" ], [ retry, {
                        name: "Continue playing without the latest version."
                    } ], function(option) {
                        option == retry ? retryScenes() : retryScenes("requestscenesforce");
                    }))) : setTimeout(awaitAllScenes, 0);
                }
            }
            return awaitAllScenes();
        }
        if (window.purchases[self.name] && isStoreSceneCacheRequired()) {
            var sceneName = this.name.replace(/ /g, "_");
            return window.store.get("cache_scene_hash_" + sceneName, function(ok, hash) {
                function keepScene(result) {
                    window.cachedResults || (window.cachedResults = {}), cachedResults[self.name] = result, 
                    self.loadLinesFast(result.crc, result.lines, result.labels);
                }
                function loadPaidScene() {
                    startLoading(), updateSinglePaidSceneCache(self.name, function(err, result) {
                        if (doneLoading(), err) {
                            if ("not registered" === err) return logout(), loginDiv(), clearScreen(function() {
                                loginForm(main, 0, "Please sign in to access this part of the game.", function() {
                                    clearScreen(loadAndRestoreGame);
                                });
                            });
                            "not purchased" === err && (err = "403x"), main.innerHTML = "<div id='text'><p>Our apologies; there was a " + err + " error while loading game data.  Please refresh now; if that doesn't work, please click the Restart button and email " + getSupportEmail() + " with details.</p> <p><button class='next' onclick='window.location.reload();'>Refresh Now</button></p></div>", 
                            curl();
                        } else keepScene(result);
                    });
                }
                ok && hash == hashes.scenes[sceneName + ".txt.json"] ? window.store.get("cache_scene_" + sceneName, function(ok, text) {
                    if (ok && text) {
                        var parsed;
                        try {
                            parsed = jsonParse(text);
                        } catch (e) {
                            window.console && console.error(e, e.stack);
                        }
                        if (parsed && parsed.crc && parsed.lines && parsed.labels) return keepScene(parsed);
                        loadPaidScene();
                    } else loadPaidScene();
                }) : loadPaidScene();
            });
        }
        startLoading(), url || (fileName = this.name.replace(/ /g, "_") + ".txt.json", url = Scene.baseUrl + "/" + fileName, 
        "https:" == window.location.protocol && window.hashes && window.hashes.scenes[fileName] && (url += "?hash=" + hashes.scenes[fileName]));
        var xhr = findXhr();
        xhr.open("GET", url, !0);
        var self = this, done = !1;
        if (xhr.onreadystatechange = function() {
            if (!done && 4 == xhr.readyState) {
                if (403 == xhr.status) try {
                    if ("not registered" == JSON.parse(xhr.responseText).error) return isRegistered(function(registered) {
                        return registered && (logout(), loginDiv()), clearScreen(function() {
                            loginForm(main, 0, "Please sign in to access this part of the game.", function() {
                                clearScreen(loadAndRestoreGame);
                            });
                        });
                    });
                } catch (e) {}
                var result;
                done = !0;
                try {
                    result = jsonParse(xhr.responseText);
                } catch (e) {
                    window.console && console.error(e, e.stack);
                }
                if (window.isWeb && (200 != xhr.status || !result)) {
                    var status = xhr.status;
                    return 200 != status && status || (status = "network"), void (main.innerHTML = "<p>Our apologies; there was a " + status + " error while loading game data.  Please refresh your browser now; if that doesn't work, please click the Restart button and email " + getSupportEmail() + " with details.</p> <p><button onclick='window.location.reload();'>Refresh Now</button></p>");
                }
                if ("" === xhr.responseText) throw new Error("Couldn't load " + url + "\nThe file is probably missing or empty.");
                window.cachedResults || (window.cachedResults = {}), cachedResults[self.name] = result, 
                self.loadLinesFast(result.crc, result.lines, result.labels);
            }
        }, isIE) xhr.send(null); else try {
            xhr.send(null);
        } catch (e) {
            if ("file:" == window.location.protocol && !window.isMobile && /Chrome/.test(navigator.userAgent)) return void window.onerror('We\'re sorry, Google Chrome has blocked ChoiceScript from functioning.  ("file:" URLs cannot load files in Chrome.)  ChoiceScript works just fine in Chrome, but only on a published website like choiceofgames.com.  For the time being, please try another browser like Mozilla Firefox.');
            window.onerror("Couldn't load URL: " + url + "\n" + e);
        }
    }
}, Scene.prototype.loadLinesFast = function(crc, lines, labels) {
    this.crc = crc, this.lines = lines, this.labels = labels, this.loading = !1, this.loaded = !0;
    var self = this;
    this.executing && safeCall(this, function() {
        doneLoading(), self.execute();
    });
}, Scene.prototype.loadScene = function() {
    if (!this.loading) {
        if (this.loading = !0, window.isFile) return this.loadFile();
        startLoading();
        var url = Scene.baseUrl + "/" + this.name + ".txt", xhr = findXhr();
        xhr.open("GET", url, !0);
        var self = this, done = !1;
        if (xhr.onreadystatechange = function() {
            if (!done && 4 == xhr.readyState) {
                if (done = !0, 403 == xhr.status) try {
                    if ("not registered" == JSON.parse(xhr.responseText).error) return isRegistered(function(registered) {
                        return registered && (logout(), loginDiv()), clearScreen(function() {
                            loginForm(main, 0, "Please sign in to access this part of the game.", function() {
                                clearScreen(loadAndRestoreGame);
                            });
                        });
                    });
                } catch (e) {}
                if (window.isWeb && 200 != xhr.status) {
                    var result = xhr.status || "network";
                    main.innerHTML = "<p>Our apologies; there was a " + result + " error while loading game data.  Please refresh your browser now; if that doesn't work, please email " + getSupportEmail() + " with details.</p> <p><button onclick='window.location.reload();'>Refresh Now</button></p>";
                } else {
                    if ("" === xhr.responseText) return "file:" == window.location.protocol && !window.isMobile && /Chrome/.test(navigator.userAgent) ? void window.onerror('We\'re sorry, Google Chrome has blocked ChoiceScript from functioning.  ("file:" URLs cannot load files in Chrome.)  ChoiceScript works just fine in Chrome, but only on a published website like choiceofgames.com.  For the time being, please try another browser like Mozilla Firefox.') : void window.onerror("Couldn't load " + url + "\nThe file is probably missing or empty.");
                    result = xhr.responseText;
                    scene = result, scene = scene.replace(/\r/g, ""), this.loading = !1, self.loadLines(scene), 
                    self.executing && safeCall(self, function() {
                        doneLoading(), self.execute();
                    });
                }
            }
        }, isIE) xhr.send(null); else try {
            xhr.send(null);
        } catch (e) {
            if ("file:" == window.location.protocol && !window.isMobile) {
                if (/Chrome/.test(navigator.userAgent)) return void window.onerror('We\'re sorry, Google Chrome has blocked ChoiceScript from functioning.  ("file:" URLs cannot load files in Chrome.)  ChoiceScript works just fine in Chrome, but only on a published website like choiceofgames.com.  For the time being, please try another browser like Mozilla Firefox.');
                if (1012 === e.code) return void window.onerror("Couldn't load scene file: " + url + "\nThe file is probably missing.");
            }
            window.onerror("Couldn't load URL: " + url + "\n" + e);
        }
    }
}, Scene.prototype.loadFile = function() {
    var _this = this;
    if ("object" != typeof uploadedFiles) clearScreen(function() {
        var header = document.getElementById("header");
        header && (header.style.display = "none");
        var makeYourOwnGames = document.getElementById("makeyourowngames");
        makeYourOwnGames && (makeYourOwnGames.style.display = "none"), _this.printLine('[b]Please "Upload" ChoiceScript[/b]'), 
        _this.paragraph(), _this.printLine('To begin, you\'ll need to grant permission to "upload" your choicescript folder containing index.html.'), 
        _this.paragraph(), _this.printLine("Use the button below to select your choicescript folder."), 
        _this.paragraph();
        var text = document.getElementById("text"), input = document.createElement("input");
        input.type = "file", input.webkitdirectory = !0, input.multiple = !0, input.addEventListener("change", function(e) {
            for (var numFiles = input.files.length, startupCandidates = [], i = 0; i < numFiles; i++) "startup.txt" === (file = input.files[i]).name && startupCandidates.push(file);
            if (!startupCandidates.length) return clearScreen(function() {
                _this.printLine("We couldn't find startup.txt in the folder you chose. Please try again."), 
                _this.paragraph(), document.getElementById("text").appendChild(input), curl();
            });
            if (1 < startupCandidates.length) return clearScreen(function() {
                _this.printLine("There were multiple files called startup.txt in the folder you chose. Please try again."), 
                _this.paragraph();
                for (var i = 0; i < startupCandidates.length; i++) _this.printLine("• " + startupCandidates[i].webkitRelativePath);
                _this.paragraph(), document.getElementById("text").appendChild(input), curl();
            });
            for (var startup = startupCandidates[0], rootDirTest = new RegExp("^" + startup.webkitRelativePath.replace(/\/startup.txt$/, "/[^/]+$")), sceneFiles = {}, i = 0; i < numFiles; i++) {
                var file = input.files[i];
                rootDirTest.test(file.webkitRelativePath) && (sceneFiles[file.name] = file);
            }
            window.uploadedFiles = sceneFiles, header && (header.style.display = ""), makeYourOwnGames && (makeYourOwnGames.style.display = ""), 
            clearScreen(function() {
                _this.loadFile();
            });
        }), text.appendChild(input), _this.paragraph(), _this.printLine("(We're not actually going to transfer your code over the Internet, but this web page needs permission to upload your choicescript folder in order to access your code and run it. The power to access your code would also grant us the power to transfer your code elsewhere, but we're not going to do that. JavaScript programmers can read our JavaScript to verify that this is true.)"), 
        _this.paragraph(), curl();
    }); else {
        var fileName = this.name + ".txt";
        if (uploadedFiles[fileName]) startLoading(), new Response(uploadedFiles[fileName]).text().then(function(result) {
            scene = result, scene = scene.replace(/\r/g, ""), _this.loading = !1, safeCall(_this, function() {
                _this.loadLines(scene), doneLoading(), _this.execute();
            });
        }); else {
            for (var otherFileName in uploadedFiles) if (fileName.toLowerCase() === otherFileName.toLowerCase()) return main.innerHTML = "<p>Couldn't find " + fileName + " in the uploaded folder, but we did find " + otherFileName + ". Scene file names must match exactly, including capitalization.</p> <p><button onclick='window.location.reload();'>Refresh Now</button></p>", 
            void curl();
            main.innerHTML = "<p>Couldn't find " + fileName + " in the uploaded folder.</p> <p><button onclick='window.location.reload();'>Refresh Now</button></p>", 
            curl();
        }
    }
}, Scene.prototype.checkSum = function() {
    if (this.temps.choice_crc) {
        if (this.randomtest || this.quicktest || this.temps.choice_crc == this.crc || !this.lineNum) return !0;
        "undefined" != typeof alertify && (initStore() ? alertify.log("The game has updated. Restarting chapter.") : alertify.log(this.name + ".txt has updated. Restarting chapter."));
        var self = this;
        return safeTimeout(function() {
            clearScreen(function() {
                loadAndRestoreGame("backup", self.name);
            });
        }, 0), !1;
    }
    return this.temps.choice_crc = this.crc, !0;
}, Scene.prototype.loadLines = function(str) {
    this.crc = crc32(str), this.lines = str.split(/\r?\n/), this.parseLabels(), this.loaded = !0;
}, Scene.prototype.execute = function() {
    if (!this.loaded) return this.executing = !0, void (Scene.generatedFast || "undefined" != typeof generatedFast && generatedFast || "undefined" != typeof allScenes ? this.loadSceneFast() : this.loadScene());
    if (this.checkSum()) {
        if (this.nav && this.nav.repairStats(stats), this.temps._choiceEnds || (this.temps._choiceEnds = {}), 
        doneLoading(), void 0 !== this.targetLabel) {
            var label = this.targetLabel.label.toLowerCase();
            if (void 0 === this.labels[label]) throw new Error(this.targetLabel.origin + " line " + (this.targetLabel.originLine + 1) + ": " + this.name + " doesn't contain label " + label);
            this.lineNum = this.labels[label], this.indent = this.getIndent(this.lines[this.lineNum]), 
            delete this.targetLabel;
        }
        this.lineNum || (this.stats.choice_subscene_stack || []).length || this.save("backup"), 
        this.redirectingFromStats && (this.save(""), delete this.redirectingFromStats), 
        this.printLoop();
    }
}, Scene.prototype.parseLabels = function() {
    var lineLength = this.lines.length, oldLineNum = this.lineNum, screenshots = "choicescript_screenshots" == this.name, seenChoiceWithoutSet = 0;
    for (this.lineNum = 0; this.lineNum < lineLength; this.lineNum++) {
        this.rollbackLineCoverage();
        var command = this.lines[this.lineNum];
        0 == this.lineNum && 65279 == command.charCodeAt(0) && (lines[0] = command.substring(1));
        var data = command.match(/^(.*)\ufffd/);
        if (data) throw new Error(this.lineMsg() + "invalid character. (ChoiceScript text should be saved in the UTF-8 encoding.) " + data[0]);
        data = /^(\s*)\*(\w+)(.*)/.exec(command);
        if (data) {
            data[1].length;
            command = data[2].toLowerCase(), data = trim(data[3]);
            if ("label" == command) {
                if (data = data.toLowerCase(), /\s/.test(data)) throw new Error(this.lineMsg() + "label '" + data + "' is not allowed to contain spaces");
                if (this.labels.hasOwnProperty(data)) throw new Error(this.lineMsg() + "label '" + data + "' already defined on line " + (+this.labels[data] + 1));
                this.labels[data] = this.lineNum;
            } else if (screenshots) if ("fake_choice" == command) {
                if (seenChoiceWithoutSet) throw new Error(this.lineMsg() + "In choicescript_screenshots, you need to *set at least one variable between *fake_choice commands, so the stat screen looks interesting. There was no *set since the last *fake_choice on line " + seenChoiceWithoutSet + ".");
                seenChoiceWithoutSet = this.lineNum + 1;
            } else "set" == command && (seenChoiceWithoutSet = 0);
        }
    }
    this.rollbackLineCoverage(), this.lineNum = oldLineNum;
}, Scene.prototype.runCommand = function(command) {
    var data = /^\s*\*(\w+)(.*)/.exec(command);
    if (!data) return !("startup" != this.secondaryMode || !this.startupCallback) && (this.finished = !0, 
    this.skipFooter = !0, this.startupCallback(), !0);
    command = data[1].toLowerCase(), data = trim(data[2]);
    if (!Scene.validCommands[command]) throw new Error(this.lineMsg() + "Non-existent command '" + command + "'");
    if ("comment" == command) return !0;
    if (Scene.initialCommands[command]) {
        if ("startup" != String(this.name).toLowerCase() || !this.initialCommands) throw new Error(this.lineMsg() + "Invalid " + command + " instruction, only allowed at the top of startup.txt");
    } else {
        if ("startup" == this.secondaryMode && this.startupCallback) return this.finished = !0, 
        this.skipFooter = !0, this.startupCallback(), !0;
        this.initialCommands = !1;
    }
    if ("choice" == command && "choicescript_screenshots" == String(this.name).toLowerCase()) throw new Error(this.lineMsg() + "choicescript_screenshots files should only contain *fake_choice commands, not real *choice commands");
    return this[command](data), !0;
}, Scene.prototype.choice = function(data) {
    for (var startLineNum = this.lineNum, groups = data.split(/ /), i = 0; i < groups.length; i++) if (!/^\w*$/.test(groups[i])) throw new Error(this.lineMsg() + "invalid choice group name: " + groups[i]);
    var options = this.parseOptions(this.indent, groups), self = this;
    if (this.renderOptions(groups, options, function(option) {
        self.standardResolution(option);
    }), this.finished = !0, 0 < this.temps._fakeChoiceDepth || this.stats.implicit_control_flow) for (this.temps._choiceEnds || (this.temps._choiceEnds = {}), 
    i = 0; i < options.length; i++) this.temps._choiceEnds[options[i].line - 1] = this.lineNum;
    this.lineNum = startLineNum;
}, Scene.prototype.fake_choice = function(data) {
    void 0 === this.temps._fakeChoiceDepth && (this.temps._fakeChoiceDepth = 0), this.temps._fakeChoiceDepth++, 
    this.choice(data);
}, Scene.prototype.standardResolution = function(option) {
    this.lineNum = option.line, this.indent = this.getIndent(this.nextNonBlankLine(!0)), 
    option.reuse && "allow" != option.reuse && (this.temps.choice_used[option.line - 1] = 1), 
    this.nav && this.nav.bugLog.push("#" + (option.line + 1) + " " + option.name), this.finished = !1, 
    this.resetPage();
}, Scene.prototype.nextNonBlankLine = function(includingThisOne) {
    var line, i = this.lineNum;
    for (includingThisOne || i++; isDefined(line = this.lines[i]) && !trim(line); ) i++;
    return line;
}, Scene.prototype.previousNonBlankLineNum = function() {
    for (var line, i = this.lineNum - 1; isDefined(line = this.lines[i]) && !trim(line); ) i--;
    return i;
}, Scene.prototype.resetCheckedPurchases = function() {
    for (var temp in this.temps) /^choice_purchased/.test(temp) && delete this.temps[temp];
}, Scene.prototype.resetPage = function() {
    var self = this;
    this.resetCheckedPurchases(), clearScreen(function() {
        self.save(""), self.prevLine = "empty", self.screenEmpty = !0, self.execute();
    });
}, Scene.prototype.save = function(slot) {
    if (this.saveSlot) transferTempStatWrites(); else {
        if (!slot) {
            for (var key in slot = "", tempStatWrites) tempStatWrites.hasOwnProperty(key) && (this.stats[key] = tempStatWrites[key]);
            tempStatWrites = {};
        }
        saveCookie(function() {}, slot, this.stats, this.temps, this.lineNum, this.indent, this.debugMode, this.nav);
    }
}, Scene.prototype.goto = function(label) {
    label = /[\[\{]/.test(label) ? this.evaluateReference(this.tokenizeExpr(label)) : String(label).toLowerCase();
    if (void 0 === this.labels[label]) throw new Error(this.lineMsg() + "bad label " + label);
    this.lineNum = this.labels[label], this.indent = this.getIndent(this.lines[this.lineNum]);
}, Scene.prototype.gosub = function(rest) {
    for (var label = /\S+/.exec(rest)[0], rest = rest.substring(label.length + 1), args = [], stack = this.tokenizeExpr(rest); stack.length; ) args.push(this.evaluateValueToken(stack.shift(), stack));
    this.temps.choice_substack || (this.temps.choice_substack = []), this.temps.choice_substack.push({
        lineNum: this.lineNum,
        indent: this.indent
    }), this.temps.param = args, this.goto(label);
}, Scene.prototype.gosub_scene = function(data) {
    this.stats.choice_subscene_stack || (this.stats.choice_subscene_stack = []), this.stats.choice_subscene_stack.push({
        name: this.name,
        lineNum: this.lineNum + 1,
        indent: this.indent,
        temps: this.temps
    }), this.goto_scene(data);
}, Scene.prototype.params = function(data) {
    var words = /\w+/.exec(data), nextParamNum = 1;
    for (this.temps.param_count = this.temps.param.length; words; ) {
        var varName = words[0];
        if (this.validateVariable(varName), this.temps.param.length < 1) throw new Error(this.lineMsg() + "No parameter passed for " + varName);
        var paramVal = this.temps.param.shift();
        this.temps[varName] = paramVal, this.temps["param_" + nextParamNum] = paramVal, 
        nextParamNum++, data = data.substring(varName.length + 1), words = /\w+/.exec(data);
    }
    for (;0 < this.temps.param.length; ) {
        paramVal = this.temps.param.shift();
        this.temps["param_" + nextParamNum] = paramVal, nextParamNum++;
    }
}, Scene.prototype.return = function() {
    var stackFrame;
    if (this.temps.choice_substack && this.temps.choice_substack.length) stackFrame = this.temps.choice_substack.pop(), 
    this.lineNum = stackFrame.lineNum, this.indent = stackFrame.indent; else {
        if (!this.stats.choice_subscene_stack || !this.stats.choice_subscene_stack.length) throw this.temps.choice_substack || this.stats.choice_subscene_stack ? new Error(this.lineMsg() + "invalid return; we've already returned from the last gosub") : new Error(this.lineMsg() + "invalid return; gosub has not yet been called");
        if ((stackFrame = this.stats.choice_subscene_stack.pop()).name == this.name) return this.temps = stackFrame.temps, 
        this.lineNum = stackFrame.lineNum - 1, void (this.indent = stackFrame.indent);
        this.finished = !0, this.skipFooter = !0;
        var scene = new Scene(stackFrame.name, this.stats, this.nav, {
            debugMode: this.debugMode,
            secondaryMode: this.secondaryMode,
            saveSlot: this.saveSlot
        });
        scene.temps = stackFrame.temps, scene.screenEmpty = this.screenEmpty, scene.prevLine = this.prevLine, 
        scene.lineNum = stackFrame.lineNum, scene.indent = stackFrame.indent, scene.accumulatedParagraph = this.accumulatedParagraph, 
        this.randomtest ? clearScreen(function() {
            scene.execute();
        }) : scene.execute();
    }
}, Scene.prototype.gotoref = function(value) {
    value = this.tokenizeExpr(value), value = this.evaluateExpr(value);
    this.goto(value);
}, Scene.prototype.finish = function(buttonName) {
    this.paragraph(), this.finished = !0;
    var self = this;
    if ("stats" == this.secondaryMode) return "undefined" == typeof window || "choicescript_stats" == window.forcedScene || window.isAndroidApp && window.statsMode.get() ? void 0 : void printButton(buttonName || "Next", main, !1, function() {
        clearScreen(loadAndRestoreGame);
    });
    var nextSceneName = this.nav && nav.nextSceneName(this.name);
    nextSceneName ? this.screenEmpty ? this.goto_scene(nextSceneName) : (buttonName = this.replaceVariables(buttonName = buttonName || "Next Chapter"), 
    printButton(buttonName, main, !1, function() {
        safeCall(self, function() {
            new Scene(nextSceneName, self.stats, self.nav, {
                debugMode: self.debugMode,
                secondaryMode: self.secondaryMode
            }).resetPage();
        });
    }), this.debugMode && println(toJson(this.stats))) : this.secondaryMode || this.ending();
}, Scene.prototype.autofinish = function(buttonName) {
    this.finish(buttonName);
}, Scene.prototype.reset = function() {
    this.nav.resetStats(this.stats), this.stats.scene = this;
}, Scene.prototype.parseGotoScene = function(data) {
    var sceneName, label, stack, param = [];
    if (/[\[\{]/.test(data)) for (stack = this.tokenizeExpr(data), sceneName = this.evaluateReference(stack, {
        toLowerCase: !1
    }), stack.length && (label = this.evaluateReference(stack)); stack.length; ) param.push(this.evaluateValueToken(stack.shift(), stack)); else {
        var match = /(\S+)\s+(\S+)\s*(.*)/.exec(data);
        if (match) for (sceneName = match[1], label = match[2], stack = this.tokenizeExpr(match[3]); stack.length; ) param.push(this.evaluateValueToken(stack.shift(), stack)); else {
            if ("" === data) throw new Error(this.lineMsg() + "missing scene name");
            sceneName = data;
        }
    }
    return {
        sceneName: sceneName,
        label: label,
        param: param
    };
}, Scene.prototype.goto_scene = function(scene) {
    var result = this.parseGotoScene(scene);
    if (result.sceneName == this.name) return void 0 === result.label ? this.lineNum = -1 : this.goto(result.label), 
    this.temps = {
        choice_reuse: "allow",
        choice_user_restored: !1,
        _choiceEnds: {}
    }, this.temps.param = result.param, void (this.initialCommands = !0);
    this.finished = !0, this.skipFooter = !0;
    scene = new Scene(result.sceneName, this.stats, this.nav, {
        debugMode: this.debugMode,
        secondaryMode: this.secondaryMode,
        saveSlot: this.saveSlot
    });
    scene.screenEmpty = this.screenEmpty, scene.prevLine = this.prevLine, scene.accumulatedParagraph = this.accumulatedParagraph, 
    void 0 !== result.label && (scene.targetLabel = {
        label: result.label,
        origin: this.name,
        originLine: this.lineNum
    }), void 0 !== result.param && (scene.temps.param = result.param), this.redirectingFromStats && (scene.redirectingFromStats = !0), 
    scene.execute();
}, Scene.prototype.redirect_scene = function(data) {
    if ("stats" != this.secondaryMode) throw new Error(this.lineMsg() + "The *redirect_scene command can only be used from the stats screen.");
    var sceneName, label, args = trim(data).split(/ /);
    1 == args.length ? sceneName = data : (sceneName = args[0], label = args[1]), this.finished = !0, 
    this.skipFooter = !0;
    var self = this;
    redirectFromStats(sceneName, label, this.lineNum, function() {
        delete self.secondaryMode, delete self.saveSlot, self.redirectingFromStats = !0, 
        self.goto_scene(data);
    });
}, Scene.prototype.product = function(productId) {
    if (!/^[a-z]+$/.test(productId)) throw new Error(this.lineMsg() + "Invalid product id: " + productId);
    this.nav && (this.nav.products[productId] = {});
}, Scene.prototype.restore_purchases = function(data) {
    var self = this, button = (button = this.target) || document.getElementById("text"), button = printButton("Restore Purchases", button, !1, function() {
        safeCall(self, function() {
            restorePurchases(null, function() {
                self.goto(data), self.finished = !1, self.resetPage();
            });
        });
    });
    setClass(button, ""), this.prevLine = "block";
}, Scene.prototype.check_purchase = function(data) {
    this.finished = !0, this.skipFooter = !0;
    for (var self = this, productList = data.split(/ /), i = 0; i < productList.length; i++) {
        var product = productList[i];
        if (!this.nav.products[product] && "adfree" != product) throw new Error(this.lineMsg() + "The product " + product + " wasn't declared in a *product command");
    }
    checkPurchase(data, function(ok, result) {
        self.finished = !1, self.skipFooter = !1, ok || (result = {
            billingSupported: !0
        }, self.temps.choice_purchase_error = !0), result = result || {};
        for (var products = data.split(/ /), everything = !0, i = 0; i < products.length; i++) {
            var purchasedProduct = result[products[i]] || !1;
            (self.temps["choice_purchased_" + products[i]] = purchasedProduct) || (everything = !1);
        }
        self.temps.choice_purchased_everything = everything, self.temps.choice_purchase_supported = !!result.billingSupported, 
        self.execute();
    });
}, Scene.prototype.parsePurchase = function(data) {
    var result;
    if (/^\{/.test(data)) {
        try {
            result = JSON.parse(data);
        } catch (e) {
            throw new Error(this.lineMsg() + "Couldn't parse purchase JSON: " + e);
        }
        if (!result.product) throw new Error(this.lineMsg() + "JSON missing product");
        if (!result.goto) throw new Error(this.lineMsg() + "JSON missing goto");
        if (result.priceGuess && result.discount) throw new Error(this.lineMsg() + "JSON has both top-level priceGuess and discount; there should be one or the other");
        if (!result.priceGuess && !result.discount) throw new Error(this.lineMsg() + "JSON has neither top-level priceGuess nor discount; there should be one or the other");
        if (result.discount) {
            if (!result.discount.end) throw new Error(this.lineMsg() + "JSON discount doesn't include end");
            if (result.discount.end = parseDateStringInCurrentTimezone(result.discount.end, this.lineNum + 1), 
            !result.discount.lowPrice) throw new Error(this.lineMsg() + "JSON discount doesn't include lowPrice");
            if (!/^\$/.test(result.discount.lowPrice)) throw new Error(this.lineMsg() + "lowPrice " + fullPriceGuess + "doesn't start with dollar");
            if (!result.discount.fullPrice) throw new Error(this.lineMsg() + "JSON discount doesn't include fullPrice");
            if (!/^\$/.test(result.discount.fullPrice)) throw new Error(this.lineMsg() + "fullPrice " + fullPriceGuess + "doesn't start with dollar");
        }
        result.title || (result.title = "It");
    } else {
        var product = /^(\w+)\s+(\S+)\s+(.*)/.exec(data);
        if (!product) throw new Error(this.lineMsg() + "invalid line; can't parse purchaseable product: " + data);
        result = {
            product: product[1],
            priceGuess: product[2],
            goto: product[3],
            title: "It"
        };
    }
    product = result.product;
    if (!this.nav.products[product] && "adfree" != product) throw new Error(this.lineMsg() + "The product " + product + " wasn't declared in a *product command");
    if (void 0 === this.temps["choice_purchased_" + product]) throw new Error(this.lineMsg() + "Didn't check_purchases on this page");
    return result;
}, Scene.prototype.purchase = function(parsed) {
    parsed = this.parsePurchase(parsed);
    parsed.discount ? this.buyButtonDiscount(parsed.product, parsed.discount.end, parsed.discount.fullPrice, parsed.discount.lowPrice, parsed.goto, parsed.title) : this.buyButton(parsed.product, parsed.priceGuess, parsed.goto, parsed.title);
}, Scene.prototype.buyButton = function(product, priceGuess, label, title) {
    this.finished = !0, this.skipFooter = !0;
    var self = this;
    getPrice(product, function(target) {
        var buttonText;
        target && "free" != target ? ("guess" == target && (target = priceGuess + " USD"), 
        buttonText = self.getVar("choice_prerelease") ? "Pre-Order " + title : "Buy " + title + " Now", 
        "hide" != target && (buttonText += " for " + target), target = (target = self.target) || document.getElementById("text"), 
        self.paragraph(), printButton(buttonText, target, !1, function() {
            safeCall(self, function() {
                purchase(product, function() {
                    safeCall(self, function() {
                        self.goto(label), self.finished = !1, self.resetPage();
                    });
                });
            });
        }), self.prevLine = "block", isRestorePurchasesSupported() && (self.prevLine = "text", 
        printLink(printParagraph("If you've already purchased, click here to "), "#", "restore purchases", function(e) {
            preventDefault(e), safeCall(self, function() {
                restorePurchases(product, function(purchased) {
                    purchased ? (self.goto(label), self.finished = !1, self.resetPage()) : clearScreen(function() {
                        loadAndRestoreGame("", window.forcedScene);
                    });
                });
            });
        })), self.skipFooter = !1, self.finished = !1, self.execute()) : (self.goto(label), 
        self.finished = !1, self.resetPage());
    });
}, Scene.prototype.purchase_discount = function(line) {
    this.paragraph();
    var startsWithDollar = trim(String(line)).split(" ");
    if (5 != startsWithDollar.length) throw new Error(this.lineMsg() + "expected five arguments, saw " + startsWithDollar.length + ": " + line);
    var product = startsWithDollar[0], expectedEndDate = parseDateStringInCurrentTimezone(startsWithDollar[1], this.lineNum + 1), fullPriceGuess = this.replaceVariables(startsWithDollar[2]), discountedPriceGuess = this.replaceVariables(startsWithDollar[3]), label = startsWithDollar[4], startsWithDollar = /^\$/;
    if (!startsWithDollar.test(fullPriceGuess)) throw new Error(this.lineMsg() + "full price guess " + fullPriceGuess + "doesn't start with dollar: " + line);
    if (!startsWithDollar.test(discountedPriceGuess)) throw new Error(this.lineMsg() + "discounted price guess " + discountedPriceGuess + "doesn't start with dollar: " + line);
    this.buyButtonDiscount(product, expectedEndDate, fullPriceGuess, discountedPriceGuess, label, "It");
}, Scene.prototype.buyButtonDiscount = function(product, expectedEndDate, priceGuess, discountedPriceGuess, label, title) {
    var discountText = this.getVar("choice_prerelease") ? "[b]Buy now before the price increases![/b]" : "[b]On sale until " + shortMonthStrings[expectedEndDate.getMonth() + 1] + " " + expectedEndDate.getDate() + "! Buy now before the price increases![/b]";
    "undefined" != typeof printDiscount && printDiscount(product, expectedEndDate.getYear() + 1900, expectedEndDate.getMonth() + 1, expectedEndDate.getDate(), discountText), 
    priceGuess = new Date().getTime() < expectedEndDate.getTime() ? discountedPriceGuess : priceGuess, 
    this.buyButton(product, priceGuess, label, title);
}, Scene.prototype.print_discount = function(dayOfMonth) {
    var discountText = /(\w+) (\d{4})-(\d{2})-(\d{2}) (.*$)/.exec(dayOfMonth);
    if (!discountText) throw new Error("invalid discount: " + dayOfMonth);
    var product = discountText[1], fullYear = discountText[2], oneBasedMonthNumber = parseInt(discountText[3], 10), dayOfMonth = parseInt(discountText[4], 10), discountText = discountText[5];
    this.temps.choice_discount_ends = "POISONTOKEN", discountText = this.replaceVariables(discountText).replace("POISONTOKEN", "${choice_discount_ends}"), 
    delete this.temps.choice_discount_ends, "undefined" != typeof printDiscount && printDiscount(product, fullYear, oneBasedMonthNumber, dayOfMonth, discountText);
}, Scene.prototype.abort = function() {
    this.paragraph(), this.finished = !0;
}, Scene.prototype.create = function(line) {
    var value = /^(\w*)(.*)/.exec(line);
    if (!value) throw new Error(this.lineMsg() + "Invalid create instruction, no variable specified: " + line);
    var variable = value[1];
    this.validateVariable(variable);
    var variable = variable.toLowerCase(), token = value[2], value = this.tokenizeExpr(token);
    if (0 === value.length) throw new Error(this.lineMsg() + "Invalid create instruction, no value specified: " + line);
    var self = this;
    function complexError() {
        throw new Error(self.lineMsg() + "Invalid create instruction, value must be a a number, true/false, or a quoted string: " + line);
    }
    1 < value.length && complexError();
    token = value[0];
    if (/STRING|NUMBER|VAR/.test(token.name) || complexError(), "VAR" != token.name || /^true|false$/i.test(token.value) || complexError(), 
    "STRING" == token.name && /(\$|@)!?!?{/.test(token.value)) throw new Error(this.lineMsg() + "Invalid create instruction, value must be a simple string without ${} or @{}: " + line);
    value = this.evaluateExpr(value);
    if (this.created || (this.created = {}), this.created[variable]) throw new Error(this.lineMsg() + "Invalid create. " + variable + " was previously created on line " + this.created[variable]);
    this.created[variable] = this.lineNum + 1, this.stats[variable] = value, this.nav && (this.nav.startingStats[variable] = value);
}, Scene.prototype.temp = function(variable) {
    var value = /^(\w*)(.*)/.exec(variable);
    if (!value) throw new Error(this.lineMsg() + "Invalid temp instruction, no variable specified: " + variable);
    variable = value[1];
    this.validateVariable(variable);
    value = value[2], value = this.tokenizeExpr(value);
    0 !== value.length ? (value = this.evaluateExpr(value), void 0 !== this.stats[variable.toLowerCase()] && this.warning("This is a temp, but we already ran *create " + variable), 
    this.temps[variable.toLowerCase()] = value) : this.temps[variable.toLowerCase()] = null;
}, Scene.prototype.getVar = function(variable) {
    var value;
    if ((variable = String(variable).toLowerCase()) && !isNaN(+variable) && String(+variable) === variable) return +variable;
    if ("true" == variable) return !0;
    if ("false" == variable) return !1;
    if ("choice_subscribe_allowed" == variable) return !0;
    if ("choice_register_allowed" == variable) return isRegisterAllowed();
    if ("choice_registered" == variable) return "undefined" != typeof window && !!window.registered;
    if ("choice_is_web" == variable) return "undefined" != typeof window && !!window.isWeb;
    if ("choice_is_steam" == variable) return "undefined" != typeof window && !!window.isSteamApp;
    if ("choice_is_ios_app" == variable) return "undefined" != typeof window && !!window.isIosApp;
    if ("choice_is_android_app" == variable) return "undefined" != typeof window && !!window.isAndroidApp;
    if ("choice_is_omnibus_app" == variable) return "undefined" != typeof window && !!window.isOmnibusApp;
    if ("choice_is_amazon_app" == variable) return "undefined" != typeof window && !!window.isAmazonApp;
    if ("choice_is_advertising_supported" == variable) return "undefined" != typeof isAdvertisingSupported && !!isAdvertisingSupported();
    if ("choice_is_trial" == variable) return !("undefined" == typeof isTrial || !isTrial);
    if ("choice_release_date" == variable) return "undefined" != typeof window && window.releaseDate ? simpleDateTimeFormat(window.releaseDate) : "release day";
    if ("choice_prerelease" == variable) return isPrerelease();
    if ("choice_kindle" == variable) return "undefined" != typeof isKindle && !!isKindle;
    if ("choice_randomtest" == variable) return !!this.randomtest;
    if ("choice_quicktest" == variable) return !1;
    if ("choice_restore_purchases_allowed" == variable) return isRestorePurchasesSupported();
    if ("choice_save_allowed" == variable) return areSaveSlotsSupported();
    if ("choice_time_stamp" == variable) return Math.floor(new Date() / 1e3);
    if ("choice_nightmode" == variable) return "undefined" != typeof isNightMode && isNightMode();
    if (!this.temps.hasOwnProperty(variable)) {
        if (!this.stats.hasOwnProperty(variable)) throw new Error(this.lineMsg() + "Non-existent variable '" + variable + "'");
        if (null == (value = this.stats[variable])) throw new Error(this.lineMsg() + "Variable '" + variable + "' exists but has no value");
        return this.debugMode && println("stats[" + variable + "]==" + value), value;
    }
    if (null == (value = this.temps[variable])) throw new Error(this.lineMsg() + "Variable '" + variable + "' exists but has no value");
    return this.debugMode && println("temps[" + variable + "]==" + value), value;
}, Scene.prototype.setVar = function(variable, value) {
    if (variable = variable.toLowerCase(), this.debugMode && println(variable + "=" + value), 
    void 0 === this.temps[variable]) {
        if (void 0 === this.stats[variable]) throw new Error(this.lineMsg() + "Non-existent variable '" + variable + "'");
        this.stats[variable] = value, "temp" == this.saveSlot && (tempStatWrites[variable] = value), 
        "implicit_control_flow" == variable && this.nav && (this.nav.startingStats.implicit_control_flow = value);
    } else this.temps[variable] = value;
}, Scene.prototype.delete = function(variable) {
    if (variable = variable.toLowerCase(), void 0 === this.temps[variable]) {
        if (void 0 === this.stats[variable]) throw new Error(this.lineMsg() + "Non-existent variable '" + variable + "'");
        delete this.stats[variable];
    } else delete this.temps[variable];
}, Scene.prototype.parseOptions = function(startIndent, choicesRemaining, expectedSubOptions) {
    var previousSubOptions, prevOption, ifResult, nextIndent = null, options = [], choiceEnds = [], currentChoice = (currentChoice = choicesRemaining[0]) || "choice", suboptionsEncountered = !1, bodyExpected = !1, namesEncountered = {}, atLeastOneSelectableOption = !1, self = (this.lineNum, 
    this);
    function removeModifierCommand(closingParen) {
        if (closingParen) {
            closingParen = line.indexOf("(") + 1, closingParen = matchBracket(line, "()", closingParen);
            if (-1 == closingParen) throw new Error(self.lineMsg() + "missing closing parenthesis");
            line = trim(line.substr(closingParen + 1));
        } else line = trim(line.replace(/^\s*\*(\w+)(.*)/, "$2"));
        (parsed = /^\s*\*(\w+)(.*)/.exec(line)) ? (command = parsed[1].toLowerCase(), data = trim(parsed[2])) : command = "";
    }
    for (;isDefined(line = this.lines[++this.lineNum]); ) if (trim(line)) {
        var reuse = this.getIndent(line);
        if (null == nextIndent) {
            if (reuse <= startIndent) throw new Error(this.lineMsg() + "invalid indent, expected at least one '" + currentChoice + "'");
            this.indent = nextIndent = reuse;
        }
        if (reuse <= startIndent) break;
        if (reuse < this.indent && (this.dedent(reuse), this.indent = reuse), reuse > this.indent) {
            if (1 < choicesRemaining.length) throw new Error(this.lineMsg() + "invalid indent, there were subchoices remaining: [" + choicesRemaining.join(",") + "]");
            this.rollbackLineCoverage(), bodyExpected = !1;
        } else {
            options.length && ((prevOption = options[options.length - 1]).endLine || (prevOption.endLine = this.lineNum));
            var parsed = /^\s*\*(\w+)(.*)/.exec(line), unselectable = !1, inlineIf = null, selectableIf = null, self = this, reuse = this.temps.choice_reuse;
            if (parsed) {
                var command = parsed[1].toLowerCase(), data = trim(parsed[2]);
                if ("hide_reuse" == command && (reuse = "hide", removeModifierCommand()), "disable_reuse" == command && (reuse = "disable", 
                removeModifierCommand()), "allow_reuse" == command && (reuse = "allow", removeModifierCommand()), 
                "random_weight" == command && removeModifierCommand(!0), "print" == command) line = this.evaluateExpr(this.tokenizeExpr(data)); else if ("if" == command) {
                    if (choiceEnds.push(this.lineNum), !(ifResult = this.parseOptionIf(data, command))) {
                        this.if(data, !0);
                        continue;
                    }
                    if (inlineIf = ifResult.condition, !ifResult.result) continue;
                    line = ifResult.line;
                } else {
                    if (/^(else|elseif|elsif)$/.test(command)) {
                        this[command](data, !0);
                        continue;
                    }
                    if ("selectable_if" == command) {
                        if (!(ifResult = this.parseOptionIf(data, command))) throw new Error(this.lineMsg() + "Couldn't parse the line after *selectable_if: " + data);
                        line = ifResult.line, selectableIf = ifResult.condition, unselectable = unselectable || !ifResult.result;
                    } else {
                        if ("comment" == command) continue;
                        if (command) throw Scene.validCommands[command] ? new Error(this.lineMsg() + "Invalid indent? Expected an #option here, not *" + command) : new Error(this.lineMsg() + "Non-existent command '" + command + "'");
                    }
                }
            }
            if ("allow" != reuse && (this.temps.choice_used || (this.temps.choice_used = {}), 
            this.temps.choice_used[this.lineNum])) {
                if ("hide" == reuse) continue;
                unselectable = !0;
            }
            if (!/^\s*\#\s*\S/.test(line)) throw new Error(this.lineMsg() + "Expected option starting with #");
            this.replaceVariables(line);
            var line, option = {
                name: line = trim(trim(line).substring(1)),
                group: currentChoice
            };
            if ("allow" != reuse && (option.reuse = reuse), this.displayOptionConditions) {
                option.displayIf = [];
                for (var i = 0; i < this.displayOptionConditions.length; i++) option.displayIf[i] = this.displayOptionConditions[i];
                inlineIf && option.displayIf.push(inlineIf);
            } else inlineIf && (option.displayIf = [ inlineIf ]);
            selectableIf && (option.selectableIf = selectableIf), option.line = this.lineNum + 1, 
            unselectable && (option.unselectable = !0), namesEncountered[line] ? this.conflictingOptions(this.lineMsg() + "Invalid option; conflicts with option '" + option.name + "' on line " + namesEncountered[line]) : namesEncountered[line] = option.line, 
            options.push(option), 1 < choicesRemaining.length ? (option.suboptions = this.parseOptions(this.indent, choicesRemaining.slice(1), previousSubOptions), 
            this.indent = nextIndent, previousSubOptions = previousSubOptions || option.suboptions, 
            suboptionsEncountered = !0) : bodyExpected = !0, unselectable || (atLeastOneSelectableOption = !0);
        }
    } else this.rollbackLineCoverage();
    if (1 < choicesRemaining.length && !suboptionsEncountered) throw new Error(this.lineMsg() + "invalid indent, there were subchoices remaining: [" + choicesRemaining.join(",") + "]");
    if (bodyExpected && (void 0 === this.temps._fakeChoiceDepth || this.temps._fakeChoiceDepth < 1)) throw new Error(this.lineMsg() + "Expected choice body");
    for (atLeastOneSelectableOption || this.conflictingOptions(this.lineMsg() + "No selectable options"), 
    expectedSubOptions && this.verifyOptionsMatch(expectedSubOptions, options), this.rollbackLineCoverage(), 
    prevOption = options[options.length - 1], this.lineNum = this.previousNonBlankLineNum(), 
    prevOption.endLine || (prevOption.endLine = this.lineNum + 1), i = 0; i < choiceEnds.length; i++) this.temps._choiceEnds[choiceEnds[i]] = this.lineNum;
    return this.rollbackLineCoverage(), options;
}, Scene.prototype.parseOptionIf = function(result) {
    var parsed = /^\s*\((.*)\)\s+(#.*)/.exec(result);
    if (parsed) {
        var condition = parsed[1], result = this.tokenizeExpr(condition), result = this.evaluateExpr(result);
        return this.debugMode && println(condition + " :: " + result), {
            result: result = (result = bool(result, this.lineNum + 1)) || this.testPath,
            line: parsed[2],
            condition: null
        };
    }
}, Scene.prototype.conflictingOptions = function(str) {
    throw new Error(str);
}, Scene.prototype.verifyOptionsMatch = function(prev, current) {
    function findMatch(name, options) {
        for (var i = 0; i < options.length; i++) {
            var option = options[i];
            if (option && name == option.name) return option;
        }
        return null;
    }
    for (var prevOpt, curOpt, i = 0; i < prev.length; i++) if (!(curOpt = findMatch((prevOpt = prev[i]).name, current))) throw new Error(this.lineMsg() + "Missing expected suboption '" + prevOpt.name + "'; all suboptions must have same option list");
    if (prev.length != current.length) {
        for (i = 0; i < current.length; i++) if (!(prevOpt = findMatch((curOpt = current[i]).name, prev))) throw new Error(this.lineMsg() + "Added unexpected suboption '" + curOpt.name + "'; all suboptions must have same option list");
        throw new Error(this.lineMsg() + "Bug? previous options and current options mismatch, but no particular missing element");
    }
}, Scene.prototype.renderOptions = function(groups, options, callback) {
    var self = this;
    !function replaceVars(options) {
        for (var i = 0; i < options.length; i++) {
            var option = options[i];
            option.name = self.replaceVariables(option.name), option.suboptions && replaceVars(option.suboptions);
        }
    }(options), this.paragraph(), printOptions(groups, options, callback), this.debugMode && println(toJson(this.stats)), 
    this.finished && printFooter();
}, Scene.prototype.page_break = function(buttonName) {
    var self;
    this.screenEmpty || (buttonName = this.replaceVariables(buttonName = buttonName || "Next"), 
    this.paragraph(), this.finished = !0, self = this, printButton(buttonName, main, !1, function() {
        self.finished = !1, self.resetPage();
    }), this.debugMode && println(toJson(this.stats)));
}, Scene.prototype.line_break = function() {
    this.accumulatedParagraph.length ? this.accumulatedParagraph.push("[n/]") : println();
}, Scene.prototype.image = function(data, invert) {
    this.paragraph();
    var dataImageVal, dataImage = !1;
    (data = data || "").match(/data:image/) && (data = 0 <= (alt = data.indexOf(" ")) ? (dataImageVal = data.substring(0, alt), 
    "CSIDE_DATA_IMG.png" + data.slice(alt)) : (dataImageVal = data, "CSIDE_DATA_IMG.png"), 
    dataImage = !0), data = this.replaceVariables(data);
    var source, alignment, match = /(\S+) (\S+)(.*)/.exec(data), alt = null;
    if (match ? (source = match[1], alignment = match[2], alt = trim(match[3])) : source = data, 
    "" === source) throw new Error(this.lineMsg() + "*image requires the file name of an image");
    if ("CSIDE_DATA_IMG.png" === source && (source = dataImageVal), !/(right|left|center|none)/.test(alignment = alignment || "center")) throw new Error(this.lineMsg() + "Invalid alignment, expected right, left, center, or none: " + data);
    printImage(source, alignment, alt, invert), this.verifyImage && !dataImage && this.verifyImage(source), 
    "none" == alignment && (this.prevLine = "text"), this.screenEmpty = !1;
}, Scene.prototype.text_image = function(data) {
    this.image(data, "invert");
}, Scene.prototype.sound = function(source) {
    "function" == typeof playSound && playSound(source), this.verifyImage && this.verifyImage(source);
}, Scene.prototype.kindle_image = function() {}, Scene.prototype.youtube = function(slug) {
    "undefined" != typeof printYoutubeFrame && (printYoutubeFrame(slug), this.prevLine = "block", 
    this.screenEmpty = !1);
}, Scene.prototype.kindle_search = Scene.prototype.kindle_product = function(query) {
    var buttonName = /^\((.+)\) ([^\)]+)/.exec(query);
    if (!buttonName) throw new Error(this.lineMsg() + "Invalid arguments: " + query);
    query = buttonName[1], buttonName = buttonName[2];
    "undefined" != typeof kindleButton && kindleButton(this.target, query, buttonName);
}, Scene.prototype.link = function(href) {
    var anchorText = /^(\S+)\s*(.*)/.exec(href);
    if (!anchorText) throw new Error(this.lineMsg() + "invalid line; this line should have an URL: " + href);
    href = anchorText[1].replace(/\]/g, "%5D"), anchorText = trim(anchorText[2]) || href;
    this.printLine("[url=" + href + "]" + anchorText + "[/url]"), this.prevLine = "text", 
    this.screenEmpty = !1;
}, Scene.prototype.link_button = function(anchorText) {
    if ("undefined" != typeof window) {
        var target = /^(\S+)\s*(.*)/.exec(anchorText);
        if (!target) throw new Error(this.lineMsg() + "invalid line; this line should have an URL: " + anchorText);
        var href = target[1], anchorText = trim(target[2]) || href;
        this.paragraph();
        target = (target = this.target) || document.getElementById("text");
        printButton(anchorText, target, !1, function() {
            window.location.href = href;
        }), this.prevLine = "empty", this.screenEmpty = !1;
    }
}, Scene.prototype.getIndent = function(len) {
    if (null == len) return 0;
    var tab = len.match(/^([ \t]*)/);
    if (null == tab) return 0;
    var space = tab[0], len = space.length;
    if (0 === len) return 0;
    tab = /\t/.test(space), space = / /.test(space);
    if (tab && space) throw new Error(this.lineMsg() + "Tabs and spaces appear on the same line");
    if (tab) {
        if (this.firstTab = this.lineNum + 1, this.firstSpace) throw new Error(this.lineMsg() + "Illegal mixing of spaces and tabs; this line has a tab, but there were spaces on line " + this.firstSpace);
    } else if (this.firstSpace = this.lineNum + 1, this.firstTab) throw new Error(this.lineMsg() + "Illegal mixing of spaces and tabs; this line has a space, but there were tabs on line " + this.firstTab);
    return len;
}, Scene.prototype.comment = function(line) {
    this.debugMode && println("*comment " + line);
}, Scene.prototype.advertisement = function() {
    var self;
    "undefined" != typeof isFullScreenAdvertisingSupported && isFullScreenAdvertisingSupported() && (this.finished = !0, 
    this.skipFooter = !0, self = this, showFullScreenAdvertisement(function() {
        self.finished = !1, self.skipFooter = !1, self.resetPage();
    }));
}, Scene.prototype.looplimit_count = 1e3, Scene.prototype.looplimit = function(count) {
    this.looplimit_count = num(count, this.lineNum);
}, Scene.prototype.hide_reuse = function() {
    this.temps.choice_reuse = "hide";
}, Scene.prototype.disable_reuse = function() {
    this.temps.choice_reuse = "disable";
}, Scene.prototype.allow_reuse = function() {
    this.temps.choice_reuse = "allow";
}, Scene.prototype.label = function() {}, Scene.prototype.print = function(value) {
    value = this.evaluateExpr(this.tokenizeExpr(value));
    this.prevLine = "text", this.screenEmpty = !1, this.printLine(value);
}, Scene.prototype.parseInputText = function(variable) {
    var stack = this.tokenizeExpr(variable), variable = this.evaluateReference(stack);
    if (void 0 === this.temps[variable] && void 0 === this.stats[variable]) throw new Error(this.lineMsg() + "Non-existent variable '" + variable + "'");
    for (var inputOptions = {
        long: !1,
        allow_blank: !1
    }, i = 0; i < stack.length; i++) {
        var option = stack[i];
        if ("VAR" !== option.name) throw new Error(this.lineMsg() + "Couldn't understand this input_text line");
        option = option.value;
        if (void 0 === inputOptions[option]) throw new Error(this.lineMsg() + "Couldn't understand this input_text option: " + option);
        inputOptions[option] = !0;
    }
    return {
        variable: variable,
        inputOptions: inputOptions
    };
}, Scene.prototype.input_text = function(result) {
    var result = this.parseInputText(result), variable = result.variable;
    this.finished = !0, this.paragraph();
    var self = this;
    printInput(this.target, result.inputOptions, function(value) {
        safeCall(self, function() {
            value = (value = trim(String(value))).replace(/\n/g, "[n/]"), self.nav && self.nav.bugLog.push("*input_text " + variable + " " + value), 
            self.finished = !1, self.setVar(variable, value), self.resetPage();
        });
    }), this.debugMode && println(toJson(this.stats));
}, Scene.prototype.input_number = function(simpleConstants) {
    var stack = this.tokenizeExpr(simpleConstants);
    if (!stack.length) throw new Error(this.lineMsg() + "Invalid input_number statement, expected three args: varname min max");
    var variable = this.evaluateReference(stack);
    if (void 0 === this.temps[variable] && void 0 === this.stats[variable]) throw new Error(this.lineMsg() + "Non-existent variable '" + variable + "'");
    if (simpleConstants = 2 == stack.length && "NUMBER" == stack[0].name && "NUMBER" == stack[1].name, 
    !stack.length) throw new Error(this.lineMsg() + "Invalid input_number statement, expected three args: varname min max");
    var minimum = this.evaluateValueToken(stack.shift(), stack);
    if (isNaN(+minimum)) throw new Error(this.lineMsg() + "Invalid minimum, not numeric: " + minimum);
    if (!stack.length) throw new Error(this.lineMsg() + "Invalid input_number statement, expected three args: varname min max");
    var intRequired, maximum = this.evaluateValueToken(stack.shift(), stack);
    if (stack.length) throw new Error(this.lineMsg() + "Invalid input_number statement, expected three args: varname min max");
    if (isNaN(+maximum)) throw new Error(this.lineMsg() + "Invalid maximum, not numeric: " + maximum);
    if ((!this.quicktest || simpleConstants) && parseFloat(minimum) > parseFloat(maximum)) throw new Error(this.lineMsg() + "Minimum " + minimum + " should not be greater than maximum " + maximum);
    function isInt(x) {
        var y = parseInt(x, 10);
        return !isNaN(y) && (x == y && x.toString() == y.toString());
    }
    isInt(minimum) && isInt(maximum) && (intRequired = 1), this.finished = !0, this.paragraph();
    var self = this;
    printInput(this.target, {
        numeric: !0
    }, function(value) {
        safeCall(self, function() {
            var numValue = parseFloat("" + value);
            isNaN(numValue) ? asyncAlert("Please type in a number.") : !intRequired || isInt(value) ? numValue < +minimum ? asyncAlert("Please use a number greater than or equal to " + minimum) : +maximum < numValue && !this.quicktest ? asyncAlert("Please use a number less than or equal to " + maximum) : (self.nav && self.nav.bugLog.push("*input_number " + variable + " " + value), 
            self.finished = !1, self.setVar(variable, numValue), self.resetPage()) : asyncAlert("Please type in an integer number.");
        });
    }, minimum, maximum, intRequired), this.debugMode && println(toJson(this.stats));
}, Scene.prototype.script = function script(code) {
    var stats = this.stats, temps = this.temps;
    try {
        "undefined" == typeof window ? function() {
            var window = _global;
            eval(code);
        }.call(this) : eval(code);
    } catch (e) {
        throw new Error(this.lineMsg() + "error executing *script: " + e + (e.stack ? "\n" + e.stack : ""));
    }
}, Scene.prototype.validateVariable = function(variable) {
    if (!variable || !/^[a-zA-Z]/.test(variable)) throw new Error(this.lineMsg() + "Invalid variable name, must start with a letter: " + variable);
    if (!/^\w+$/.test(variable)) throw new Error(this.lineMsg() + "Invalid variable name: '" + variable + "'");
    if (/^(and|or|true|false|scene|scenename)$/i.test(variable)) throw new Error(this.lineMsg() + "Invalid variable name, '" + variable + "' is a reserved word");
    if (/^choice_/.test(variable)) throw new Error(this.lineMsg() + "Invalid variable name, variables may not start with 'choice_'; this is a reserved prefix");
}, Scene.prototype.rand = function(result) {
    var random = this.tokenizeExpr(result);
    if (!random.length) throw new Error(this.lineMsg() + "Invalid rand statement, expected three args: varname min max");
    var variable = this.evaluateReference(random);
    if (void 0 === this.temps[variable] && void 0 === this.stats[variable]) throw new Error(this.lineMsg() + "Non-existent variable '" + variable + "'");
    if (!random.length) throw new Error(this.lineMsg() + "Invalid rand statement, expected three args: varname min max");
    var minimum = this.evaluateValueToken(random.shift(), random);
    if (!random.length) throw new Error(this.lineMsg() + "Invalid rand statement, expected three args: varname min max");
    var maximum = this.evaluateValueToken(random.shift(), random);
    if (random.length) throw new Error(this.lineMsg() + "Invalid rand statement, expected three args: varname min max");
    if (result = maximum - minimum, isNaN(result)) throw new Error(this.lineMsg() + "Invalid rand statement, min and max must be numbers");
    if (result < 0) throw new Error(this.lineMsg() + "Invalid rand statement, min must be less than max: " + minimum + " > " + maximum);
    function isInt(x) {
        var y = parseInt(x, 10);
        return !isNaN(y) && (x == y && x.toString() == y.toString());
    }
    0 != result ? (random = Math.random(), result = isInt(minimum) && isInt(maximum) ? +minimum + Math.floor(random * (1 + result)) : +minimum + random * result, 
    this.setVar(variable, result), this.randomLog && this.randomLog("*rand " + variable + " " + result), 
    this.nav && this.nav.bugLog.push("*rand " + variable + " " + result)) : this.setVar(variable, minimum);
}, Scene.prototype.set = function(line) {
    var value = this.tokenizeExpr(line), variable = this.evaluateReference(value);
    if (void 0 === this.temps[variable] && void 0 === this.stats[variable]) throw new Error(this.lineMsg() + "Non-existent variable '" + variable + "'");
    if (0 === value.length) throw new Error(this.lineMsg() + "Invalid set instruction, no expression specified: " + line);
    /OPERATOR|FAIRMATH/.test(value[0].name) && value.unshift({
        name: "VAR",
        value: variable,
        pos: "(implicit)"
    });
    value = this.evaluateExpr(value);
    this.setVar(variable, value);
}, Scene.prototype.setref = function(variable) {
    var value = this.tokenizeExpr(variable), variable = this.evaluateValueToken(value.shift(), value), variable = String(variable).toLowerCase();
    if (void 0 === this.temps[variable] && void 0 === this.stats[variable]) throw new Error(this.lineMsg() + "Non-existent variable '" + variable + "'");
    /OPERATOR|FAIRMATH/.test(value[0].name) && value.unshift({
        name: "VAR",
        value: variable,
        pos: "(implicit)"
    });
    value = this.evaluateExpr(value);
    this.setVar(variable, value);
}, Scene.prototype.share_this_game = function(now) {
    now = !!trim(now), this.paragraph(), printShareLinks(this.target, now), this.prevLine = "empty";
}, Scene.prototype.more_games = function(button) {
    var self;
    "undefined" != typeof window && "undefined" != typeof moreGames && (trim(button) ? moreGames() : ((self = this).paragraph(), 
    button = (button = this.target) || document.getElementById("text"), button = printButton("Play More Games Like This", button, !1, function() {
        safeCall(self, moreGames);
    }), setClass(button, ""), this.prevLine = "block"));
}, Scene.prototype.ending = function() {
    var self;
    "undefined" != typeof window && (this.paragraph(), options = [], options.push({
        name: "Play again.",
        group: "choice",
        restart: !0
    }), window.isOmnibusApp || options.push({
        name: "Play more games like this.",
        group: "choice",
        moreGames: !0
    }), options.push({
        name: "Share this game with friends.",
        group: "choice",
        share: !0
    }), options.push({
        name: "Email me when new games are available.",
        group: "choice",
        subscribe: !0
    }), self = this, function endingMenu() {
        printFollowButtons(), self.renderOptions([ "" ], options, function(option) {
            return option.restart ? restartGame() : void (option.moreGames ? (self.more_games("now"), 
            "undefined" != typeof curl && curl()) : option.share ? clearScreen(function() {
                self.share_this_game("now"), endingMenu();
            }) : option.subscribe && subscribeLink());
        });
    }(), this.finished = !0);
}, Scene.prototype.restart = function() {
    if (delayBreakEnd(), this.secondaryMode) {
        if ("stats" != this.secondaryMode) throw new Error(this.lineMsg() + "Cannot *restart in " + this.secondaryMode + " mode");
        this.reset(), this.redirect_scene(this.nav.getStartupScene());
    } else restartGame();
    this.finished = !0;
}, Scene.prototype.subscribe = function(data) {
    this.paragraph();
    var options = {};
    if (data) try {
        options = JSON.parse(data);
    } catch (e) {
        throw new Error(this.lineMsg() + "Couldn't parse subscribe arguments: " + data);
    }
    this.prevLine = "block", this.finished = !0, this.skipFooter = !0;
    var self = this;
    subscribe(this.target, options, function(now) {
        self.finished = !1, now ? (self.skipFooter = !1, self.execute()) : self.resetPage();
    });
}, Scene.prototype.restore_game = function(data) {
    var cancelLabel;
    if (data) {
        var result = /^cancel=(\S+)$/.exec(data);
        if (!result) throw new Error(this.lineMsg() + "invalid restore_game line: " + data);
        cancelLabel = result[1];
    }
    this.finished = !0, this.skipFooter = !0;
    var self = this, unrestorableScenes = this.parseRestoreGame(!1);
    getDirtySaveList(function(dirtySaveList) {
        getSaves(function(saveList) {
            !function renderRestoreMenu(saveList, dirtySaveList) {
                self.paragraph();
                for (var options = [], i = 0; i < saveList.length; i++) {
                    var name, save = saveList[i], date = new Date(+save.timestamp);
                    save && (name = "", save.temps && save.temps.choice_restore_name && (name = save.temps.choice_restore_name), 
                    options.push({
                        name: name + " (" + simpleDateTimeFormat(date) + ")",
                        group: "choice",
                        state: save
                    }));
                }
                options.push({
                    name: "Retrieve saved games online from choiceofgames.com.",
                    group: "choice",
                    fetch: !0
                }), dirtySaveList.length && options.push({
                    name: "Upload saved games to choiceofgames.com.",
                    group: "choice",
                    upload: !0
                }), options.push({
                    name: "Cancel.",
                    group: "choice",
                    cancel: !0
                });
                self.renderOptions([ "" ], options, function(unrestorable) {
                    if (unrestorable.upload) clearScreen(function() {
                        fetchEmail(function(defaultEmail) {
                            self.printLine("Please type your email address to identify yourself."), self.paragraph(), 
                            promptEmailAddress(this.target, defaultEmail, "allowContinue", function(cancel, email) {
                                return cancel ? (self.finished = !1, void 0 !== cancelLabel && self.goto(cancelLabel), 
                                void self.resetPage()) : void clearScreen(function() {
                                    startLoading(), submitDirtySaves(dirtySaveList, email, function(count) {
                                        doneLoading(), self.prevLine = "text", count ? (count = dirtySaveList.length + (1 == dirtySaveList.length ? " save" : " saves"), 
                                        self.printLine("Uploaded " + count + "."), renderRestoreMenu(saveList, [])) : (self.printLine("Error uploading saves. Please try again later."), 
                                        renderRestoreMenu(saveList, dirtySaveList));
                                    });
                                });
                            });
                        });
                    }); else if (unrestorable.fetch) clearScreen(function() {
                        fetchEmail(function(defaultEmail) {
                            self.printLine("Please type your email address to identify yourself."), self.paragraph(), 
                            promptEmailAddress(this.target, defaultEmail, "allowContinue", function(cancel, email) {
                                return cancel ? (self.finished = !1, void 0 !== cancelLabel && self.goto(cancelLabel), 
                                void self.resetPage()) : void clearScreen(function() {
                                    startLoading(), getRemoteSaves(email, function(remoteSaveList) {
                                        doneLoading(), self.prevLine = "text", remoteSaveList ? mergeRemoteSaves(remoteSaveList, "recordDirty", function(saveList, newRemoteSaves, dirtySaveList) {
                                            var downloadCount;
                                            remoteSaveList.length ? (downloadCount = remoteSaveList.length + " saved " + (1 == remoteSaveList.length ? "game" : "games"), 
                                            self.printLine("Synchronized " + downloadCount + ". Downloaded " + newRemoteSaves + " new saved " + (1 == newRemoteSaves ? "game" : "games") + ".")) : self.printLine('No saves downloaded for email address "' + email + "\". (Is that the correct email address?) If you're having trouble, please contact support at " + getSupportEmail() + "."), 
                                            renderRestoreMenu(saveList, dirtySaveList);
                                        }) : (self.printLine("Error downloading saves. Please try again later."), renderRestoreMenu(saveList, dirtySaveList));
                                    });
                                });
                            });
                        });
                    }); else if (unrestorable.password) clearScreen(function() {
                        self.restore_password();
                    }); else if (unrestorable.cancel) self.finished = !1, void 0 !== cancelLabel && self.goto(cancelLabel), 
                    self.resetPage(); else {
                        var state = unrestorable.state, unrestorable = null;
                        if (state.stats && state.stats.sceneName && (unrestorable = ("" + state.stats.sceneName).toLowerCase()), 
                        unrestorable = unrestorableScenes[unrestorable]) return asyncAlert(unrestorable), 
                        self.finished = !1, void self.resetPage();
                        saveCookie(function() {
                            clearScreen(function() {
                                restoreGame(state, null, !0);
                            });
                        }, "", state.stats, state.temps, state.lineNum, state.indent, this.debugMode, this.nav);
                    }
                });
            }(saveList, dirtySaveList);
        });
    });
}, Scene.prototype.restore_password = function() {
    var alreadyFinished = this.finished;
    this.finished = !0, this.paragraph(), this.printLine('Please paste your password here, then press "Next" below to continue.'), 
    this.prevLine = "text", this.paragraph();
    var self = this, unrestorableScenes = this.parseRestoreGame(alreadyFinished);
    getPassword(this.target, function(cancel, unrestorable) {
        if (cancel) return self.finished = !1, void self.resetPage();
        unrestorable = (unrestorable = unrestorable.replace(/\s/g, "")).replace(/^.*BEGINPASSWORD-----/, "");
        var state, unrestorable = self.deobfuscatePassword(unrestorable);
        unrestorable = (unrestorable = unrestorable.replace(/^[^\{]*/, "")).replace(/[^\}]*$/, "");
        try {
            state = jsonParse(unrestorable);
        } catch (e) {
            return void asyncAlert("Sorry, that password was invalid. Please contact " + getSupportEmail() + " for assistance. Be sure to include your password in the email.");
        }
        unrestorable = null;
        state.stats && state.stats.sceneName && (unrestorable = ("" + state.stats.sceneName).toLowerCase());
        unrestorable = unrestorableScenes[unrestorable];
        if (unrestorable) return asyncAlert(unrestorable), self.finished = !1, void self.resetPage();
        saveCookie(function() {
            clearScreen(function() {
                restoreGame(state, null, !1);
            });
        }, "", state.stats, state.temps, state.lineNum, state.indent, this.debugMode, this.nav);
    }), alreadyFinished && printFooter();
}, Scene.prototype.parseRestoreGame = function(alreadyFinished) {
    alreadyFinished && (this.lineNum--, this.rollbackLineCoverage());
    for (var nextIndent = null, unrestorableScenes = {}, startIndent = this.indent; isDefined(sceneName = this.lines[++this.lineNum]); ) if (trim(sceneName)) {
        var error = this.getIndent(sceneName);
        if (null == nextIndent && startIndent < error && (this.indent = nextIndent = error), 
        error <= startIndent) return alreadyFinished || (this.lineNum--, this.rollbackLineCoverage()), 
        unrestorableScenes;
        if (error != this.indent) throw new Error(this.lineMsg() + "invalid indent, expected " + this.indent + ", was " + error);
        var sceneName = trim(sceneName), error = /^(\w+)\s+(.*)/.exec(sceneName);
        if (!error) throw new Error(this.lineMsg() + "invalid line; this line should have a scene name followed by an error message: " + sceneName);
        sceneName = error[1].toLowerCase(), error = trim(error[2]);
        unrestorableScenes[sceneName] = error;
    } else this.rollbackLineCoverage();
    return alreadyFinished || (this.lineNum--, this.rollbackLineCoverage()), unrestorableScenes;
}, Scene.prototype.check_registration = function() {
    var self;
    "undefined" != typeof window && "undefined" != typeof isRegistered && (this.finished = !0, 
    this.skipFooter = !0, self = this, isRegistered(function() {
        self.finished = !1, self.skipFooter = !1, self.execute();
    }));
}, Scene.prototype.login = function(optional) {
    if ("undefined" != typeof window && "undefined" != typeof loginForm) {
        if (optional = trim(optional)) {
            if ("optional" != optional) throw new Error(this.lineMsg() + "invalid *login option: " + optional);
            optional = 1;
        }
        var self = this;
        this.finished = !0, this.skipFooter = !0, this.paragraph();
        var target = (target = this.target) || document.getElementById("text");
        loginForm(target, optional, null, function() {
            clearScreen(function() {
                self.finished = !1, self.prevLine = "empty", self.screenEmpty = !0, self.execute();
            });
        });
    }
}, Scene.prototype.save_game = function(destinationSceneName) {
    if (!destinationSceneName) throw new Error(this.lineMsg() + "*save_game requires a destination file name, e.g. *save_game Episode2");
    var self;
    this.temps.choice_user_restored || ((self = this).finished = !0, this.skipFooter = !0, 
    fetchEmail(function(target) {
        self.paragraph();
        var form = document.createElement("form");
        setClass(form, "saveGame"), form.action = "#";
        var message = document.createElement("div");
        message.style.color = "red", message.style.fontWeight = "bold", form.appendChild(message);
        var saveName = document.createElement("input");
        saveName.type = "text", saveName.name = "saveName", saveName.setAttribute("placeholder", "Type a name for your saved game"), 
        saveName.setAttribute("style", "display:block; font-size: 25px; width: 90%; margin: 1rem 0"), 
        form.appendChild(saveName);
        println("Please login to the choiceofgames.com save system with your email address below.", form);
        var emailInput = document.createElement("input");
        try {
            emailInput.type = "email";
        } catch (e) {}
        emailInput.name = "email", emailInput.value = target, emailInput.setAttribute("placeholder", "you@example.com"), 
        emailInput.setAttribute("style", "display:block; font-size: 25px; width: 90%; margin: 1rem 0"), 
        form.appendChild(emailInput);
        target = document.createElement("label");
        target.setAttribute("for", "subscribeBox");
        var subscribeBox = document.createElement("input");
        subscribeBox.type = "checkbox", subscribeBox.name = "subscribe", subscribeBox.setAttribute("id", "subscribeBox"), 
        subscribeBox.setAttribute("checked", !0), target.appendChild(subscribeBox), target.appendChild(document.createTextNode("Email me when new games are available.")), 
        form.appendChild(target);
        target = this.target;
        (target = target || document.getElementById("text")).appendChild(form), printButton("Next", form, !0), 
        printButton("Cancel", target, !1, function() {
            clearScreen(function() {
                self.finished = !1, self.prevLine = "empty", self.screenEmpty = !0, self.execute();
            });
        }), form.onsubmit = function(e) {
            preventDefault(e), safeCall(this, function() {
                var messageText;
                if (!trim(saveName.value)) return messageText = document.createTextNode("Please type a name for your saved game."), 
                message.innerHTML = "", void message.appendChild(messageText);
                var stat, slot = "save" + new Date().getTime(), saveStats = {};
                for (stat in self.stats) "scene" != stat && (saveStats[stat] = self.stats[stat]);
                saveStats.scene = {
                    name: destinationSceneName
                };
                var subscribe = subscribeBox.checked && window.isHeartsChoice ? "hc" : "cog", email = trim(emailInput.value);
                if (!/^\S+@\S+\.\S+$/.test(email)) return messageText = document.createTextNode('Sorry, "' + email + '" is not an email address.  Please type your email address again.'), 
                message.innerHTML = "", void message.appendChild(messageText);
                recordEmail(email, function() {
                    clearScreen(function() {
                        saveCookie(function() {
                            recordSave(slot, function() {
                                startLoading(), submitRemoteSave(slot, email, subscribe, function(ok) {
                                    doneLoading(), ok ? (self.finished = !1, self.prevLine = "empty", self.screenEmpty = !0, 
                                    self.execute()) : asyncAlert("Couldn't upload your saved game to choiceofgames.com. You can try again later from the Restore menu.", function() {
                                        self.finished = !1, self.prevLine = "empty", self.screenEmpty = !0, self.execute();
                                    });
                                });
                            });
                        }, slot, saveStats, {
                            choice_reuse: "allow",
                            choice_user_restored: !0,
                            choice_restore_name: saveName.value
                        }, 0, 0, !1, self.nav);
                    });
                });
            });
        }, printFooter();
    }));
}, Scene.prototype.show_password = function() {
    var password;
    this.temps.choice_user_restored || (this.paragraph(), "undefined" == typeof window || window.isMobile || (this.printLine('Please copy and paste the password in a safe place, then press "Next" below to continue.'), 
    println("", this.target), println("", this.target)), password = computeCookie(this.stats, this.temps, this.lineNum, this.indent), 
    password = this.obfuscate(password), showPassword(this.target, password), this.prevLine = "block");
}, Scene.prototype.obfuscate = function(password) {
    var self = this;
    return password.replace(/./g, function(x) {
        return self.obfuscator[x];
    });
}, Scene.prototype.obfuscator = {
    " ": "k",
    "!": "E",
    '"': "`",
    "#": "\\",
    $: "r",
    "%": "J",
    "&": "o",
    "'": "0",
    "(": "Z",
    ")": "M",
    "*": "G",
    "+": "t",
    ",": "Y",
    "-": "f",
    ".": "2",
    "/": "!",
    0: "i",
    1: "*",
    2: "1",
    3: "3",
    4: "[",
    5: "6",
    6: "v",
    7: '"',
    8: "F",
    9: "9",
    ":": "{",
    ";": "Q",
    "<": "?",
    "=": "5",
    ">": "#",
    "?": "K",
    "@": "/",
    A: "=",
    B: "N",
    C: "z",
    D: "$",
    E: "W",
    F: "(",
    G: ")",
    H: "q",
    I: "C",
    J: "+",
    K: "U",
    L: ".",
    M: "H",
    N: "B",
    O: "S",
    P: "X",
    Q: "I",
    R: "-",
    S: "m",
    T: "D",
    U: "^",
    V: "A",
    W: "a",
    X: "y",
    Y: ",",
    Z: "d",
    "[": "O",
    "\\": "s",
    "]": "8",
    "^": "sVii6h",
    _: "]",
    "`": "sViivi",
    a: "4",
    b: "g",
    c: "%",
    d: "w",
    e: "h",
    f: "n",
    g: "b",
    h: "7",
    i: "x",
    j: "~",
    k: "_",
    l: "l",
    m: ":",
    n: "c",
    o: "L",
    p: "j",
    q: "u",
    r: "R",
    s: "}",
    t: "p",
    u: "V",
    v: "P",
    w: "'",
    x: "T",
    y: "|",
    z: "@",
    "{": "e",
    "|": 'sVii"%',
    "}": ";",
    "~": 'sVii"h'
}, Scene.prototype.deobfuscator = {
    k: " ",
    E: "!",
    "`": '"',
    "\\": "#",
    r: "$",
    J: "%",
    o: "&",
    0: "'",
    Z: "(",
    M: ")",
    G: "*",
    t: "+",
    Y: ",",
    f: "-",
    2: ".",
    "!": "/",
    i: "0",
    "*": "1",
    1: "2",
    3: "3",
    "[": "4",
    6: "5",
    v: "6",
    '"': "7",
    F: "8",
    9: "9",
    "{": ":",
    Q: ";",
    "?": "<",
    5: "=",
    "#": ">",
    K: "?",
    "/": "@",
    "=": "A",
    N: "B",
    z: "C",
    $: "D",
    W: "E",
    "(": "F",
    ")": "G",
    q: "H",
    C: "I",
    "+": "J",
    U: "K",
    ".": "L",
    H: "M",
    B: "N",
    S: "O",
    X: "P",
    I: "Q",
    "-": "R",
    m: "S",
    D: "T",
    "^": "U",
    A: "V",
    a: "W",
    y: "X",
    ",": "Y",
    d: "Z",
    O: "[",
    s: "\\",
    8: "]",
    "]": "_",
    4: "a",
    g: "b",
    "%": "c",
    w: "d",
    h: "e",
    n: "f",
    b: "g",
    7: "h",
    x: "i",
    "~": "j",
    _: "k",
    l: "l",
    ":": "m",
    c: "n",
    L: "o",
    j: "p",
    u: "q",
    R: "r",
    "}": "s",
    p: "t",
    V: "u",
    P: "v",
    "'": "w",
    T: "x",
    "|": "y",
    "@": "z",
    e: "{",
    ";": "}"
}, Scene.prototype.deobfuscatePassword = function(password) {
    var self = this;
    return password = password.replace(/./g, function(x) {
        return self.deobfuscator[x];
    });
}, Scene.prototype.stat_chart = function() {
    this.paragraph();
    var rows = this.parseStatChart(), target = (target = this.target) || document.getElementById("text"), barWidth = 0, standardFontSize = 0;
    function fixFontSize(span1, actual) {
        var newSize;
        standardFontSize = standardFontSize || (window.getComputedStyle ? parseInt(getComputedStyle(document.body).fontSize, 10) : document.body.currentStyle ? parseInt(document.body.currentStyle.fontSize, 10) : 16), 
        barWidth = barWidth || span1.parentNode.offsetWidth, actual = actual ? (newSize = barWidth / 2 - 1, 
        Math.max(span1.offsetWidth, actual.offsetWidth)) : (newSize = barWidth, span1.offsetWidth), 
        newSize < actual && (newSize = Math.floor(standardFontSize * newSize / actual), 
        span1.parentNode.style.fontSize = newSize + "px", !window.getComputedStyle || newSize < (actual = parseInt(getComputedStyle(span1).fontSize, 10)) && (span1.parentNode.style.fontSize = (newSize *= newSize / actual) + "px"));
    }
    for (i = 0; i < rows.length; i++) {
        var div, span, statValue, row = rows[i], type = row.type, label = row.variable, value = this.evaluateExpr(this.tokenizeExpr(label)), label = this.replaceVariables(row.label);
        this.replaceVariables(row.definition || "");
        if ("text" == type) div = document.createElement("div"), setClass(div, "statText"), 
        span = document.createElement("span"), trim(label) || trim(value) ? printx(label + ": " + value, span) : printx(" ", span), 
        div.appendChild(span), target.appendChild(div); else if ("percent" == type) div = document.createElement("div"), 
        setClass(div, "statBar statLine"), span = document.createElement("span"), printx("  " + label + ": " + value + "%", span), 
        div.appendChild(span), statValue = document.createElement("div"), setClass(statValue, "statValue"), 
        statValue.style.width = value + "%", statValue.innerHTML = "&nbsp;", div.appendChild(statValue), 
        target.appendChild(div), fixFontSize(span); else {
            if ("opposed_pair" != type) throw new Error("Bug! Parser accepted an unknown row type: " + type);
            div = document.createElement("div"), setClass(div, "statBar statLine opposed"), 
            span0 = document.createElement("span"), printx("  " + label + ": " + value + "% ", span0), 
            div.appendChild(span0), (span = document.createElement("span")).setAttribute("style", "float: right"), 
            printx(this.replaceVariables(row.opposed_label) + ": " + (100 - value) + "%  ", span), 
            div.appendChild(span), statValue = document.createElement("div"), setClass(statValue, "statValue"), 
            statValue.style.width = value + "%", statValue.innerHTML = "&nbsp;", div.appendChild(statValue), 
            target.appendChild(div), fixFontSize(span0, span);
        }
    }
    this.prevLine = "block", this.screenEmpty = !1;
}, Scene.prototype.parseStatChart = function() {
    for (var line1, line2, line2indent, nextIndent = null, rows = [], startIndent = this.indent; isDefined(line4 = this.lines[++this.lineNum]); ) if (trim(line4)) {
        var line4indent = this.getIndent(line4);
        if (null == nextIndent) {
            if (line4indent <= startIndent) throw new Error(this.lineMsg() + "invalid indent, expected at least one row");
            this.indent = nextIndent = line4indent;
        }
        if (line4indent <= startIndent) return this.rollbackLineCoverage(), this.lineNum = this.previousNonBlankLineNum(), 
        this.rollbackLineCoverage(), rows;
        if (line4indent != this.indent) throw new Error(this.lineMsg() + "invalid indent, expected " + this.indent + ", was " + line4indent);
        var line4 = trim(line4), result = /^(text|percent|opposed_pair)\s+(.*)/.exec(line4);
        if (!result) throw new Error(this.lineMsg() + "invalid line; this line should start with 'percent', 'text', or 'opposed_pair'");
        var variable, label, type = result[1].toLowerCase(), data = trim(result[2]);
        if ("opposed_pair" == type) {
            if (this.getVar(data), line1 = this.lines[++this.lineNum], this.replaceVariables(line1), 
            line1indent = this.getIndent(line1), line1indent <= this.indent) throw new Error(this.lineMsg() + "invalid indent; expected at least one indented line to indicate opposed pair name. indent: " + line1indent + ", expected greater than " + this.indent);
            if (line2 = this.lines[this.lineNum + 1], (line2indent = this.getIndent(line2)) <= this.indent) rows.push({
                type: type,
                variable: data,
                label: data,
                opposed_label: trim(line1)
            }); else if (this.lineNum++, this.replaceVariables(line2), line2indent == line1indent) rows.push({
                type: type,
                variable: data,
                label: trim(line1),
                opposed_label: trim(line2)
            }); else {
                if (!(line2indent > line1indent)) throw new Error(this.lineMsg() + "invalid indent; expected a second line with indent " + line1indent + " to match line " + this.lineNum + ", or else no more opposed_pair lines");
                var line3 = this.lines[++this.lineNum];
                this.replaceVariables(line3);
                line4indent = this.getIndent(line3);
                if (line4indent != line1indent) throw new Error(this.lineMsg() + "invalid indent; this line should be the opposing label name. expected " + line1indent + " was " + line4indent);
                line4 = this.lines[++this.lineNum];
                this.replaceVariables(line4);
                line4indent = this.getIndent(line4);
                if (line4indent != line2indent) throw new Error(this.lineMsg() + "invalid indent; this line should be the opposing label definition. expected " + line2indent + " was " + line4indent);
                rows.push({
                    type: type,
                    variable: data,
                    label: trim(line1),
                    definition: trim(line2),
                    opposed_label: trim(line3),
                    opposed_definition: trim(line4)
                });
            }
        } else {
            if (/ /.test(data)) if (/^\(/.test(data)) {
                for (var parens = 0, closingParen = -1, i = 1; i < data.length; i++) {
                    var c = data.charAt(i);
                    if ("(" === c) parens++; else if (")" === c) {
                        if (!parens) {
                            closingParen = i;
                            break;
                        }
                        parens--;
                    }
                }
                if (-1 == closingParen) throw new Error(this.lineMsg() + "missing closing parenthesis");
                variable = data.substring(1, closingParen), "" === (label = trim(data.substring(closingParen + 1))) && (label = variable);
            } else {
                if (!(result = /^(\S+) (.*)/.exec(data))) throw new Error(this.lineMsg() + "Bug! can't find a space when a space was found");
                variable = result[1], label = result[2];
            } else label = variable = data;
            this.evaluateExpr(this.tokenizeExpr(variable)), this.replaceVariables(label), line2 = this.lines[this.lineNum + 1], 
            (line2indent = this.getIndent(line2)) <= this.indent ? rows.push({
                type: type,
                variable: variable,
                label: label
            }) : (this.lineNum++, this.replaceVariables(line2), rows.push({
                type: type,
                variable: variable,
                label: label,
                definition: trim(line2)
            }));
        }
    } else this.rollbackLineCoverage();
    return rows;
}, Scene.prototype.timer = function(target) {
    var end;
    if ("release" == target) {
        if ("undefined" == typeof window || !window.releaseDate) return;
        end = window.releaseDate / 1e3;
    } else end = Date.parse(target) / 1e3;
    new Date() / 1e3 < end && ((target = this.target) || (target = document.createElement("p"), 
    document.getElementById("text").appendChild(target)), showTicker(target, end, function() {
        clearScreen(loadAndRestoreGame());
    }));
}, Scene.prototype.delay_break = function(durationInSeconds) {
    if (isNaN(+durationInSeconds)) throw new Error(this.lineMsg() + "invalid duration");
    this.finished = !0, this.skipFooter = !0;
    var target = this.target;
    target || (target = document.createElement("p"), document.getElementById("text").appendChild(target)), 
    this.paragraph();
    var self = this;
    delayBreakStart(function(delayStart) {
        window.blockRestart = !0, showTicker(target, +durationInSeconds + +delayStart, function() {
            printButton("Next", target, !1, function() {
                delayBreakEnd(), self.finished = !1, self.resetPage();
            });
        }), printFooter();
    });
}, Scene.prototype.delay_ending = function(args) {
    if ("undefined" != typeof window && window.isSteamApp) return this.ending();
    var args = args.split(/ /), durationInSeconds = args[0], fullPriceGuess = args[1], singleUsePriceGuess = args[2];
    if (isNaN(+durationInSeconds)) throw new Error(this.lineMsg() + "invalid duration");
    if (!/^\$/.test(fullPriceGuess)) throw new Error(this.lineMsg() + 'invalid fullPriceGuess: "' + fullPriceGuess + '"');
    if (singleUsePriceGuess && !/^\$/.test(singleUsePriceGuess)) throw new Error(this.lineMsg() + 'invalid singleUsePriceGuess: "' + singleUsePriceGuess + '"');
    this.finished = !0, this.skipFooter = !0;
    var self = this;
    checkPurchase("adfree", function(ok, result) {
        !result.adfree && result.billingSupported ? getPrice("adfree", function(fullPrice) {
            "guess" == fullPrice && (fullPrice = fullPriceGuess), getPrice("skiponce", function(singleUsePrice) {
                "guess" == singleUsePrice && (singleUsePrice = singleUsePriceGuess), options = [];
                options.push({
                    name: "Play again after a short wait. ",
                    unselectable: !0
                });
                var upgradeSkip = {
                    name: "Upgrade to the unlimited version for " + fullPrice + " to skip the wait forever."
                };
                options.push(upgradeSkip);
                var skipOnce = {
                    name: "Skip the wait one time for " + singleUsePrice + "."
                };
                singleUsePriceGuess && options.push(skipOnce);
                var restorePurchasesOption = {
                    name: "Restore purchases from another device."
                };
                isRestorePurchasesSupported() && options.push(restorePurchasesOption);
                var playMoreGames = {
                    name: "Play more games like this."
                };
                options.push(playMoreGames);
                var emailMe = {
                    name: "Email me when new games are available."
                };
                function restartNow() {
                    window.blockRestart = !1, restartGame();
                }
                options.push(emailMe), self.paragraph(), printOptions([ "" ], options, function(option) {
                    if (option == playMoreGames) self.more_games("now"), "undefined" != typeof curl && curl(); else if (option == emailMe) subscribeLink(); else if (option == upgradeSkip) purchase("adfree", restartNow); else if (option == skipOnce) purchase("skiponce", restartNow); else {
                        if (option != restorePurchasesOption) return restartGame();
                        restorePurchases("adfree", function() {
                            clearScreen(loadAndRestoreGame);
                        });
                    }
                });
                var target = document.querySelector(".choice label");
                delayBreakStart(function(delayStart) {
                    window.blockRestart = !0, showTicker(target, +durationInSeconds + +delayStart, function() {
                        clearScreen(function() {
                            self.ending();
                        });
                    }), printFooter();
                });
            });
        }) : self.ending();
    });
}, Scene.prototype.if = function(line) {
    var result = this.tokenizeExpr(line), result = this.evaluateExpr(result);
    this.debugMode && println(line + " :: " + result), (result = bool(result, this.lineNum + 1)) ? this.indent = this.getIndent(this.nextNonBlankLine()) : this.skipTrueBranch(!1);
}, Scene.prototype.skipTrueBranch = function(inElse) {
    for (var startIndent = this.indent, nextIndent = null; isDefined(line = this.lines[++this.lineNum]); ) if (this.rollbackLineCoverage(), 
    trim(line)) {
        var parsed, indent = this.getIndent(line);
        if (null == nextIndent) {
            if (indent <= startIndent) throw new Error(this.lineMsg() + "invalid indent, expected at least one line in 'if' true block");
            nextIndent = indent;
        }
        if (indent <= startIndent) {
            if (!(parsed = indent == startIndent ? /^\s*\*(\w+)(.*)/.exec(line) : parsed) || inElse) return this.lineNum = this.previousNonBlankLineNum(), 
            this.rollbackLineCoverage(), void (this.indent = indent);
            var command = parsed[1].toLowerCase(), data = trim(parsed[2]);
            if ("else" == command) {
                if (data) {
                    if (/^if\b/.test(data)) throw new Error(this.lineMsg() + "'else if' is invalid, use 'elseif'");
                    throw new Error(this.lineMsg() + "nothing should appear on a line after 'else': " + data);
                }
                this.lineNum = this.lineNum, this.indent = this.getIndent(this.nextNonBlankLine());
            } else /^else?if$/.test(command) ? (this.lineNum = this.lineNum, this.if(data)) : (this.lineNum = this.previousNonBlankLineNum(), 
            this.rollbackLineCoverage(), this.indent = this.getIndent(this.nextNonBlankLine()));
            return;
        }
        if (indent < nextIndent) throw new Error(this.lineMsg() + "invalid indent, expected " + nextIndent + ", was " + indent);
    }
}, Scene.prototype.else = Scene.prototype.elsif = Scene.prototype.elseif = function(data, inChoice) {
    if (!inChoice && !this.stats.implicit_control_flow) throw new Error(this.lineMsg() + "It is illegal to fall in to an *else statement; you must *goto or *finish before the end of the indented block.");
    this.skipTrueBranch(!0);
}, Scene.prototype.tokenizeExpr = function(str) {
    for (var stack = [], tokenTypes = Scene.tokens, tokenTypesLength = tokenTypes.length, pos = 0; str; ) {
        for (var matched = !1, i = 0; i < tokenTypesLength; i++) {
            var tokenType = tokenTypes[i], token = tokenType.test(str, this.lineNum + 1);
            if (token) {
                matched = !0, str = str.substr(token.length), pos += token.length;
                var item = {
                    name: tokenType.name,
                    value: token,
                    pos: pos
                };
                if ("WHITESPACE" == tokenType.name) break;
                if ("CURLY_QUOTE" == tokenType.name) throw new Error(this.lineMsg() + "Invalid use of curly smart quote: " + token + '\nUse straight quotes " instead');
                "FUNCTION" == tokenType.name && (item.func = /^\w+/.exec(token)[0]), stack.push(item);
                break;
            }
        }
        if (!matched) throw new Error(this.lineMsg() + "Invalid expression, couldn't extract another token: " + str);
    }
    return stack;
}, Scene.prototype.evaluateExpr = function(stack, parenthetical) {
    if (!stack.length) throw new Error(this.lineMsg() + "no expression specified");
    var token, operator, result, self = this;
    function getToken() {
        var token = stack.shift();
        if (!token) throw new Error(self.lineMsg() + "null token");
        return token;
    }
    if (result = this.evaluateValueToken(getToken(), stack), !stack.length) {
        if (parenthetical) throw new Error(this.lineMsg() + "Invalid expression, expected " + parenthetical);
        return result;
    }
    if (token = getToken(), parenthetical && parenthetical == token.name) return result;
    if (!(operator = Scene.operators[token.value])) throw new Error(this.lineMsg() + "Invalid expression at char " + token.pos + ", expected OPERATOR" + (parenthetical ? " or " + parenthetical : "") + ", was: " + token.name + " [" + token.value + "]");
    if ("%" === token.value && (this.warning("this is a bare % sign, which should be replaced with %+, %-, or modulo if you're really advanced."), 
    this.warning("For more details on modulo, see: https://forum.choiceofgames.com/t/21176")), 
    !stack[0]) throw new Error(this.lineMsg() + "Invalid expression at char " + token.pos + ", expected something after a " + token.value);
    if (result = operator(result, "auto" == stack[0].func ? this.autobalance(stack, token, result) : this.evaluateValueToken(getToken(), stack), this.lineNum + 1, this), 
    parenthetical) {
        if (stack.length) {
            if (parenthetical == (token = getToken()).name) return result;
            throw new Error(this.lineMsg() + "Invalid expression at char " + token.pos + ", expected " + parenthetical + ", was: " + token.name + " [" + token.value + "]");
        }
        throw new Error(this.lineMsg() + "Invalid expression, expected " + parenthetical);
    }
    if (stack.length) throw token = getToken(), new Error(this.lineMsg() + "Invalid expression at char " + token.pos + ", expected no more tokens, found: " + token.name + " [" + token.value + "]");
    return result;
}, Scene.prototype.evaluateValueToken = function(token, stack) {
    var value, name = token.name;
    if ("OPEN_PARENTHESIS" == name) return this.evaluateExpr(stack, "CLOSE_PARENTHESIS");
    if ("OPEN_CURLY" == name) return value = this.evaluateExpr(stack, "CLOSE_CURLY"), 
    this.getVar(value);
    if ("FUNCTION" == name) {
        if (!this.functions[token.func]) throw new Error(this.lineMsg + "Unknown function " + token.func);
        return value = this.evaluateExpr(stack, "CLOSE_PARENTHESIS"), this.functions[token.func].call(this, value);
    }
    if ("NUMBER" == name) return token.value;
    if ("STRING" == name) return this.replaceVariables(token.value.slice(1, -1).replace(/\\(.)/g, "$1"));
    if ("VAR" != name) throw new Error(this.lineMsg() + "Invalid expression at char " + token.pos + ", expected NUMBER, STRING, VAR or PARENTHETICAL, was: " + name + " [" + token.value + "]");
    for (var variable = String(token.value); stack.length && "OPEN_SQUARE" == stack[0].name; ) stack.shift(), 
    variable += "_" + this.evaluateExpr(stack, "CLOSE_SQUARE");
    return this.getVar(variable);
}, Scene.prototype.evaluateReference = function(stack, closingCurly) {
    var name, toLowerCase = !0;
    function findClosingBracket(stack, type, offset) {
        for (var opens = 0, openType = "OPEN_" + type, closeType = "CLOSE_" + type, i = offset = offset || 0; i < stack.length; i++) if (stack[i].name == openType) opens++; else if (stack[i].name == closeType) {
            if (!opens) return i;
            opens--;
        }
        return -1;
    }
    function normalizeCase(name) {
        return toLowerCase ? String(name).toLowerCase() : name;
    }
    if (closingCurly && closingCurly.hasOwnProperty("toLowerCase") && (toLowerCase = !!closingCurly.toLowerCase), 
    !stack.length) throw new Error(this.lineMsg() + "Invalid expression, expected a name");
    if ("OPEN_CURLY" === stack[0].name) {
        stack.shift();
        closingCurly = findClosingBracket(stack, "CURLY");
        if (-1 == closingCurly) throw new Error(this.lineMsg() + "Invalid expression, no closing curly bracket: " + data);
        return name = this.evaluateExpr(stack.slice(0, closingCurly)), stack.splice(0, closingCurly + 1), 
        normalizeCase(name);
    }
    if ("NUMBER" === stack[0].name) return name = stack[0].value, stack.shift(), name;
    if ("VAR" !== stack[0].name) throw new Error(this.lineMsg() + "Invalid expression; expected name, found " + stack[0].name + " at char " + stack[0].pos);
    for (name = String(stack[0].value), stack.shift(); stack.length && "OPEN_SQUARE" == stack[0].name; ) {
        var closingBracket = findClosingBracket(stack, "SQUARE", 1);
        if (-1 == closingBracket) throw new Error(this.lineMsg() + "Invalid expression, no closing array bracket at char " + stack[1].pos);
        name += "_" + this.evaluateExpr(stack.slice(1, closingBracket)), stack.splice(0, closingBracket + 1);
    }
    return normalizeCase(name);
}, Scene.prototype.functions = {
    not: function(value) {
        return !bool(value, this.lineNum + 1);
    },
    round: function(value) {
        if (isNaN(+value)) throw new Error(this.lineMsg() + "round() value is not a number: " + value);
        return Math.round(value);
    },
    timestamp: function(value) {
        return Date.parse(value) / 1e3;
    },
    log: function(value) {
        if (isNaN(+value)) throw new Error(this.lineMsg() + "log() value is not a number: " + value);
        return Math.log(value) / Math.log(10);
    },
    length: function(value) {
        return String(value).length;
    },
    auto: function() {
        throw new Error(this.lineMsg() + "Invalid expression, auto() must come after a < or > symbol");
    }
}, Scene.prototype.autobalance = function(result, operatorToken, value) {
    if ("INEQUALITY" !== operatorToken.name) throw new Error(this.lineMsg() + "Invalid expression, auto() must come after a < or > symbol");
    if (result.shift(), result.length < 4 || "NUMBER" !== result[0].name || "COMMA" !== result[1].name || "VAR" != result[2].name && "NUMBER" != result[2].name || "CLOSE_PARENTHESIS" !== result[3].name) throw new Error(this.lineMsg() + "Invalid expression, auto() requires (percentage, id)");
    var id = result.shift().value, rate = parseFloat(id);
    if (isNaN(rate) || rate < 1 || 99 < rate) throw new Error(this.lineMsg() + "the first auto() parameter should be a number between 1 and 99: " + id);
    result.shift();
    id = result.shift().value;
    result.shift();
    result = this.stats["auto_" + this.name + "_" + id];
    return void 0 !== result ? result : this.recordBalance ? this.recordBalance(value, operatorToken.value, rate, id) : 50;
}, Scene.prototype.evaluateValueExpr = function(value) {
    var stack = this.tokenizeExpr(value), token = stack.shift();
    if (!token) throw new Error(this.lineMsg() + "null token");
    value = this.evaluateValueToken(token, stack);
    if (stack.length) {
        if (!(token = stack.shift())) throw new Error(this.lineMsg() + "null token");
        throw new Error(this.lineMsg() + "Invalid expression at char " + token.pos + ", expected no more tokens, found: " + token.name + " [" + token.value + "]");
    }
    return value;
}, Scene.prototype.goto_random_scene = function(allowNoSelection) {
    var parsed = this.parseGotoRandomScene(allowNoSelection), option = /\ballow_reuse\b/.test(allowNoSelection), allowNoSelection = /\ballow_no_selection\b/.test(allowNoSelection), option = this.computeRandomSelection(Math.random(), parsed, option);
    if (option) this.goto_scene(option.name); else if (!allowNoSelection) throw new Error(this.lineMsg() + "No selectable scenes");
}, Scene.prototype.parseGotoRandomScene = function(data) {
    for (var directives = (data = data || "").split(" "), allowReuseGlobally = !1, i = 0; i < directives; i++) {
        var directive = trim(directives[i]);
        if (directive) if ("allow_reuse" == directive) allowReuseGlobally = !0; else if ("allow_no_selection" != directive) throw new Error(this.lineMsg() + "invalid command: '" + directive + "'");
    }
    for (var nextIndent = null, options = [], startIndent = this.indent; isDefined(line = this.lines[++this.lineNum]); ) if (trim(line)) {
        var indent = this.getIndent(line);
        if (null == nextIndent) {
            if (indent <= startIndent) throw new Error(this.lineMsg() + "invalid indent, expected at least one line in *goto_random_scene");
            this.indent = nextIndent = indent;
        }
        if (indent <= startIndent) {
            this.rollbackLineCoverage(), this.lineNum--, this.rollbackLineCoverage();
            break;
        }
        if (indent != this.indent) throw new Error(this.lineMsg() + "invalid indent, expected " + this.indent + ", was " + indent);
        line = trim(line);
        for (var command, option = {
            allowReuse: allowReuseGlobally
        }; command = /^\*(\S+)/.exec(line); ) if ("allow_reuse" != (command = command[1])) {
            if ("if" != command) throw new Error(this.lineMsg() + " invalid command: " + line);
            var conditional = /^\*if\s+\((.+)\)\s+([^\)]+)/.exec(line);
            if (!conditional) throw new Error(this.lineMsg() + " invalid *if, expected () followed by scene name: " + line);
            var line = conditional[2], stack = this.tokenizeExpr(conditional[1]);
            this.evaluateExpr(stack), option.conditional = conditional[1];
        } else option.allowReuse = !0, line = trim(line.substring("*allow_reuse".length)), 
        command = /^\*(\S+)/.exec(line);
        option.name = trim(line), options.push(option);
    } else this.rollbackLineCoverage();
    return options;
}, Scene.prototype.computeRandomSelection = function(randomFloat, options, allowReuseGlobally) {
    var filtered = [], finished = {};
    allowReuseGlobally || this.stats.choice_grs || (this.stats.choice_grs = []);
    for (var option, grs = this.stats.choice_grs, i = 0; i < grs.length; i++) finished[grs[i]] = 1;
    for (i = 0; i < options.length; i++) if ((option = options[i]).allowReuse || !finished[option.name]) {
        if (option.conditional) {
            var stack = this.tokenizeExpr(option.conditional);
            if (!this.evaluateExpr(stack)) continue;
        }
        filtered.push(option);
    }
    return filtered.length ? ((option = filtered[Math.floor(randomFloat * filtered.length)]).allowReuse || this.stats.choice_grs.push(option.name), 
    option) : null;
}, Scene.prototype.end_trial = function() {
    this.paragraph(), printLink(this.target, "#", "Start Over from the Beginning", function(e) {
        return preventDefault(e), restartGame("prompt");
    }), this.prevLine = "block", this.screenEmpty = !1, this.finished = !0;
}, Scene.prototype.achieve = function(name) {
    if (name = name.toLowerCase(), !this.nav.achievements.hasOwnProperty(name)) throw new Error(this.lineMsg() + "the achievement name " + name + " was not declared as an *achievement in startup");
    var achievement = this.nav.achievements[name];
    this.nav.achieved[name] = !0, "undefined" != typeof window && "undefined" != typeof achieve && achieve(name, achievement.title, achievement.earnedDescription);
}, Scene.prototype.check_achievements = function() {
    var self = this;
    function callback(immediately) {
        for (var achievement in nav.achievements) self.temps["choice_achieved_" + achievement] = nav.achieved.hasOwnProperty(achievement);
        immediately || (self.finished = !1, self.skipFooter = !1, self.execute());
    }
    "undefined" == typeof checkAchievements ? callback("immediately") : (this.finished = !0, 
    this.skipFooter = !0, checkAchievements(callback));
}, Scene.prototype.scene_list = function() {
    var scenes = this.parseSceneList();
    this.nav.setSceneList(scenes);
}, Scene.prototype.parseSceneList = function() {
    for (var nextIndent = null, scenes = [], startIndent = this.indent; isDefined(line = this.lines[++this.lineNum]); ) if (trim(line)) {
        var purchaseMatch = this.getIndent(line);
        if (null == nextIndent) {
            if (purchaseMatch <= startIndent) throw new Error(this.lineMsg() + "invalid indent, expected at least one row");
            this.indent = nextIndent = purchaseMatch;
        }
        if (purchaseMatch <= startIndent) return this.rollbackLineCoverage(), this.lineNum--, 
        this.rollbackLineCoverage(), scenes;
        if (purchaseMatch != this.indent) throw new Error(this.lineMsg() + "invalid indent, expected " + this.indent + ", was " + purchaseMatch);
        var line = trim(line), purchaseMatch = /^\$(\w*)\s+(.*)/.exec(line);
        purchaseMatch && (line = purchaseMatch[2]), scenes.length || "startup" == String(line).toLowerCase() || scenes.push("startup"), 
        scenes.push(line);
    } else this.rollbackLineCoverage();
    return scenes;
}, Scene.prototype.title = function(title) {
    "undefined" != typeof changeTitle && changeTitle(title);
}, Scene.prototype.author = function(author) {
    "undefined" != typeof changeAuthor && changeAuthor(author);
}, Scene.prototype.achievement = function(points) {
    var postEarnedDescription = /(\S+)\s+(\S+)\s+(\S+)\s+(.*)/.exec(points);
    if (!postEarnedDescription) throw new Error(this.lineMsg() + "Invalid *achievement, requires short name, visibility, points, and display title: " + points);
    var achievementName = postEarnedDescription[1];
    if (!/^[a-z][a-z0-9_]+$/.test(achievementName)) throw new Error(this.lineMsg() + "Invalid achievement name: " + achievementName);
    if (this.nav.achievements.hasOwnProperty(achievementName)) {
        var title = this.nav.achievements[achievementName];
        if (title.lineNumber && title.lineNumber != this.lineNum + 1) throw new Error(this.lineMsg() + "Achievement " + achievementName + " already defined on line " + this.nav.achievements[achievementName].lineNumber);
        this.nav.achievements = {}, this.nav.achievementList = [], this.achievementTotal = 0, 
        this.seenAchievementTitles = {};
    }
    var lineNumber = this.lineNum + 1, indent = postEarnedDescription[2];
    if ("hidden" != indent && "visible" != indent) throw new Error(this.lineMsg() + "Invalid *achievement, the second word should be either 'hidden' or 'visible': " + indent);
    var visible = "hidden" != indent, preEarnedDescription = postEarnedDescription[3];
    if (!/[1-9][0-9]*/.test(preEarnedDescription)) throw new Error(this.lineMsg() + "Invalid *achievement, the third word should be an integer number of points: " + preEarnedDescription);
    points = parseInt(preEarnedDescription, 10);
    if (100 < points) throw new Error(this.lineMsg() + "Invalid *achievement, no achievement may be worth more than 100 points: " + points);
    if (points < 1) throw new Error(this.lineMsg() + "Invalid *achievement, no achievement may be worth less than 1 point: " + points);
    if (this.achievementTotal || (this.achievementTotal = 0), this.achievementTotal += points, 
    1e3 < this.achievementTotal) throw new Error(this.lineMsg() + "Invalid achievements. Adding " + points + " would add up to more than 1,000 points: " + this.achievementTotal);
    title = postEarnedDescription[4];
    if (/(\$\{)/.test(title)) throw new Error(this.lineMsg() + "Invalid *achievement. ${} not permitted in achievement title: " + title);
    if (/(\@\{)/.test(title)) throw new Error(this.lineMsg() + "Invalid *achievement. @{} not permitted in achievement title: " + title);
    if (/(\[)/.test(title)) throw new Error(this.lineMsg() + "Invalid *achievement. [] not permitted in achievement title: " + title);
    if (50 < title.length) throw new Error(this.lineMsg() + "Invalid *achievement. Title must be 50 characters or fewer: " + title);
    var line = this.lines[++this.lineNum], indent = this.getIndent(line);
    if (!indent) throw new Error(this.lineMsg() + "Invalid *achievement. An indented description is required.");
    preEarnedDescription = trim(line);
    if (/(\$\{)/.test(preEarnedDescription)) throw new Error(this.lineMsg() + "Invalid *achievement. ${} not permitted in achievement description: " + preEarnedDescription);
    if (/(\@\{)/.test(preEarnedDescription)) throw new Error(this.lineMsg() + "Invalid *achievement. @{} not permitted in achievement description: " + preEarnedDescription);
    if (/(\[)/.test(preEarnedDescription)) throw new Error(this.lineMsg() + "Invalid *achievement. [] not permitted in achievement description: " + preEarnedDescription);
    if (200 < preEarnedDescription.length) throw new Error(this.lineMsg() + "Invalid *achievement. Pre-earned description must be 200 characters or fewer: " + preEarnedDescription);
    if (!visible && "hidden" != preEarnedDescription.toLowerCase()) throw new Error(this.lineMsg() + "Invalid *achievement. Hidden achievements must set their pre-earned description to 'hidden'.");
    for (postEarnedDescription = null; isDefined(line = this.lines[++this.lineNum]) && !trim(line); ) this.rollbackLineCoverage();
    if (this.getIndent(line)) {
        if (postEarnedDescription = trim(line), /(\$\{)/.test(postEarnedDescription)) throw new Error(this.lineMsg() + "Invalid *achievement. ${} not permitted in achievement description: " + postEarnedDescription);
        if (/(\@\{)/.test(postEarnedDescription)) throw new Error(this.lineMsg() + "Invalid *achievement. @{} not permitted in achievement description: " + postEarnedDescription);
        if (/(\[)/.test(postEarnedDescription)) throw new Error(this.lineMsg() + "Invalid *achievement. [] not permitted in achievement description: " + postEarnedDescription);
        if (200 < postEarnedDescription.length) throw new Error(this.lineMsg() + "Invalid *achievement. Post-earned description must be 200 characters or fewer: " + postEarnedDescription);
    } else this.rollbackLineCoverage(), this.lineNum--, this.rollbackLineCoverage();
    if (!postEarnedDescription) {
        if (!visible) throw new Error(this.lineMsg() + "Invalid *achievement. Hidden achievements must set a post-earned description.");
        postEarnedDescription = preEarnedDescription;
    }
    if (!this.nav.achievements.hasOwnProperty(achievementName) && (this.nav.achievementList.push(achievementName), 
    100 < this.nav.achievementList.length)) throw new Error(this.lineMsg() + "Too many *achievements. Each game can have up to 100 achievements.");
    if (this.seenAchievementTitles || (this.seenAchievementTitles = {}), this.seenAchievementTitles[title]) throw new Error(this.lineMsg() + 'An achievement with display title "' + title + '" was already defined at line ' + this.seenAchievementTitles[title]);
    this.seenAchievementTitles[title] = this.lineNum + 1, this.nav.achievements[achievementName] = {
        visible: visible,
        points: points,
        title: title,
        earnedDescription: postEarnedDescription,
        preEarnedDescription: preEarnedDescription,
        lineNumber: lineNumber
    }, "undefined" != typeof setButtonTitles && setButtonTitles();
}, Scene.prototype.bug = function(message) {
    throw message = message ? "Bug: " + this.replaceVariables(message) : "Bug", new Error(this.lineMsg() + message);
}, Scene.prototype.warning = function(message) {}, Scene.prototype.feedback = function() {
    if ("undefined" != typeof window && !this.randomtest) {
        this.paragraph(), this.printLine("On a scale from 1 to 10, how likely are you to recommend this game to a friend?"), 
        this.paragraph();
        for (var options = [ {
            name: "10 (Most likely)"
        } ], i = 9; 1 < i; i--) options.push({
            name: i
        });
        options.push({
            name: "1 (Least likely)"
        }), options.push({
            name: "No response."
        });
        var self = this;
        this.renderOptions([ "" ], options, function(option) {
            var value = "null", numberMatch = /^(\d+)/.exec(option.name);
            if (numberMatch && (value = +numberMatch[1]), !window.storeName) return self.finished = !1, 
            void self.resetPage();
            function postFeedback() {
                if (xhrAuthRequest("POST", "feedback", function(ok, response) {
                    window.console && console.log("ok", ok, response);
                }, "game", window.storeName, "platform", platformCode(), "rating", value), /^(9|10)/.test(option.name) && isReviewSupported()) return clearScreen(function() {
                    self.printLine("Great! "), promptForReview(), self.screenEmpty = !1, self.prevLine = "text", 
                    self.page_break(), printFooter();
                });
                self.finished = !1, self.resetPage();
            }
            isRegistered(function(registered) {
                registered ? postFeedback() : clearScreen(function() {
                    loginForm(main, 1, "Please sign in to have your vote counted!", postFeedback);
                });
            });
        }), this.finished = !0;
    }
}, Scene.prototype.parseTrackEvent = function(intValue) {
    var event = {}, intValue = this.tokenizeExpr(intValue);
    if (!intValue.length) throw new Error(this.lineMsg() + "Invalid track_event statement, expected at least two args: category and action");
    if (event.category = this.evaluateValueToken(intValue.shift(), intValue), !intValue.length) throw new Error(this.lineMsg() + "Invalid track_event statement, expected at least two args: category and action");
    if (event.action = this.evaluateValueToken(intValue.shift(), intValue), intValue.length && (event.label = this.evaluateValueToken(intValue.shift(), intValue), 
    intValue.length)) {
        if (event.value = this.evaluateValueToken(intValue.shift(), intValue), intValue.length) throw new Error(this.lineMsg() + "Invalid track_event statement, expected at most four args: category, action, label, value");
        intValue = parseInt(event.value, 10);
        if (isNaN(intValue) || event.value != intValue || event.value.toString() != intValue.toString()) throw new Error(this.lineMsg() + "Invalid track_event statement, value must be an integer: " + event.value);
    }
    return event;
}, Scene.prototype.track_event = function(event) {
    event = this.parseTrackEvent(event);
    "undefined" != typeof ga && ga("send", "event", event.category, event.action, event.label, event.value);
}, Scene.prototype.ai = function(data) {}, Scene.prototype.config = function(value) {
    var value = this.tokenizeExpr(value), variable = this.evaluateReference(value);
    if (void 0 === this.temps[variable] && void 0 === this.stats[variable]) throw new Error(this.lineMsg() + "Non-existent variable '" + variable + "'");
    if (0 === value.length) throw new Error(this.lineMsg() + "Invalid set instruction, no expression specified: " + line);
    var self, value = this.evaluateExpr(value);
    this.setVar(variable, value), void 0 === remoteConfig || this.randomtest || this.quicktest || (this.finished = !0, 
    this.skipFooter = !0, self = this, remoteConfig(variable, function(result) {
        null !== result && self.setVar(variable, result), self.finished = !1, self.skipFooter = !1, 
        self.execute();
    }));
}, Scene.prototype.lineMsg = function() {
    return this.name + " line " + (this.lineNum + 1) + ": ";
}, Scene.prototype.rollbackLineCoverage = function() {}, Scene.baseUrl = "scenes", 
Scene.regexpMatch = function(result, re) {
    result = re.exec(result);
    return result ? result[0] : null;
}, Scene.tokens = [ {
    name: "OPEN_PARENTHESIS",
    test: function(str) {
        return Scene.regexpMatch(str, /^\(/);
    }
}, {
    name: "CLOSE_PARENTHESIS",
    test: function(str) {
        return Scene.regexpMatch(str, /^\)/);
    }
}, {
    name: "OPEN_CURLY",
    test: function(str) {
        return Scene.regexpMatch(str, /^\{/);
    }
}, {
    name: "CLOSE_CURLY",
    test: function(str) {
        return Scene.regexpMatch(str, /^\}/);
    }
}, {
    name: "OPEN_SQUARE",
    test: function(str) {
        return Scene.regexpMatch(str, /^\[/);
    }
}, {
    name: "CLOSE_SQUARE",
    test: function(str) {
        return Scene.regexpMatch(str, /^\]/);
    }
}, {
    name: "FUNCTION",
    test: function(str) {
        return Scene.regexpMatch(str, /^(not|round|timestamp|log|length|auto)\s*\(/);
    }
}, {
    name: "NUMBER",
    test: function(str) {
        return Scene.regexpMatch(str, /^\d+(\.\d+)?\b/);
    }
}, {
    name: "STRING",
    test: function(str, line) {
        var i;
        if (!/^\"/.test(str)) return null;
        for (i = 1; i < str.length; i++) {
            var x = str.charAt(i);
            if ("\\" == x) i++; else if ('"' == x) return str.substring(0, i + 1);
        }
        throw new Error("line " + line + ": Invalid string, open quote with no close quote: " + str);
    }
}, {
    name: "CURLY_QUOTE",
    test: function(str) {
        return Scene.regexpMatch(str, /^[\u201c\u201d]/);
    }
}, {
    name: "WHITESPACE",
    test: function(str) {
        return Scene.regexpMatch(str, /^\s+/);
    }
}, {
    name: "NAMED_OPERATOR",
    test: function(str) {
        return Scene.regexpMatch(str, /^(and|or|modulo)\b/);
    }
}, {
    name: "VAR",
    test: function(str) {
        return Scene.regexpMatch(str, /^\w*/);
    }
}, {
    name: "FAIRMATH",
    test: function(str) {
        return Scene.regexpMatch(str, /^%[\+\-]/);
    }
}, {
    name: "OPERATOR",
    test: function(str) {
        return Scene.regexpMatch(str, /^[\+\-\*\/\&\%\^\#]/);
    }
}, {
    name: "INEQUALITY",
    test: function(str) {
        return Scene.regexpMatch(str, /^[\!<>]\=?/);
    }
}, {
    name: "EQUALITY",
    test: function(str) {
        return Scene.regexpMatch(str, /^=/);
    }
}, {
    name: "COMMA",
    test: function(str) {
        return Scene.regexpMatch(str, /^,/);
    }
} ], Scene.operators = {
    "+": function(v1, v2, line) {
        return num(v1, line) + num(v2, line);
    },
    "-": function(v1, v2, line) {
        return num(v1, line) - num(v2, line);
    },
    "*": function(v1, v2, line) {
        return num(v1, line) * num(v2, line);
    },
    "/": function(v1, v2, line) {
        if (0 === (v2 = num(v2, line))) throw new Error("line " + line + ": can't divide by zero");
        return num(v1, line) / num(v2, line);
    },
    "^": function(v1, v2, line) {
        return Math.pow(num(v1, line), num(v2, line));
    },
    "&": function(v1, v2) {
        return [ v1, v2 ].join("");
    },
    "#": function(v1, i, line) {
        i = num(i, line);
        if (i < 1) throw new Error("line " + line + ": There is no character at position " + i + "; the position must be greater than or equal to 1.");
        if (i > String(v1).length) throw new Error("line " + line + ": There is no character at position " + i + '. "' + v1 + '" is only ' + String(v1).length + " characters long.");
        return String(v1).charAt(i - 1);
    },
    "%+": function(v1, v2, line) {
        if (v1 = num(v1, line), v2 = num(v2, line), !(0 <= v1 && v1 <= 100)) throw new Error("line " + line + ": Can't fairAdd to non-percentile value: " + v1);
        if (0 < v2) {
            var value = +v1 + v2 * ((100 - v1) / 100);
            return value = 99 < (value = Math.floor(value)) ? 99 : value;
        }
        value = v1 - (0 - v2) * (v1 / 100);
        return value = (value = Math.ceil(value)) < 1 ? 1 : value;
    },
    "%-": function(v1, v2, line) {
        return v2 = num(v2, line), Scene.operators["%+"](v1, 0 - v2, line);
    },
    "=": function(v1, v2) {
        return v1 == v2 || String(v1) == String(v2);
    },
    "<": function(v1, v2, line) {
        return num(v1, line) < num(v2, line);
    },
    ">": function(v1, v2, line) {
        return num(v1, line) > num(v2, line);
    },
    "<=": function(v1, v2, line) {
        return num(v1, line) <= num(v2, line);
    },
    ">=": function(v1, v2, line) {
        return num(v1, line) >= num(v2, line);
    },
    "!=": function(v1, v2) {
        return v1 != v2;
    },
    and: function(v1, v2, line) {
        return bool(v1, line) && bool(v2, line);
    },
    or: function(v1, v2, line) {
        return bool(v1, line) || bool(v2, line);
    },
    modulo: function(v1, v2, line) {
        return num(v1, line) % num(v2, line);
    }
}, Scene.initialCommands = {
    create: 1,
    scene_list: 1,
    title: 1,
    author: 1,
    comment: 1,
    achievement: 1,
    product: 1
}, Scene.validCommands = {
    comment: 1,
    goto: 1,
    gotoref: 1,
    label: 1,
    looplimit: 1,
    finish: 1,
    abort: 1,
    choice: 1,
    create: 1,
    temp: 1,
    delete: 1,
    set: 1,
    setref: 1,
    print: 1,
    if: 1,
    rand: 1,
    page_break: 1,
    line_break: 1,
    script: 1,
    else: 1,
    elseif: 1,
    elsif: 1,
    reset: 1,
    goto_scene: 1,
    fake_choice: 1,
    input_text: 1,
    ending: 1,
    share_this_game: 1,
    stat_chart: 1,
    subscribe: 1,
    show_password: 1,
    gosub: 1,
    return: 1,
    hide_reuse: 1,
    disable_reuse: 1,
    allow_reuse: 1,
    check_purchase: 1,
    restore_purchases: 1,
    purchase: 1,
    restore_game: 1,
    advertisement: 1,
    kindle_search: 1,
    kindle_product: 1,
    feedback: 1,
    save_game: 1,
    delay_break: 1,
    image: 1,
    kindle_image: 1,
    link: 1,
    input_number: 1,
    goto_random_scene: 1,
    restart: 1,
    more_games: 1,
    delay_ending: 1,
    end_trial: 1,
    login: 1,
    achieve: 1,
    scene_list: 1,
    title: 1,
    bug: 1,
    link_button: 1,
    check_registration: 1,
    sound: 1,
    author: 1,
    gosub_scene: 1,
    achievement: 1,
    check_achievements: 1,
    redirect_scene: 1,
    print_discount: 1,
    purchase_discount: 1,
    track_event: 1,
    timer: 1,
    youtube: 1,
    product: 1,
    text_image: 1,
    ai: 1,
    params: 1,
    config: 1
}, SceneNavigator.prototype.setSceneList = function(sceneList) {
    this._sceneList = sceneList, this._sceneMap = {};
    for (var i = 0; i < sceneList.length - 1; i++) {
        var scene1 = sceneList[i], scene2 = sceneList[i + 1];
        this._sceneMap[scene1] = scene2;
    }
    this._startupScene = sceneList[0];
}, SceneNavigator.prototype.nextSceneName = function(currentSceneName) {
    return this._sceneMap[currentSceneName];
}, SceneNavigator.prototype.getStartupScene = function() {
    return this._startupScene;
}, SceneNavigator.prototype.setStartingStatsClone = function(stats) {
    for (var i in this.startingStats = {}, stats) this.startingStats[i] = stats[i];
}, SceneNavigator.prototype.resetStats = function(stats) {
    for (var i in stats) delete stats[i];
    for (i in this.startingStats) stats[i] = this.startingStats[i];
    this.bugLog = [];
}, SceneNavigator.prototype.repairStats = function(stats) {
    for (var i in this.startingStats) {
        var startingStat = this.startingStats[i];
        null != startingStat && (void 0 !== stats[i] && null !== stats[i] || (stats[i] = this.startingStats[i]));
    }
}, SceneNavigator.prototype.bugLog = [], SceneNavigator.prototype.achievements = {}, 
SceneNavigator.prototype.achievementList = [], SceneNavigator.prototype.achieved = {}, 
SceneNavigator.prototype.products = {}, SceneNavigator.prototype.loadAchievements = function(achievementArray) {
    if (achievementArray) {
        this.achievements = {}, this.achievementList = [];
        for (var i = 0; i < achievementArray.length; i++) {
            var preEarnedDescription = achievementArray[i], achievementName = preEarnedDescription[0], visible = preEarnedDescription[1], points = preEarnedDescription[2], title = preEarnedDescription[3], earnedDescription = preEarnedDescription[4], preEarnedDescription = preEarnedDescription[5];
            this.achievements[achievementName] = {
                visible: visible,
                points: points,
                title: title,
                earnedDescription: earnedDescription,
                preEarnedDescription: preEarnedDescription
            }, this.achievementList.push(achievementName);
        }
    }
}, SceneNavigator.prototype.loadProducts = function(productArray, purchaseMap) {
    if (productArray || purchaseMap) {
        this.products = {};
        for (var scene, i = 0; i < productArray; i++) this.products[productArray[i]] = {};
        for (scene in purchaseMap) {
            var product = purchaseMap[scene];
            this.products[product] = {};
        }
    }
}, _global = "undefined" != typeof globalThis ? globalThis : this, function() {
    var userAgent, url, protocol, appMeta;
    "undefined" != typeof window && (userAgent = navigator.userAgent, url = window.location.href, 
    protocol = window.location.protocol, appMeta = window.document.querySelector("meta[name=apple-itunes-app]")), 
    _global.isWebOS = /webOS/.test(userAgent), _global.isMobile = _global.isWebOS || /Mobile/.test(userAgent), 
    _global.isFile = /^file:/.test(url), _global.isXul = /^chrome:/.test(url);
    try {
        _global.greenworks = require("greenworks"), _global.isGreenworks = !0;
    } catch (ignored) {}
    _global.isWinOldApp = !1;
    try {
        isWinOldApp = window.external.IsWinOldApp();
    } catch (ignored) {}
    _global.isAndroid = /Android/.test(userAgent), _global.isOmnibusApp = /CoGnibus/.test(userAgent), 
    _global.isIosApp = _global.isIosApp || _global.isOmnibusApp && !_global.isAndroid, 
    _global.isAndroidApp = _global.isAndroidApp || _global.isOmnibusApp && _global.isAndroid, 
    _global.isAmazonAndroidApp = _global.isAmazonAndroidApp || _global.isAndroidApp && _global.flavor && _global.flavor.isAmazon(), 
    _global.isWeb = !_global.isIosApp && !_global.isAndroidApp && !_global.isWinOldApp && /^https?:/.test(url), 
    _global.isSecureWeb = /^https:?$/.test(protocol), _global.isSafari = /Safari/.test(userAgent), 
    _global.isIE = /(MSIE|Trident)/.test(userAgent), _global.isIPad = /iPad/.test(userAgent), 
    _global.isIPhone = /iPhone/.test(userAgent), _global.isKindleFire = /Kindle Fire/.test(userAgent), 
    _global.isWinStoreApp = "ms-appx:" == protocol, _global.isCef = !!_global.cefQuery, 
    _global.isNode = "undefined" != typeof process, _global.isHeartsChoice = appMeta && /1487052276/.test(appMeta.getAttribute("content"));
}(), _global.loadTime = new Date().getTime();

var loginUrlBase = "https://www.choiceofgames.com/api/";

function xhrAuthRequest(method, endpoint, callback) {
    for (var paramBuilder = new Array(3 * arguments.length), i = 3; i < arguments.length; i += 2) 3 < i && paramBuilder.push("&"), 
    paramBuilder.push(arguments[i]), paramBuilder.push("="), paramBuilder.push(arguments[i + 1]);
    var params = paramBuilder.join(""), xhr = findXhr();
    "POST" == method ? (xhr.open(method, loginUrlBase + endpoint + ".php", !0), xhr.setRequestHeader("Content-type", "application/x-www-form-urlencoded")) : xhr.open(method, loginUrlBase + endpoint + ".php?" + params, !0);
    var done = !1;
    xhr.onreadystatechange = function() {
        if (!done && 4 == xhr.readyState) {
            done = !0;
            var ok = 200 == xhr.status, response = {};
            try {
                xhr.responseText && (response = JSON.parse(xhr.responseText));
            } catch (e) {
                ok = !1;
            }
            ok || response.error || (response.error = "unknown error"), callback && safeCall(null, function() {
                callback(ok, response);
            });
        }
    }, xhr.send(params);
}

function login(email, password, register, subscribe, callback) {
    xhrAuthRequest("POST", "login", callback, "email", encodeURIComponent(email), "password", encodeURIComponent(password), "register", register, "subscribe", subscribe);
}

function forgotPassword(email, callback) {
    xhrAuthRequest("POST", "forgot", callback, "email", encodeURIComponent(email));
}

function logout(callback) {
    document.cookie = "login=0;path=/;expires=Thu, 01 Jan 1970 00:00:01 GMT;", xhrAuthRequest("GET", "logout", callback), 
    recordLogin(!1), window.knownPurchases = null, window.registered = !1, "undefined" != typeof FB && FB.logout && FB.logout(), 
    "undefined" != typeof gapi && gapi.auth && gapi.auth.signOut && gapi.auth.signOut();
}

function recordLogin(registered, loginId, email, callback) {
    initStore() ? (registered && recordEmail(email), window.store.set("login", loginId || 0, function() {
        safeCall(null, callback);
    }), window.registered = registered) : safeTimeout(callback, 0);
}

function getRemoteEmail(callback) {
    xhrAuthRequest("GET", "getuser", callback);
}

function saveCookie(callback, slot, stats, temps, lineNum, indent) {
    return writeCookie(computeCookie(stats, temps, lineNum, indent), slot, callback);
}

function computeCookie(stats, temps, lineNum, value) {
    var scene = stats.scene;
    delete stats.scene, scene && (stats.sceneName = scene.name);
    var version = "UNKNOWN", value = toJson({
        version: version = "undefined" != typeof window && window && window.version ? window.version : version,
        stats: stats,
        temps: temps,
        lineNum: lineNum,
        indent: value
    });
    return stats.scene = scene, value;
}

function writeCookie(value, slot, callback) {
    _global.pseudoSave || (_global.pseudoSave = {}), slot = slot || "", _global.pseudoSave[slot] = value, 
    initStore() ? window.store.set("state" + slot, value, safeCallback(callback)) : callback && safeTimeout(callback, 0);
}

function clearCookie(callback, slot) {
    writeCookie("", slot, safeCallback(callback));
}

function areSaveSlotsSupported() {
    return !(!initStore() || "cookie" == window.Persist.type);
}

function recordSave(slot, callback) {
    areSaveSlotsSupported() ? restoreObject(initStore(), "save_list", [], function(saveList) {
        saveList.push(slot), window.store.set("save_list", toJson(saveList), safeCallback(callback));
    }) : safeTimeout(callback, 0);
}

function recordDirtySlots(slots, callback) {
    areSaveSlotsSupported() ? restoreObject(initStore(), "dirty_save_list", [], function(saveList) {
        saveSet = {};
        for (var i = 0; i < saveList.length; i++) saveSet[saveList[i]] = 1;
        for (i = 0; i < slots.length; i++) saveSet[slots[i]] || saveList.push(slots[i]);
        window.store.set("dirty_save_list", toJson(saveList), safeCallback(callback));
    }) : safeTimeout(callback, 0);
}

function recordEmail(email, callback) {
    initStore() ? (window.recordedEmail = email, window.store.set("email", email, safeCallback(callback))) : safeTimeout(callback, 0);
}

function fetchEmail(callback) {
    if (initStore()) {
        if (window.recordedEmail) return safeTimeout(function() {
            callback(window.recordedEmail);
        });
        if (window.isWeb) {
            var cookieEmail = getCookieByName("login");
            if (/@/.test(cookieEmail)) return recordEmail(cookieEmail, function() {
                callback(cookieEmail);
            });
        }
        window.store.get("email", function(ok, value) {
            safeCall(null, function() {
                var temp;
                ok && (window.recordedEmail = value), callback && (temp = callback, callback = null, 
                temp(ok && value ? value : ""));
            });
        }), safeTimeout(function() {
            var temp;
            callback && (temp = callback, callback = null, temp(""));
        }, 1e3);
    } else safeTimeout(function() {
        callback("");
    }, 0);
}

function restoreObject(store, key, defaultValue, callback) {
    store ? store.get(key, function(ok, value) {
        var result = defaultValue;
        if (ok && value) try {
            result = jsonParse(value);
        } catch (e) {}
        safeCall(null, function() {
            callback(result);
        });
    }) : safeTimeout(function() {
        callback(defaultValue);
    }, 0);
}

function getDirtySaveList(callback) {
    restoreObject(initStore(), "dirty_save_list", [], function(slotList) {
        callback(slotList);
    });
}

function remoteSaveMerger(i, callback) {
    var remoteStore = new Persist.Store(window.remoteStoreNames[i]);
    restoreObject(remoteStore, "save_list", [], function(remoteSlotList) {
        fetchSavesFromSlotList(remoteStore, remoteSlotList, 0, [], function(remoteSaveList) {
            mergeRemoteSaves(remoteSaveList, 0, function() {
                ++i < window.remoteStoreNames.length ? remoteSaveMerger(i, callback) : callback.apply(null, arguments);
            });
        });
    });
}

function getSaves(callback) {
    var remoteStore;
    window.remoteStoreNames && window.remoteStoreNames.length ? remoteSaveMerger(0, callback) : window.remoteStoreName && window.storeName != window.remoteStoreName ? restoreObject(remoteStore = new Persist.Store(window.remoteStoreName), "save_list", [], function(remoteSlotList) {
        fetchSavesFromSlotList(remoteStore, remoteSlotList, 0, [], function(remoteSaveList) {
            mergeRemoteSaves(remoteSaveList, 0, callback);
        });
    }) : restoreObject(initStore(), "save_list", [], function(localSlotList) {
        fetchSavesFromSlotList(initStore(), localSlotList, 0, [], callback);
    });
}

function fetchSavesFromSlotList(store, slotList, i, saveList, callback) {
    if (i >= slotList.length) return safeCall(null, function() {
        callback(saveList);
    });
    restoreObject(store, "state" + slotList[i], null, function(saveState) {
        saveState && (saveState.timestamp = slotList[i].substring(4), saveList.push(saveState)), 
        fetchSavesFromSlotList(store, slotList, i + 1, saveList, callback);
    });
}

function isWebSavePossible() {
    return !!initStore() && (!/^http/.test(window.location.protocol) || (document.domain == window.webSaveDomain || "localhost" == document.domain));
}

function submitRemoteSave(slot, email, subscribe, callback) {
    if (!isWebSavePossible()) return safeTimeout(function() {
        callback(!1);
    });
    window.store.get("state" + slot, function(gameName, value) {
        var xhr, params, done;
        gameName ? (params = slot.substring(4), xhr = findXhr(), gameName = window.remoteStoreName || window.storeName, 
        params = "email=" + email + "&game=" + gameName + "&realGame=" + window.storeName + "&json=" + encodeURIComponent(value) + "&timestamp=" + params + "&subscribe=" + subscribe, 
        xhr.open("POST", webSaveUrl, !0), xhr.setRequestHeader("Content-type", "application/x-www-form-urlencoded"), 
        done = !1, xhr.onreadystatechange = function() {
            done || 4 == xhr.readyState && (done = !0, 200 == xhr.status ? safeCall(null, function() {
                callback(!0);
            }) : recordDirtySlots([ slot ], function() {
                safeCall(null, function() {
                    callback(!1);
                });
            }));
        }, xhr.send(params)) : recordDirtySlots([ slot ], function() {
            asyncAlert("There was a problem uploading the saved game. This is probably a bug; please contact support@choiceofgames.com with code 17891.", function() {
                safeCall(null, function() {
                    callback(!1);
                });
            });
        });
    });
}

function submitDirtySaves(dirtySaveList, email, callback) {
    !function submitDirtySave(i) {
        dirtySaveList[i] ? submitRemoteSave(dirtySaveList[i], email, !1, function(ok) {
            ok ? submitDirtySave(i + 1) : safeCall(null, function() {
                callback(!1);
            });
        }) : window.store.remove("dirty_save_list", function() {
            safeCall(null, function() {
                callback(!0);
            });
        });
    }(0);
}

function submitAnyDirtySaves(callback) {
    callback = callback || function(ok) {};
    try {
        getDirtySaveList(function(dirtySaveList) {
            if (dirtySaveList && dirtySaveList.length) try {
                fetchEmail(function(email) {
                    email ? submitDirtySaves(dirtySaveList, email, callback) : callback(!1);
                });
            } catch (e) {
                callback(!1);
            }
        });
    } catch (e) {
        callback(!1);
    }
}

function getRemoteSaves(email, callback) {
    var xhr, gameName, done;
    isWebSavePossible() ? (xhr = findXhr(), gameName = window.remoteStoreName || window.storeName, 
    xhr.open("GET", webSaveUrl + "?email=" + email + "&game=" + gameName, !0), done = !1, 
    xhr.onreadystatechange = function() {
        if (!done && 4 == xhr.readyState) if (done = !0, 200 != xhr.status) window.console && console.log("Couldn't load remote saves. " + xhr.status + ": " + xhr.responseText), 
        safeCall(null, function() {
            callback(null);
        }); else {
            for (var result = jsonParse(result = xhr.responseText), remoteSaveList = [], i = 0; i < result.length; i++) {
                var save = result[i].json;
                save.timestamp = result[i].timestamp, remoteSaveList.push(save);
            }
            safeCall(null, function() {
                callback(remoteSaveList);
            });
        }
    }, xhr.send()) : safeTimeout(function() {
        callback([]);
    }, 0);
}

function mergeRemoteSaves(remoteSaveList, recordDirty, callback) {
    isWebSavePossible() ? restoreObject(initStore(), "save_list", [], function(localSlotList) {
        fetchSavesFromSlotList(initStore(), localSlotList, 0, [], function(localSaveList) {
            for (var localSlotMap = {}, i = 0; i < localSlotList.length; i++) localSlotMap[localSlotList[i]] = 1;
            for (var remoteSlotMap = {}, i = 0; i < remoteSaveList.length; i++) remoteSlotMap["save" + remoteSaveList[i].timestamp] = 1;
            var newRemoteSaves = 0;
            for (i = 0; i < remoteSaveList.length; i++) {
                var remoteSave = remoteSaveList[i], slot = "save" + remoteSave.timestamp;
                localSlotMap[slot] || (saveCookie(null, slot, remoteSave.stats, remoteSave.temps, remoteSave.lineNum, remoteSave.indent), 
                localSlotList.push(slot), localSaveList.push(remoteSave), newRemoteSaves++);
            }
            var dirtySaveList = [];
            for (i = 0; i < localSlotList.length; i++) remoteSlotMap[localSlotList[i]] || dirtySaveList.push(localSlotList[i]);
            function finale() {
                newRemoteSaves ? window.store.set("save_list", toJson(localSlotList), function() {
                    safeCall(null, function() {
                        callback(localSaveList, newRemoteSaves, dirtySaveList);
                    });
                }) : safeCall(null, function() {
                    callback(localSaveList, newRemoteSaves, dirtySaveList);
                });
            }
            recordDirty ? window.store.set("dirty_save_list", toJson(dirtySaveList), finale) : finale();
        });
    }) : safeTimeout(function() {
        callback([], 0, []);
    }, 0);
}

function getAppId() {
    if (window.isIosApp) {
        var androidLink = document.querySelector("meta[name=apple-itunes-app]");
        return /app-id=(\d+)/.exec(androidLink.getAttribute("content"))[1];
    }
    if (window.isAndroidApp) {
        androidLink = document.getElementById("androidLink");
        return /id=([\.\w]+)/.exec(androidLink.href)[1];
    }
}

function submitReceipts(receipts, callback) {
    console.log("submitReceipts: " + JSON.stringify(receipts)), callback = callback || (window.transferPurchaseCallback || function() {});
    var error, appId = receipts.appId, count = 0;
    function submitCallback(product) {
        return function(ok, response) {
            ok || (console.log("failed: " + product + " " + JSON.stringify(response)), error || callback("error"), 
            error = !0), error || --count || (receipts.avoidOverrides || cacheKnownPurchases(response), 
            callback("done"));
        };
    }
    if (window.isAndroidApp) {
        var platform = window.isAmazonAndroidApp ? "amazon" : "google";
        if (receipts.prePurchased && "google" == platform) for (var i = 0; i < receipts.prePurchased.length; i++) {
            var product = receipts.prePurchased[i];
            count++, xhrAuthRequest("POST", "submit-device-receipt", submitCallback(product), "platform", platform, "company", receipts.company, "game_id", window.storeName, "app_package", appId, "product_id", product, "signature", encodeURIComponent(receipts.signature), "receipt", encodeURIComponent(receipts.signedData));
        }
        if (receipts.iaps) for (var product in receipts.iaps) count++, xhrAuthRequest("POST", "submit-device-receipt", submitCallback(product), "platform", platform, "company", receipts.company, "game_id", window.storeName, "app_package", appId, "product_id", product, "receipt", encodeURIComponent(receipts.iaps[product]));
        count || safeTimeout(function() {
            callback("done");
        }, 0);
    } else callback("error");
}

function delayBreakStart(callback) {
    var nowInSeconds = Math.floor(new Date().getTime() / 1e3);
    initStore() ? window.store.get("delayBreakStart", function(ok, value) {
        var valueNum = +value;
        safeCall(null, function() {
            ok && value && !isNaN(valueNum) ? callback(valueNum) : (window.store.set("delayBreakStart", nowInSeconds), 
            callback(nowInSeconds));
        });
    }) : safeTimeout(function() {
        callback(nowInSeconds);
    }, 0);
}

function delayBreakEnd() {
    initStore() && window.store.remove("delayBreakStart");
}

function initStore() {
    if (!window.storeName) return !1;
    if (window.store) return window.store;
    try {
        window.store = new Persist.Store(window.storeName);
    } catch (e) {}
    return window.store;
}

function loadAndRestoreGame(slot, forcedScene) {
    function valueLoaded(ok, value) {
        safeCall(null, function() {
            var state = null;
            if (ok && value && "" + value) state = jsonParse(value); else if ("backup" == slot) return console.log("loadAndRestoreGame couldn't find backup"), 
            loadAndRestoreGame("", forcedScene);
            restoreGame(state, forcedScene);
        });
    }
    return slot = slot || "", _global.pseudoSave && pseudoSave[slot] ? valueLoaded(!0, pseudoSave[slot]) : initStore() ? void window.store.get("state" + slot, valueLoaded) : restoreGame(null, forcedScene);
}

function isStateValid(state) {
    return !!state && (!!state.stats && !!state.stats.sceneName);
}

function restartGame(shouldPrompt) {
    function actuallyRestart(result) {
        result && (delayBreakEnd(), submitAnyDirtySaves(), clearCookie(function() {}, "temp"), 
        clearCookie(function() {
            _global.nav.resetStats(_global.stats), clearScreen(restoreGame);
        }, ""));
    }
    _global.blockRestart ? asyncAlert("Please wait until the timer has run out.") : shouldPrompt ? asyncConfirm("Start over from the beginning?", actuallyRestart) : actuallyRestart(!0);
}

function restoreGame(state, forcedScene, userRestored) {
    var parts, scene, secondaryMode = null, saveSlot = "", forcedSceneLabel = null;
    /\|/.test(forcedScene) && (forcedScene = (parts = forcedScene.split("|"))[0], forcedSceneLabel = parts[1]), 
    "choicescript_stats" == forcedScene ? (secondaryMode = "stats", saveSlot = "temp") : "choicescript_upgrade" == forcedScene && (secondaryMode = "upgrade", 
    saveSlot = "temp"), isStateValid(state) ? (forcedScene && (state.stats.sceneName = forcedScene), 
    _global.stats = state.stats, scene = new Scene(state.stats.sceneName, state.stats, _global.nav, {
        debugMode: state.debug || _global.debug,
        secondaryMode: secondaryMode,
        saveSlot: saveSlot
    }), forcedScene || (scene.temps = state.temps, scene.lineNum = state.lineNum, scene.indent = state.indent), 
    userRestored && (scene.temps.choice_user_restored = !0)) : scene = new Scene(forcedScene || _global.nav.getStartupScene(), _global.stats, _global.nav, {
        debugMode: _global.debug,
        secondaryMode: secondaryMode,
        saveSlot: saveSlot
    }), null !== forcedSceneLabel && (scene.targetLabel = {
        label: forcedSceneLabel,
        origin: "url",
        originLine: 0
    }), safeCall(scene, scene.execute);
}

function redirectScene(sceneName, label, originLine) {
    var scene = new Scene(sceneName, window.stats, window.nav, {
        debugMode: window.debug
    });
    label && (scene.targetLabel = {
        label: label,
        origin: "choicescript_stats",
        originLine: originLine
    }), clearScreen(function() {
        scene.execute();
    });
}

function transferTempStatWrites() {
    _global.isIosApp && callIos("transferwrites", JSON.stringify(tempStatWrites));
}

function getCookieByName(cookieName, ck) {
    if (!(ck = ck || window.document.cookie)) return null;
    for (var ckPairs = ck.split(/;/), i = 0; i < ckPairs.length; i++) {
        var ckNameValue = trim(ckPairs[i]).split(/=/);
        if (decodeURIComponent(ckNameValue[0]) === cookieName) return decodeURIComponent(ckNameValue[1]);
    }
    return null;
}

function parseQueryString(str) {
    if (!str) return null;
    if (!(str = String(str).substring(1))) return null;
    for (var map = {}, pairs = str.split("&"), i = pairs.length; i--; ) {
        var parts = pairs[i].split("=");
        map[parts[0]] = parts[1];
    }
    return map;
}

function trim(str) {
    return null == str ? null : str.replace(/^\s+/g, "").replace(/\s+$/g, "");
}

function findOptimalDomain(result) {
    if ("localhost" == (result = result || document.domain) || "127.0.0.1" == result) return null;
    if (/^\d+\.\d+\.\d+\.\d+$/.test(result)) return null;
    result = result.match(/(\w+\.\w{3}$)/);
    return result ? result[1] : null;
}

function num(x, line) {
    line = line || "UNKNOWN";
    var x_num = parseFloat(x);
    if (isNaN(x_num)) throw new Error("line " + line + ": Not a number: " + x);
    if (!isFinite(x_num)) throw new Error("line " + line + ": Not finite " + x);
    return x_num;
}

function bool(x, line) {
    if (line = line || "UNKNOWN", "boolean" == typeof x) return x;
    if ("true" === x) return !0;
    if ("false" === x) return !1;
    throw new Error("line " + line + ": Neither true nor false: " + x);
}

function findXhr() {
    var ieFile = isIE && isFile;
    if (window.XMLHttpRequest && !ieFile) return new window.XMLHttpRequest();
    for (var ids = [ "Msxml2.XMLHTTP", "Microsoft.XMLHTTP", "Msxml2.XMLHTTP.4.0" ], i = 0; i < 3; i++) try {
        return new ActiveXObject(ids[i]);
    } catch (e) {}
    throw new Error("Couldn't create XHR object");
}

function crc32(str, crc) {
    crc = crc || 0;
    var n;
    crc ^= -1;
    for (var i = 0, iTop = str.length; i < iTop; i++) n = 255 & (crc ^ str.charCodeAt(i)), 
    crc = crc >>> 8 ^ "0x" + crcTable.substr(9 * n, 8);
    return -1 ^ crc;
}

function simpleDateTimeFormat(date) {
    var day = [ "Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat" ][date.getDay()], month = [ "Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec" ][date.getMonth()], minutes = date.getMinutes();
    minutes < 10 && (minutes = "0" + minutes);
    var yearString = "";
    return 31536e6 < new Date().getTime() - date.getTime() && (yearString = ", " + date.getFullYear()), 
    day + ", " + month + " " + date.getDate() + yearString + ", " + date.getHours() + ":" + minutes;
}

function jsonParse(str) {
    if ("undefined" == typeof JSON) return eval("(" + str + ")");
    try {
        return JSON.parse(str);
    } catch (e) {
        try {
            return eval("(" + str + ")");
        } catch (e2) {
            try {
                eval("1");
            } catch (e3) {
                var str2 = (str + "").replace(/([,\{])\s*(\w+)\s*\:/g, '$1"$2":');
                try {
                    return JSON.parse(str2);
                } catch (e4) {}
            }
            return JSON.parse(str);
        }
    }
}

function cefQuerySimple(method) {
    cefQuery({
        request: method,
        onSuccess: function(response) {
            console.log(method + " success");
        },
        onFailure: function(error_code, error_message) {
            console.error(method + " error: " + error_message);
        }
    });
}

function parseDateStringInCurrentTimezone(shortMonthString, fullYear) {
    var dayOfMonth = /^(\d{4})-(\d{2})-(\d{2})$/.exec(shortMonthString);
    if (!dayOfMonth) throw new Error("line " + fullYear + ": invalid date string " + shortMonthString);
    fullYear = dayOfMonth[1], shortMonthString = parseInt(dayOfMonth[2], 10), dayOfMonth = parseInt(dayOfMonth[3], 10), 
    shortMonthString = shortMonthStrings[shortMonthString];
    return new Date(shortMonthString + " " + dayOfMonth + ", " + fullYear);
}

function matchBracket(line, brackets, startIndex) {
    for (var openBracket = brackets[0], closeBracket = brackets[1], brackets = 0, i = startIndex; i < line.length; i++) {
        var c = line.charAt(i);
        if (c === openBracket) brackets++; else if (c === closeBracket) {
            if (!brackets) return i;
            brackets--;
        }
    }
    return -1;
}

function isStoreSceneCacheRequired() {
    if (!(initStore() && _global.purchases && _global.checkPurchase && _global.hashes) || _global.isOmnibusApp && _global.isIosApp || !hashes.scenes) return !1;
    var scene, empty = !0;
    for (scene in purchases) if (!/^fake:/.test(scene)) {
        empty = !1;
        break;
    }
    return !empty;
}

function updateSinglePaidSceneCache(sceneName, callback) {
    var fileName = (sceneName = sceneName.replace(/ /g, "_")) + ".txt.json";
    initStore() && _global.hashes && hashes.scenes && hashes.scenes[fileName] && !function actualRequest(receiptsSent) {
        var xhr = new XMLHttpRequest(), url = document.querySelector("link[rel=canonical]"), url = (url && url.getAttribute("href")) + "scenes/" + fileName + "?hash=" + hashes.scenes[fileName];
        xhr.open("GET", url), xhr.onload = function() {
            var error, result;
            if (200 !== xhr.status) try {
                error = JSON.parse(xhr.responseText).error;
            } catch (e) {}
            if (404 === xhr.status) try {
                if ("hash doesn't match" === error) return awaitAppUpdate(function() {
                    callback("strange");
                });
            } catch (e) {
                window.console && console.error(e, e.stack);
            }
            if (403 == xhr.status && _global.isOmnibusApp && _global.isAndroidApp) {
                if (!receiptsSent) return window.receiptRequestCallback = function(receipts) {
                    window.receiptRequestCallback = null, submitReceipts(receipts, function() {
                        actualRequest("receiptsSent");
                    });
                }, void androidBilling.requestReceipts();
                if ("not registered" === error || "not purchased" == error) return callback(error);
            } else if (200 !== xhr.status) return callback(xhr.status);
            try {
                result = jsonParse(xhr.responseText);
            } catch (e) {
                window.console && console.error(e, e.stack);
            }
            if (!(result && result.crc && result.lines && result.labels)) return callback("network");
            window.store.set("cache_scene_" + sceneName, xhr.responseText, function() {
                window.store.set("cache_scene_hash_" + sceneName, hashes.scenes[fileName], function() {
                    callback(null, result);
                });
            });
        }, xhr.onerror = function() {
            callback("network");
        }, console.log("updateSinglePaidSceneCache " + url), xhr.send();
    }();
}

function updateAllPaidSceneCaches(receiptsSent) {
    if (isStoreSceneCacheRequired()) {
        if (_global.isOmnibusApp && _global.isAndroidApp && !receiptsSent) return window.receiptRequestCallback = function(receipts) {
            submitReceipts(receipts, function() {
                updateAllPaidSceneCaches("receiptsSent");
            });
        }, void androidBilling.requestReceipts();
        var scene, flipped = {};
        for (scene in purchases) /^fake:/.test(scene) || (scene = scene.replace(/ /g, "_"), 
        flipped[purchases[scene]] || (flipped[purchases[scene]] = []), flipped[purchases[scene]].push(scene));
        var product, products = [];
        for (product in flipped) products.push(product);
        products.length && checkPurchase(products.join(" "), function(ok, result) {
            if (ok && result) {
                var product, sceneList = [], push = Array.prototype.push;
                for (product in flipped) result[product] && push.apply(sceneList, flipped[product]);
                if (sceneList.length) for (var i = 0; i < sceneList.length; i++) !function(i) {
                    var scene = sceneList[i], fileName = scene + ".txt.json";
                    window.store.get("cache_scene_hash_" + scene, function(ok, result) {
                        ok && result === hashes.scenes[fileName] || updateSinglePaidSceneCache(scene, function() {});
                    });
                }(i);
            }
        });
    } else window.isOmnibusApp && window.isAndroidApp && (window.receiptRequestCallback = submitReceipts, 
    androidBilling.requestReceipts());
}

function checkForAppUpdates() {
    navigator.serviceWorker && navigator.serviceWorker.getRegistration().then(function(reg) {
        reg && reg.update();
    });
}

function refreshIfAppUpdateReady() {
    if (navigator.serviceWorker) {
        if (window.controllerchanged) return window.location.reload();
        navigator.serviceWorker.getRegistration().then(function(reg) {
            if (reg.waiting) return reg.waiting.postMessage("skipWaiting"), window.location.reload();
        });
    }
}

function awaitAppUpdate(callback) {
    if (!(navigator.serviceWorker && navigator.serviceWorker.controller)) return callback();
    function maybeCallback() {
        calledBack || (calledBack = !0, callback());
    }
    var calledBack = !1;
    if (window.controllerchanged) return maybeCallback();
    setTimeout(maybeCallback, 1e4), navigator.serviceWorker.getRegistration().then(function(reg) {
        if (!reg) return maybeCallback();
        if (reg.waiting) return reg.waiting.postMessage("skipWaiting"), maybeCallback();
        function watchStateChange() {
            "installed" == this.state && (reg.waiting && reg.waiting.postMessage("skipWaiting"), 
            maybeCallback());
        }
        reg.installing && reg.installing.addEventListener("statechange", watchStateChange), 
        reg.update(), reg.addEventListener("updatefound", function() {
            reg.installing.addEventListener("statechange", watchStateChange);
        });
    });
}

function remoteConfig(variable, callback) {
    if (_global.isOmnibusApp) {
        if (!_global.isIosApp) {
            var result = _global.androidRemoteConfig && androidRemoteConfig.remoteConfig(variable) || null;
            return safeTimeout(function() {
                callback(result);
            }, 0);
        }
        var nonce = "remoteConfig" + variable + +new Date();
        window[nonce] = function(value) {
            delete window[nonce], callback(value);
        }, callIos("remoteconfig", variable + " " + nonce);
    } else safeTimeout(function() {
        callback(null);
    }, 0);
}

function autotester(sceneText, nav, sceneName, extraLabels) {
    if (19e5 < sceneText.length) throw new Error(sceneName + ": this scene is too large. It may crash on some devices");
    function log(msg) {
        "undefined" != typeof console && console.log(msg);
    }
    var coverage = [];
    printx = printParagraph = function(msg, parent) {};
    var inputCallback, sceneList = [];
    Scene.prototype.oldSceneList || (Scene.prototype.oldSceneList = Scene.prototype.scene_list), 
    Scene.prototype.scene_list = function() {
        if ("startup" != this.name || !this.screenEmpty || !this.initialCommands) throw new Error(this.lineMsg() + "Invalid scene_list instruction, only allowed at the top of startup.txt");
        for (var scenes = this.parseSceneList(), i = 0; i < scenes.length; i++) this.verifySceneFile(scenes[i]);
    }, Scene.prototype.quicktest = !0, Scene.prototype.finish = function(buttonName) {
        this.paragraph(), this.finished = !0, buttonName = this.replaceVariables(buttonName = buttonName || "Next Chapter"), 
        this.testFinish && this.testFinish();
    }, Scene.prototype.bug = function() {
        this.finished = !0;
    }, Scene.prototype.page_break = function(buttonName) {
        this.replaceVariables(buttonName), this.resetCheckedPurchases();
    }, Scene.prototype.subscribe = function() {}, Scene.prototype.feedback = function() {}, 
    Scene.prototype.save = function() {}, Scene.prototype.restore_purchases = function() {}, 
    Scene.prototype.buyButton = function(product, priceGuess, label) {
        var scene;
        seen[label] || ((scene = this.clone()).testPath.push(","), scene.testPath.push(this.lineNum + 1), 
        scene.testPath.push("$"), scene.lineNum = this.lineNum, scene.rollbackLineCoverage(), 
        scene.indent = this.indent, scene.goto(label), scene.rollbackLineCoverage(), scene.resume = function() {
            this.lineNum = this.lineNum, scene.printLoop();
        }, sceneList.push(scene));
    }, Scene.prototype.delay_break = function() {}, Scene.prototype.delay_ending = function(durationInSeconds) {
        var price = durationInSeconds.split(/ /), durationInSeconds = price[0], price = price[1];
        if (isNaN(+durationInSeconds)) throw new Error(this.lineMsg() + "invalid duration");
        if (!/^\$/.test(price)) throw new Error(this.lineMsg() + "invalid price");
        this.paragraph(), this.finished = !0;
    }, Scene.prototype.check_purchase = function(data) {
        for (var products = data.split(/ /), i = 0; i < products.length; i++) this.temps["choice_purchased_" + products[i]] = !0, 
        this.nav.products && this.nav.products[products[i]] || "adfree" == products[i] || this.warning("The product " + products[i] + " wasn't declared in a *product command");
        this.temps.choice_purchase_supported = !1, this.temps.choice_purchased_everything = !0;
    }, printInput = function(target, inputOptions, callback, minimum) {
        inputCallback = function() {
            inputOptions.numeric ? callback(minimum) : callback("blah blah");
        };
    }, Scene.prototype.oldInputText || (Scene.prototype.oldInputText = Scene.prototype.input_text), 
    Scene.prototype.oldInputNumber || (Scene.prototype.oldInputNumber = Scene.prototype.input_number), 
    Scene.prototype.input_text = function(data) {
        this.oldInputText(data), this.lineNum++, inputCallback();
    }, Scene.prototype.input_number = function(data) {
        this.oldInputNumber(data), this.lineNum++, inputCallback();
    }, Scene.prototype.goto_random_scene = function(data) {
        for (var parsed = this.parseGotoRandomScene(data), i = 0; i < parsed.length; i++) {
            var name = parsed[i].name;
            this.verifySceneFile(name);
        }
        /\ballow_no_selection\b/.test(data) || (this.finished = !0);
    }, Scene.prototype.save_game = function(destinationSceneName) {
        if (!destinationSceneName) throw new Error(this.lineMsg() + "*save_game requires a destination file name, e.g. *save_game Episode2");
        this.verifySceneFile(destinationSceneName);
    }, Scene.prototype.restore_game = function(data) {
        if (this.parseRestoreGame(!1), data) {
            var result = /^cancel=(\S+)$/.exec(data);
            if (!result) throw new Error(this.lineMsg() + "invalid restore_game line: " + data);
            cancel = result[1], this.goto(cancel);
        }
    }, Scene.prototype.rollbackLineCoverage = function(lineNum) {
        lineNum = lineNum || this.lineNum, coverage[lineNum]--;
    };
    try {
        Scene.prototype.__defineGetter__("lineNum", function() {
            return this._lineNum;
        }), Scene.prototype.__defineSetter__("lineNum", function(val) {
            coverage[val] ? coverage[val]++ : coverage[val] = 1, this._lineNum = val;
        });
    } catch (e) {}
    function dojoClone(o) {
        if (!o) return o;
        if (o instanceof Array || "array" == typeof o) {
            for (var r = [], i = 0; i < o.length; ++i) r.push(dojoClone(o[i]));
            return r;
        }
        if ("object" != typeof o && "function" != typeof o) return o;
        if (o.nodeType && o.cloneNode) return o.cloneNode(!0);
        if (o instanceof Date) return new Date(o.getTime());
        for (i in r = "function" == typeof o.constructor ? new o.constructor() : {}, o) i in r && r[i] == o[i] || (r[i] = dojoClone(o[i]));
        return r;
    }
    Scene.prototype.choice = function(data) {
        var groups = [ "choice" ];
        if (data) for (var groups = data.split(/ /), i = 0; i < groups.length; i++) if (!/^\w*$/.test(groups[i])) throw new Error(this.lineMsg() + "invalid choice group name: " + groups[i]);
        var choiceLine = this.lineNum, options = this.parseOptions(this.indent, groups);
        for (this.temps._choiceEnds || (this.temps._choiceEnds = {}), i = 0; i < options.length; i++) this.temps._choiceEnds[options[i].line - 1] = this.lineNum;
        var flattenedOptions = [];
        !function flattenOptions(list, options, flattenedOption) {
            flattenedOption = flattenedOption || {};
            for (var i = 0; i < options.length; i++) {
                var option = options[i];
                flattenedOption[option.group] = i, option.suboptions ? flattenOptions(list, option.suboptions, flattenedOption) : (flattenedOption.ultimateOption = option, 
                list.push(dojoClone(flattenedOption)));
            }
        }(flattenedOptions, options);
        for (var index = 0; index < flattenedOptions.length; index++) {
            var item = flattenedOptions[index];
            this.printLine(item.ultimateOption.name);
            var scene = this.clone();
            scene.testOption = item, scene.testChoiceLine = choiceLine, scene.testPath.push(","), 
            scene.testPath.push(choiceLine + 1), scene.testPath.push("#"), scene.testPath.push(index + 1), 
            scene.testPath.push(" ("), scene.testPath.push(item.ultimateOption.line), scene.testPath.push(")"), 
            scene.resume = function() {
                this.standardResolution(this.testOption.ultimateOption);
            }, sceneList.push(scene);
        }
        this.finished = !0;
    }, Scene.prototype.clone = function() {
        this.stats.scene = null;
        var scene = dojoClone(this.stats), scene = new Scene(this.name, scene, this.nav, {
            secondaryMode: this.secondaryMode
        });
        return scene.lines = this.lines, scene.labels = this.labels, scene.temps = dojoClone(this.temps), 
        scene.loaded = !0, scene.testPath = dojoClone(this.testPath), scene.firstTab = this.firstTab, 
        scene.firstSpace = this.firstSpace, this.stats.scene = this, scene;
    }, Scene.prototype.conflictingOptions = function() {}, Scene.prototype.oldRunCommand || (Scene.prototype.oldRunCommand = Scene.prototype.runCommand), 
    Scene.prototype.runCommand = function(line) {
        return this.ignoreCoverage || !(1 < coverage[this._lineNum]) || /^\s*\*else/i.test(line) || seenInChoice[this.lineNum] ? this.oldRunCommand(line) : (this.return(), 
        !0);
    }, Scene.prototype.oldGoto || (Scene.prototype.oldGoto = Scene.prototype.goto);
    var seen = {};
    Scene.prototype.goto = function(label, key) {
        key ? this.oldGoto(label, !0) : (key = label.toLowerCase(), seen[key] ? this.return() : (seen[key] = 1, 
        this.oldGoto(label)));
    }, Scene.prototype.oldGosub || (Scene.prototype.oldGosub = Scene.prototype.gosub), 
    Scene.prototype.gosub = function(label, inChoice) {
        seen[label.toLowerCase()] || this.oldGosub(label);
    }, Scene.prototype.ending = function() {
        this.finished = !0;
    }, Scene.prototype.restart = Scene.prototype.ending, Scene.prototype.goto_scene = function(result) {
        result = this.parseGotoScene(result);
        this.verifySceneFile(result.sceneName), this.finished = !0;
    }, Scene.prototype.redirect_scene = function(data) {
        if ("stats" != this.secondaryMode) throw new Error(this.lineMsg() + "The *redirect_scene command can only be used from the stats screen.");
        this.goto_scene(data);
    }, Scene.prototype.gosub_scene = function(result) {
        result = this.parseGotoScene(result);
        this.verifySceneFile(result.sceneName);
    }, Scene.prototype.return = function() {
        var stackFrame;
        this.temps.choice_substack && this.temps.choice_substack.length ? (stackFrame = this.temps.choice_substack.pop(), 
        this.lineNum = stackFrame.lineNum, this.indent = stackFrame.indent) : this.finished = !0;
    }, Scene.prototype.oldElse || (Scene.prototype.oldElse = Scene.prototype.else), 
    Scene.prototype.else = function(data, inChoice) {
        inChoice ? this.oldIf("true") : this.oldElse();
    }, Scene.prototype.elseif = Scene.prototype.elsif = function(data, inChoice) {
        var result = this.tokenizeExpr(data), result = this.evaluateExpr(result);
        if ("boolean" != typeof result) throw new Error(this.lineMsg() + "Invalid boolean expression; this isn't a boolean: " + result);
        this.else(data, inChoice);
    }, Scene.prototype.oldIf || (Scene.prototype.oldIf = Scene.prototype.if);
    var seenInChoice = {};
    Scene.prototype.if = function(result, inChoice) {
        result = this.tokenizeExpr(result), result = this.evaluateExpr(result);
        if ("boolean" != typeof result) throw new Error(this.lineMsg() + "Invalid boolean expression; this isn't a boolean: " + result);
        if (inChoice) return seenInChoice[this.lineNum] = 1, void this.oldIf("true");
        var scene = this.clone();
        scene.testPath.push(","), scene.testPath.push(this.lineNum + 1), scene.testPath.push("F"), 
        scene.lineNum = this.lineNum, scene.rollbackLineCoverage(), scene.indent = this.indent, 
        scene.skipTrueBranch(), scene.lineNum++, scene.rollbackLineCoverage(), scene.resume = function() {
            this.lineNum = this.lineNum, scene.printLoop();
        }, sceneList.push(scene), this.oldIf("true");
    }, Scene.prototype.stat_chart = function() {
        this.parseStatChart();
    }, Scene.operators["/"] = function(v1, v2, line) {
        return 0 === (v2 = num(v2, line)) ? 9007199254740991 : num(v1, line) / num(v2, line);
    }, sceneName = sceneName || "test";
    var startingStats = {};
    (nav = nav || {
        repairStats: function() {},
        resetStats: function() {},
        startingStats: {},
        bugLog: []
    }).resetStats(startingStats);
    var secondaryMode = void 0;
    "choicescript_stats" == sceneName ? secondaryMode = "stats" : "choicescript_upgrade" == sceneName && (secondaryMode = "upgrade");
    var originalScene = scene = new Scene(sceneName, startingStats, nav, {
        secondaryMode: secondaryMode
    });
    for (scene.testPath = [ sceneName ], scene.loadLines(sceneText), log("executing"), 
    scene.execute(); scene = sceneList.shift(); ) log(scene.testPath.join("")), scene.resume();
    if (extraLabels) for (var i = 0; i < extraLabels.length; i++) {
        var scene, extraLabel = extraLabels[i];
        for ((scene = new Scene(sceneName, startingStats, nav, {
            secondaryMode: secondaryMode
        })).lines = originalScene.lines, scene.labels = originalScene.labels, scene.loaded = !0, 
        scene.targetLabel = extraLabel, seen = {}, scene.ignoreCoverage = !0, scene.testPath = [ sceneName, ",", "goto " + extraLabel.label ], 
        log(scene.testPath.join("")), scene.execute(); scene = sceneList.shift(); ) log(scene.testPath.join("")), 
        scene.resume();
    }
    for (;scene = sceneList.shift(); ) log(scene.testPath.join("")), scene.resume();
    for (var uncovered = [], startRange = null, i = 0; i < coverage.length; i++) line = trim(originalScene.lines[i]), 
    coverage[i] ? startRange == i ? (uncovered.push(startRange), startRange = null) : startRange && (uncovered.push(startRange + "-" + i), 
    startRange = null) : null === startRange && line && !/\*(comment|bug)\b/.test(line) && (startRange = i + 1);
    return startRange && uncovered.push(startRange + "-" + (i - 1)), uncovered.length ? (log("UNCOVERED:"), 
    log(uncovered.join("\n")), [ coverage, uncovered ]) : [ coverage ];
}

webSaveDomain = "www.choiceofgames.com", webSaveUrl = "https://" + webSaveDomain + "/ajax_proxy.php/websave", 
tempStatWrites = {}, crcTable = "00000000 77073096 EE0E612C 990951BA 076DC419 706AF48F E963A535 9E6495A3 0EDB8832 79DCB8A4 E0D5E91E 97D2D988 09B64C2B 7EB17CBD E7B82D07 90BF1D91 1DB71064 6AB020F2 F3B97148 84BE41DE 1ADAD47D 6DDDE4EB F4D4B551 83D385C7 136C9856 646BA8C0 FD62F97A 8A65C9EC 14015C4F 63066CD9 FA0F3D63 8D080DF5 3B6E20C8 4C69105E D56041E4 A2677172 3C03E4D1 4B04D447 D20D85FD A50AB56B 35B5A8FA 42B2986C DBBBC9D6 ACBCF940 32D86CE3 45DF5C75 DCD60DCF ABD13D59 26D930AC 51DE003A C8D75180 BFD06116 21B4F4B5 56B3C423 CFBA9599 B8BDA50F 2802B89E 5F058808 C60CD9B2 B10BE924 2F6F7C87 58684C11 C1611DAB B6662D3D 76DC4190 01DB7106 98D220BC EFD5102A 71B18589 06B6B51F 9FBFE4A5 E8B8D433 7807C9A2 0F00F934 9609A88E E10E9818 7F6A0DBB 086D3D2D 91646C97 E6635C01 6B6B51F4 1C6C6162 856530D8 F262004E 6C0695ED 1B01A57B 8208F4C1 F50FC457 65B0D9C6 12B7E950 8BBEB8EA FCB9887C 62DD1DDF 15DA2D49 8CD37CF3 FBD44C65 4DB26158 3AB551CE A3BC0074 D4BB30E2 4ADFA541 3DD895D7 A4D1C46D D3D6F4FB 4369E96A 346ED9FC AD678846 DA60B8D0 44042D73 33031DE5 AA0A4C5F DD0D7CC9 5005713C 270241AA BE0B1010 C90C2086 5768B525 206F85B3 B966D409 CE61E49F 5EDEF90E 29D9C998 B0D09822 C7D7A8B4 59B33D17 2EB40D81 B7BD5C3B C0BA6CAD EDB88320 9ABFB3B6 03B6E20C 74B1D29A EAD54739 9DD277AF 04DB2615 73DC1683 E3630B12 94643B84 0D6D6A3E 7A6A5AA8 E40ECF0B 9309FF9D 0A00AE27 7D079EB1 F00F9344 8708A3D2 1E01F268 6906C2FE F762575D 806567CB 196C3671 6E6B06E7 FED41B76 89D32BE0 10DA7A5A 67DD4ACC F9B9DF6F 8EBEEFF9 17B7BE43 60B08ED5 D6D6A3E8 A1D1937E 38D8C2C4 4FDFF252 D1BB67F1 A6BC5767 3FB506DD 48B2364B D80D2BDA AF0A1B4C 36034AF6 41047A60 DF60EFC3 A867DF55 316E8EEF 4669BE79 CB61B38C BC66831A 256FD2A0 5268E236 CC0C7795 BB0B4703 220216B9 5505262F C5BA3BBE B2BD0B28 2BB45A92 5CB36A04 C2D7FFA7 B5D0CF31 2CD99E8B 5BDEAE1D 9B64C2B0 EC63F226 756AA39C 026D930A 9C0906A9 EB0E363F 72076785 05005713 95BF4A82 E2B87A14 7BB12BAE 0CB61B38 92D28E9B E5D5BE0D 7CDCEFB7 0BDBDF21 86D3D2D4 F1D4E242 68DDB3F8 1FDA836E 81BE16CD F6B9265B 6FB077E1 18B74777 88085AE6 FF0F6A70 66063BCA 11010B5C 8F659EFF F862AE69 616BFFD3 166CCF45 A00AE278 D70DD2EE 4E048354 3903B3C2 A7672661 D06016F7 4969474D 3E6E77DB AED16A4A D9D65ADC 40DF0B66 37D83BF0 A9BCAE53 DEBB9EC5 47B2CF7F 30B5FFE9 BDBDF21C CABAC28A 53B39330 24B4A3A6 BAD03605 CDD70693 54DE5729 23D967BF B3667A2E C4614AB8 5D681B02 2A6F2B94 B40BBE37 C30C8EA1 5A05DF1B 2D02EF8D", 
shortMonthStrings = [ null, "Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec" ], 
nav = new SceneNavigator([ "startup" ]), stats = {};